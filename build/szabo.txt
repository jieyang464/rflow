MODERN
QUANTUM CHEMISTRY
Introduction to Advanced
Electronic Structure Theory
ATTILA SZABO

Laboratory of Chemical Physics
National Institutes of Health
Bethesda, Maryland

NEIL 8S. OSTLUND
Hypercube, Inc.

Waterloo, Ontario

DOVER PUBLICATIONS, INC.
Mineola, New York

Copyright
Copyright © 1982 by Macmillan Publishing Co., Inc.
Copyright © 1989 by McGraw-Hill, Inc.

All rights resers 2d under Pan American and International Copyright Conventions.
, Don
Published in Canada by General Publishing Company, Ltd., 30 Lesmilf Road
‘

Mills, Toronto, Ontario.

ers,
Published in the United Kingdom by Constable and Company, Ltd., 3 The Lanchest

162-164 Fulham Palace Road,

London W6 9ER.

Bibliographical Note
ation of
This Dover edition, first published in 1996, is an unabridged, unaltered republic
Comthe “First Edition, Revised,” originally published by the McGraw-Hill Publishing

pany,

New York,

1989. The original edition was published by the Maemillan Publishing

Company, New York, 1982.

Library of Congress Cataloging-in-Publication Data
i
Szabo, Attila, 1947—
Modem quantum chemistry : introduction to advanced electronic

‘

Attila Szabo, Neil S. Ostlund.
p.
cm,
Previously published:

structure theory /

Ist ed., rev. New York : McGraw-Hill, c1989.

Includes bibliographical references and index.
ISBN 0-486-69186-1 (pbk.)
1. Ostlund, Neil S.
1. Quantum chemistry.
1996}
[QD462.895
541.2’8—dce20

IT. Title.

i

Manufactured in the United States of America
Dover Publications, Inc., 31 East 2nd Street, Mineola, N.Y. 11501

96-10775
CIP

TABLE

OF CONTENTS

Preface to Revised Edition

ix

Preface

xi

Chapter 1.
1.1

Mathematical Review

Linear Algebra

1.1.1
1.1.2
1.1.3
1.1.4
1.1.5
1.1.6
1.1.7

Three-Dimensional Vector Algebra
2
Matrices
5
Determinants
7
N-Dimensional Complex Vector Spaces
Change of Basis
13
The Eigenvalue Problem
15
Functions of Matrices
2]

9

1.2

Orthogonal Functions, Eigenfunctions, and Operators

24

1.3

The Variation Method
1.3.1 The Variation Principle

31

1.3.2.

31

The Linear Variational Problem

33

Notes

38

Further Reading

38

Chapter 2.

39

2.1

The Electronic Problem
2.1.1

2.1.2
2.1.3.

2.2

Many Electron Wave Functions and Operators
Atomic Units

41

The Born-Oppenheimer Approximation
43
The Antisymmetry or Pauli Exclusion Principle

Orbitals, Slater Determinants, and Basis Functions
2.2.1 Spin Orbitals and Spatial Orbitals 46
2.2.2.

Hartree Products

47

45

46

iv MODERN

2.2.3
2.2.4
2.2.5
2.2.6
2.2.7

2.3

2.4

CHEMISTRY

Slater Determinants 49
The Hartree-Fock Approximation
53
The Minimal Basis H, Model
55
Excited Determinants
58
Form of the Exact Wave Function and Configuration Interaction

Operators and Matrix Elements
2.3.1
2.3.2
2.3.3.
2.3.4
2.3.5
2.3.6
2.3.7
2.4.1

Minimal Basis H, Matrix Elements 64
Notations for One- and Two-Electron Integrals 67
General Rules for Matrix Elements 68
Derivation of the Rules for Matrix Elements
74
Transition from Spin Orbitals to Spatial Orbitals 87
Coulomb and Exchange Integrals 85
Pseudo-Classical Interpretation of Determinantal Energies
Creation and Annihilation Operators and Their
Anticommutation Relations 8&9
Second-Quantized Operators and Their Matrix Elements

87

89
95

Spin-Adapted Configurations
2.5.1.
2.5.2
2.5.3

Spin Operators
97
Restricted Determinants and Spin-Adapted Configurations
Unrestricted Determinants
/04

60

64

Second Quantization
2.4.2

2.5

QUANTUM

97
100

Notes

107

Further Reading

107

Chapter 3.

108

The Hartree-Fock Approximation

3.1

The Hartree-Fock Equations

3.2

Derivation of the Hartree-Fock Equations

3.1.1
3.1.2

3.2.1.
3.2.2
3.2.3.

The Coulomb and Exchange Operators
The Fock Operator
114

iil

112

Functional Vanation
1/15
Minimization of the Energy of a Single Determinant
The Canonical Hartree-Fock Equations 120

115
117

3.3

Interpretation of Solutions to the Hartree-Fock Equations

123

3.4

Restricted Closed-Shell Hartree-Fock: The Roothaan Equations

131

3.3.1
3.3.2.
3.3.3.

3.4.1
3.4.2.
3.4.3
3.4.4.
3.4.5

Orbital Energies and Koopmans’ Theorem
Brillouin’s Theorem
128
The Hartree-Fock Hamiltoman
130

123

Closed-Shell Hartree-Fock: Restricted Spin Orbitals 132
Introduction of a Basis: The Roothaan Equations
136
The Charge Density
138
Expression for the Fock Matrix
140
Orthogonalization of the Basis 142

TABLE

3.4.6
3.4.7.

3.5

3.6

3.7

3.8

The SCF Procedure
145
Expectation Values and Population Analysis

OF

CONTENTS

149

Model Calculations on H, and HeH*
3.5.1
3.5.2
3.5.3.

The 1s Minimal STO-3G Basis Set 153
STO-3GH,
159
An SCF Calculation on STO-3G HeH*

152
168

Polyatomic Basis Sets
3.6.1
3.6.2
3.6.3
3.6.4

Contracted Gaussian Functions
180
Minimal Basis Sets: STO-3G
184
Double Zeta Basis Sets: 4-31G
186
Polarized Basis Sets: 6-31G* and 6-31G**

180

189

Some Illustrative Closed-Shell Calculations
3.7.1
3.7.2
3.7.3.
3.7.4

Total Energies
191
lonization Potentials
194
Equilibrium Geometries
200
Population Analysis and Dipole Moments

190

203

Unrestricted Open-Shell Hartree-Fock:
The Pople-Nesbet Equations
3.8.1
3.8.2
3.8.3
3.8.4
3.8.5
3.8.6
3.8.7.

Vv

Open-Shel] Hartree Fock: Unrestricted Spin Orbitals 206
Introduction of a Basis: The Pople-Nesbet Equations 2/0
Unrestricted Density Matrices
2/2
Expression for the Fock Matrices
214
Solution of the Unrestricted SCF Equations
215
Illustrative Unrestricted Calculations 2/6
The Dissociation Problem and its Unrestricted Solution
22/

Notes

205

229

Further Reading

229

Chapter 4.

231

4.1

Configuration Interaction

Multiconfigurational Wave Functions and the

Structure of the Full CI Matrix

233

4.2

Doubly Excited Cl

242

4.3

Some Illustrative Calculations

245

4.4

Natural Orbitals and the One-Particle Reduced Density Matrix

252

4.5

The Multiconfiguration Self-Consistent Field (MCSCF)
and Generalized Valence Bond (GVB) Methods

258

4.6

Truncated CI and the Size-Consistency Problem

261

4.1.1

Intermediate Normalization and an Expression for
the Correlation Energy 237

Vi

MODERN

QUANTUM

CHEMISTRY

Notes

269

Further Reading

269

Chapter 5.

5.1

5.2

The Independent Electron Pair Approximation (IEPA)

5.1.1
51.2

Invariance under Unitary Transformations: An Example
Some Illustrative Calculations 284

277

Coupled-Pair Theories

5.2.1
5.2.2.
5.2.3.

5.2.4

5.3

271

Pair and Coupled-Pair Theories

287
The Coupled Cluster Approximation (CCA)
290
The Cluster Expansion of the Wave Function
Linear CCA and the Coupled Electron Pair
Approximation (CEPA)
292
Some Illustrative Calculations
296

Many-Electron Theories with Single Particle Hamiltonians

5.3.1
5.3.2

The Relaxation Energy via Cl, IEPA, CCA, and CEPA
303
The Resonance Energy of Polyenes in Hiickel Theory
309

272

286

297

Notes

318

Further Reading

319

Chapter 6.

Many-Body Perturbation Theory

320

6.1

Rayleigh-Schrédinger (RS) Perturbation Theory

322

*6.2

Diagrammatic Representation of RS Perturbation Theory

327

6.3

Orbital Perturbation Theory: One-Particle Perturbations

338

*6.4

Diagrammatic Representation of Orbital Perturbation Theory

348

6.5

Perturbation Expansion of the Correlation Energy

350

6.6

The N-Dependence of the RS Perturbation Expansion

354

*6.7

Diagrammatic Representation of the Perturbation
Expansion of the Correlation Energy

356

6.2.1
62.2
6.2.3

671

672
6.73
6.7.4

6.8

Diagrammatic Perturbation Theory for 2 States
Diagrammatic Perturbation Theory for N States
Summation of Diagrams
336

Hugenholtz Diagrams

356

Goldstone Diagrams
362
Summation of Diagrams 368
What Is the Linked Cluster Theorem?

Some Illustrative Calculations

327
335

369

370

Notes

378

Further Reading

379

TABLE OF CONTENTS

Chapter 7.

The One-Particle Many-Body Green’s Function

Vii

380

7.1

Green’s Functions in Single Particle Systems

381

7.2.

The One-Particle Many-Body Green’s Function

387

7.2.1
7.2.2

The Self-Energy
389
The Solution of the Dyson Equation

39]

7.3

Application of the Formalism to H, and HeH*

392

7.4

Perturbation Theory and the Green’s Function Method

398

7.5

Some Illustrative Calculations

405

Notes

409

Further Reading

409

Appendix A.

Integral Evaluation with 1s Primitive Gaussians

410

Appendix B.

Two-Electron Self-Consistent-Field Program

417

Appendix C.
Analytic Derivative Methods and Geometry
Optimization by M.C. Zerner

437

Appendix D.
Length

459

Index

Molecular Integrals for H, as a Function of Bond

461

Szeretettel a sziileimnek
AS

To my wonderful father and
the memory of my dear mother
NSO

PREFACE

TO

REVISED

EDITION

This revised edition differs from its predecessor essentially in three ways.
First, we have included an appendix describing the important recent developments that have made the efficient generation of equilibrium geometries almost routine. We are fortunate that M. Zerner agreed to write
this since our own recent interests have been channeled in other directions.
Second, numerous minor but annoying errors have been corrected. For
most of these we are indebted to K. Ohno, T. Sakai and Y. Mochizuki

who detected them in the course of preparing the Japanese translation
which has recently been published by Tokyo University Press. Finally, we
have updated the Further Reading sections of all the chapters. We are
extremely pleased by the many favorable comments we have received about our
book and we hope that the next generation of readers will find this edition useful.
ATTILA SZABO
NEIL S. OSTLUND

PREFACE

The aim of this graduate textbook is to present and explain, at other than a
superficial level, modern ab initio approaches to the calculation of the
electronic structure and properties of molecules. The first three chapters
contain mtroductory material culminating in a thorough discussion of the
Hartree-Fock approximation. The remaining four chapters describe a variety
of more sophisticated approaches, which improve upon this approximation.
We have strived to make advanced ‘opics understandable to the beginning graduate student. Our goal was to teach more than cocktail party
jargon; we wanted to give insight into the nature and validity of a variety
of approximate formalisms and improve the reader’s problem-solving skills.
Needless to say, a book of this size cannot cover all of quantum chemistry;
it would be easy to write down a long list of important topics which we have
not covered. Nevertheless, we believe that anyone who has mastered the
material in this book will have a solid foundation to build upon, and will

be able to appreciate most research papers and seminars dealing with
electronic structure theory and its applications.
The origins of this book go back to our student days when we were
trying to understand a variety of quantum chemical formalisms that at first
glance appeared to be extremely complicated. We found that by applying
such formalisms to simple, analytically tractable, model systems we not only
got a feeling as to what was involved in performing actual calculations but
also gained insight into the interrelationships among different approximation
schemes.

The models

we used then, and ones we devised or learned sub-

sequently, play an important role in the pedagogical approach we adopt in
this book. The writing began in 1976 when we jointly taught a special topics
course at Indiana University. The manuscript gradually evolved in response
to the needs and reactions of students enrolled in a second-semester quantum
xi

xii MODERN QUANTUM CHEMISTRY

chemistry course we taught some five times at both Indiana University and
the University of Arkansas.
Animportant feature of this book is that over 150 exercises are embedded
in the body of the text. These problems were designed to help the reader
acquire a working knowledge of the material. The level of difficulty has been
kept reasonably constant by breaking up the more complicated ones into
manageable parts. Much of the value of this book will be missed if the
exercises are ignored.
In the following, we briefly describe some of the highlights of the seven
chapters. Chapter I reviews the mathematics (mostly matrix algebra) required for the rest of the book. It is self-contained and suited for self-study.
Its presence in this book is dictated by the deficiency in mathematics of
most chemistry graduate students. The pedagogical strategy we use here,
and in much of the book, is to begin with a simple example that illustrates
most of the essential ideas and then gradually generalize the formalism to
handle more complicated situations.
Chapter

2 introduces

the

basic

techniques,

ideas,

and

notations

of

quantum chemistry. A preview of Hartree-Fock theory and configuration
interaction is used to motivate the study of Slater determinants and the
evaluation of matrix elements between such determinants. A simple model
system (minimal basis H,) is introduced to illustrate the development. This
model and its many-body generalization (N independent H, molecules)
reappear in all subsequent chapters to illuminate the formalism. Although
not essential for the comprehension of the rest of the book, we also present
here a Self-contained discussion of second quantization.
Chapter 3 contains a thorough discussion of the Hartree-Fock approximation. A unique feature of this chapter is a detailed illustration of the
computational aspects of the self-consistent-field procedure for minimal
basis HeH*. Using the output of a simple computer program, listed in
Appendix B, the reader is led iteration-by-iteration through an ab initio
calculation. This chapter also describes the results of Hartree-Fock calculations on a standard set of simple molecules using basis sets of increasing
sophistication. We performed most of these calculations ourselves, and in
later chapters we use these same molecules and basis sets to show how the
Hartree-Fock results are altered when more sophisticated approaches are
used. Thus we illustrate the influence of both the quality of the one-electron
basis set and the sophistication of the quantum chemical method on calculated results. In this way we hope to give the reader a feeling for the kind
of accuracy that can be expected from a particular calculation.
Chapter 4 discusses configuration interaction (CI) and is the first of the
four chapters that deal with approaches incorporating electron correlation.
One-electron density matrices, natural orbitals. the multiconfiguration selfconsistent-field approximation, and the generalized valence bond method are

PREFACE

Xiii

discussed from an elementary point of view. The size-consistency problem
associated with truncated CI is illustrated using a model consisting of
N independent hydrogen molecules. This example highlights the need for
so-called many-body approaches, which do not suffer from this deficiency,
that are discussed in subsequent chapters.
Chapter 5 describes the independent electron pair approximation and
a variety of more sophisticated approaches that incorporate coupling between pairs. Since this chapter contains some of the most advanced material
in the book, many illustrative examples are included. In the second half of
the chapter, as a pedagogical device, we consider the application of manyelectron approaches to an N-electron system described by a Hamiltonian
containing only single particle interactions. This problem can be solved
exactly in an elementary way. However, by seeing how “high-powered”
approaches work in such a simple context. the student can gain insight into
the nature of these approximations.
Chapter 6 considers the perturbative approach to the calculation of the
correlation energy of many-electron systems. A novel pedagogical approach
allows the reader to acquire a working knowledge of diagrammatic perturbation theory surprisingly quickly. Although the chapter is organized so
that the sections on diagrams (which are starred) can be skipped without
loss of continuity, we find that the diagrammatic approach is fun to teach
and is extremely well received by students.
Chapter 7 contains a brief introduction to the use of the one-particle
many-body Green’s function in quantum chemistry. Our scope is restricted
to discussing ionization potentials and electron affinities. The chapter is
directed towards a reader having no knowledge of second quantization or
Green’s functions, even in a simple context.
This book is largely self-contained and, m principle, requires no prerequisite other than a solid undergraduate physical chemistry course. However, exposure to quantum chemistry at the level of the text by I. N. Levine
(Quantum Chemistry, Allyn and Bacon) will definitely enhance the student’s
appreciation of the subject material. We would normally expect the present
text to be used for the second semester of a two-semester sequence on quantum chemistry. It is also suitable for a special topics course. There is probably
too much material in the book to be taught in-depth in a single semester.
For students with average preparation, we suggest covering the first four
chapters and then discussing any one of the last three, which are essentially
independent. Our preferred choice is Chapter 6. For an exceptionally wellprepared class, the major fraction of the semester could be spent on the
last four chapters. We have found that a course based on this text can be
enriched in a number of ways. For example, it is extremely helpful for
students to perform their own numerical calculations using, say, the Gaussian
80 system of programs. In addition, recent papers on the applications of

xiv

MODERN

QUANTUM

CHEMISTRY

electronic structure theory can be assigned at the beginning of the course
and the students asked to give short in-class presentations on one or more
of such papers at the end-of the course.
We have placed special emphasis on using a consistent notation through-

out the book. Since quantum chemists use a number of different notations,
it is appropriate to define the notation we have adopted. Spatial molecular

orbitals (with latin mdices i, j,k...) are denoted by wy. These are usually

expanded in a set of spatial (atomic) basis functions (with greek indices
Lt, v, 4,..-) denoted by @. Molecular spin orbitals are denoted by y. Occupied
molecular orbitals are specifically labeled by a, b, c,... and unoccupied
(virtual) molecular orbitals are specifically labeled by r, s, t,... Manyelectron operators are denoted by capital script letters (for example, the
Hamiltonian

is #), and one-electron operators are denoted by lower case

latin letters (for example, the Fock operator for electron-one is f(1)). The
exact many-electron wave function 1s denoted by ®, and we use V to denote
approximate many-electron wave functions (i.e.. the Hartree-Fock ground
state wave function is ‘Wo, while ‘V5, is a doubly excited wave function).
Exact and approximate energies are denoted by & and E, respectively. All
numerical quantities (energies, dipole moments, etc.) are given in atomic
units.

It is a pleasure to thank those people who helped us with scientific
aspects of this book. J, A. Pople has always been a source of inspiration.
M. Karplus and W. Reinhardt introduced us to many-body theory. J.-P.
Malrieu and K. Schulten independently showed us in the early 1970s how
to illustrate the lack of size consistency of doubly excited configuration
interaction using the model of N noninteracting H, molecules. This led
to our extensive use of this model. M. Zerner constructively criticized the
entire manuscript. The following colleagues gave advice, performed cal-

culations just for the book, or assisted us in some other useful way: R. Bartlett,
J. Binkley, M. Bowen, R. Counts, C. Dykstra, W. Eaton, D. Freeman,
W. Goddard III. S. Hagstrom, A. Hernandez, D. Merrifield, J. Neece,

I. Shavitt, and R. Whiteside. The following students helped us clarify our
presentation and eliminate errors: B. Basinger. G. Caldwell, T. Croxton,
R. Farren, R. Feeney. M. Flanagan, J. Freeze. V. Hess. K. Holtzclaw, J. Joens,
J. Johnson, R. Jones, J. Kehayias, G. Lipari, D. Lupo, D. McMullen, J. Meek,
S. Munchak, N. Peyghambarian, R. Russo, W. Schinzer, D. Shoup, B. Stone,
E. Tsang and I. Waight. Of all the secretaries who typed various versions
of the manuscript, K. Wagner, M. Mabie, and L. Ferro were the most
helpful. J. Hawkins prepared the illustrations.
ATTILA SZABO
Ne S. OstLUND

CHAPTER

ONE

MATHEMATICAL
REVIEW

This chapter provides the necessary mathematical background for the rest
of the book. The most important mathematical tool used m quantum chemistry is matrix algebra. We have directed this chapter towards the reader who
has some familiarity with matrices but who has not used them in some time
and is anxious to acquire a working knowledge of linear algebra. Those with
strong mathematical backgrounds can merely skim the material to acquaint

themselves with the various notations we use. Our development is informal
and rigour 1s sacrificed for the sake of simplicity. To help the reader develop

those often neglected, but important, manipulative skills we have included
carefully selected exercises within the body of the text. The material cannot
be mastered without doing these simple problems.
In Section 1.1 we present the elements of linear algebra by gradually
generalizing the ideas encountered in three-dimensional vector algebra. We
consider matrices, determinants. linear operators and their matrix representations, and, most importantly, how to find the eigenvalues and eigenvectors of certain matrices. We introduce the very clever notation of Dirac,
which expresses our results in a concise and elegant manner. This notation
is extremely useful because it allows one to manipulate matrices and derive
various theorems painlessly. Moreover, it highlights similarities between
lmear algebra and the theory of complete sets of orthonormal functions as
will be seen in Section

1.2. Finally, in Section

1.3 we consider one of the

cornerstones of quantum chemistry namely, the variation principle.

2

MODERN

QUANTUM

1.1 LINEAR

CHEMISTRY

ALGEBRA

We begin our discussion of linear algebra by reviewing three-dimensional
vector algebra. The pedagogical strategy we use here, and in much of the

book, 1s to start with the simplest example that iilustrates the essential ideas
and then gradually generalize the formalism to handle more complicated

situations.

1.1.1 Three-Dimensional Vector Algebra
A three-dimensional vector can be represented by specifying 1ts components
a,, 1=1,2,3 with respect to a set of three mutually perpendicular unit

vectors {é,} as

d= é,a, + &,a, + éya, =) Ga,

(1-1)

I

The vectors é; are said to form

a basis, and

are called basis vectors. The

basis 1s complete in the sense that any three-dimensional vector can be
written as a linear combination of the basis vectors. However, a basis is
not unique, we could have chosen three different mutually perpendicular
unit vectors, é,, 1 = 1, 2, 3 and represented G as

& = #ya, + é,a) + 303 = > Fa,

(1.2)

Given a basis, a vector is completely specified by its three components with
respect to that basis. Thus we can represent the vector @ by a column matrix as

a=[a,}

in the basis {6}

(1.3a)

a =|a,]_

in the basis {é,}

(1.3b)

or as

The scalar or dot product of two vectors a and b is defined as

Note that

a@ b= a,b, + a,b, + a3b3 = >. ab,

(1.4)

a@-&= aj +a} +43 = al’

(1.5)

is simply the square of the length (al) of the vector @. Let us evaluate the
scalar product @- b using Eq. (1 1)

a-b=) Yé-é,a,b,
iy

(1.6)

MATHEMATICAL REVIEW

3

For this to be identical to the definition of (1.4), we must have
eC

Or

.

e..=

65S

6

=

06:

Ouj * C7

—

1 ifi=j

‘0

otherwise

(1.7)

where we have introduced the Kronecker delta symbol 6,;, This relation is
the mathematical way of saying that the basis vectors are mutually per-

pendicular (orthogonal) and have unit length (normalized), in other words
they are orthonormal.

Given a vector d. we can find its component

along é, by taking the

scalar product of Eq. (1 1) with é, and using the orthonormality relation (1.7)

é,-a@=) 2,-@a,=) 5,4, =a,

(1.8)

Hence we can rewrite Eq. ({.1) as

where

a=) é%é,-a=1-4

(1.9)

l=) 2é,

(1.10)

1s the unit dyadic. A dyadic 1s an entity which when dotted mto a vector
gives another vector. The unit dyadic gives the same vector back. Equation

(1.10) is called the completeness relation for the basis {é,} since it is an alternate

form of Eg. (1.1), which states that any vector @ can be written as a linear

combination of the basis vectors {é,}.

We now define an operator @ as an entity which when acting on a vector
a converts it into a vector 5

Oa=6b

(1.11)

The operator is satd to be Jinear if for any numbers x and 3

C(xd + yb) = xOa + yOb

(1.12)

A linear operator 1s completely determined if its effect on every possible
vector is known. Because any vector can be expressed in terms of the basis
{é,!, 1t is sufficient to know what @ does to the basis vectors. Now since

Oé, 1s a vector, it can be written as a linear combination of the basis vectors

té}, ie,

3
Cé, = >» é 0 jis
i=1

1=

1, 2,3

(1.13)

The number O,; is the component of the vector é, along é;. The nine
numbers O,,, 1.) = 1, 2, 3 can be arranged tn a two-dimensional array called
a matrix as
0;

1

0; 2

0;

3

O=[02;

022

O23

Os,

O32

O33

(1.14)

4 MODERN QUANTUM CHEMISTRY

We say that O is the matrix representation of the operator @ in the basis
{é,}. The matrix O completely specifies how the operator @ acts on an
arbitrary vector since this vector can be expressed as a linear combination

of the basis vectors {é,} and we know what © does to each of these basis

vectors.

Exercise 1.1 a)

b, = ¥. 0,;4,.

Show

that

O,,= é,-0@,.

b)

If

04 =5

show

that

i

If A and B are the matrix representations of the operators «/ and &,
the matrix representation of the operator %, which is the product of . and
B(@ = #8), can be found as follows:

€é, =) 8C,,
= SRE,
=o 2, é,By,j
= d, 2,4yBy;

(1.15)

so that

C=

d Ai Br;

(1.16)

which is the definition of matrix multiplication and hence

C= AB

(1.17)

Thus if we define matrix multiplication by (1.16), then the matrix representation of the product of two operators is just the product of their matrix

representations.
The order in which two operators or two matrices are multiplied is
crucial. In general “4 #4 Bo or AB # BA. That is, two operators or
matrices do not necessarily commute. For future reference, we define the
commutator of two operators or matrices as

[7, #] = AR -BA

(1.18a)

[A, B] = AB— BA

(1.18b)

{7, B=

(1.19a)

and their anticommutator as

AB+

Bal

{A, B} = AB + BA

(1.19b)

MATHEMATICAL REVIEW

5

Exercise 1.2 Calculate [A. B] and {A. B} when
1

1
2
2

A=}1
0

1.1.2

0
2
—-t1

1
B=

|-1
1

-]
0
0

]
0
1

Matrices

Now that we have seen how 3 x 3 matrices naturally arise in three-dimen-

sional vector algebra and how they are multiplied, we shall generalize these
results, A set of numbers {A,,} that are in general complex and have ordered
subscripts i= 1,2,...,N and j = 1,2,..., M can be considered elements
of a rectangular (N x M) matrix A with N rows and M columns
Ay,

Aj2

-

Aiy

A

A

7?

7:

A

Ay,

Ana

77

Any

A={7)

OM

(1.20)

If N = M the matrix is square. When the number of columns in the N x M
matrix A is the same as the number of rows in the M

and B can be multiplied to give a N x P matrix C

x P matrix B, then A

C= AB

(1.21)

where the elements of C are given by the matrix multiplication rule
C=
4

“
2,

i=1,...,N

Ay By;

oa

ne

jJ=1,...,P

(

1,22

The set of M numbers {a,} i= 1,2,..., M can similarly be considered
elements of a column matrix
ay

a=|‘?

(1.23)

dy

Note that for an N x M matrix A

Aa=hb

(1.24)

where b is a column matrix with N elements

b=

M

¥ Aya,
jHi

1=1,2,...,N

(1.25)

)

6 MODERN QUANTUM CHEMISTRY

We now introduce some important definitions. The adjoint of an N x M
x N matrix with elements

matrix A, denoted by At, is an M

(1.26)

(A‘),, = A*

ie., we take the complex conjugate of each of the matrix elements of A and

interchange rows and columns. If the elements of A are real, then the adjoint

of A is called the transpose of A.

Exercise 1.3 If A is an N x M matrix and B is a M x K matrix show

that (AB) = BtAt,

The adjoint of a column matrix is a row matrix containing the complex
conjugates of the elements of the column matrix.
at = (a*a%--- aX)

(1.27)

If a and b are two column matrices with M elements, then

by
atht = (ataS-+-ak)|

b,\_.°

|= ¥ a¥b,

:

i=1

(1.28)

bu
Note that if the elements of a and b are real and M is 3, this is simply the
scalar product of two vectors, c.f. Eq. (1.4). Taking the adjoint of Eq. (1.24)
and using the result of Exercise 1.3 we have

bt = atat

(1.29)

where bt is a row matrix with the N elements
M

bx = > ayia

M

=(¥

ay)

*

i=1,2,...,N

J=1
j=l
=
Note that Eq. (1.30) is simply the complex conjugate of Eq. (1.25).

(1.30)

We now give certain definitions and properties applicable only to square
matrices:

1. A matrix A is diagonal if all its off-diagonal elements are zero

Ajj = Ai6ij-

(1.31)

2. The trace of the matrix A is the sum of its diagonal elements

trA=) A,,.

(1.32)

1A=AL=A

(1.33)

3. The unit matrix is defined by

MATHEMATICAL REVIEW

7

for any matrix A, and has elements
(D,;

(1.34)

Oy

=

4. The inverse of the matrix A, denoted by A7', is a matrix such that

AUA=AA™'=1

(1.35)

5. A unitary matrix A is one whose inverse is its adjoint

Av! = At.

(1.36)

A real unitary matrix is called orthogonal.

6. A Hermitian matrix is self-adjoint, i.e.,

At=A

(1.37a)

A = Ay

(1.37b)

or

A real Hermitian matrix is called symmetric.
Exercise 1.4 Show that

Boe

tr AB = trBA.

(AB)~! = B71A7!,

If U is unitary and B = UTAU, then A = UBUT.
If the product C = AB of two Hermitian matrices is also Hermitian, then
A and B commute.

e. If A is Hermitian then A~?, if it exists, is also Hermitian.

bata =(40

Ax,

1.1.3

(2)
Aaa

nen Aw! = pt
(Ay1A22

—

Ay2Aa1)

( Aaa

“any,

—Ax

Ay

Determinants

We now define and give some properties of the determinant of a square
matrix A. Recall that a permutation of the numbers 1, 2, 3,..., N is simply
a way of ordering these numbers, and there are N! distinct permutations of
N numbers. The determinant of an N x N matrix A is a number obtained
by the prescription

det(A) = [A] =}:

Ay

-**)

Ain

Ani

°°"

Awyn

>

NI

f= 2D (- PPA WA

Any

(1.38)

mt

where Y, is a permutation operator that permutes the column indices
1, 2, 3,..., N and the sum runs over all N! permutations of the indices; p;

8

MODERN

QUANTUM

CHEMISTRY

to restore a given permutation

of transpositions required

is the number

ij, i,,..., iy to natural order 1, 2, 3,..., N. Note that it is important only

whether p, is an even or odd number. As an illustration we evaluate the
determinant of a 2 x 2 matrix A.
a=(in

a2)

An

Ax?

There are two permutations of the column indices 1 and 2, 1e..
12(p,

=0)

21(p.=

1)

hence
Ay

Ay2

Az,

Adz

oO

1

=(—1)°AyyAn2 + (—1)'AypAay

= AyyAa2 — Ar2Aar

(1.39)

Some important properties of determinants which follow from the above
definition are:
1. If each element in a row or in a column 1s zero the value of the determinant is zero.

2. If (A); = A,6,; ix then |A] = [] Aj = 411422 - - - Ayw-

3. A single interchange of any two rows (or columns) of a determinant
changes its sign.

4. |A| = (jA*])*

5. |AB| = |AI|B}
Exercise 1.5 Verify the above properties for 2 x 2 determinants.
Exercise 1.6 Using properties (1)-(5) prove that in general
6. Ifany two rows (or columns) of a determinant are equal, the value of the
determinant is zero.
oe

7. If|A~!|AAt = = (A)!
1, then |Aj(|A])* = 1.

9. If UtOU = Q and U'tU = UUt = I, then |O| = |Q].
Exercise 1.7 Using Eq. (1.39), note that the inverse of a 2 x 2 matrix
A obtained in Exercise |.4f can be written as
AT

=1

A 22

Al\-4n

—A ")

Ay,

MATHEMATICAL REVIEW

9

and thus A~‘ does not exist when |A| = 0. This result holds in general for
N x N matrices. Show that the equation

Ac = 0

where A is an N x N matrix and c is a column

matrix with elements c,,

r= 1,2,..., N can have a nontrivial solution (¢ # 0) only when |A| = 0.

For a2 x 2 determinant it is easy to verify by direct calculation that
€yBy,
+ C2By,

Aja

€,By,

Aga

+€,By,

=Cy

By,

Ayo

By,

Ao

+

C4

By

Ai

By

Ana

This result is a special case of the following property of determinants that
we shall use several times in the book.
M
Ayy

Ayn

°°"

> By,
k=1

+77

Ain

+>)

Aaw

M

Ao,

Anz

0°

Y

Bo

k=1
M

Ay:

Avo

_

>

O.Bwr

k=1

Ann

xM

Ay,
Ce A 24

Aj2
A 22

By,
B2k

An
A 2N

k=}

:

:

:

:

Ay:

Anw2

°**

Bye

7+

(1.40)

Ayn

A similar result holds for rows.

1.1.4 N-Dimensional Complex Vector Spaces
We need to generalize the ideas of three-dimensional vector algebra to an
N-dimensional space in which the vectors can be complex. We will use the
powerful notation introduced by Dirac, which expresses our results in an
exceedingly concise and simple manner. In analogy to the basis {é,} in three
dimensions, we consider N basis vectors denoted by the symbol |i>, i =
1, 2,..., N, which are called ket vectors or simply kets. We assume this
basis is complete so that any ket vector |2) can be written as

la>= ¥ |Da,
i=1

(1.41)

This is a simple generalization of Eq. (1.1) rewritten in our new notation.

10 MODERN QUANTUM CHEMISTRY

After we specify a basis, we can completely describe our vector |a> by giving
its N components a,, i= 1, 2,..., N with respect to the basis {|i>}. Just as
before, we arrange these numbers in a column matrix a as

a=|.

(1.42)

and we say that a is the matrix representation of the abstract vector |a> in

the basis {|i>}. Recall (Eq. (1.27)) that the adjoint of the column matrix a is

the row matrix a‘

at = (ata} --- ak)

(1.43)

Now we introduce an abstract bra vector <a| whose matrix representation
is at. The scalar product between a bra al and a ket |b> is defined as

by

N

:

i=

<al |b) = <alby = ath = (atay --- a{°2\= 9 ath,

bx

(1.44)

which is the natural generalization of the scalar product defined in Eq. (1.4).

The unusual names bra (for < |) and ket (for | >) were chosen because the
notation for the scalar product (¢ | >) looks like a bra-c-ket. Note that
N

N

<ala>= ¥ aka,= ¥° |a,|?
1=1
i=1

(1.45)

is always real and positive and is just the generalization of the square of the
length of a three-dimensional vector. In analogy to Eq. (1.41) it is natural to
introduce a bra basis {¢i]} that is complete in the sense that any bra <a| can
be written as a linear combination of the bra basis vectors as

<al =) aC
The scalar product between <a

(1.46)

and |b> now becomes

<a|b> =). at<i|
J yb;
yy

For this to be identical to our definition (1.44) of the scalar product we must
have that

<i] = 5,

(1.47)

which is a statement of the orthonormality of the basis and is a generalization of Eq. (1.7). In summary, a ket vector la> is represented by a column

MATHEMATICAL REVIEW

11

matrix a, a bra vector <b is represented by a row matrix bt, and their scalar
product is just the matrix product of their representations.

We now ask, given a

ket |a) or a bra <al, how can we determine its

components with respect to the basis {|i>} or {<i]}? We proceed in complete

analogy to the three-dimensional case (c.f. Eq. (1.8)). We multiply Eq. (1.41)

by <j] on the left and Eq. (1.46) by |j> on the right and obtain

(a> =Y Kida =V bya: = a,

(1.48a)

aki > =D a¥6, = aj

(1.48b)

and

<ali> =

The expression “multiplying by < j| on the left” is a shorthand way of saying

“taking the scalar product with ¢ j|.” Note that

<ila> = Kal i>)* = <al i>*

(1.49)

Using these results we can rewrite Eqs. (1.41) and (1.46) as

lay = 2 lida, = » li><i]ay

(1.50a)

=P <alid<il

(1.50b)

and

<a = Lari
which suggests we write

1= » lé><i

(1.51)

which is the analogue of Eq. (1.10) and is a statement of the completeness of

the basis. We will find that multiplying by unity and using Eq. (1.51) is an
extremely powerful way of deriving many relations.

In analogy to Eq. (1.11), we define an operator © as an entity which
when acting on a ket |a> converts it into a ket [b>.

Olay = |by

(1.52)

As before, the operator is completely determined if we know what it does to

the basis {|i>}:

Olid = VFO, =D [Oj
J

J

(1.53)

so that O is the matrix representation of the operator © in the basis {i>}.
Multiplying (1.53) on the left by <k|, we have

<KOli> =X KK] F>(O)n =X 54,(O), = (Oe
J

J

(1.54)

12 MODERN QUANTUM CHEMISTRY

which provides a useful expression for the matrix elements of O. It should
be noted that we can easily get the matrix representation of © by using the
completeness relation (1.51) as follows

Olid = 10]) =V | <iOwb

(1.55)

which upon comparison to Eq. (1.53) yields

<i|Oli> =O), =O,

(1.56)

As another illustration of the use of the completeness relation and the built-in
consistency and simplicity of Dirac notation, let us find the matrix representation of the operator @ = .Z in terms of the matrix representations of
the operators o/ and # (c.f. Eq. (1.15))

<i@|7> = (©), = <if PAID = <i 1Al7D
= » Cil.A|k><k|B| i>
=) (A),.(B),,
K

We now introduce the adjoint of the operator ©, which we denote by

©*. If @ changes a ket |a> into the ket |b) (c.f. Eq. (1.52)), then its adjoint
changes the bra <al into the bra <6], ie.,

<alOt = <b|

(1.57)

This equation is said to be the adjoint of Eq. (1.52). Multiplying both sides
of Eq. (1.52) by <c| on the left and multiplying both sides of Eq. (1.57) by

|c> on the right, we have

<clCla> = <c]b>
and
<alCt|c> = <b|o>

Since <b|c> = <c|b>*, it follows that
<alO"lc> = <c|Ola>*

(1.58)

Since the labels a, b, and c are arbitrary, we have shown that the matrix

representation of (“t is the adjoint of the matrix representation of @ since

<i{O"|7> = (O%), = <iJOl>* = O%

(1.59)

Finally, we say that an operator is Hermitian when it is self-adjoint

O=0t

(1.60)

Thus the elements of the matrix representation of a Hermitian operator
satisfy

<alO|b> = <alO'|b> = <b|O|ay*

(1.61)

MATHEMATICAL REVIEW

1.1.5

13

Change of Basis

In Subsection 1.1.1 we have seen that the choice of basis is not unique. Given

two complete orthonormal bases {|i>} and {|x>} we now wish to find the

relationship between them. We use latin letters i, 7, k,. . . to specify the bras
and kets in the first basis and greek letters x, 8, y to specify the bras and kets
of the second basis. Thus we have

<i|j> = 6;,.

» i><i] = 1

(1.62a)

<a|B> =o.

= Yi fe><o| = 1

(1.62b)

and

Since the basis {i>} is complete, we can express any ket in the basis {|o>} as
a linear combination of kets in the basis {|i>} and vice versa. That is,

a> = Ia =) |A><i]a> =P DU. = Y |DOa

(1.63)

where we have defined the elements of a transformation matrix U as

<ija> = U,, = (U)ia

(1.64)

Transforming in the opposite direction, we have

|i> = 1] = 2 lo <a |i> = 2 lao>Ux = » Jo>(U" aa

(1.65)

where we have used Eq. (1.49) and the definition of the adjoint matrix to show
that

<ai> = <iJo>* = UX = (U4),

(1.66)

It is important to remember that since we have defined U via Eq. (1.64),
<a|i> # U,; but rather is given by Eq. (1.66). We now prove that the transformation matrix U is unitary. This is a consequence of the orthonormality
of the bases:

=) <ilo><ali>
=

»

(U),,(U"),;

=(UU'),
which in matrix notation is just

1=U0Ut

(1.67a)

In an analogous way, by starting with <a,| B> = 64, one can show that

1=U'U

(1.676)

14 MODERN QUANTUM

CHEMISTRY

and hence U is unitary. Thus we arrive at the important result that two
orthonormal bases are related by a unitary matrix via Eq. (1.63) and its

inverse, Eq. (1.65). As shown by Eq. (1.64), the elements of the transformation
matrix U are scalar products between the two bases.
Let us now consider how the matrix representations of an operator &

are related in two different complete orthonormal bases. The result we shall
obtain plays a central role in the next subsection where we consider the
eigenvalue problem. Suppose O is the matrix representation of @ in the

basis {|i>}, while Q is its matrix representation in the basis {|}

Ol = VID <C>

= YO,

Ola = 2 IB>< BlOla> = x |B>Qga

(1.68a)
(1.68b)

To find the relationship between O and © we use the, by now, familiar
technique of introducing the unit operator

OQug = <olO|B> = <of101/B>

=) <ali><OLD<I|BD
=) (U"),AO),(O)ig

(1.69)

2 = U'OU

(1.70a)

O = UaUt

(1.70b)

ij

Thus

or. multiplying on the left by U and on the right by Ut
These equations show that the matrices O and © are related by a unitary
transformation. The importance of such transformations lies in the fact that
for any Hermitian operator whose matrix representation in the basis {|i>}
is not diagonal, it is always possible to find a basis {|«>} in which the matrix
representation of the operator is diagonal, ie.,

Qup = Odap

(1.71)

In the next subsection we consider the problem of diagonalizing Hermitian
matrices by unitary transformations.

Exercise 1.8 Show that the trace of a matrix is invariant under a unitary
transformation, Le., if
Q=UtOU
then show that trQ = trO.

MATHEMATICAL REVIEW

15

1.1.6 The Eigenvalue Problem
When an operator (@ acts on a vector lo, the resulting vector Is in general

distinct from |x. If Ga) is simply a constant times |e), ice.,

Ole> = ca,\e>

(1.72)

then we say that |) is an eigenvector of the operator (© with an eigenvalue @,.
Without loss of generality we can choose the eigenvectors to be normalized

<ale> = 1

(1.73)

In this book we are interested in the eigenvectors and eigenvalues of Hermitian operators (Ot = ©). They have the following properties.

1. The eigenvalues of a Hermitian operator are real. This follows imme-

diately from Eq. (1.61), which states that

KofOloe> = <alO*e> = <a Ola>*

(1.74)

Multiplying the eigenvalue relation Eq. (1.72) by <a| and substituting into
(1.74) we have
which is the required result.
2. The eigenvectors of a Hermitian operator are orthogonal.
consider

To prove this

O\B> = |B»
The adjoint of this equation is

CBC" = <Bloog
where we have used (1.57) and the fact that the adjoint of a number is its
complex conjugate. Since © is Hermitian and cz, is real, we have

<BlC = < Bla,
Multiplying (1.72) by <|
expressions, we obtain

(1.76)

and (1.76) by |w> and subtracting the resulting

(cop — @,)< Bla = 0

(1.77)

so that <B]a> = Oifw, # @ ,. Thus orthogonality follows immediately if the
two eigenvalues are not the same (nondegenerate). Two eigenvectors |1> and
|2> are degenerate if they have the same eigenvalue

OlL> = a@|1>

O|2> = «|2>

(1.78)

16 MODERN QUANTUM CHEMISTRY

We now show that degenerate eigenvectors can always be chosen to be
orthogonal. We first note that any linear combination of degenerate cigen-

vectors is also an eigenvector with the same eigenvalue, i.e.,

E(x|1> + y|2>) = x1

+ y€|2> = efx|1> + y[2)

(1.79)

There are many ways we can find two linear combinations of |1> and |2),
which are orthogonal. One such procedure is called Schmidt orthogonalization. We assume that |1> and |2) are normalized and let (1]2> = S #0.

We choose |I> = |1> so that {I{I> = 1. We set |II’> = |1> + cl2) and choose
cso that <I| I’) = 0 = | + cS. Finally we normalize |IJ’> to obtain

[IT = (S~? — 1) (Ly — S742)

(1.80)

Thus the eigenvectors {|«>} of a Hermitian operator can be chosen to form
an orthonormal set

(1.81)

<a]B> = bap

The matrix representation of a Hermitian operator © in an arbitrary
basis {|i>} is generally not diagonal. However, its matrix representation in
the basis formed by its eigenvectors is diagonal. To show this we multiply
the eigenvalue equation (1.72) by <f| and use the orthonormality relation
(1.81) to obtain

(1.82)

CBIGla> = 0,65

The eigenvalue problem we wish to solve can be posed as follows. Given
the matrix representation, O, of a Hermitian operator € in the orthonormal

basis {|i), i= 1,2,...,.N} we wish to find the orthonormal basis {|«),

a=

1,2,...,N}

in which

the matrix

representation, Q, of € is diagonal,

i... 1, = ©,5,5. In other words, we wish to diagonalize the matrix O. We
have seen in the last subsection, that the two representations of the operator
© are related by a unitary transformation (c.f. Eq. (1.70a))

X=U'OU

Thus the problem of diagonalizing the Hermitian matrix O is equivalent to
the problem of finding the unitary matrix U that converts O into a diagonal

matrix

Coy

UOU=a0=

W

6

(1.83)
Wy

It is clear from this formulation that an N x N Hermitian matrix
eigenvalues.

has N

MATHEMATICAL REVIEW

17

There exist numerous, efficient algorithms for diagonalizing Hermitian
matrices.’ For our purposes, computer programs based on such algorithms

can be regarded as “black boxes,” which when given O determine U and a.

In order to make contact with the discussion of the eigenvalue problem
found in most elementary quantum chemistry texts. we now consider a
computationally inefficient procedure that is based on finding the roots of
the secular determinant.

The eigenvalue problem posed above can be reformulated as follows.

Given an N x N Hermitian matrix O, we wish to find all distinct column
vectors c (the eigenvectors of O) and corresponding numbers o (the eigenvalues of O) such that
Oc = we

(1.84a)

(O — awl)jc = 0

(1.84b)

This equation can be rewritten as

As shown in Exercise 1.7, Eq. (1.84b) can have a nontrivial solution (c # 0)
only when

[0 — wl] = 0

(1.85)

This is called the secular determinant. This determinant is a polynomial of
degree N in the unknown w. A polynomial of degree N has N roots @,,
a=

1,2,..., N. which in this case are called the eigenvalues of the matrix

O. Once we have found the eigenvalues, we can find the corresponding eigenvectors by substituting each w, into Eq. (1.84) and solving the resulting
equations for c*. In this way, c* can be found to within a multiplicative
constant, which is finally determined by requiring c* to be normalized

¥ (cet = 1

(1.86)

In this way we can find N solutions to Eq. (1.84)
Oc® = w,c*

a=1,2,...,N

(1.87)

Since O is Hermitian, the eigenvalues are real and the eigenvectors are

orthogonal

DV (c*cf = Sup

(1.88)

In order to establish the connection with our previous development, let
us now construct a matrix U defined as U,, = cj, ie.,

co

ch
2

N

= (c'e? +++ c%)

(1.89)

18 MODERN QUANTUM CHEMISTRY

Thus the eth column of U is just the column matrix c*. Then using (1.87)

it can be shown that

Oy

(1.90)

=Ue

-

U

OU

Since U,,, = c?, the orthonormality relation (1.88) is equivalent to

(1.91)

>» URUig = YU ai(Wip = Sag
which in matrix notation is

UU=1

(1.92)

Finally, multiplying both sides of Eq. (1.90) by Ut and using Eq. (1.92) we
have

U'OU=a

(1.93)

which is identical to Eq. (1.83). Thus Eq. (1.89) gives the relationship between

the unitary transformation (U), which diagonalizes the matrix O, and the

eigenvectors (c”) of O.

Exercise 1.9 Show that Eq. (1.90) contains Eq. (1.87) for all «= 1, 2,...,N.
As an illustration of the above formalism, we consider the problem of
finding the eigenvalues and eigenvectors of the 2 x 2 symmetric matrix
(O12 = On))

oO
o=("!!

oO ")

(0.

02

or, equivalently, solving the eigenvalue problem
On

3 )(3)

(o

022]

\C2

(*)
=o
C2

(1.94)

We shall solve this problem in two ways: first via the secular determinant
(Eq. (1.85)) and second by directly finding the matrix U that diagonalizes O.

For Eq. (1.94) to have a nontrivial solution, the secular determinant must
vanish
O1-@

On

O12

|

022 ~ @ = 0 — 0022 + 014) + 041022

~— 012021 = 0

(1.95)

MATHEMATICAL REVIEW

19

This quadratic equation has two solutions

@, = 4011 + O22 — (O22 — O11)" + 401 2021)"7]
2 = [0,1 + O22 + ((O22 — O11)? + 404202,)'"'7]

(1.96a)
(1-966)

which are the eigenvalues of the matrix O. To find the eigenvector corresponding to a given eigenvalue, say «, we substitute «w, into Eq. (1.94) to
obtain

0,10? + O,2c3 = wc?

(1.97a)

02,02 + 0223 = wc3

(1.97b)

where the superscripts “2” indicate that we are concerned with the second
eigenvalue. We then use one of these two equivalent equations and the
normalization condition

(1.98)

(ci)? + (c3)? = 1

to solve for c? and c3. As a simple illustration. we consider the case when
O01, = 02. =aand O,, = 02, = b. From Eq. (1.96). the two eigenvalues are

o,=a—b

(1.99a)

@,=a+b

(1.99b)

To find the eigenvector corresponding to @ 2 we use Eq. (1.97a), which in this
case gives

ac? + be} = (a + b)c?
from which we obtain

d=

Finally, the normalization condition (1.98) gives
cj = 2712

c=

Q7

(1.100a)

In an entirely analogous way, we find

ch =2712

ch= —2712

(1.100b)

Exercise 1.10 Since the components of an eigenvector can be found
from the eigenvalue equation only to within a multiplicative constant, which
is later determined by the normalization, one can set c, = 1 and ce, =c
in Eq. (1.94). If this is done, Eq. (1.94) becomes
01,

+

O,.c

=O

Ox,

+

O20

=

cc

20

MODERN

QUANTUM

CHEMISTRY

After eliminating c, find the two roots of the resulting equation and show
that they are the same as those given in Eq. (1.96). This technique, which we
shall use numerous times in the book for finding the lowest eigenvalue of a
matrix, is basically the secular determinant approach without determinants.
Thus one can use it to find the lowest eigenvalue of certain N x N matrices
without having to evaluate an N x N determinant.
Now let us solve the 2 x 2 eigenvalue problem by directly finding the

orthogonal matrix U that diagonalizes the symmetric matrix O, ie.
vou=(7"
Uy.

oor

an

to

i)=o=(4

Ua2/\Oi2

O22J/\Ux,

Un2

i)
0

(1.101)

a,

The requirement that

UU

= Caen +U2,U2,
Uj 2U,, + U22U2,

U,,Uy2+ an
Uy2U,2 + U22U22

==

(

\)
|

0

(1.102)

places three constraints (two diagonal and one off-diagonal) on the four
elements of the matrix U. Therefore U can be completely specified by only
one parameter. Since

cos 8

sin@

sin8 \ fcos 6

-—cos@/\sin@

1

sin#\ _

cos? #+sin? 6

0

—cosé)_

0

cos? 6+sin? 6)
(1.103)

for all values of the parameter @, it is convenient to write

U=

cos @

sin 6

(Sr @

—cos i)

(

1.104

This is the most general form of a 2 x 2 orthogonal matrix. Let us now
choose @ such that
UioU=

_

~

cos 6

sin@\/0O,,

sin@6

—cos@/\O,2

O42

cos 6

sin 6

O22/\sin@

—cosé

O,, cos?
+ O,, sin?@

4(0,, — O22) sin
2@ — 0,

14(0,,; — O22) sin26 — 0, cos26

O,, sin?@ + O22 cos?@

+ 0,2 sin26

cos20

— O,, sin26

is diagonal. This can be done if we choose @ such that

3(O1, — O22) sin 26 — O,, cos26 =0
This has the solution
1

2

6) =~ tan”?
2

On

aOv
~~

O22

(1.105)

)

MATHEMATICAL REVIEW

21

Thus the two eigenvalues of O are

@, = 0,, cos* 6) + O22 sin? Oy + O,2 sin26,

(1.106a)

W2
= O,, sin?
Oy + 02

(1.106b)

and
Upon
to be

cos?
Oy — O12 sin26,

comparison of Eqs. (1.104) and (1.89), we find the two eigenvectors

ch

cos 89

(:)
and

= (or)

2
ci

(3)

=

(1.107a)

.
sin 6,

1.107b

(one)

(1.1076)

It should be mentioned that the Jacobi method for diagonalizing N x N
matrices is a generalization of the above procedure. The basic idea of this
method is to eliminate iteratively the off-diagonal elements of a matrix by
repeated applications of orthogonal transformations, such as the ones we
have considered here.
Exercise 1.11 Consider the matrices
A

=

(1 5)
3

1

Find numerical values for the eigenvalues and corresponding eigenvectors of
these matrices by a) the secular determinant approach: b) the unitary transformation approach. You will see that approach (b) is much easier.
1.1.7

Functions of Matrices

Given a Hermitian matrix A, we can define a function of A. i.e.. f(A), in much
the same way we define functions f(x) of a simple variable x. For example,
the square root of a matrix A, which we denote by A", is simply that matrix

which when multiplied by itself gives A, ie.,

A! 7Al2_— A

(1.108)

The sine or the exponential of a matnx are defined by the Taylor series of
the function, e.g.,

exp(A)

1+

|

l At n

A

24 +34

Sy...
T

22 MODERN QUANTUM CHEMISTRY

or In general

(1.109)

Ms

f(A) = 2, cA"
n=0

After these definitions, we are still faced with the problem of calculating A‘/?
or exp (A). If A is a diagonal matrix
(A)ij = 4;0;;

everything is simple, since

ay

(1.110)

°

0.

(A)" =

. at

so that

Dena
%

f(A) = Y cA" =
n=0

0

min

nt

0

yn
f(a)

=

a”

-

0

(1.111)
f (ay)

Similarly, the square root of a diagonal matrix is

all?

At?

0.

1/2

0

(1.112)
ah?

What do we do if A is not diagonal? Since A is Hermitian, we can always
find a unitary transformation that diagonalizes it, i-e.,

UtAU=a

(1.113a)

The reverse transformation that “undiagonalizes” a is

A = UaUt

(1.113b)

Now notice that

A? = UaUUaU'

= Ua?Ut

MATHEMATICAL REVIEW

23

or in general

(1.114)

= Ua"tt
so that

f(A) = Fc, A" = u(y CA ‘ju'= Uf(ayut
f(a.)

=U

fa)
0

9

Yur

(1.115)

f (an)

Thus to calculate any function of a Hermitian matrix A, we first diagonalize
A to obtain a, the diagonal matrix containing all the eigenvalues of A. We
then calculate f(a), which is easy because a is diagonal. Finally we “undragonalize” f(a) using (1.113b) to obtain (1.115). For example, we can find
the square root of a matrix A as
All?

=

Uai/2Ut

since

A'?Al?2= Ua'/?UtUal/2Ut= Ual/2al Ut = UaUt

=A

If the above procedure were to yield a result for f(A) that was infinite, then
f(A) does not exist. For example, if we try to calculate the inverse of a matrix
A that has a zero eigenvalue (say a; = 0), then f(a;) = 1/a,; = co and so A7™!
does not exist. As Exercise 1.12(a) shows, the determinant of a matrix is
just the product of its eigenvalues. Thus if one of the eigenvalues of A is
zero, det(A) is zero and the above argument shows that A~? does not exist
This same result was obtained in a different way in Exercise 1.7.
Exercise 1.12

Given that
ay

U'AU =a=
a

0

a4

Show that

a. det(A") = aja

b. trA"=

N

}o ab.

a=1

** ay.

0

or

Ac*=a,c*

a=1,2,...,N

24 MODERN QUANTUM

CHEMISTRY

c. If G(w) = (wl — A)~*

then
UU}

Nv

(G());, =

»

a=1

O

—

Ay

n

Cae
CiCj

N

*&

»

=

g=1

©

—

Gy

as
ten
rit
rew
be
can
this
on
ati
not
ac
Dir
ng
usi
t
tha
ow
Sh

(GO), = AOA

=>

<ila><al i>
@ — ay

a

solving
of
m
le
ob
pr
the
er
sid
con
on
ati
rel
s
thi
of
on
ati
lic
app
ng
As an interesti
the following set of inhomogeneous linear equations
(wl — Ax=c

— A. i.e.,
wl
t
inver
to
is
eed
proc
to
way
ard
forw
ight
stra
most
The
for x
x =(@1 — A) te = Gloje
each value
for
rix
mat
the
ert
inv
to
d
nee
we
@
of
on
cti
fun
a
as
If we want x
of w. However, if we diagonalize A, we can write
U,,U*%c

¥ = ¥(GO),¢,=

pd

7

a

O-

Ay

e.
of
on
cti
fun
a
as
x
te
lua
eva
to
ple
sim
lly
ona
ati
put
com
It is now
Exercise 1.13 If
A

show

that

=

(5)
ab

sLfla+ b) + fla—b)]
sia) =(
IE flat b)— fla— by]

aL fla+b)— fla- ni)
3 [flat b) + fla—b)]

FUNCTIONS,

EIGENFUNCTIONS,

1.2 ORTHOGONAL
AND OPERATORS

ent
res
rep
to
le
sib
pos
1s
it
t
tha
ies
ser
r
ie
ur
Fo
of
We know from the theory

te
ini
inf
an
as
al
erv
int
me
so
on
)
f(x
on
cti
fun
ed
a sufficiently well-behav
the
on
nd
pe
de
t
tha
nts
cie
ffi
coe
h
wit
s
ine
cos
and
es
sin
of
n
io
linear combinat
se
the
g
yin
cif
spe
by
d
te
en
es
pr
re
be
can
on
cti
fun
h
suc
function. Thus any

in
tor
vec
a
g
in
nd
pa
ex
of
a
ide
the
to
r
ila
sim
y
ver
ms
see
coefficients. This
e this
lor
exp
to
is
n
tio
sec
s
thi
of
e
os
rp
pu
e
Th
s.
tor
vec
is
bas
of
terms of a set
,.--} that
1,2
i=
i
{W
ons
cti
fun
of
set
te
ini
inf
an
er
sid
con
We
similarity.

MATHEMATICAL REVIEW

satisfy the orthonormality condition

25

(1.116)

[? dx PRO, = 4,

on the interval [x,, x]. From now on, we shall drop the integration limits

x, and xp.
Let us suppose that any function a(x) can be expressed as a linear com-

bination of the set of functions {y;}

a(x) = Yo wna,

(1.117)

In other words, the basis {y,(x)} 1s complete. Given a function a(x) we can
determme its components a; with respect to the basis {y,;} by multiplying

Eg. (1 117) by w#(x) and integrating over x, smce
fax W(a(x)

= » fax WROOW(G,

= » biG, = Gj

(1.118)

Substitutmg this result for the coefficients mto the original expansion (1 117),
we have

atx) = [dx I Waly 1 a(x’)

(1.119)

The quantity in square brackets is a function of x and x, and has the unusual

property that when multiplied by a(x’) and integrated over all x one obtains

a(x). An entity with this property 1s called the Dirac delta function d(x — x)

Y Wax F(x) = (x — x)

(1.120)

The Dirac delta function is the continuous generalization of the familiar
O, Le,

a, =

» 6,j4, 2 a(x) = fax

d(x — x )a(x)

(1.121)

— x)

(1.122)

J

Moreover, just as 6,; = 5j,,
o(x — x)
= d(x

By setting, x = 0 m (1.121) and using (1.122), we obtain

al) = dx alx) (x)

(1.123)

Finally, taking a(x ) = | in (1.123), we have

1= [dx d(x)

(1.124)

as long as the integration mterval includes x = 0 Thus 6(x) is a rather peculiar “function.” Equation (1.124) shows that it has unit area. Moreover,

26 MODERN QUANTUM

Figure 1.1

CHEMISTRY

Successive approximations to the Dirac delta function 6(x)

when multiplied by a function a(x) and mtegrated over any interval contaming x = 0, it “plucks”

out the value of the function at x = 0 (see Eq.

(1 123)) The Dirac delta function 6(x) can be thought of as the limit of a
sequence of functions that simultaneously become more and more peaked
about x = 0 and narrower and narrower such that the area is always unity.
For example, one representation of 6(x), which is shown in Fig. 1.1, is

O( <) = lum 6,(x)
70

(1.125)

where
0 (x) = 7!

=0

<x<
—e<x<e

otherwise

(1.126)

MATHEMATICAL REVIEW

27

Since the height of 6,4) 1s 1/2¢ and its width is 2e, the area under 6x) is
unity for all ¢.

Exercise 1.14 Using the above representation of 5(x), show that
a(0) = fr.

dx a(x\6(x)

Our development thus far is quite similar to the one we used in Sub-

section 1.1.4, where we discussed N-dimensional vector spaces. Indeed, the
theory of complete orthonormal functions can be regarded as a generaliza-

tion of ordinary linear algebra. To make the analogy explicit, it is convenient
to mtroduce the shorthand notation

W(x) = |i>

Wi(x) = <1

(1.127a)

a(x) = a>

a*(x) = Cal

(1.127b)

or more generally

and define the scalar product of two functions as

f dx a*(x)b(x) = <alby

(1.128)

Thus the orthonormality relation (1.116) becomes

<i}j> = dj;

(1.129)

<j] =a;

(1.130)

la> =} [><ila>

(1.131)

In this notation, Eq. (1.118) is
and thus Eq. (1.117) becomes

It is important

to note that Eqs. (1.129), (1.130), and (1.131) are formally

identical to Eqs. (1.47). (1.48a), and (1.50a), respectively of the previous

section.

We define an operator ( as an entity that acts on function a(x) to yield

the function b(x)

Ca(x)

=

b(x)

(1. 132a)

which can be rewritten using our shorthand notation as

(1.132b)

Clay = |by

which is identical to Eq. (1.52). An operator € 1s said to be nonlocal if we
calculate b(x) as
b(x) = @a(x) = fax

O(x, x a(x)

(1.133)

28 MODERN QUANTUM CHEMISTRY

Thus to find b(x) at the point x = x, we need to know a(x) for all v. Nonlocal
operators are sometimes called integral operators. Note that (1.133) is the

continuous generalization of

b=} O44;

(1.134)

J

and hence we can regard O(x, x’) as a continuous matrix. An operator CG is

local when we can find b(x) at the point x) by knowing a(x) only in an
infinitesimally small neighborhood of x,. The derivative (d/dx) is an example
of a local operator. If

Ob dx) = Vahl)

(1.135a)

Ola> = w,|o

(1.135b)

or in our shorthand notation

then in analogy to matrix algebra, we say that @,(x) is an eigenfunction of
¢ with an eigenvalue w,. We can choose the eigenfunctions to be normalized

f dx b2x)b{x) = <a) = 1

(1.136)

Multiplying (1.135a) by (x), integrating over all x and using (1.136). we
have

04 = [dx $82) b.00 = Cole|2>

(1.137)

where we have introduced the notation

fax aXxyeb(x) = Cale by

(1.138)

Note that we could have obtained (1.137) by multiplying (1.135b) on the
left by <a| and using the normalization condition (1.136). In the rest of the
book “multiplying by <a|” will be just a simple way of saying “multiplying
by a*(x) and integrating over all x.”
Just as before, we shall be interested in the eigenfunctions and eigenvalues of Hermitian operators. These are defined as operators for which

fax a*(x)Ob(x) = f dx b(x\(@a(x))* = ( f dx b*(si@ats))

*

(1.139)

Using the notation introduced in (1.138), Eq. (1.139) becomes

<alO|by = <b|C\ay*

(1.140)

which is identical to Eq. (1.61). The beauty of Dirac notation is that it allows
us to manipulate vectors and functions, as well as the operators acting on

MATHEMATICAL REVIEW

29

them, in a formally identical way. For example, the proofs in Subsection 1.1.6

concerning the properties of the eigenvectors and eigenvalues of Hermitian
operators acting on vectors apply immediately to Hermitian operators acting

on functions. Thus the eigenfunctions of a Hermitian

normal and the corresponding eigenvalues are real.

operator are ortho-

Exercise 1.15 As a further illustration of the consistency of our notation.
consider the matrix representation of an operator @ in the basis {y,(x)}.

Starting with

CW (x)

=

>

W(x)O,,

(1)

J

Show that

0, = fax vArIeyi~
Then using Eqs. (1.127a) and (1.138) rewrite (1) in bra-ket notation and show
that it is identical to Eq. (1.55).

Exercise 1.16 Consider the eigenvalue problem

COX) = OG()
By expanding @ in the complete set {w,(x), i= 1, 2,...} as
oC

(x) = Y cab (x)
1=1

show that it becomes equivalent to the matrix eigenvalue problem
Oc
= we

where (ec), = c; and (O),; = | dx WEO)GY (x). Do this with and without using
bra-ket notation. Note that O is an infinite matrix. In practice, we cannot
handle infinite matrices. To keep things manageable, one uses only a finite
subset of the set {wi{x)}, Le, {Wx i= 1, 2,..., N}. If the above analysis
is repeated in this subspace, we obtain an N x N eigenvalue problem. As
we shall see in Section 1.3, the corresponding N eigenvalues approximate
the true eigenvalues. In particular, we shall prove that the lowest eigenvalue
of the truncated eigenvalue problem is greater or equal to the exact lowest

eigenvalue.

Exercise 1.17 In this subsection we have used a watered-down version
of Dirac notation that is sufficient for our purposes but that oversimplifies
the deep relationship between vectors and functions. The purpose of this
exercise is to provide a glimpse at Dirac notation in its full glory. Consider

30 MODERN QUANTUM CHEMISTRY

a denumerably infinite set of complete orthonormal! basis vectors, i.¢.,

Y |D<ij=1

(1a)

ili) = 8,

(1b)

fax |xycx| = 1

(2a)

i=1

Let us introduce a continuously infinite complete set of basis vectors denoted

by |x>. The analogue of (1a) is

that is, we have replaced the summation in (1a) by an integral. If we multiply

(2a) on the left by <a] and on the right by |b) we have

fax <a|x><x|b> = <a|b)
Comparing this to Eq. (1.128) suggests that we identify a*(x) with <a|x>
and b(x) with <x|b>. Recall that <i[a)> is the component of {a} along the

basis vector |i>. Thus we can regard a function b(x) as the x component of
the abstract vector |b) in a coordinate system with a continuously infinite
number of axes.

a. Multiply (2a) on the left by <i| and on the right by |j>. Using (1b) show
that the resulting equation is identical to (1.116) if

Wi(x) = <i]x>

W400) = <x|p>.

b. Multiply (1a) by <x| on the left and |x’> on the right. Show that the resulting equation is identical to (1.120) if

&x|(x’> = 5(x — x’)

(2b)

This is just the continuous analogue of (ib).
c. Multiply (2a) by <x’| on the left and |a> on the right. Show that the resulting expression is identical to (1.121).
d. Consider an abstract operator ©. Its matrix elements in the continuous

basis |x) are

<x|O|x’> = O(x, x’)

Starting with the relation ©|a> = |b) and inserting unity, we have

Ola = Ola) = f dx O|x><x|a) = |b)
Multiply this equation by <x’| and show that the result is identical to
Eq. (1.133).

e. If O,; = <ilO|j>, show that

O(%, x) = Y WiQINOWF().-

MATHEMATICAL REVIEW

1.3 THE

VARIATION

31

METHOD

In this section we discuss an important approach to finding approximate
solutions to the eigenvalue problem

O9(x) = wG(x)

(1.141)

We are interested in ergenvalue problems because the time-independent
Schrédinger equation is an eigenvalue equation:

HP) = &|®)

(1.142)

where # is a Hermitian operator called the Hamiltonian, |®) is the wave
function, and & is the energy. We are interested in finding approximate
solutions to eigenvalue equations because the Schrédinger equation cannot
be solved exactly, except for the simplest cases. Although the subsequent
development is applicable to any eigenvalue problem, we shall use the
notation and terminology associated with the Schrédinger equation (1.142).
Given the operator #, there exists a set of exact solutions to the Schrédinger equation, infinite in number, labeled by the index a

H|®,> = E|®,>

%=0,1,...

(1.143)

where
69556;

<6,

5°°°S6,<5°°°

We have assumed for the sake of simplicity that the set of eigenvalues {&,}
is discrete. Since # ts a Hermitian operator, the eigenvalues &, are real and
the corresponding eigenfunctions are orthonormal
<®,|Dp> = yp

Thus by multiplying Eq. (1.143) by <®,| on the left, we find

(®,|30|,) = Eden

(1.144)

(1.145)

Furthermore, we assume that the eigenfunctions of # form a complete set
and hence any function |®) that satisfies the same boundary conditions as

the set {|®,>} can be written as a linear combination of the |®,)’s

I> = ¥ |®, de, = Y |<, |)

(1.146)

O| = ¥ c3(0,| = Y (8 ®,><4,|

(1.147)

and

1.3.1 The Variation Principle
We are now in a position to state and prove an important theorem, called
the variation principle: Given a normalized wave function |®) that satisfies

32 MODERN QUANTUM CHEMISTRY

the appropriate boundary conditions (usually the requirement that the wave
function vanishes at infinity), then the expectation value of the Hamiltonian
is an upper bound to the exact ground state energy. That is, if

<®|) = 1

(1.148)

{G|H#|B> > Eo

(1.149)

then

The equality holds only when |®) is identical to |®o>.
The proof of this theorem is simple. First we consider

(6/6) =1= 2 (B|O,)<®,|,><Hp|Hy = ¥ (H],)5,,.¢0,|5>
&,

ap

= Y)<G/0,<,|B) = ¥ |<, |)?

(1.150)

where we have used Eqs. (1.144), (1.146), and (1.147). Then

{®| #|D> = ¥ Do, <0, | 7 |O,> (| b> = YE] <O,|H>]?
af

a

(1.151)

where we have used Eq. (1.145). Finally, since &, > & for all «, we have

{DH
|B

> Yo ,| B)]? = & Y |KO, |B]? = &

(1.152)

where we have used the normalization condition (1.150).
The variation principle for the ground state tells us that the energy of
an approximate wave function is always too high. Thus one measure of the
quality of a wave function is its energy: The lower the energy, the better
the wave function. This is the basis of the variation method in which we
take a normalized trial function \®>, which depends on certain parameters,
and vary these parameters until the expectation value <O| KH |®> reaches a
minimum. This minimum value of (DH [® i is then our variational estimate
of the exact ground state energy.

Exercise 1.18 The Schrédinger equation (in atomic units) of an electron
moving in one dimension under the influence of the potential — d(x) is

we
( 5 53- avs) lb) = s|y
Use the variation method with the trial function

|b) = Ne“

to show that —z~/ is an upper bound to the exact ground state energy
(which is —0.5). You will need the integral
ff

*

dx

2mp—ax?

xe

__

(2my'x0"!?

22M

tg

+ 112

MATHEMATICAL REVIEW

33

Exercise 1.19 The Schrédinger equation (in atomic units) for the hydro-

gen atom is

1,
|
—~_Vy2—_\lpy

*)I > = é|®)

( 5¥

=

.

Use the variation method with the trial function

[> = New"?

to show that —4/3z = —0.4244 is an upper bound to the exact ground state
energy (which is —0.5). You will need the relations

vyinar (Po)
fn
dr
x

dr

p2tt gar?

tq

_

(2m)!x

0
0

«° dr

22m
pant

lamar

_

Tyg og

l/2

1/2

m!

~~

Dott

Exercise 1.20 The variation principle as applied to matrix eigenvalue

problems states that if ¢ is a normalized (ete = 1) column vector, then c'Oc

is greater or equal to the lowest eigenvalue of O. For the 2 x 2 symmetric
matrix (0; = O2,)
oO

_

(o

0)

O12

Or

consider the trial vector

_

~

cos

\sin @

which is normalized for any value of @. Calculate

(8) = ctOc
and find the value of 6 (i.e., @9) for which (6) is a minimum. Show that
o(6,) is exactly equal to the lowest eigenvalue of O (see Eqs. (1.105) and
(1.106a)). Why should you have anticipated this result?

1.3.2 The Linear Variational Problem

Given a trial function |b», which depends on a set of parameters, then the
expectation value <®|#|®) will be a function of these parameters. In

general, it will be such a complicated function that there is no simple way

34

MODERN

QUANTUM

CHEMISTRY

of determining the values of the parameters for which <O| |b)

mum. However.
Le, if

is a mini-

if only linear variations of the trial function are allowed,
N

(1.153)

|b = ¥ c|¥o
i=1

where {|‘¥,>} 1s a fixed set of N basis functions, then the problem of finding

the optimum set of coefficients, {c,}, can be reduced to a matrix diagonalization.
To show this we assume that the basis functions are real and orthonormal

(1 154)

(P,P) = CPP = 65;

The case where the basis functions are complex and not orthogonal will be
considered in Chapter 3. The matrix representation of the Hamiltonian

operator in the basis {|’,>} isan N x N matrix H with elements

(1.155)

(H),; = Hy = CP)
Since the Hamiltonian

is Hermitian

and the basis is real, H 1s symmetric,

1e., H,, = H,,. The trial function is normalized, so that

(|b) = Yee <¥,|¥) =Yc2 =1
uf

(1.156)

t

The expectation value

(B|% [By =F cK PIA

Ye, = Vcc,

(1.157)

1s a function of the expansion coefficients.

Our problem is to find the set of parameters for which (®|#7|®) is a

minimum. Unfortunately, we cannot simply solve the equations

< <6|4|by =0
Cy

k=1,2,...,N

(1.158)

because our N parameters are not independent. Since our trial function 1s

normalized, the expansion coefficients are related by Eq. (1.156), and thus

only N — 1 of them are independent. The problem of minimizing a function
(Eq (1.157)) subject to a constraint (Eq. (1.156)) is elegantly solved by
Lagrange’s method of undetermined multipliers. Let us construct a function

L(Cy,---5 Cy, E) = (BHHy — E(Kb|®) — 1)

=¥ oeHy - e(y ce

i)

(1.159)

Since the trial function is normalized, we have merely added zero to Eq.

(1 157), and so the minimum

of both <8).

|®> and ¥

occurs at the same

values of the coefficients. If we arbitrarily chose c,, C3, .--,Cy—1 a8 independent so that cy is determined from the normalization condition (1.156), then

MATHEMATICAL REVIEW

we have

of

_

—=0
2c,

k=1,2,...,N—
,2,--.,N—1

35

.
(1.160)

but 0d /Ocy is not necessarily zero. However, we still have the undetermined
multiplier E at our disposal. We now choose this multiplier so that AY /Acy
does equal zero and thus
Oo”
_ 6
ac,

k=1,2
“T
Ag

geet

N-1,N
—~
4,

1.161 )

(1.

so that

aL

a, 7 OF SY GHy + > Hy — 2Ecy
k

but since H,

J

t

(1.162)

= H,,, we have

> H,,c, — Ec; = 0

(1.163)

j

By introducing a column vector ¢ with elements c,, this set of equations can
be written in matrix notation as

He = Ec

(1.164)

which is the standard eigenvalue problem for the matrix H.
Since H is symmetric, Eq. (1.164) can be solved to yield N orthonormal
eigenvectors c* and corresponding eigenvalues E,, which for convenience
are arranged so that Ey) < Fy <- -< Ey ,. Thus

Het? =E,?

«=0.1,...,N—1

(1.165)

with

(ete? = ¥° cich = bug

(1.166)

Introducing the diagonal matrix E containing the eigenvalues E, (1¢., (E),, =
E,6ag) and the matrix of eigenvectors C defined as C,, = cj, the N relations
contained in (1.165) can be written as

(1.167)

HC =CE

Thus instead of finding just one solution for \b> and the expansion
coefficients, we actually have found N solutions
N

b= Y a=

N

«=0,1,...,N—1

(1.168)

<®,|@,> = Yih, |'P,> = Yi cfchdy = L ciel = bp

(1.169)

1=1

> CI

mil

which are orthonormal, since
y

yy

i

36

MODERN

QUANTUM

CHEMISTRY

where we have used Egg. (1.154) and (1.166). To discover the significance of
the E’s, we consider

{Bp|.H |©,> = YP
PP
de
W
=) fH,
uy

= (e*)'He*
= Eec?)'c* = E,ozp

(1.170)

where we have used Eqs. (1.165) and (1.166). Thus the eigenvalue E, is the
expectation value of the Hamiltonian with respect to |®,>. In particular, the
lowest eigenvalue E, is the best possible approximation to the ground state
energy of # in the space spanned by the basis functions {|,>}. Moreover,
the variation principle assures us that

E, = <@,| ¥|®,> > &

(1.171)

What is the significance of the remaining E’s? It can be shown (see Exercise

1.21) that E, > 6é,,«=1,2,.... Thus E, is an upper bound to the energy ,

of the first excited state of # and so on.

Exercise 1.21 Consider a normalized trial function |o’> that is orthogonal to the exact ground state wave function, i.e., <®’|®_> = 0.

a. Generalize the proof of the variation principle of Subsection
show that

1.3.1

to

(O'.4|8> > &,.
b. Consider the function

By = x10) + yf,

where \®,>, x = 0. 1 are given by Eq. (1.168). Show that if it is normalized,
then

bl? + yP = 1.

c. When x and ) are chosen so that \®’> is normalized and so that
{D'|D_> = 0. then from part (a) it follows that <P’ | |b> > &,. Show that

(&|H|®') = E, —|x\(E, — Eo)
Since E, > Ep, conclude that E, > &,. The above
generalized to show that E, > 6,, « = 2,3,...

argument

can

be

MATHEMATICAL REVIEW

37

In summary, the linear variational method is a procedure for finding
the best possible approximate solutions to the eigenvalue problem

#|O) = 6|®)

(1.172)

given a fixed set of orthonormal functions {|¥>, i= 1,2, ..., N}. The procedure entails forming the matrix representation of the operator # in the

finite basis {|‘¥;>}, iLe.. (H),; = <YJ2¢|W,> and solving the matrix eigenvalue
problem
He = Ec

(1.173)

that is, diagonalizing the N x N matrix H.
We derived this result by explicitly minimizing the expectation value of
the Hamiltonian. However, we can obtain Eq. (1.173) in an alternate way,
which we will find useful. In an attempt to solve (1.172), let us approximate
|®> as
N

¥ cl¥,>
|o> = j=l

(1.174)

and substitute this expansion into (1.172)

Y 64%) = € Lal»
I
J

(1.175)

Multiplying (1.175) by <‘P;| on the left and replacing & by E as a reminder
that the expansion (1.174) is approximate, we find

¥ ¢X<PI4p = EY ¢< P|) = Ee,
J

or

> Hic, = Ec;

(1.176)

which in matrix notation is identical to Eq. (1.173). If we had used a complete
orthonormal basis {|‘P,>, 1= 1,2,...,. N, N+ 1,...}, we would have obtained an equation identical to (1.173) except, of course, H would have been
an infinite matrix. The eigenvalues of this matrix are exactly equal to the
eigenvalues of the operator #. Thus the linear variational method is equivalent to solving the eigenvalue equation, (1.172) in a finite subspace spanned
by {|¥>,i=1,2,..., N}.

Exercise 1.22 The Schrédinger equation (in atomic units) for a hydrogen
atom in a uniform electric field F in the z direction is

(-37 - . + Fr cos6) [b> = (Ho + Fr cos 0){®> = &(F)|®>

38 MODERN QUANTUM CHEMISTRY

Use the trial function

\b> = c,|1s> + ¢,|2p,>
where |1s> and |2p,> are the normalized eigenfunctions of %, ie.,

[is)=n "Ve

[2p,> = (322)

‘re “"? cos

to find an upper bound to &(F). In constructing the matrix representation of
H, you can avoid a lot of work by noting that

Hollsy = —~3|1s), — H#ol2p.> = — s|2P.)
Using (1 + x)! 2? ~ 1 + x/2, expand your answer in a Taylor series in F, i.e,

E(F) = E(0) — 40F? +--Show that the coefficient « which is the approximate dipole polarizability

of the system, is equal to 2.96. The exact result is 4.5.

NOTES
i

J. H. Wilkinson, The Algebraic Eigenvalue Problem. Oxford University Press. New York,
1965. The classic reference work on the subject.

FURTHER

READING

Acton, F S.. Numerical Methods that Work. Harper & Row. New York. 1970. Chapter 13 of
this excellent book contains a nice discussion of a vanety of efficient algorithms for finding
the eigenvalues of matrices.
Cushing. J T.. Apphed Analytical Mathematics for Physical Scientists. Wiley, New York. 1975
The first four chapters contain a more rigorous. yet reasonably accessible. treatment of
the mathematics of this chapter
Merzbacher, E., Quantum Mechanics, 2nd ed., Wiley. New York, 1970. Most graduate
quantum mechanics texts discuss Dirac notation in its full glory, and Chapter 14 of this
book contains a good mtroduction.
Press, W. H., Flannery, B. P.. Teukolsky, S. A., and Vetterling, W. T . Numerical Recipes,
Cambndge University Press, Cambridge. 1986. Chapter 11 of this bible of scientific
computing discusses and provides FORTRAN codes for a variety of algorithms for
finding the eigenvalues and eigenvectors of matrices.

CHAPTER

TWO
MANY-ELECTRON

WAVE
AND

FUNCTIONS
OPERATORS

This chapter introduces the basic concepts, techniques, and notations of
quantum chemistry. We consider the structure of many-electron operators
(e.g., the Hamiltonian) and discuss the form of many-electron wave functions
(Slater determinants and linear combinations of these determinants). We
describe the procedure for evaluating matrix elements of operators between
Slater determinants. We introduce the basic ideas of the Hartree-Fock
approximation. This allows us to develop the material of this chapter in a
form most useful for subsequent chapters where the Hartree-Fock approximation and a variety of more sophisticated approaches, which use the
Hartree-Fock method as a starting point, are considered in detail.
In Section 2.1, the electronic problem 1s formulated, i.e., the problem of
describing the motion of electrons in the field of fixed nuclear point charges.
This is one of the central problems of quantum chemistry and our sole
concern in this book. We begin with the full nonrelativistic time-independent
Schrédinger equation and introduce the Born-Oppenheimer approximation.
We then discuss a general statement of the Pauli exclusion principle called
the antisymmetry principle, which requires that many-electron wave functions
must be antisymmetric with respect to the interchange of any two electrons.
In Section 2.2, we describe one-electron functions (spatial and spm
orbitals) and then construct many-electron functions (Hartree products and
39

40 MODERN QUANTUM CHEMISTRY

Slater determinants) in terms of these one-electron functions. We then consider the Hartree-Fock approximation in which the exact wave function of
the system is approximated by a single Slater determimant and describe its
qualitative features. At this point, we introduce a simple system, the minimal

basis (1s orbital on each atom) ab initio model of the hydrogen molecule.
We shall use this model throughout the book as a pedagogical tool to
illustrate and illuminate the essential] features of a variety of formalisms that
at first glance appear to be rather formidable. Finally, we discuss the multideterminantal expansion of the exact wave function of an N-electron system.
Section 2.3 is concerned with the form of the one- and two-electron
operators of quantum chemistry and the rules for evaluating matrix elements
of these operators between Slater determinants. The conversion of expressions for matrix elements involving spin orbitals to expressions involving
spatial orbitals is discussed. Finally, we describe a mnemonic device for
obtaining the expression for the energy of any single determinant.
Section 2.4 introduces creation and annihilation operators and the
formalism of second quantization. Second quantization is an approach to
dealing with many-electron systems, which incorporates the Pauli exclusion
principle but avoids the explicit use of Slater determinants. This formalism
is widely used in the literature of many-body theory. It is, however, not
required for a comprehension of most of the rest of this book, and thus this
section can be skipped without loss of continuity.
Section 2.5 discusses electron spin and spin operators in many-electron
systems and contains a description of restricted and unrestricted spin orbitals
and spin-adapted configurations. Spin-adapted configurations, unlike many
single determinants derived from restricted spin orbitals, are correct eigen-

functions of the total electron spin operator. Singlet, doublet, and triplet

spin-adapted configurations as well as unrestricted wave functions, which are

not eigenfunctions of the total electron spin operator, are described.

2.1 THE ELECTRONIC

PROBLEM

Our main interest in this book is finding approximate solutions of the nonrelativistic time-independent Schrédinger equation

H|®) = E|®)

(2.1)

where # is the Hamiltonian operator for a system of nuclei and electrons
described by position vectors R, and r,, respectively. A molecular coordinate
system is shown in Fig. 2.1. The distance between the ith electron and Ath

nucleus is r,4 = |r,4| = |r, — R.,4); the distance between the ith and jth electron

is r,,= |r; ~r,|, and the distance between the Ath nucleus and the Bth

nucleus is R,g = ([R,, — R,]. In atomic units, the Hamiltonian for N electrons

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

i,j

=

electrons

A,B

2

nuclei

41

a

Figure 2.1

A molecular coordinate system

i, j = electrons, A, B = nuclei

and M nuclei is
N

KH

=

—

1

M

1

N

~V? —vVi» 2
», 2M,
“
»
NN
1
M
MZ

+yyt4y
w=1j>rly

ys

A=1

B>A

M

Za

—
2, Via

02

‘aR

In the above equation, M, 1s the ratio of the mass of nucleus A to the mass
of an electron, and Z, is the atomic number of nucleus A. The Laplacian
operators V? and V2, involve differentiation with respect to the coordinates
of the ith electron and the Ath nucleus. The first term in Eq. (2.2) is the
operator for the kinetic energy of the electrons; the second term is the
operator for the kinetic energy of the nuclei; the third term represents
the coulomb attraction between electrons and nuclei; the fourth and fifth

terms represent
respectively.

2.1.1

the

repulsion

between

electrons

and

between

nuclei,

Atomic Units

The units we use throughout this book are called atomic units. To see how
these units arise naturally let us consider the Schrédinger equation for the
hydrogen atom. In SI units, we have

| ---v
2m,

e?

4réor

|e-e

(2.3)

42 MODERN QUANTUM CHEMISTRY

where h is Planck’s constant divided by 2z, m, is the mass of the electron,

and —e is the charge on the electron. To cast this equation into dimensionless
form we let x, y, 2

4x’, Ay’, Az’ and obtain
h

2

e?

|- 2m,A? vo

| o = 6

(2.4)

The constants in front of the kinetic and potential energy operators can
then be factored, provided we choose 4 such that

= &,

(2.5)

where &, is the atomic unit of energy called the Hartree. Solving Eq. (2.5)
for / we find

A=

4h?

mn Z

= dp

(2.6)

Thus 2 is just the Bohr radius ag which is the atomic unit of Jength called a
,
Bohr. Finally, since
|

3 v2 — | ¢ = 6¢'
2

(2.7)

r

if we let &’ = &/E,, we obtain the dimensionless equation

! v2
2

I
r

?=&¢'
~

2.8)
(2.

which is the Schrédinger equation in atomic units. The solution of this
equation for the ground state of the hydrogen atom yields an energy &”
equal to —0.5 atomic units = —0.5 Hartrees. Table 2.1 gives the conversion
factors X between atomic units and SI units, such that the SI value of any

Table 2.1

Conversion of atomic units to SI units

Physical quantity

Length
Mass
Charge
Energy
Angular momentum

Electric dipole moment
Electric polarizability
Electric field
Wave function

Conversion factor X

ay
m,
e
6,
h

2
ea, |
6,¢ ‘a5
Gg?

Value of X (SI)

5.2918
91095
1.6022
4.3598
19546

8.4784
1.6488
§ 1423
2.5978

x
x
x
x
x

10-'! m
1074! kg
107!°C
10778 J
1074 Js

x 1073° Cm
x 10°74! C?m7J- 3
x 10'' Vm"!
x 1015 m~32

MANY-ELECTRON

WAVE

FUNCTIONS

AND

OPERATORS

43

quantity Q is related to its value in atomic units Q’ by

(2.9)

Q = XQ’

Conversion factors for a few other units, which are not related to SI but
which are necessary to read the existing literature, are as follows. One
atomic unit of length equals 0.52918 Angstroms (A). One atomic unit of
dipole moment (two unit charges separated by ay) equals 2.5418 Debyes (D),
and one atomic unit of energy equals 27.211 electron volts (eV) or
627.51 kcal/mole.

From now on we drop the primes and all our quantities will be in atomic

units.

2.1.2 The Born-Oppenheimer Approximation
The Born-Oppenheimer approximation is central to quantum chemistry.
Our discussion of this approximation is qualitative. The quantitative aspects
of this approximation, including the problem of deriving corrections to it,
are clearly discussed by Sutcliffe.! Since nuclei are much heavier than
electrons. they move more slowly. Hence, to a good approximation, one can
consider the electrons in a molecule to be moving in the field of fixed nuclei.
Within this approximation, the second term of (2.2), the kinetic energy of
the nuclei, can be neglected and the last term of (2.2), the repulsion between
the nuclei, can be considered to be constant. Any constant added to an
operator only adds to the operator eigenvalues and has no effect on the
operator eigenfunctions. The remaining terms in (2.2) are called the electronic
Hamiltonian or Hamiltonian describing the motion of N electrons in the
field of M point charges,

KH,

ae=-Lavi-¥ ¥ yyy

(2.10)

The solution to a Schrédinger equation involving the electronic Hamiltonian,
KH recPerec

=

EctecPeiec

(1

1)

is the electronic wave function,
Deicc

=

Deel {t,} 5

{R,}

(2.12)

which describes the motion of the electrons and explicitly depends on the
electronic coordinates but depends parametrically on the nuclear coordinates,
as does the electronic energy,
Getec

=

etec({Ra})

(2.13)

By a parametric dependence we mean that, for different arrangements of the
nuclei, ®,,,, is a different function of the electronic coordinates. The nuclear

44

MODERN

QUANTUM

CHEMISTRY

coordinates do not appear explicitly in ®,,,,. The total energy for fixed nuclei
must also include the constant nuclear repulsion.
Exot

= Eeiec

+

>

A=1

>

R

B>A

8

(2.14)

AB

Equations (2.10) to (2.14) constitute the electronic problem,
interest in this book.

which

is our

If one has solved the electronic problem, it is subsequently possible to
solve for the motion of the nuclei under the same assumptions as used to
formulate the electronic problem. As the electrons move much faster than the
nuclei, it is a reasonable approximation in (2.2) to replace the electronic
coordinates by their average values, averaged over the electronic wave
function. This then generates a nuclear Hamiltonian for the motion of the
nuclei in the average field of the electrons,
F

aucl =

—

A=1

2M,

‘

+y y 24s
M

M

=

~~

nH Yi

i=1 2

liq

+

_

Gan joi l iy

Kap

1

A=1 2M,

1 Asi

——

ZZ

A=1 B>A
M

+

M

Vi

“

+

Gaec({R

elt

Ra}

)+

Xs

M

me

ZZ

ae

Rap

~_¥_!12M, ViA + Go({
tot Ry))
A

(2.15)
.

The total energy &,,.({R,}) provides a potential for nuclear motion. This
function constitutes a potential energy surface as shown schematically in
Fig. 2.2. Thus the nuclei in the Born-Oppenheimer approximation move on
a potential energy surface obtained by solving the electronic problem. Solu-

E tot ( R, /)

Figure 2.2 Schematic illustration of a
potential surface.

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

45

tions to a nuclear Schrédinger equation,

H, nuciP nucl = &® nucl

(2.16)

describe the vibration, rotation, and translation of a molecule,
®yuci

=

Drrei({Ra})

(2.17)

and &, which is the Born-Oppenheimer approximation to the total energy

of (2.1), includes electronic, vibrational, rotational, and translational energy.
The corresponding approximation to the total wave function of (2.1) is,
O({r}; , {R,})

From

=

Derecl{ Ti)

{R,)® nucl ({R4})

(2.18)

now on, we will not consider the vibrational-rotational problem

but concentrate solely on the electronic problem of (2.11) to (2.14). We thus
drop the subscript “elec” and only consider electronic Hamiltonians and
electronic wave functions. Where it is convenient or necessary, we will distinguish between the electronic energy of (2.13) and the total energy of (2.14),
which includes nuclear-nuclear repulsion.

2.1.3 The Antisymmetry or Pauli Exclusion Principle
The electronic Hamiltonian in Eq. (2.10) depends only on the spatial coordinates of the electrons. To completely describe an electron it is necessary,
however, to specify its spin. We do this in the context of our nonrelativistic
theory by introducing two spin functions o(w) and f(w), corresponding to
spin up and down, respectively. These are functions of an unspecified spin
variable w; from the operational point of view we need only specify that the
two spin functions are complete and that they are orthonormal,

fideo 2*(co)a(eo) = [deo Pw)P(wo) = 1

(2.19a)

= 1

(2.19b)

fideo a(co)pleo) = [deo preojx(o) = 0

(2.20a)

= 0

(2.20b)

<aleo>=

<BiB>

and

<a|B>=

<Bla>

where the integration has been used in a formal way. In this formalism an
electron is described not only by the three spatial coordinates r but also by
one spin coordinate «. We denote these four coordinates collectively by x,

x ={r, w}

(2.21)

The wave function for an N-electron system is then a function of x,,
X2,...,Xy. That is, we write B(x,, xX 2,..., Xy).
Because the Hamiltonian operator makes no reference to spin, simply
making the wave function depend on spin (in the way just described) does

46

MODERN QUANTUM

CHEMISTRY

not lead anywhere. A satisfactory theory can be obtained, however, if we
make the following additional requirement on a wave function: A many-

electron wave function must be antisymmetric with respect to the interchange
of the coordinate x (both space and spin) of any two electrons,

(Ky, 62

Xp

Xyo ee es Xy) = — DK,

Xp ee Xe Xy)

(2.22)

This requirement, sometimes called the antisymmetry principle, is a very
general statement of the familiar Pauli exclusion principle. It is an independent postulate of quantum mechanics. Thus the exact wave function not
only has to satisfy the Schrédinger equation, it also must be antisymmetric
in the sense of Eq. (2.22). As we shall see, the requirement of antisymmetry
is easily enforced by using Slater determinants.

2.2 ORBITALS, SLATER
BASIS FUNCTIONS

DETERMINANTS,

AND

In this section we are concerned with the nomenclature, the conventions,

and the procedure for writing down the wave functions that we use to describe

many-electron systems. We will only consider many-electron wave functions
that are either a single Slater determinant or a linear combination of Slater
determinants. Sometimes, for very small systems, special functional forms

are used for the wave function, but in most cases quantum chemists use
Slater determinants. Before considering wave functions for many electrons,
however, it is necessary to discuss wave functions for a single electron.

2.2.1 Spin Orbitals and Spatial Orbitals
We define an orbital as a wave function for a single particle, an electron.

Because we are concerned with molecular electronic structure, we will be

using molecular orbitals for the wave functions of the electrons m a molecule.

A spatial orbital w,(r), is a function of the position vector r and describes the

spatial distribution of an electron such that |y,(r)|* dr is the probability of

finding the electron in the small volume element dr surrounding r. Spatial
molecular orbitals will usually be assumed to form an orthonormal set

f de WrlrW,(e) = 6,

(2.23)

If the set of spatial orbitals {y,} were complete, then any arbitrary function
J (rt) could be exactly expanded as

f=)

x

r=]

abo

(2.24)

where the a, are constant coefficients. In general, the set would have to be

infinite to be complete; however, in practice we will never have available a

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

47

complete set, but only a finite set {p,|i= 1, 2,..., K} of K such orbitals.
This finite set will only span a certain region of the complete space, but we
can, however, describe results as being “exact” within the subspace spanned
by the finite set of orbitals.

To completely describe an electron, it is necessary to specify its spin. A
complete set for describing the spin of an electron consists of the two orthonormal functions a(c) and B(@), Le., spin up (f) and spin down (|). The wave

function for an electron that describes both its spatial distribution and its
spin is a spin orbital, x(x), where x indicates both space and spin coordinates
(see Eq. (2.21)). From each spatial orbital, p(r), one can form two different
spin orbitals—one corresponding to spin up and the other to spin down—by
multiplying the spatial orbital by the « or f spin function, respectively, ie.,

Xx) =4

W(r)a(c)

(2.25)

or

Wr) B(o)

Given a set of K spatial orbitals {y,|i= t, 2,..., K}, one can thus form a
set of 2K spin orbitals {y,|i = 1,2,..., 2K} as
%2.—1(X)

=

(Hala)

X2AX)

=

W,(1) Blo)

bint ann

(2.26)

If the spatial orbitals are orthonormal, so are the spin orbitals

f dx 4(x)x,(x) = nlx

= 6,

(2.27)

Exercise 2.1 Given a set of K orthonormal spatial functions, {y(n},
and another set of K orthonormal functions, {/(r)}, such that the first set
is not orthogonal] to the second set, i.e.,

fae y*(qtte = S,
where S is an overlap matrix, show that the set {y,} of 2K spin orbitals,
formed by multiplying Y(t) by the « spin function and w4{(r) by the B spin
function, i.e.,

Yar 113) = Wieya(co
Y%2(x)

=

Yr) B(e)

} f= 1,2.0.5k
t

sores

is an orthonormal set.

2.2.2

Hartree Products

Having seen that the appropriate wave function describing a single electron
is a spin orbital, we now consider wave functions for a collection of electrons,

48

MODERN QUANTUM CHEMISTRY

weak

tt

ie., N-electron wave functions. Before considering the form of the exact

wave function for a fully interacting system, let us first consider a simpler
system containing uoninteracting electrons having a Hamiltonian of the
form
N

*

# = ¥. hii)

(2.28)

1=1

where /(i) is the operator describing the kinetic energy and potential energy
of electron i. If we neglect electron-electron repulsion, then the full electronic
Hamiltonian has this form. Alternatively, h(i) might be an effective oneelectron Hamiltonian that includes the effects of electron-electron repulsion
in some average way.

Now, the operator h(i) will have a set of eigenfunctions that we can take

to be a set of spin orbitals {,},

A(I)Xj(%) = €,%,(%)

(2.29)

We now ask, “What are the corresponding eigenfunctions of “”?” Because
# 1s asum of one-electron Hamiltonians, a wave function which ts a simple
product of spin orbital wave functions for each electron,
wPPxy,

Xa, +++. Xy) = Z:(K1)¥,(%2) °°

YadXy)

(2.30)

is an eigenfunction of #,

HOP

w EXPHP

(2.31)

with eigenvalue E, which is just the sum of the spin orbital energies of each

of the spin orbitals appearing in ¥"",

E=e,+ € +++

n

&

‘

(2.32)

Such a many-electron wave function is termed a Hartree product, with
electron-one being described by the spin orbital y,, electron-two being
described by the spin orbital y,, etc.
Exercise 2.2 Show that the Hartree product of (2.30) is an eigenfunction
N

of # = > h(i) with an eigenvalue given by (2.32).
1=1

The Hartree product is an uncorrelated or independent-electron wave

function because

°

PPBPOXs, 2.2, Xy)l? dxy 0+

dXy

which is the simultaneous probability of finding electron-one in the volume
element dx,, centered at x,, electron-two in dx,, etc., is just equal, from (2.30),
to the product of probabilities
x1)?

dx, \z,(x2)|* dX2°°° Lx.(X») |? AXy

MANY-ELECTRON

WAVE

FUNCTIONS

AND

OPERATORS

49

that electron-one is in dx;, tumes the probability that electron-two is in
dx», etc. The situation is analogous to the probability of drawing an ace of
hearts (1/52) being equal to the probability of drawing an ace (1/13) times
the probability of drawing a heart (1/4), since the probability of a particular
card being an ace is independent or uncorrelated with the probability that
the given card is a heart. The probability of finding electron-one at a given
point in space is independent of the position of electron-two when a Hartree
product wave function is used. In reality, electron-one and electron-two will
be instantaneously repelled by the two-electron coulomb interaction, and
electron-one will “avoid” regions of space occupied by electron-two so that
the motion of the two electrons will be explicitly correlated. An example of
correlated probabilities is provided by 2 hot potatoes and 2 cold apples in
a bucket. The probability of obtaining a hot potato upon randomly withdrawing an object from the bucket (1/2) is not equal to the product of the
probability of getting a hot object (1/2) times the probability of getting a

potato (1/2), since whether the object is hot is perfectly correlated with
whether the object is a potato.
Assuming independent electrons and a Hamiltonian of the form of
Eq. (2.28), there is still a basic deficiency m the Hartree product; it takes no
account of the indistinguishability of electrons, but specifically distinguishes
electron-one as occupying spin orbital y,, electron-two as occupying y,, etc.
The antisymmetry principle does not distinguish between identical electrons
and requires that electronic wave functions be antisymmetric (change sign)
with respect to the interchange of the space and spin coordinates of any
two electrons.
2.2.3

Slater Determinants

The Hartree product does not satisfy the antisymmetry principle. However,

we can obtain correctly antisymmetrized wave functions as follows. Consider
a two-electron case in which we occupy the spin orbitals y, and y,. If we put
electron-one in y, and electron-two in y,, we have
PV5(x1,

X2)

=

AX

DY (X2)

(2.33a)

On the other hand, if we put electron-one in y, and electron-two in y,, we
have

P(X. Xa) = rs 2)H,(%1)

(2.33b)

Each of these Hartree products clearly distinguishes between electrons; how-

ever, we can obtain a wave function which does not, and which satisfies the

requirement of the antisymmetry principle by taking the appropriate linear
combination of these two Hartree products,

P(X, X2) = 270K) (Ka) — LK)x%2))

(2.34)

The factor 2~'/? is a normalization factor. The minus sign insures that
W(x,, X2) is antisymmetric with respect to the interchange of the coordinates

50 MODERN QUANTUM CHEMISTRY

of electrons one and two. Clearly,
P(X1, Xo) = —'P(X2, X1)

(2.35)

From the form of Eg. (2.34), it is evident that the wave function vanishes if
both electrons occupy the same spin orbital (i.e, if i=). Thus the antisymmetry requirement immediately leads to the usual statement of the
Pauli exclusion principle namely, that no more than one electron can occupy
a spin orbital.

Exercise 2.3 Show that ‘¥(x,, x2) of Eq. (2.34) is normalized.
Exercise 2.4 Suppose the spin orbitals y, and y, are eigenfunctions of
a one-electron operator h with eigenvalues ¢, and e, as in Eq. (2.29). Show
that the Hartree products in Eqs. (2.33a, b) and the antisymmetrized wave
function in Eq. (2.34) are eigenfunctions of the independent-particle Hamiltonian # = h(1) + h(2) (cf. Eq. (2.28)) and have the same eigenvalue namely,

&; + €;.

“

The antisymmetric wave function of Eq. (2.34) can be rewritten as a

determinant (see Eq. (1.39))

W(x, X,) = 271?

7X1)

7, (1)

X(%2)

XX)

(2.36)

and is called a Slater determinant. For an N-electron system the generalization of Eq. (2.36) is

WX, Xo...

Xn) = (NNTP

2X1)

UM%1)

XX2)

X;(%2)

1A%y)

140%n)

7

eX)
AX)

ee

(2.37)

1lXy)

The factor (N!)~'/? is a normalization factor. This Slater determinant has
N electrons occupying N spin orbitals (y;,, y;.--., ¥,) without specifying
which electron is in which orbital. Note that the rows of an N-electron Slater
determinant are labeled by electrons: first row (x,), second row (x,), etc.,
and the columns are labeled by spin orbitals: first column (y,), second column

(x,), etc. Interchanging the coordinates of two electrons corresponds to,interchanging two rows of the Slater determinant, which changes the sign of the
determinant. Thus Slater determinants meet the requirement of the antisymmetry principle. Having two electrons occupying the same spin orbital
corresponds to having two columns of the determinant equal, which makes
the determinant zero. Thus no more than one electron can occupy a spin
orbital (Pauli exclusion principle). It is convenient to introduce a short-hand

notation for a normalized Slater determinant, which includes the normaliza-

MANY-ELECTRON

WAVE

FUNCTIONS

AND

OPERATORS

51

tion constant and only shows the diagonal elements of the determinant,
(x1, Xa... +5 Xy) = v(x )7,%2)

“+ W(Ky)>

(2.38)

If we always choose the electron labels to be in the order x,, x
then Eq. (2.38) can be further shortened to

,...,Xy>

W(X1, X2,- +65 Xy) = Waky

(2.39)

XD

Because the interchange of any two columns changes the sign of a determinant, the ordering of spin orbital labels in Eq. (2.39) is important. In our
short-hand notation, the antisymmetry property of Slater determinants is
bm

Me

Sb

de

DD

(2.40)

To within a sign, a Slater determinant is completely specified by the spin
orbitals from which it is formed (i.e.. the spin orbitals that are occupied).
Slater determinants formed from orthonormal spin orbitals are normalized.
N-electron Slater determinants that have different orthonormal spin orbitals
occupied are orthogonal.
Exercise 2.5 Consider the Slater determinants

IK> = |xiz)>
IL> = |xex>
Show that
<K|L> = 640 — 619jx

Note that the overlap is zero unless: 1) k = iand | = j, in which case|L> = |K>

and the overlap is unity and 2) k = j and / = i in which case |L> = |y;;> =

—|K) and the overlap is minus one.

We have seen that a Hartree product is truly an independent-electron
wave function since the simultaneous probability of finding electron-one
in dx, at x,, electron-two in dx, at x, etc. is Simply equal to the product of
the probabilities that electron-one is in dx,, electron-two is in dx, etc.
Antisymmetrizing a Hartree product to obtain a Slater determinant introduces exchange effects, so-called because they arise from the requirement

that |V|? be invariant to the exchange of the space and spin coordinates of
any two electrons. In particular, a Slater determinant incorporates exchange
correlation, which means that the motion of two electrons with parallel spins

is correlated. Since the motion of electrons with opposite spins remains
uncorrelated, it is customary to refer to a single determinantal wave function
as an uncorrelated wave function.

To see how exchange correlation arises, we now investigate the effect

of antisymmetrizing a Hartree product on the electron density. Consider a

52 MODERN QUANTUM CHEMISTRY

two-electron Slater determinant in which spin orbitals 7, and yz are occupied

P(X, X2) = [y1€X)x2(X2))

(2.41)

If the two electrons have opposite spins and occupy different spatial orbitals,
Hal%&1) = Wilt a(@;)

(2.42)

X2lX2) = W(t 2)B(@2)

(2.43)

then by expanding the determinant, one obtains
I?

dx, dx, =

{WY (ry oe(co 4)

2(t2)B(@2) _ W (rr )oe(co2)h alt YB(,)]?

dx, dx

(2.44)

for the simultaneous probability of electron-one being in dx, and electrontwo being in dx,. Let P(r,, r2) dr,dr, be the probability of finding electronone in dr, at r, and simultaneously electron-two in dr, at r,, as shown in
Fig. 2.3. This probability is obtained by integrating (averaging) Eq. (2.44)
over the spins of the two electrons,

P(r,,¥2) dr, dr. = fideo, deo, |W? dr, dr,
= +L)?

|b 2lt2)]? + Wir 2)|7[ or]? ] dr, dr,

(2.45)

The first term in (2.45) is the product of the probability of finding electron-one
in dr, at r, times the probability of finding electron-two in dr, at r., if
electron-one occupies i, and electron-two occupies y,. The second term
has electron-one occupying yw, and electron-two occupying wW,. Since electrons are indistinguishable, the correct probability is the average of the two

Figure 2.3 Probability of electron-one
being in dr, and electron-two being
in dr,

MANY-ELECTRON

WAVE

FUNCTIONS

AND

OPERATORS

53

terms as shown. Thus the motion of the two electrons is uncorrelated. This
is particularily obvious if ¥, = YW, for in that case

P(r, ry) = [Wr

(2.46)

[Wilr))?

Note that P(r,,r,) # 0 so that there is a finite probability of finding two
electrons with opposite spins at the same point in space.
If the two electrons have the same spin (say f), we have
71(%1) = Wit )P@,)

(2.47)

/AX2) = Y2(2)B(@2)

(2.48)

then, by steps identical to the above, we obtain

Pty, 2) = 3 {[Ws(r)[7[ (ra)? + Wer? [otr |?
— (WFO Dhol

WR

W

lta) + Wi

WAC Da

WT

2) I]
(2.49)

where we now have an extra cross term, making the probabilities correlated,
This 1s exchange correlation between electrons of parallel spin. Note that
P(r,,1,) = 0. and thus the probability of finding two electrons with parallel
spins at the same point in space is zero. A Fermi hole is said to exist around
an electron. In summary, within the single Slater determinantal description,
the motion of electrons with parallel spins is correlated but the motion of
electrons with opposite spins is not.

2.2.4 The Hartree-Fock Approximation
Finding and describing approximate solutions to the electronic Schrédinger
equation has been a major preoccupation of quantum chemists since the
birth of quantum mechanics. Except for the very simplest cases like Hj,
quantum chemists are faced with many-electron problems. Central to attempts at solving such problems, and central to this book, is the HartreeFock approximation. It has played an important role in elucidating modern
chemistry. In addition, it usually constitutes the first step towards more
accurate approximations. We are now in a position to consider some of the
basic ideas which underlie this approximation. A detailed description of the
Hartree-Fock method is given in Chapter 3.
The simplest antisymmetric wave function, which can be used to describe
the ground state of an N-electron system, 1s a single Slater determinant,
|Wo>

=

1/2

/n>

(2 50)

The variation principle states that the best wave function of this functional
form is the one which gives the lowest possible energy

Eo = <P o|4% o>

(2.51)

54

MODERN

QUANTUM

CHEMISTRY

where # is the full electronic Hamiltonian. The variational flexibility in the

wave function (2.50) is in the choice of spin orbitals. By minimizing Ey with
respect to the choice of spin orbitals, one can derive an equation, called the
Hartree-Fock equation, which determines the optimal spin orbitals. We
shall show in Chapter 3 that the Hartree-Fock equation is an eigenvalue

equation of the form

F(Ox(x,) = ex(x,)

(2.52)

where f(i) is an effective one-electron operator, called the Fock operator, of
the form

1

f= -3VP-

“Zz
A=1

Via

+ vEF(i)

(2.53)

where v"¥(i). which will be explicitly defined in Chapter 3, is the average

potential experienced by the ith electron due to the presence of the other
electrons. The essence of the Hartree-Fock approximation is to replace the
complicated many-electron problem by a one-electron problem in which
electron-electron repulsion is treated in an average way.
f

The Hartree-Fock potential v"*(i), or equivalently the “field” seen by

the ith electron, depends on the spin orbitals of the other electrons (i.e., the
Fock operator depends on its eigenfunctions). Thus the Hartree-Fock equation (2.52) is nonlinear and must be solved iteratively. The procedure for
solving the Hartree-Fock equation is called the self-consistent-field (SCF)
method.
The basic idea of the SCF method is simple. By making an initial guess
at the spin orbitals, one can calculate the average field (e., o*) seen by each
electron and then solve the eigenvalue equation (2.52) for a new set of spin
orbitals. Using these new spin orbitals, one can obtain new fields and repeat
the procedure until self-consistency is reached (i.e., until the fields no longer
change and the spin orbitals used to construct the Fock operator are the
same as its eigenfunctions).
The solution of the Hartree-Fock eigenvalue problem (2.52) yields a set

{,,} of orthonormal Hartree-Fock spin orbitals with orbital energies {e,}. The

N spin orbitals with the lowest energies are called the occupied or hole spin
orbitals. The Slater determinant formed from these orbitals is the HartreeFock ground state wave function and is the best variational approximation
to the ground state of the system, of the single determinant form. We shall
label occupied spin orbitals by the indices a, b, ¢,... (16, Yoo Xps-- +). The
remaining members of the set {y,} are called virtual, unoccupied, or particle

spin orbitals. We shall label virtual spin orbitals by the indices 7, s, t,...
(1.6, Ys Zoo
+)

In principle, there are an infinite number of solutions to the HartreeFock equation (2.52) and an infinite number of virtual spin orbitals. In
practice, the Hartree-Fock equation is solved by introducing a finite set of

MANY-ELECTRON

FUNCTIONS

AND

OPERATORS

55

X2k

oe
e

virtual
spin
orbitats

WAVE

oe

——_——_—__

x,

———_

x,

e
e
e

Xnw

RPPPBPPIDIDPP PPI

e

occupied

—__

—

Xp

orbitals

—_—__*——_

x,

spin

——*#——
—*——

x)

Figure 2.4 The Hartree-Fock ground state
determinant, |y:%2° * %aXe* Xn

spatial basis functions {¢,(r)| = 1, 2,..., K}. The spatial parts of the spin
orbitals with the « spin function can then be expanded in terms of the known
set of functions {¢,}. The spatial parts of the spin orbitals with the B spin

can be expanded in the same way and both expansions substituted into the
eigenvalue problem (2.52) to obtain matrix eigenvalue equations for the
expansion coefficients. These matrix equations (e.g., the Roothaan equations)
will be studied in some detail in Chapter 3. It is sufficient for this discussion

to realize that using a basis set of K spatial functions {¢,} leads to a set of

2K spin orbitals (K with a spin and K with # spin). This leads to a set of N
occupied spin orbitals {z,} and a complementary set of 2K — N unoccupied
or virtual spin orbitals {y,}. A single Slater determinant formed from the

set {y,} is the variational Hartree-Fock ground state, for which we will use
the symbol

y or |¥o>. A pictorial representation of |Wo> is presented in

Fig. 2.4. The 2K Hartree-Fock spin orbitals have been ordered according

to their energy, and we have neglected possible degeneracies. The occupancy
of the N lowest energy spin orbitals—one electron per spin orbital—is
indicated by the asterisks.

The larger and more complete the set of basis functions {¢,}, the greater

is the degree of flexibility in the expansion for the spin orbitals and the lower
will be the expectation value Ey = <‘VYo|#/|¥
>>. Larger and larger basis sets
will keep lowering the Hartree-Fock energy Ep until a limit is reached,
called the Hartree-Fock limit. In practice, any finite value of K will lead to
an energy somewhat above the Hartree-Fock limit.

2.2.5 The Minimal Basis H., Model
At this point we introduce a simple model system, which we will be using
throughout this book to illustrate many of the methods and ideas of quantum

56 MODERN QUANTUM CHEMISTRY

chemistry. The model we use is the familiar minimal basis MO-LCAO
description of H.
In this model, each hydrogen atom has a 1s atomic orbital and, as the
two atoms approach, molecular orbitals (MOs) are formed as a linear combination of atomic orbitals (LCAO). The coordinate system is shown in
Fig, 2.5. The first atomic orbital. ¢,, is centered on atom 1 at R,. The value
of ¢, at a point in space r is },(r) or, since its value depends on the distance
from its origin, we sometimes write ¢, = ¢,(r — R,). The second atomic
orbital is centered on atom 2 at R32, ie, d2 = $2(r — R2). The exact 1s orbital of a hydrogen atom centered at R has the form
o(r — R) = (63 /n)'2e~
where ¢, the orbital exponent,

(2.54)

has a value of 1.0. This 1s an example

of a

Slater orbital. In this book we will be concerned mostly with Gaussian
orbitals, which lead to simpler integral evaluations than Slater orbitals. The

1s Gaussian orbital has the form

1

(r — R) = (2a/n)*/4e7
2 - RP?

(2.55)

where a is the Gaussian orbital exponent. For the present, we need not be
concerned with the particular form of the 1s atomic orbitals. The two atomic
orbitals ¢, and $4 can be assumed to be normalized, but they will not be
orthogonal. They will overlap, such that the overlap integral is

Sia = [ar bFr)p.lr)

(2.56)

Figure 2.5 Coordinate system for minunal
basis H,.

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

57

The overlap will depend on the distance R,, = |R, — RoI, such that Sy, = 1
when R12 = Oand S,, =0 when R,, = 0.

From the two localized atomic orbitals, 6, and 62, one can form, by

linear combination, two delocalized molecular orbitals. The symmetric
combination leads to a bonding molecular orbital of gerade symmetry (Le.,
symmetric with respect to inversion about the point centered between the
nuclei}

Wi = [2(1 + Sy)

(2.57)

(1 + 62)

whereas, the antisymmetric combination leads to an antibonding molecular
orbital of ungerade symmetry (Le., antisymmetric with respect to inversion
about the point centered between the nuclei)

Wo = [2(1 — 8,2)]7

(2.58)

(hy — G2)

Exercise 2.6 Show that y, and yf, form an orthonormal set.

The above procedure is the simplest example of the general technique
of expanding a set of spatial molecular orbitals in a set of known spatial
basis functions

Wr)=

K

¥ Cyd, (0)

(2.59)

h=1

To obtain the exact molecular orbitals of H, one would need an infinite
number of terms in such an expansion. Using only two basis functions for

H, is an example of a minimal basis set and an obvious choice for the two
functions }, and ¢, is the 1s atomic orbitals of the atoms. The correct linear

combinations for this simple choice are determined

by symmetry, and one

need not solve the Hartree-Fock equations; y, and W2 of Eqs. (2.57) and

(2.58) are the Hartree-Fock spatial orbitals in the space spanned by ¢, and ¢>.
Given the two spatial orbitals wy, and y,, we can form four spin orbitals

als) = Wy (a(co)

X2(X) = Wy (r)B(o)
Xa(x) = Wa(n)a(co)

(2.60)

Lalx) = Walt) B()

The orbital energies associated with these spin orbitals can be obtained only

by explicitly considering the Hartree-Fock operator. But, as might be ex-

Pected, y, and y, are degenerate and have the lower energy corresponding

C0 a bonding situation, while y, and y, are also degenerate having a higher

‘nergy corresponding to an antibonding situation, The Hartree-Fock
ground
State in this model is the single determinant

Yo> = |x1x2>

(2.61)

58 MODERN QUANTUM
x3 —————Yo?

CHEMISTRY
—-

Xa

=
x)
—_k—

—¥*—Xe

X3 ————_——_-__

———X%4

Ye
—{t—

Figure 2.6 Three different representations of the
Hartree-Fock ground state of minimal basis H.

%

shown pictorially in Fig. 2.6. Sometimes it is convenient to use a notation
that indicates a spin orbital by its spatial part, using a bar or lack of a bar
to denote whether it has the B or o spin function. Thus

mew
a
13 = VW

2=W
ae
ta = Vo

(2.62)

In this notation the Hartree-Fock ground state is

'¥o> = Witi> = [11>

(2.63)

which indicates that both electrons occupy the same spatial orbital y,, but
one has an @ spin and one has a f spin. It will be apparent from the context
whether yy, denotes a spatial orbital, or a spin orbital made up of the ¥,
spatial orbital and the a spin function.
2.2.6

Excited Determinants

The Hartree-Fock procedure produces a set {y,;} of 2K spin orbitals. The
Hartree-Fock ground state,

|Wo> = Wyit2 °° Lake °° n>

(2.64)

is the best (in a variational sense) approximation to the ground state, of the
single determinant form. However, it clearly is only one of many determinants

that could be formed from the 2K > N spin orbitals, The number of combinations of 2K objects taken N at a time is the binomial coefficient

2K\__—(2K)!
N) NIQK—N)!

MANY-ELECTRON

WAVE

FUNCTIONS

AND

OPERATORS

59

This is the same as the number of different single determinants that one
can form from N electrons and 2K spin orbitals; the Hartree-Fock ground
state is just one of these. A convenient way of describing these other determinants is to consider the Hartree-Fock ground state (2.64) to be a reference
state and to classify other possible determinants by how they differ from the
reference state, i.¢., by stating which occupied or hole spin orbitals of the
set {7q} in (2.64), have been replaced by which virtual or particle spin orbitals

of the set {y,}. These other determinants can be taken to represent approxi-

mate excited states of the system or, as we shall see shortly, they can be used
in linear combination with |W > for a more accurate description of the
ground state or any excited state of the system.
A singly excited determinant is one in which an electron, which occupied
Za in the Hartree-Fock ground state (2.64), has been promoted to a virtual
spin orbital ¥,, as shown in Fig. 2.7,

[E> = lead2 °° Lede

XN

(2.65)

A doubly excited determinant, shown in Fig. 2.8, is one in which electrons
have been excited from y, and y, to y, and y,,

N> = |xiX2 °° * ks
All

2K
()

determinants

XW

(2.66)

can thus be classified as either the Hartree-Fock

ground state or singly, doubly, triply, quadruply, ... , N-tuply excited states.
The importance of these determinants as approximate representations of
the true states of the system diminishes, in some sense, in the above order.
While the excited determinants are not accurate representations of the

Figure 2.7 A singly excited determinant.

60 MODERN QUANTUM CHEMISTRY

e

5
Xo
_— kX,

Figure 2.8 A doubly excited determinant

excited states of the system, they are important as N-electron basis functions

for an expansion of the exact N-electron states of the system.

2.2.7 Form of the Exact Wave Function and Configuration
Interaction
We now consider the use of excited determinants as N-electron basis functions. Suppose we have a complete set of functions {y,(x)}. Any function
®(x,) of a single variable can then be exactly expanded as
O(x,) = » ayi{X)

(2.67)

where a, is an expansion coefficient. How can we expand a function of two
variables ®(x,, x2) in an analogous way? If we think of x, as being held
fixed, then we can expand ®(x,, x.) as
O(X1, X2) = Y A(X 2)%i(%1)
L

(2.68)

where the expansion coefficients are now functions of x. Since a,(x2) is a
function of a single variable, it can be expanded in the complete set {y;} as
G,(x2) = » bx {%2)
j

(2.69)

Substituting this result in (2.68) gives
D(x, Xo) = Dix
‘y

xX)

(2.70)

MANY-ELECTRON

WAVE FUNCTIONS AND OPERATORS

61

If, however, we require ® to be antisymmetric,
D(x),

Xa)

=

— D(x,

x)

(2.71)

then b,, = —b, and b;, = 0. or
@(x,, 2) = >
i

¥

p>i

biLslX1)7j(%2)

_ A(X )LAX2) |

= 2b, Xi >

(2.72)

i<j

Thus an arbitrary antisymmetric function of the two variables can be exactly
expanded in terms of all unique determinants formed from a complete set
of one-variable functions {7,(x)}. This argument is readily extended to more
than two variables, so that the exact wave function for the ground and excited states of our N-electron problem can be written as a linear combination
of all possible N-electron Slater determinants formed from a complete set

of spin orbitals {7,}.

Since all possible determinants can be described by reference to the
Hartree-Fock determinant, we can write the exact wave function for any

state of the system as

>> =col¥o>+¥ c+ Y aE + Yo aeWaty +--+ (2.73)
ra

a<b

a<b<c

r<s

r<s<t

By summing over a < b, we mean summing over all a and over all b greater
than a (i.e, over all unique pairs of occupied spin orbitals). Similarly, summing over ry < s means summing over all unique pairs of virtual spin orbitals.
Thus all unique doubly excited configurations are included in the expansion.
The situation is analogous for triply and higher excited determinants. Thus

the infinite set of N-electron determinants {];>} = {]Wo>, W%>, [Wa>, ---}

is a complete set for the expansion of any N-electron wave function. The

exact energies of the ground and excited states of the system are the eigen-

values of the Hamiltonian matrix (Le. the matrix with elements (¥,|7/[¥,>)

formed from the complete set {/W;>}. Since every |;> can be defined by

specifying a “configuration” of spin orbitals from which it is formed, this

procedure is called configuration interaction (CI); CI will be considered in
some detail in Chapter 4. The lowest eigenvalue of the Hamiltonian matrix,

denoted by &, 1s the exact nonrelativistic ground state energy of the system

within the Born-Oppenheimer approximation. The difference between this

exact energy, &, and the Hartree-Fock-limit energy, Eo, is called the corre-

lation energy

Ecore

=

Eo

~

Eo

(2.74)

since the motion of electrons with opposite spins 1s not correlated within

the Hartree-Fock approximation.
Unfortunately, the above procedure for the complete solution to the
many-electron problem cannot be implemented in practice because one

62

MODERN

CHEMISTRY

QUANTUM

cannot handle infinite basis sets. If we work with a finite set of spin orbitals
2K
.
.
{y:|i= 1, 2,..., 2K}, then the (n) determinants formed from these spin
orbitals do not form a complete N-electron basis. Nevertheless, diagonalizing
the finite Hamiltonian matrix formed from this set of determinants leads to
solutions that are exact within the one-electron subspace spanned by the
2K spin orbitals or, equivalently, within the N-electron subspace spanned
2K
by the ( y)
determinants. This procedure is called full CI. Even for rela-

tively small systems and minimal basis sets, the number of determinants
that must be included in a full CI calculation is extremely large. Thus in
practice one must truncate the full CI expansion and use only a small fraction
2K
of the (‘y ) possible determinants. Figure 2.9 schematically shows how the
exact nonrelativistic Born-Oppenheimer wave function is approached
the size of the one-electron and N-electron basis sets increases.

as

Exercise 2.7 A minimal basis set for benzene consists of 72 spin orbitals.
Calculate the size of the full CI matrix if it would be formed from determinants. How many singly excited determinants are there? How many
doubly excited determinants are there?
Let us illustrate the above ideas with our minimal basis H, model.
Recall (see Eq. (2.60)) that there are four (2K = 4) spin orbitals 71, ¥2, Ys,
Hartree-Fock
Limit
x

Exact

Result

50

no

5 40

2

2

z
a

wn

cc]

B
a

30

ae

Full

Cl

20

So
3

oO

10

€

=]

2

1
l

Number

bo
10

of Slater

100

1
=1000__

a
10,000

Determinants (2x)

Figure 2.9 Dependence of calculations on size of one-electron and N-electron basis sets

MANY-ELECTRON

WAVE

FUNCTIONS

4
.
.
and 74 in this model. Since N = 2 we can form ( )

2)

AND

OPERATORS

63

.
4!
zany = 6 unique

212!

determinants. The Hartree-Fock ground state determinant is

~

=

[o> = [aX = Wid = [1D

u

2

(2.75)

;

(2.76a)

gt 1

The singly excited determinants are

_

['¥2> = [21>
5

y—t—

4

—}—2

a

WD=P—I>

—_t 9

a

"i> = [12>
5

x

'P7> = [12>

(2.76b)

—f{—2

(2.76¢)

i

(2.764)

1

(2.77)

|

There is only one doubly excited determinant.
x

|Pit> = [22> = |vaxa> = [P72

u—t}+2
g

Within the space spanned by the minimal basis set, the exact wave functions
will be linear combinations of these six determinants. The Hartree-Fock

ground state has two electrons in a gerade orbital and is of g symmetry (plus

times plus equals plus). The doubly excited determinant has two electrons
in an ungerade orbital and hence is also of g symmetry (minus times minus
equals plus). The singly excited determinants, on the other hand, have one
electron in a gerade orbital and one electron in an ungerade orbital and,
therefore, are of u symmetry (plus times minus equals minus). The exact
ground state wave function of minimal basis H, |®o), like the Hartree-Fock
approximation to it, |¥o>, is of g symmetry. Therefore, only determinants
ofg symmetry can appear in the expansion of |®)> and thus we have

|®o> = ColWo> + c27|¥72>

= colWo> + cf] FS

(2.78)

The exact value of the coefficients in (2.78), which describe the wave function

|)> and the value of the exact energy (®,|#|®,). can be found by diag-

onalizing the full CE matrix, ie., the 2 x 2 Hamiltonian matrix in the basis
['¥o> and PIDs

4 -( (Po
H [Plod <Pol [73 )
CPP

<P

|PID

(2.79)

64 MODERN QUANTUM CHEMISTRY

To proceed any further with this problem, or with most other formulations encountered in quantum chemistry, we need to be able to evaluate
matrix elements of the Hamiltonian between determinants. The evaluation
of such matrix elements is discussed in the next section.

2.3 OPERATORS

AND

MATRIX

ELEMENTS

This section considers the problem of evaluating matrix elements of operators between Slater determinants formed from orthonormal orbitals. Given

an operator © and two N-electron determinants |K) and |L), our problem

is to evaluate <K|C|L>. By evaluating such matrix elements, we mean reducing them to integrals involving the individual spin orbitals x, occupied

in |K> and |L), and ultimately to integrals mvolving spatial orbitals y;.

Before giving general rules for evaluating such matrix elements, we illustrate

the procedure with our minimal basis H, model

2.3.1 Minimal Basis H, Matrix Elements
Let us evaluate the matrix elements that appear in the full CI matrix of
minimal basis H, (see Eq. (2.79)). The exact ground state of this model is a

linear combination of the Hartree-Fock ground state {o> = |y,¥2> = [ID
and the doubly excited state |¥79> = |ysv4> = |¥7{> = |22>. We need to
evaluate the diagonal elements ¢‘¥ o|#|Wo> and <‘¥33|/|¥ 75> (the HartreeFock ground state energy and the energy of the doubly excited state, respec-

tively), as well as the off-diagonal elements (W,|%|¥?5> and <¥75|4%|Wo>.
The Hamiltonian for any two-electron system is

-(

tir
I

)+(
twi-y
“Je
Alia
A ?2A
Zz

I

= AQ) + h(2) + I

Z

I
12

(2.80)

Py2

where h(1) is a core-Hamiltonian for electron-one, describing its kinetic
energy and potential energy in the field of the nuclei (the “core”), It will be

convenient to separate the total Hamiltonian into its one- and two-electron
parts

©, = hl) + h(2)

(2.81)

CO,

(2.82)

=

riz

MANY-ELECTRON

WAVE

FUNCTIONS

AND

OPERATORS

65

Let us first consider the matrix element <‘¥o|0,|%o> which, from (2.81),
is a sum of two terms. The first term 1s

CW ofh(L) Moy = Fdx dry [2°
x Ar )[2>

1
= > fax, AX, {EK
— KEK

XB

2)A

10s eal) — ral )r02))*
70,1041 )X 2X2)

— Xo )Xr(K2))]

DX 1%) K2(%2) + HECK

LEK 2)A

LAK Za(%2)—

EC 2A

2% )K1(%2)

HECK Tada

71% )2(¥2)}

(2.83)

In the above four terms the integration over x, produces either 1 (first two
terms) or O (last two terms) from the orthonormality of the spin orbitals.
Thus
1
<P ofh(1)|%o> = 3 fax,

80x DAC

I
0%.) + 3 fax, HECK DA

ol)

(2.84)

By exactly the same procedure, one finds that <'¥ o|h(2)|¥o> = <Polh()|Vo>

and thus

CWolOi[¥o> = fax. cea dhte als) + fax. AIK.)

(285)

The integrals m this expression are one-electron integrals, i.e., the integration

is over the coordinates of a single electron. The dummy variables of integra-

tion are, by convention, chosen to be the coordinates of electron-one.
Introducing the following notation for one-electron integrals involving spin
orbitals,

we have

Cilhliy = Galhlas> = [dx xO herds.)

(2.86)

CH olOi|¥o> = <IlAlL> + 2|4|2>

(287)

Exercise 2.8 Show that

<P730,|P
13> = ¢3|h[3> + <4]h|4>
and

CF lO,|¥12> = (P75|O,|%o> = 0

66

MODERN

QUANTUM

CHEMISTRY

Now, let us evaluate matrix elements of @2.
<P lC2|¥o> = fax, dx. [27

(x(x )x2(%2) — X2(K1)K1(%2))]*

x e222)

— Xo(%)La(%2))]

xa Lab%s) + 10 )eH adr Fz 1208)0%2)
mF fy de (Hx lxadrid
— HECK EO) 12 KK aKa) — EET

111) X2(%2)}

(2.88)

Since r,2 =f21, we can interchange the dummy variables of integration in

the second term of the above expression and show that it is equal to the first
term. Similarly, the third and fourth terms are equal. Thus

WXa(%2)
rit
(Wola) %o> = [dry dra xs) 8(2)110s
)
¥1)X1(%2)
2 Xa
- fax, Ax. XF(X EK

(2.89)

The integrals in this expression are examples of two-electron integrals, 1.¢.,
the integration is over the eight space and spin coordinates of electron 1 and
2. It is conventional always to choose the dummy variables of integration in
a two-electron integral to be the coordinates of electrons 1 and 2. Introducing the following notation for two-electron integrals involving spin
orbitals,

<ij|kD

= COAL

= fax,

dx, WK DE (Ka)

HK

a2)

(2.90)

we have

CP ol€ 2|Wo> = (12]12> — <12]21>

(2.91)

and the Hartree-Fock ground state energy is
CF ol #|%o>

= <PolC,

+ C2|%o>

= CAAIL> + <2{h]2> + (12}12> — ¢12]21)

(2.92)

Exercise 2.9 Using the above approach, show that the full CI matrix
for minimal basis H, is

<Ah|L> + <2|h|2>

+ €12|12>— ¢12|21>

ea

“~~ | £34]12> — ¢34]21>
\

and that it is Hermitian.

<12|34> — ¢12]43>

<3|h]3> + <4|h/4>

+ (34[34> — ¢34|43

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

67

2.3.2 Notations for One- and Two-Electron Integrals
Before generalizing the above results and presenting general expressions for
matrix elements involving N-electron determinants, it is appropriate to
summarize the different notations we use in this book for one- and twoelectron integrals, The notation for two-electron integrals over spin orbitals
that we have introduced in Eq. (2.90), i.e.
<ij|kID = CHK |X

= fax, ax, HEX

(Ka

2 Ll

1) LAK)

(2.93)

is often referred to as the physicists’ notation. Note that the complex conjugated spin orbitals appear side by side on the left and the space-spin
coordinate of electron-one appears first. It is clear from this definitic a that

<ij|kD = ¢ji| kD

(2.94)

Cif [kL = Ck |if>*

(2.95)

and that

Because two-electron integrals often appear in the following combination,
we introduce a special symbol for an antisymmetrized two-electron integral

ij |kI> = <ai[ I> — <ii[D
= fax, dx, Wxdetxri7

— Prya)pil&1)ya(%2)

(2.96)

where ¥,, is an operator which interchanges the coordinates of electron
one and two. Note that

<ij||kk> =0

(2.97)

It is an unfortunate fact of life that there is another notation for twoelectron integrals over spin orbitals in common use, particularly in the
literature of Hartree-Fock theory. This notation. often referred to as the
chemists’ notation. is

[ii] ar] = fax, dxs xFx ize ris 2h 202)

(2.98)

Note that in this notation spin orbitals, which are functions of the coordinate of electron-one, appear side by side on the left and the complex conjugated spin orbital appears first. By mterchanging the dummy variables of
integration, one has

[iif] = Chai]

(2.99a)

Cij| KL] = Cail kt] = Cyl] = Lili]

(2.99b)

In addition, if the spin orbitals are real, as is almost always the case in
molecular Hartree-Fock calculations, one has

68 MODERN QUANTUM CHEMISTRY

Table 2.2 Notations for one- and two-electron integrals over spin
(y) and spatial (y) orbitals

SPIN

ORBITALS

[lhl] = <i> = fax, 2rox)hOrZ,04)
<i [kLD =

thy

ed

= fax. dx, PEK

KW

(a [A = [xx lex) = fax, As LEK IX

1

AKA)

12 KEK )LX2) = Cik LAD

CaffTAE> = Cu fkL> — Cyt = [drs axe 240A
SPATIAL

= [ik| 71)

— Pradeds2)

ORBITALS

(lhl) = h, = Wala) = far Yee Dh OYA)
(i|L) = (Wh, [Wadd = [dey des WME WW Ces AUR WFD)
J,, = (i].)

Coulomb integrals

K,,=(y| 1)

Exchange integrals

For one-electron mtegrals over spin orbitals, the chemists’ and physicists’ notations are essentially the same.

[ilAlA] = <ilhli> = [dx

Oe drt Ges)

(2.100)

Table 2.2 summarizes all the notations for one- and two-electron integrals
used in this book. When we consider the reduction of integrals over spin
orbitals to integrals over spatial orbitals later in this chapter, we will introduce a new notation for spatial integrals, which we have included in the
table for the sake of completeness and ease of future reference.
2.3.3

General Rules for Matrix Elements

We have seen that it is fairly easy to evaluate matrix elements between twoelectron Slater determinants. The N-electron case is more complicated, and
here we simply present a set of rules that can be used to evaluate matrix

elements

and leave their derivation to the next subsection, which can be

skipped, if desired.
There are two types of operators in quantum chemistry. The first type
is a sum of one-electron operators

0,= y h(i)
i=l

(2.101)

where h(i) is any operator involving only the ith electron. These operators
represent dynamic variables that depend only on the position or momentum

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

69

of the electron in question, independent of the position or momentum of
other electrons. Examples are operators for the kinetic energy, attraction of
an electron to a nucleus, dipole moment, and most of the other operators

that one encounters. The second type of operator is a sum of two-electron
operators
N

C,=>¥

i=l

N

Voin=yY

j>i

vp

i<j

(2.102)

where v(i, j) is an operator that depends on the position (or momentum) of
both the ith and jth electron. The sum in (2.102) is over all unique pairs of
electrons. The coulomb interaction between two electrons

(2.103)

vi, j) = ry"
is a two-electron operator.

The rules for evaluating the matrix element <K|C|L> between the
determinants {K> and {L)> depend on whether the operator © is a sum of
one-electron operators

(O,) or a sum

of two-electron

operators

(©).

In

addition, the value of ¢K|G|L> depends on the degree to which the two
determinants |K> and |L) differ. We can distinguish three cases. The first,

Case 1, is when the two determinants are identical, i.e., the matrix element is

a diagonal matrix element <K|O|K>. For this case, we choose the deter-

minant to be

IK = [o> nln

>

(2.104)

The second, Case 2, is when the two determinants differ by one spin orbital,

%m in |K> being replaced by y, in |L).

IL> = |->> Xp%n

>

IL> = [0° Xpx%q

>

(2.105)

The third, Case 3, is when the two determinants differ by two spin orbitals.
%m and y, in |K> being replaced by Yp and y,, respectively, in IL»,

(2.106)

When the two determinants differ by three or more spin orbitals the matrix
element is always zero.
Tables 2.3 and 2.4 summarize the rules for the three cases, Note that the
larger the difference in the two determinants, the simpler is the matrix
element, i.¢., the fewer number of terms it involves. The one-electron matrix
elements are zero if the two determinants differ by rwo or more spin orbitals,
in the same way that the two-electron matrix elements are zero if the two
determinants

differ by three or more spin orbitals. In the tables, m and n

denote spin orbitals occupied in |K), so that sums over these indices include
all N spin orbitals in that determinant.
To use the rules, the two determinants must first be in maximum coincidence. Consider, for example, a matrix element between |,> and |'¥,>

70 MODERN QUANTUM CHEMISTRY

Table 2.3 Matrix elements between determinants for one-electron operators
in terms of spin orbitals

O=)

N

w-1

Case 1: |K>=|-

-mn-

>
{K\@,{K> = ¥ [m{h{m] = : <mlh{m>

Case 2° |K> =|:

-mn-

[L>=|---pn-

>

>

<K|@,|L> = [olhlp] = <mlh[p>
Case 3: |K> =|-

-mn-

IL>=|

pq

>>

>

<K|O,|L> = 0

Table 2.4 Matrix elements between determinants for two-electron operators
in terms of spin orbitals
N

ON

t=1

y>e

O.=%

Case i: |K>=|

mn

r,!

>

tN
1uN
<K|O,|K> = 3 ¥ ¥ [mm| nr] - [on| am] = 3 YY Gal |mny

Case 2: |K> =|-

mn

->

[L>=|-

pr

>
N

N

{K|@2|L> = ¥ [mp nny — [mn|np} = ¥. <mn| [pnd
Case 3: |K) =|

IL>=|

mm--

>

-pq- >
{K|O2|L> = [mp|ng] — [mg|np] = <n |pq>

where

|W > = |abed>
|'¥2> = |erds>
At first glance, it might appear that the two determinants differ in all four
columns; however, by interchanging columns of |‘¥2> and keeping track of

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

71

the sign, we have

|'¥2> = |erds> = —|ersd> = |sred>
After being placed in maximum coincidence, they differ in two columns,
and we can use the Case 3 rules. Using the following correspondence

|K> =|")

|L>
= |¥2>

m=a

p=s

n=b

g=r

we thus have <P ,|O,|¥2> = Oand <¥,|0,|¥.> = <ab| |sr>.

Using Tables 2.3 and 2.4, we can immediately write down the expression
for the energy of a single determinant |K), ie,
N

N

N

(K|#|K> = ¢K|O, + ©,{K> = ¥ <nilh|m> + ; YY <mn||nm>

(2.107)

where

h(t)= -=sv?

yo—

(2.108)

The sum in (2.107) is over the spin orbitals occupied in |K). Since (see Eq.
(2.97))

<mm||mm> = Cnn |nny = 0

(2.109a)

<mn| mn = <nm| |nm>

(2.109b)

and

the expression (2.107) can be rewritten as

(K|#|K> = Y <mlh{m> + y

y

<mn||mny

mur>m

==) [mh] + x y

[mm|nn]—[mn|nm]

(2.110)

The summation of antisymmetrized two-electron integrals is thus over all
unique pairs of spin orbitals y,, and y, occupied in |K). This observation
suggests a simple mnemonic device for writing down the energy of any single
determinant in terms of one- and two-electron integrals over spin orbitals.

Each occupied spin orbital 4, contributes a term <ilh|i> to the energy, and

every unique pair of occupied spin orbitals y,, y, contributes a term <ij| lif> to

the energy. Thus we can think of the total energy of an N-electron system,
which is described by a Slater determinant, as the sum of “one-electron-

energies” (<i{h|i> for an electron in spin orbital y,) plus the sum of unique

72, MODERN QUANTUM CHEMISTRY

pair-wise

«

“interaction-energies”

(<ij||ij> for a pair of electrons in spin

orbitals y; and 7,). In using this language, remember that it is only a mnemonic
device. The physical interaction between two electrons is described by the
coulomb repulsion term (rj;') in the Hamiltonian and not by an antisym-

metrized two-electron integral.

Exercise 2.10 Derive Eq. (2.110) from Eq. (2.107).

Exercise 2.11 If |K> = |x17%2%3> show that

(KI H#|K> = <Ahi> + <2|h[2> + <3|h]3> + ¢12|[12>
+ €13]|13> + ¢23] [23>
In this book we will often need matrix elements involving the HartreeFock ground state. For convenience, we have rewritten the rules in Tables 2.3
and 2.4 by identifying the labels m and n with a and b (occupied Hartree-Fock
spin orbitals) and the labels p and g with r and s (unoccupied Hartree-Fock

spin orbitals). Tables 2.5 and 2.6 contain matrix elements between the
Hartree-Fock ground state and either itself (Case 1), a singly excited deter-

Table 2.5 Matrix

electron operators

elements with the Hartree-Fock

O,=F

N

ground state for one-

hw
1

\

\

Case 1

CP oO | %o> =>) [alala] = ¥ <alhla)

Case 2:

<PolG1)¥2> = Lalhlr] = <alhlr

Case 3:

CP ol [Pa

= 0

with the Hartree-Fock

Table 2.6 Matrix elements
electron operators

ground

state for two-

NON

€,=)

Yat

=Ly>t

1

NON

]

VON

Case 1:

CP |@2)¥o> = 3 > ¥ [aa|bb] — [ab|ba]= 3 > ¥ <abj |ab>

Case 2:

WlOa)'2 = ¥ [ar|bb] — [ab|br] =, <abl eb)

Case 3:

<P {6 2|'¥%5> = Lar|bs] — [as|br] = <ab] |rs>

ab

ab

b

b

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

73

minant (Case 2), or a doubly excited determinant (Case 3). Using these
tables, we see that the energy of the Hartree-Fock ground state is

a= (¥fael¥0>= 5. Label]
+55. [aa}66]— [ab6a] 211
1X

using the chemists’ notation, or equivalently
N

1

N

N

Ey = ¥. <alhla> + 5 ¥” ¥ <ab| |aby
a

(2.112)

ab

using the physicists’ notation. As shown above, expression (2.112) can be
rewritten as

(2.113)

> <alhlay + ya y:b>a <ab| |ab>
For minimal basis set H), |Wo> = |%1%2> so that from (2.113), we have

= CAh|L> + <2|h]2> + ¢12|]12>
= CAfh|i> + (2h[2> + <12|12> — ¢12]21>

(2.114)

in agreement with our previous result in Eq. (2.92).
Exercise 2.12 Evaluate the matrix elements that occur in the minimal

basis H, full CI matrix (Eq. (2.79)) using the rules. Compare with the result

obtained in Exercise 2.9.

Exercise 2.13 Show that <‘¥7}@,|‘¥5>
=0

ifafxbr#s

= <r|h|s>

ifa=br#s

= —<blh|a>

ifazAbr=s

=) <elhle> — <alha) + <rfhly)—

ifa=br=s

N

Exercise 2.14 The Hartree-Fock ground state energy for an N-electron

system is NE, = <“W,|#|"¥>. Consider a state of the ionized system (in
which

an

electron

has

been

NOTE = (Now ||"),

spin orbitals but 7, occupied,

YM

removed

from

spin orbital

z,) with

energy

where |”~!,) is a single determinant with all

= [yao

Xe 1Xat

XW?

Show, using the rules in the tables, that the energy required for this ionization
process is
N

NEo —"~1E, = <alhla> + ¥ <ab||ab>
b

74 MODERN QUANTUM

CHEMISTRY

To show the power and simplicity of the mnemonic device introduced in
this subsection, let us derive the above result without doing any algebra.

Consider the representation of |“W,> in Fig. 2.4. If we remove an electron

from y,, we lose the “one-electron energy” contribution <alkla> to ‘Ep.
Moreover, we lose the pair-wise contributions arising from the “interaction™
N
of the electron in y, with the remaining electrons (ie, > <ab| o>)
Because <aa||aa> = 0, the above result follows immediately.
2.3.4

b#a

Derivation of the Rules for Matrix Elements

In this section we derive the rules in Tables 2.3 and 2.4 for matrix elements
of one- and two-electron operators between N-electron determinants

formed from orthonormal spin orbitals. The definition of an N-electron
Slater determinants containing the spin orbitals y,(x1), 7,(X2), . - - » X«(Xw)

is (see Eq. (1.38))

Nt

A2) ANY
ad = (ND? SY (-1P AD

tj

n=]

(2.115)

where we have let x(x, = ¢(/). ¥, is an operator that generates the nth
permutation

of the electron

labels

1,2,...,N

and

p, is the number

transpositions (simple interchanges) required to obtain this permutation.

of

Exercise 2.15 Generalize the result of Exercise 2.4 to N-electron Slater
determinants. Show that the Slater determinant |y,7,°°- 74> formed from
spin orbitals, which are eigenfunctions of the one-electron operator fr as in
Eq. (2.29), is an eigenfunction of the independent-electron Hamiltonian
N

(2.28). # = }

h(i). with an eigenvalue e,+e,+:

-+.6,. Hint

i=]

is invariant to permutations of the electron labels, it commutes

Since

#

with the

permutation operator F,.

We wish to evaluate matrix elements of the form (K|€|L> where

IK> = [zm Vy) °° >

(2.116)

is a determinant, which occupies the spin orbitals z,,. 7,..... The determinant |L) differs from |K> in some known way. Prior to considering oneand two-electron operators and Cases J, 2, and 3 let us set ( equal to the

unit operator and evaluate the overlap <K|L> between |K) and an arbitrary

determinant |L> formed from the same set of spin orbitals,

IL> = [gin Dzi(2) - > ->

(2.117)

MANY-ELECTRON

WAVE

FUNCTIONS

AND

OPERATORS

75

It is assumed that the two determinants have been placed in maximum
coincidence. Using expression (2.115) for a determinant, we then have
Nt

Nt

CKILD= (NITY LD”

fade da dx

x PAX tm(Ve(2) FD)

«3

(2.118)

The spin orbitals are assumed to form an orthonormal set. If the above
overlap is to be nonzero, the primed spin orbitals must be identical
with the unprimed spin orbitals. Otherwise a zero would always result
from the orthogonality of some spin orbital yj, in |L> to the spin orbitals
Am» Xn --- in [K>. Thus a determinant |K) is orthogonal to any other deter-

minant that does not contain identical spin orbitals. If two determinants
contain identical spin orbitals and are in perfect coincidence, te., if they are
the same determinant, then
Nt

Nt

<K|K> =(N) nmnlss
PLM LGH2)

dx, + dX

SFA Ltn Dta2) * >}

(2.119)

Now, in the above sum, mtegration will give zero unless each electron
occupies the same spin orbital in both the ith permutation and the jth
permutation. Thus the two permutations must be identical (i = j) and, since

(—1)??' = 1, we have

N’
<K|K) =(NITY, fede dua

AK PL mL R(2)

SFL

Vtu(2) > °

(2.120)

Each term in this sum is unity and. therefore.
vt

(2.121)

{K|K> =(N!)'Y1=1
showing that |K) is normalized. Thus we have

<K|K)=1

Case 1

<K|L>=0

Case2

(2.122)

Next let us consider matrix elements of a sum of one-electron operators.

CKO, |L> = (KIA) + A(Q2) +--+

h(N)|L>

(2.123)

Because the electrons in a determinant are indistinguishable, matrix elements
of h(1) will be identical to those of h(2), h(3), etc. Thus each term of the sum

76 MODERN QUANTUM CHEMISTRY

in (2.123) is identical, and we can write

<K|O,|L> = NCKIA(D)ILD

(2.124)

where, by convention, we choose to use the operator for electron 1. We
begin with Case 1,

<K|O,|K> = NCK|h(1)|K>
Nt

Nt

= NINN Y Y (P= 1) fd, dx
MW KG(2)
x Pim

dey

FHP L%m(Vxol2)- >}

(2.125)

Now in the integration over electrons 2, 3, ..., N, we will obtain zero unless
these electrons occupy the same spin orbitals in the ith permutation as in
the jth permutation, since the spin orbitals are orthonormal. If electrons
2, 3,..., N occupy identical spin orbitals in both permutations, it must be
that electron 1 also occupies the same spin orbital in both permutations.
Thus only if the two permutations are identical (i = j) will we obtain a result
different from zero.
NI

(KJO,|K> = [(N — IY. fax, dx, +++ dXy
x PidxmUye(2)

SRA L%m(Dxnl2)-° 7}

(2.126)

In the sum over the N! permutations, electron 1 will occupy each of the spin

orbitals, {y,,|m = 1, 2,...,.N}, (N — 1)! times, ie, if electron

1 is in a

specific spin orbital y,,, there will be (N — 1)! ways of arranging electrons
2, 3,..., N amongst the other N — 1 spin orbitals. Integration over electrons
2, 3,..., N willalways give a factor of 1 since the spin orbitals are normalized
and thus,
N

<K|O,|K> =(N — IIF(N — DY? > fax, mh)
Xn 1)
N

=) <mlhlm>

Case 1

(2.127)

We now turn to Case 2, in which the two determinants differ by a single

spin orbital, x, appearing in |L> where y,, appears in |K),

IK> = |xn(1)x,(2) °° >
IL> = |x,()x2) -- >

(2.128)
(2.129)

By the same arguments we used for Case 1, to obtain (2.126) from (2.125),

identical permutations must appear on either side of the operator to obtain

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

77

a result different from zero
NI

CKIG ILD = [ON — PY fds
dey + dy
% PA ym( A tel2)

= FHDAL
AD Z(2)---}

(2.130)

Because the spin orbital 7,, in the first permutation is orthogonal to any
spin orbital in the second permutation, it must be occupied by electron 1,
to “associate” it with h(1) and yield a nonzero result. There are (N — 1)!
ways of permuting the remaining electrons 2, 3,..., N amongst the other
N — 1 spin orbitals y,, .... Integrating over these electrons always yields a
factor of 1 from their normalization and, hence.

<R|O,|L) = ON ~ DIE(N — 1)
= <mlh|p>

fax, AAC)

Case 2

(2.131)

Case 3 has the two determinants differing by two spin orbitals, 7, and
7%, appearing in |L>, where z,, and z, appear in |K>

(2.132)

IK> = |zn(1)x.(2) °° *>

(2.133)

IL> = |xp(D)x,(2) >>

Analogous to (2.125) we write

<K|C,|L> = NIN

Nt

NI

SY (-

x Fld Dyxn(2)

1)

fax, dx, ---dxy

GHD AtzpDxq(2) +>}

(2.134)

Because 7,, and 7, are orthogonal to any spin orbital in the second permutation, and because they both cannot be occupied by electron 1 to “associate”
with h(1), no combination

of permutations

in zero by spin orbital orthogonality. Hence,

<K|O,|L> =0

is possible that does not result

Case 3

(2.135)

We now turn to two-electron operators. The general matrix element is

(KIOLILD
= CK irid teri trad to brag baad too + tye wlL>

(2.136)

where the sum is over all pairs of electrons. Because determinants do not
distinguish between identical electrons, each of the terms in this equation
will give the same result, and we may replace ©, by a single operator 1,7,
provided we multiply by the number of pairs of electrons,

<KIOL> =

N(N— 1)

<K|ry2|L>

(2.137)

78 MODERN QUANTUM CHEMISTRY

We begin again with Case 1,

<KICaIKY = ®t
N(N —

SS OP
uM

x Pd zn(Lyn(2) >> init Bb

fae aad

Vynl2) =}

(2.138)

Because the operator in (2.138) involves only electrons 1 and 2, it must be

that electrons 3,4,...,.N occupy the same spin orbitals in both the ith
permutation and the jth permutation or we would obtain zero by orthogonality on integrating over the coordinates of these electrons. If electrons

3,4,..., N occupy the same spin orbitals in the two permutations and
electrons | and 2 occupy two spin orbitals, say x, and x; in the permutation
#,, then there are two possibilities for electrons 1 and 2 in the permutation
#,: they could occupy the same spin orbitals as in the permutation F (i.e.,
PY, = F) or they could occupy the spin orbitals y, and y, (Le. A, differs from
F, by an interchange of the coordinates of electrons | and 2). Thus if

PX kn V)Xn(2) >>} = Fea Daa(2) >>]

(2.139)

then

Pm Vyn(2) >

= Daa) } or [x(Qa(i) >]

(2.140)

If P,, is an operator that interchanges the coordinates of electrons 1 and 2,
we can thus write our matrix element as
n!

¢K|O,|K> = [2(N — 2)

fax, Ax, +++ AXy PL xm KE(2) °°}

Hy 2A {zm Lxn(2) °°} — Pro
Pl xo
a(2) ** }]

(2.141)

where there is a minus sign in front of #,, because the permutation ¥,,F,
differs from the permutation & by the interchange of the coordinates of
electrons 1 and 2, and hence will be an odd permutation if Z is an even
permutation, and vice versa. In the sum of N! permutations &, electrons 1

and 2 of (2.141) will occupy any two different spin orbitals y,, and z, of the
set of N spin orbitals contained in |K). For each choice of these two spin
orbitals there are (N — 2)! ways of permuting the other N — 2 electrons
amongst the N — 2 remaining spin orbitals, and hence

(KIGIK) 35,ay, 5 fdas dx, (Dr VTE

ZX

1

N

WN

—

2) rm(ta(2Vt

Jerr dvs HOD [mle ~ Aol]

¥. <mn|mn> — <mn| nm)

(2.142)

MANY-ELECTRON

WAVE

FUNCTIONS

AND

OPERATORS

79

Since <mn| |mn> = <mn|mn> — <mn|nm) vanishes when m = n, we can eliminate the restriction on the summation above and write
N

N

<K|O,|K> = 5D ¥.<mn||mn>

Case 1

(2.143)

For Case 2 we replace y,, in|K)> by x, in |L> and obtain

<K|OalLy =O
N

wy LE
N!

Nt

x PARR)

fay da dey
(2.144)

hr Ailxp(Lxn(2) >> °}

By the same argument that leads to Eq, (2.141) for Case 1, we can write for

Case 2,

dxy
-dx,
fldx,
Y
91"
—
[20N
<K]O,|L> =
NI

xR 1
x PL

yR(2)> ryt

— ArdA xD

2) - +f

(2.145)

Now, since the spin orbital y,, in the first permutation is orthogonal to any
spin orbital in the second permutation, it must be occupied by either electron
1 or electron 2, to associate it with rj}, and yield a nonzero result. If y,, is
occupied by electron 1, electron 2 can be in any of the remaining N — |
spin orbitals common to both |K> and |L>. If %m is occupied by electron 2,
then electron | can be in any of the remaining N — 1 spin orbitals common

to both |K> and |L>. There are (N — 2)! ways of permuting electrons
3,4,..., N and integrating over these electrons gives

E)
CKYOa|
= AA
fay
dxs
[eke
OTAD—
Aa
frp
(0EA}
ve
2(N— 2)! em
+ 48 (t)yR(2)rro! (t— Fy 2) {Xn Vx p(2)}]
(2.146)
where the two terms arise from placing electron 1 in y,, or electron 2 in 7,,-

Since rj} = rz and Y,, = Y,,, we can interchange the definition of the

two dummy variables of integration in the second term and show that it is
equal to the first,

fax, dx AMDT — Pra xs()xp(2)}
= [ dx, dx, QAI — Pos)fxlDxp(D}
= fdx, dx, ARO -—ArMxp(HulD}

(2.147)

80 MODERN QUANTUM CHEMISTRY

We thus obtain
N

CKIGIL>= Y fds dx, 7X22)A0 — Aadlxo(W7i2)}
ném
N

Y fax, dx, 20 82)r13 (D202) — wD 7920]

ntm
Vv

¥

n#m

N

<mn|pn> — <mn{ np) = ¥ <mn||pn>
n

Case 2

(2.148)
where we have removed the restriction on the summation since <mm] |pm)> =0.
For Case 3, we replace ,, and y, in |K) by 7, and y, in |L> and use the

same argument as in the previous two cases to begin with
N

<KIO,|L> = [20N — 21). fax, dx, - dxy
x Phx

pe2)

Fria — PA {yp(Uy (2) ++}

(2.149)

Because 7,, and /,, are orthogonal to any spin orbitals in the second permutation, they must be occupied by electrons 1 and 2 (or 2 and 1), There are
(N — 2)! permutations of the remaining electrons 3, 4,..., N, and integrating over these electrons gives

1

KKIOILY=, fax, dx, [ek WAFDr20 — Arad {zo(V 742}
+ Ar) tm(2)r 2

— FP, a){Zq(Vzp(2)}}

(2-150)

As in the last case, we can show that the two terms are identical by interchanging the dummy variables of integration, so that

{K|O.|L> = fax, dx, UVF -A Vzp(Vz2)}
= fax, dx, AD Le( D721921]
= <mn|pq> — <mn|qp> = <mn||pq>

Case 3

(2.151)

In the same way that matrix elements of a sum of one-electron operators are
zero if the determinants differ by two or more spin orbitals, matrix elements

of a sum of two-electron operators are zero if the determinants differ by
three or more spin orbitals,

<K|O,|L> = 0

(2.152)

MANY-ELECTRON

WAVE

FUNCTIONS

of the rules for matrix

This completes the derivation
Slater determinants.

AND

OPERATORS

81

elements between

Exercise 2.16 A different procedure for deriving the above matrix ele-

ments uses the theorem that (K|#|L)> = (N!)'/?<K®?|#|L> where |K”?>
is the Hartree product corresponding to the determinant |K), i.e.,

IK> = [Zm(%1)%n(%2) * * *>
and
|K#P> = Xm(X

ha X2) ° >”

Prove this theorem. Use it to derive the matrix elements of a sum

electron operators.

of one-

2.3.5 Transition from Spin Orbitals to Spatial Orbitals
All of our development so far has involved spin orbitals y, rather than
spatial orbitals y;. The use of spin orbitals simplifies the algebraic manipulations and notation associated with the general formulation of various theories encountered in quantum chemistry. For most computational purposes,

however, the spin functions « and # must be integrated out, to reduce spin
orbital formulations to ones which involve only spatial functions and spatial

integrals that are amenable to numerical computation. We will show how
this is done and introduce a notation for spatial integrals.
To illustrate the procedure in the simplest possible context, consider
the Hartree-Fock energy of our minimal basis H, model (see Eq. (2.92))

Eo = <xalhixa> + <xalblze> + <xi%al%1%2> — <XaX2l%o%1> — (2-153)
using the physicists’ notation, or

Eo = Callas] + Laalely2) + Dezalxex2] — Drvalxax:]

(2-154)

using the chemists’ notation. Recall (see Eq. (2.60)) that

XA(x) = Od) = Wy (ale)

120%) = Fi) = WOH)

(2.155)

(2.156)

Substituting these expressions for the spin orbitals in Eq. (2.154), we have
Eo=[v, Alvi] + Delay] +L

Wid] —[Wiws Wid]

(2.157)

Consider the one-electron integral
Lyla

1] = fae,

doo, Wey) P*(e

hale y(t )B(@,)

(2.158)

where we have assumed (as is the case for nonrelativistic Hamiltonians) that
the one-electron operator does not depend on spin. Integrating over the

82 MODERN QUANTUM CHEMISTRY

spin variable «w, and using ¢f|f> = 1, we have
[vlAhys]

= far,

Tr DhO)wilty)

(2.159)

= (w,|hh1)

where we have introduced a new notation for a one-electron spatial integral

(see Table 2.2). Since (a|a> = ¢B|B> = 1 and <a]B> = ¢B|a> = 0, the general reduction is

(2.160)

= Le |hhy,] = (wilhly)

Ly ilhly]

(2.161)

[wlh{e,] = (di{hly,] = 0
so that the one-electron contribution to Ep is (ys {hly).

Consider, next, the first of the two-electron
(2.157) for the ground state energy,
[Wavy aaa

= far, dev, dry deoy WF (rt )o*(co

integrals in expression

Wilt )e(@)ri

x WT(F2)B*(@2)Wi(F2)B(e2)

(2.162)

Integrating over the spin variables c
we have

and w, and using <a|«)> = ¢B|B> = 1,

[yivy Wid]

wie Wr)

= far,

dr, We Wer

= (Wii |b)

(2.163)

where we have introduced a new notation for spatial two-electron integrals
(see Table 2.2). This notation for spatial integrals is just the chemists’ notation with round, instead of square, brackets. We shall not introduce a comparable notation for spatial integrals written using the physicists’ notation.

Thus whether ¢ij|ki> refers to an integral over spin or over spatial orbitals
can be determined only from the context. The last integral in (2.157),
[wad

|i

| = far, doo, dry dog Wr )o*(a,
y(t )B(@\ rt

x W(T2)B(co2)Y
(1 2)0(@2) = 0

(2.164)

since ¢a|B> = (B|x> = 0. In general, when only a single bar appears on

either side of the two electron integral (e.g, [yav, |W,4]), the integral vanishes
by spin orthogonality. The general reduction is
Liab lwahd

= (ww; |Yae]

=

Wd |v

= (eal, |Wivi]

= (Wal, |W)

(2.165)

with all other combinations of bars giving zero. Therefore, the Hartree-Fock
energy of minimal basis H, is
Eo = 2(W fh) + Wy
= 2(1Al1) + (1111)

lWiw)

(2.166)

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

83

Exercise 2.17 By integrating out spin, show that the full CI matrix for
minimal basis H, (see Exercise 2.9) is

H7

2(iJhl1) + (11]11)
(21(21)

(12|12)
2(2\h|2) + (22{22)

Let us generalize the above results to obtain an expression involving spatial
integrals for the Hartree-Fock energy of an N-electron system containing an
even number of electrons. The analogue of the minimal basis H, HartreeFock wave function,

[o>

= \x1%2> = Wady>

(2.167)

in an N-electron system is the closed-shell restricted Hartree-Fock wave
function
['Po> = IXi%2%a%a “'* ¥n-1%n>

= Wid habe

(2.168)

nj2>

“Wy

This wave function is represented in Fig. 2.10. Note that the spatial orbitals
are restricted to be the same for « and # spins, and each spatial orbital is
occupied by two electrons with different spin. The energy of this wave function, expressed in terms of the set of spin orbitals

given by Eq. (2.111),

{y,\a = 1,2,...,N},

{AN

Eo = > [alhla] + 5 ¥ 2 [aa|bb] — [ab|ba]

is

(2.169)

Since the wave function (2.168) contains N/2 spin orbitals with « spin

function and N/2 spin orbitals with # spin function, we can write a sum over
all N spin oribtals 7, as
N

Y=

Figure 2.10

N/2

N/2

Lmtd

UV,

(2.170)

A closed-shell restricted Hartree-Fock ground state

determinant, |) .0 Wolo ++ Waa ay «+ Wnpal'ja>-

84 MODERN QUANTUM CHEMISTRY

where we have used the bar notation. Symbolically this becomes

(2.171)

y=¥4+d

which means that the sum over all spin orbitals is equal to the sum of those
with spin up and those with spin down. For double sums, we have
N

N

N

N

a

b

DD katt = Sudx
a

Nj2
=

N/2

Y

(Wa

N/2 N/2

= PV Y
a

b

+

Ve) 2.

(W,

+

W,)

Waly + Vals + Valls + Vay

(2.172)

or symbolically,
N/2.N/2-N/2.Nj2—

Py-<V a ELE

-NJ2Nj/2_—NJ2-NI2

+EV+Y

DS

(2.173)

Let us use these to reduce (2.169) to an equation involving spatial orbitals.

We treat the one-electron integrals first,
N/2

Nj2

Nj2

¥ [alala] = ¥ [alhla} + ¥ Calhla] = 2 ¥ a fal.)

(2.174)

The two-electron integral term is

; y y [aa|bb] — [ab|ba]
=34d 3 ¥ [aa| bb] — [ab|ba] + ¥ y [aa|bb} — [ab|ba]
+ ¥ ¥ (aa| bb] — [ab|ba] + ¥ ¥ (aa|bb] — (256)
= ¥ ¥ (Whale) — Waho| Weve)

(2.175)

Thus the Hartree-Fock energy of a closed-shell ground state is
N/2 N/2

N/2

=2

Y

(Yall)

+ Y

2

20 Wal Wows) _ (Waly | Wo)

(2.176)

The upper limits of summation, which indicate that we are summing over
spatial orbitals, are redundant since we are using the round brackets, Thus

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

85

Eq. (2.176) can be rewritten as

Ey =2¥ (ahla) + ¥° 2(aa|bb) ~ (ab| ba)
a

ab

(2.177)

When using the physicists’ notation, it is necessary to show the upper limits
of summation, since we have not introduced a notation analogous to round
brackets. The convention we use is as follows. If no upper limit appears, the
sum is over spin orbitals. If the upper limit 1s N/2, the sum is over spatial
orbitals. Thus using the physicists’ notation Eq. (2.177) is
NI2

N/2

a

ab

Ey =2 ¥ ¢alhla> + ¥° 2<abl|ab) — <ab|ba)

(2.178)

Exercise 2.18 In Chapter 6, where we consider perturbation theory, we
show that the leading correction to the Hartree-Fock ground state energy is
E®)
9

1

| <ab| | | |rs>|?|

yy

— 4

abrs &q + &

— & —

&,

Show that for a closed-shell system (where ¢, = ¢;) this becomes
NI2

K

ey

Sy

(ab|rs)\(2(rs|ab) — (rs|ba))
Eq + & — & — &,

aba r s=(N2+1)

2.3.6 Coulomb and Exchange Integrals
Let us consider the physical interpretation of the result given in Eq. (2.177)
for the Hartree-Fock energy of a closed-shell ground state. i.e.

Ey =2¥

(alhla) + ¥, 2(aa| bb) — (ab| ba)
a

(2.179)

ab

Consider the one-electron terms first,
(alh|a)

=

Naa

=

far,

vate)(—3¥2

2

—~

»

Alia

nse

(2.180)

Thus h,, is the average kinetic and nuclear attraction energy of an electron
described by the wave function y,(r,). Next consider the two-electron integral

1) |7r yo [yrelt2)|?
(aa|bb) = far, dry |Yralt

(2.181)

which is the classical coulomb repulsion between the charge clouds |y.(r,)|?
and |y,(r2)|?. This integral is called a coulomb integral and is denoted by
Jy. In general,

J, = (iil i) = iD

(2.182)

86 MODERN QUANTUM CHEMISTRY

Finally, consider the two-electron integral

ba)drs WAe Wale did Wile Walt2)
= fdr,
(ab|

(2.183)

Kj, = (|i) = Gi JD

(2.184)

This integral does not have a simple classical interpretation. It is called an
exchange integral and is denoted by K,,. In general,

Both exchange and coulomb integrals have positive values. We will now
show that the appearance of exchange integrals in the expression for the

energy of a determinant is the result of exchange correlation (i.e., the motion

of electrons with parallel spins is correlated within the single determinantal
approximation to the wave function). We have seen in Subsection 2.2.3 that
antisymmetrizing a Hartree product to yield a Slater determinant introduces
correlation. Before proceeding, let us rewrite the Hartree-Fock energy of a
closed-shell system given in (2.179) in terms of coulomb and exchange

integrals

Eo =2¥ Nag t+ ¥ Wey — Kap
a

(2.185)

ab

Exercise 2.19 Prove the following properties of coulomb and exchange
integrals
Jn

= K,

Jij = Ji

Ki = Ki,

Jy = Fiji

Ky =

Ky

Exercise 2.20 Show that for real spatial orbitals

Ki; = (iif) = (i|i)

= (iil i> = iiliiD

Exercise 2.21 Show that the full CI matrix for minimal basis H, (see
Exercise 2.17) is
B= (7

tdi,
Ky,

Ky,
)
2ha. + S22

The spatial molecular orbitals of this model are real because they were
constructed as linear combinations of real atomic orbitals (see Egs. (2.54),
(2.55), (2.57), and (2.58)).
A feeling for the occurance of exchange integrals can be gained by
reconsidering the example discussed at the end of Subsection 2.2.3 from the
energetic point of view. We have seen that in a system containing two elec-

MANY-ELECTRON

WAVE

FUNCTIONS

AND

OPERATORS

87

trons with parallel spin, described by the wave function |i/,W), the probability of finding two electrons at the same point in space is zero, whereas

in a system containing two electrons with opposite spin, described by the
wave function | /.), it is not. Therefore, it is reasonable to expect that the

energy of |),/2> is lower than the energy of }¥/,i/.> when the coulomb

repulsion between electrons is taken into account. Using Eq. (2.110), the

energy of |),

denoted by E(T|), is

E(t) = Ly alhly] + [ya|h\b 2] + [yids WoW]
= (1|h{1) + (2|h|2) + (11]22)

=hh,

thy

_ [yd |v)

+ J,

(2.186)

and the energy of |i/,W2), denoted by E(||), is
E(\Q=

(Wilhh

J + (halhlyo) + (Hiv

|Wavo]

= (1[h{1) + (2|h|2) + (11[22) — (12]21)

_ [viv

|Povrs]

=hiy + hoa +J12—
Ky2

(2.187)

where we have used Egs. (2.160), (2.161), and (2.165) to integrate out the
spin. Because K,, is positive, E(||) is indeed lower than E(T|). Thus the
appearance of exchange integrals in the energy of a Slater determinant is a

manifestation of the fact that, even within the single determinantal approximation to the wave function, the motion of electrons with parallel spins is
correlated.

Exercise 2.22 Show that the energies of the Hartree products
wet = Wy (01 )a(@, i (r2)B (2)

and
wi

= WP )B(@ Walt 2)B(o2)

are the same and equal to E(t |) as to be expected since the motion of electrons with parallel spin is not correlated within the Hartree product approximation to the wave function.

2.3.7 Pseudo-Classical Interpretation of Determinantal Energies
In Subsection 2.3.3, we introduced a simple mnemonic device for writing
down the energy of a single determinant, constructed from a set of spin

orbitals {y;}, in terms of one-electron integrals over spin orbitals (<ilh|i>)
and antisymmetrized two-electron integrals over spin orbitals (<ij| |i/>). Here

we will show how one can express, with equal ease, the energy of any re-

stricted determinant, constructed from spin orbitals {y,«} and {yf}, in

terms of h,,, coulomb (J;,;), and exchange (K;,) integrals.

88 MODERN QUANTUM

CHEMISTRY

We begin with the one-electron contributions to the energy. Recall that
an electron in spin orbital 7; contributed the term Cilhli> to the energy. If

4 = Wa, then Cilh|iy = CYpalhiee> = (Wilh) = hy. Similarly, if x, = V,B,
then Cilhli> =h,,,

Therefore, an electron (irrespective of its spin) in spatial

orbital yw, contributes the term h,, to the energy.
Next we consider the two-electron contributions to the energy. Recall
that each unique pair of electrons in spin orbitals y, and 7, contributes the

term ¢ij||ij> to the energy. A pair of electrons can have either parallel or

opposite spi's. If they have opposite spins, say 7, = yv,a and 7, = w,f, then

(2.188)

CHD = Lo, |W) — [Yad [bad = J,

On the other hand, if they have parallel spins, say 7; = ,f and x; = w,f, then
ijl

lif>

=

(Wii

wah]

~~

AVAL

AUA

=

Jy

~

K,,

(2.189)

Therefore, each unique pair of electrons (irrespective of their spin) in spatial
orbitals ys, and yw; contributes the term J,, to the energy, and each unique pair
of electrons with parallel spins in spatial orbitals w, and Ww, contributes the
term — K;; to the energy. The total energy of the determinant is the sum of
all these contributions.
Thus we can think of the total energy of an N-electron system, which is
described by a restricted determinant, as a sum of “one-electron-energies”
(h,, for an electron in spatial orbital y,) plus all unique coulomb interaction
energies (J;, for a pair of electrons in spatial orbitals y, and y,) plus all
unique exchange interaction energies between electrons with parallel spins
(—K,, for a pair of electrons with parallel spin in spatial orbitals y, and wy).
In using this language, it must be remembered that exchange interactions
between electrons with parallel spin are not real physical interactions but a
convenient way of representing the energy of a system described by a single
determinant. The physical interaction between two electrons, as described
by the coulomb repulsion term (r;;') in the Hamiltonian, does not depend
on the spin of the electrons.
As an illustration of the above approach, consider the energy of the
determinant

—|—3
Ww WoWas>

=—t-2

—}—1

The one-electron contributions to the energy are h,,, 2h2,, and h33. The
coulomb contributions are J22, J13, 2J,2, and 2J,,. The exchange contributions are — K,3, —K,,, and — K,3. Thus the total energy is h,, + 2hg2 +

hy3 + Jaq +J13 + 12

+ 2393 — Kr3 — Ki. — Ki3.

MANY-ELECTRON

Exercise 2.23 Verify

inspection.

I
a
b.
c.
d.
e.
f.
g.

4$— —

the

energies

+- +

WAVE

of the

th

FUNCTIONS

AND

OPERATORS

89

following

determinants

by

th
I
—-

2
—He-1

Ityy + htg2 +542
— Ky.
hyy + hg.
+d 49.
2hyy
+ Jyy.
2hy2
+ Jap.
2hy, + hag +51, +2),, — Kyo.
2hag
+ hy, + Jag + 2.
— Kyp.
2hy, + 2hgg +41, + Jo. +41. — 2Kyp.

2.4 SECOND

QUANTIZATION

The antisymmetry principle is an axiom of quantum mechanics quite apart
from the Schrédinger equation. We have insured that this principle is satisfied by using Slater determinants and linear combinations of such determinants for wave functions. Can we satisfy the antisymmetry principle without
using Slater determinants? Second quantization is a formalism in which the
antisymmetry property of the wave function has been transferred onto the
algebraic properties of certain operators. Second quantization introduces
no new physics. It is just another, although very elegant, way of treating
many-electron systems, which shifts much of the emphasis away from Nelectron wave functions to the one- and two-electron integrals Cilh| j> and
<ij |kI> that were discussed in the preceding section. The formalism of second
quantization is widely used in the literature dealing with many-electron
problems. We introduce it here not only as an interesting way of rederiving
some of our previous results but also as a background for approaching such
literature. Since we will not make general use of second quantization in the
remaining chapters, this section can be considered optional.

2.4.1 Creation and Annihilation Operators and
Their Anticommutation Relations
We shall gradually construct the formalism of second quantization by
showing how the properties of determinants can be transferred onto the
algebraic properties of operators. We begin by associating a creation operator

a} with each spin orbital z;. We define a} by its action on an arbitrary Slater

90

MODERN

QUANTUM

CHEMISTRY

determinant |z,-- +7), aS

(2.190)

XD

D> = [tite

atlyn

Thus af creates an electron in spin orbital y;. The order in which two creation
operators are applied to a determinant is crucial. Consider

afat te

1 = af ile

WD =

ud = ab tite

> = |e

|i

WD

(2.191)

On the other hand,

atallyn

= — (tte

OD

wD

(2.192)

where we have used the antisymmetry property of Slater determinants (see

Eq. (2.40)). Adding Eqs. (2.191) and (2.192), we have

(alat + alah)|y.°*- %> =0
Because |z,°** 7,
operator relation

is an arbitrary

determinant,

(2.193)
we

have

discovered

atat + ata} = 0 = {a}, af}

the

(2.194)

where we have used the notation for the anticommutator of two operators
introduced in Eq. (1.19a). Since,

(2.195)

ajat = —ata}

we can interchange the order of two creation operators provided we change
the sign. If i = j, we have

alai = —ata! =0

(2.196)

which states that we cannot create two electrons in the same spin orbital
y, (Pauli exclusion principle). Thus
atal|yoxs>

= ah |x1%2%3> = Iy1%1%2%a>

=0

(2.197)

In general,

dla

xp =90

fie {k,...,1

(2.198)

which states we cannot create an electron in spin orbital y, if there is one
already there.
Exercise 2.24 Show, using the properties of determinants, that

(afa} + a}a})|K> = 0

for every |K) in the set { Mik»>

lx1%3>s \x1%4a>s

Yoda

lx2%a>» \xsx4>}-

We now introduce the annihilation operator a,, which is the adjoint of
the creation operator a; (i.e, (af) = a). In analogy with Eq. (2.190), a; is

MANY-ELECTRON

WAVE

FUNCTIONS

AND

OPERATORS

91

defined by
ai|%iXn

Y=

xx “¥D

(2.199)

Thus a; annihilates or destroys an electron in spin orbital y,. Note that the

annihilation operator can only act on a determinant if the spin orbital, which
will disappear, is immediately to the left. If a spin orbital is not in the proper
position, it must be placed there by interchanging the columns of the determinant, e.g.,
a, ZX

=

—alyinno>

=

—|ni%n>

= lyux>

(2.200)

Why is the annihilation operator defined as the adjoint of the creation
operator? Consider the determinant

IK> = |xix>

(2.201)

|K> = all>

(2.202)

Clearly,
The adjoint of this equation (see Eqs. (1.52) and (1.57)) is

CK = Caillat) = Cail

(2.203)

(K|K) = ¢x,a,|K>

(2.204)

Multiplying (2.203) on the right by |K), we have
Since (K|K> = 1 = ¢z,|x,>, our formalism is consistent when

a,|K> = al, = |x>

(2.205)

in agreement with the definition of (2.199) of the annihilation operator. From
Eq. (2.203) we see that a, acts like a creation operator if it operates on a
determinant to the left. Similarly, at acts like an annihilation operator if it
operates to the left. For example, the adjoint of Eq. (2.205) is

(Kat = <x;

(2.206)

To obtain the anticommutation relation satisfied by annihilation operators we take the adjoint of (2.194). Since (c.f. Exercise 1.3)
(SB) = Broa

(2.207)

a,a; + a,a; = 0 = {a,, a;}

(2.208)

aa; = —a,G;

(2.209)

we have

Since

we can interchange the order of two annihilation operators provided we
change the sign. If i = j, we have
aja; = —aja; = 0

(2.210)

92

MODERN QUANTUM

CHEMISTRY

which states that we cannot destroy an electron twice. A consequence of this
is that we cannot remove an electron from a spin orbital y;, if it is not already
there,

It remains

annihilation

for us to discover how

operators.

arbitrary determinant,
determinant, we have

Consider

(2.211)

ifi€ {k,...,D

=O

aly

we can interchange creation and

the operator a,ai + ala; acting on an

|y, °°: 4). If spin orbital y; is not occupied in this

(a,a} + ata) |x,

YDS

a,at|y, “YD
= ailyXx “XD
= Xn “XD

(2.212)

on the other hand, if x, is occupied, we have
(a,at + ala, |x,

XD

= abailyy** Xi “YD
=

—a}a;|x,

Yn

XD

= —all-- uD

= — lei

Xe

=e
Since we recover the same determinant

the operator relation

wD

XD

(2.213)

in both cases, we have discovered

(2.214)

aa} + aja, = 1 = {a;, af}

Finally, consider (ala; + a,a!)|y,*-- 4 when i # j. This expression can be
nonzero only if the spin orbital y, appears and the spin orbital x, does not
appear in |y, --- x. Otherwise, we obtain zero either because ai tries to
create an electron that is already there or a; tries to destroy one that is not

there. However, even when ie {k,...,/} and j ¢ {k,..., 1} we obtain zero
as a result of the antisymmetry property of determinants,
(a,at + ata)ly, KD

—(a,a}

=

— alte

= OiiXy
=|

Me

ae

Me
UD

XD

Xe

+ ajai)|y;

=

UD

— al

XO — Wy

Wye

he

ae

(2.215)

=0

Thus we have

aat + ala;=0= {a,a}}

(2.216)

i #j

Combining this with (2.214), the anticommutation
creation and an annihilation operator is

aa} + ala, = 6;; = {a,, at}

MD

AD

relation

between

a

(2.217)

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

93

Thus we can interchange a creation and an annihilation operator, which
refer to different spin orbitals, provided we change the sign, i.e.,

a,at = —aja

ixj

pout

(2.218a)

However, if the operators refer to the same spin orbital, we have

at = 1 —- alfa,

(2.218b)

Exercise 2.25 Show, using the properties of determinants, that

(a,a$ + aba,)|K> =0
(ayaj + aja,)|K>

for every |K> in the set {|x:x2>» \y1%a>»

= |K>

Yas

IX2%3>s \x2%4>s lx3%4>}-

All the properties of Slater determinants are contained in the anticommutation relations between two creation operators (Eq. (2.194)), between
two annihilation operators (Eq. (2.208)), and between

a creation and an

annihilation operator (Eq. (2.217)). In order to define a Slater determinant
in the formalism of second quantization, we introduce a vacuum state
denoted by | >. The vacuum state represents a state of the system that
contains no electrons. It is normalized,

(2.219)

<|>=1
and has the property that

a| >=0=<
that is, since the vacuum

(2.220)

|a?

state contains no electrons, we cannot remove an

electron from it. We can construct any state of the system by applying a
succession of creation operators to the vacuum state. For example.

(2.221)

lv.> =a] >

or, in general,

ara

> all > = late

a>

(2.222)

This relation is the second-quantized representation of a Slater determinant.
Any result that can be obtained using the properties of determinants can also
be proved using only the algebraic properties of creation and annihilation
operators.

In Exercise 2.5 we evaluated the overlap between the two determinants

IK> = |xziz;> = ata] >
IL> = |uxe> = atal| >
by expanding out the determinants,

(2.223)
(2.224)

integrating over the space and spin

coordinates of the two electrons, and using the orthonormality relation of

94 MODERN QUANTUM CHEMISTRY

spin orbitals. Here we evaluate the overlap by using the formalism of second
quantization. Since the adjoint of Eq. (2.223) is

<k| =< |(afat)t =¢ |aja,

(2.225)

=< [aja,afa}| >

(2.226)

we have

{K|L>

The general strategy for evaluating such matrix elements is to move, using
the anticommutation relations, the annihilation operators to the right until
they operate directly on the vacuum state. We begin with a;. Since

(2.227)

a,a}. = 64, — ata,
we have
<K|L>

=<

la (Six _ aja,al|

|ajaf| >—<

= 64<

>

(2.228)

>

|a,afa,ai|

To continue, we move a, to the right in the first term and keep moving a;
to the right in the second,
{K|L>= 646 <

| >On

lafa,|

>- bk

aja}

>+<

lajazafa,

>

(2.229)

The second and last terms now have an annihilation operator acting on the
vacuum and hence are zero. Finally, moving a; to the right in the third term,
we have
<K|L>

= Sin O aX
=

Oi

0 1

| >_

60

6110 nc&

| > + dink

lafa,|

>

jx

(2.230)

since the vacuum is normalized. This result is the same as found in Exercise
2.5.

Exercise 2.26 Show using second quantization that <y,|x,> = 5,
Exercise 2.27 Given a state
[K> = Ix1%2 °° *¥n>=

ajah: -- ah

>

show that (K|afa,|K> = 1 ifi=jandie {1,2,..., N}, but is zero otherwise.

Exercise 2.28 Let |Po> = |x1 °° + xa%e°*' Xw>
ground state wave function. Show that
a.

a

Po

=

O=

<¥

oat.

b. al|¥o>= 0 = <Polag.
c. [WS = ala,|Vo>.

be

the

Hartree-Fock

MANY-ELECTRON

WAVE

FUNCTIONS

AND

OPERATORS

95

d. <P] = <Polata,.

e. |¥G> = ala,ata,|¥o> = atala,a,|¥
o>.

f.

<P

=

<P olata,aja,

=

<P olatafa,a,.

2.4.2 Second-Quantized Operators and Their Matrix Elements
We have seen that we can represent determinants by using creation and
annihilation operators, which obey a set of anticommutation relations and
a vacuum state. Thus we have found a representation of a many-electron
wave function that satisfies the requirement of the antisymmetry principle,
but which can be manipulated without any knowledge of the properties of
determinants. To be able to develop the entire theory of many-electron
systems without using determinants, we must express the many-particle
operators, ©, and ©, in terms of creation and annihilation operators. We
can then evaluate matrix elements of these operators using only the algebraic
properties of creation and annihilation operators. Clearly, the expression

for an operator © in second quantization must be such that the value of the

matrix element <K|O|L) is the same irrespective of whether we obtained it

using the properties of determinants or using the algebra of creation and
annihilation operators. The appropriate expressions for ©, (our sum of oneelectron operators) and ©, (the operator describing the total coulomb
repulsion between electrons) in second quantization are

0, =) <ilh|pafa;

(2.231)

1
..
6, = 5 » <ij |kDalataa,

(2.232)

iy

Wy

where the sums run over the set spin orbitals {y,;'. Note that the one- and

two-electron integrals appear explicitly and that the form of these operators
is independent of the number of electrons. One of the advantages of second
quantization is that it treats systems with different numbers of particles on an
equal footing. This is particularly convenient when one is dealing with
infinite systems such as solids.

Exercise 2.29 Let |Wo> = |x,%2> = aja$| > be the Hartree-Fock wave

function for minimal basis H,. Show using second quantization that
<P lO ,|Po> = » <ilh|7><
ij

la,a,ata,atas|

>

= <HhL> + ¢2|h[2>
As an illustration of the equivalence of second quantization with our

previous development, based on Slater determinants, we calculate the energy

of the Hartree-Fock ground state, |‘¥o> = lx. °°" Xa%p °° * Xw>» USiINg second

96

MODERN

QUANTUM

CHEMISTRY

quantization. For the sum of one-electron operators, we have

(¥olO,|%o> = ¥ <ifAli><Wolala|¥o>

(2.233)

uj

Since both a, and a! are trying to destroy an electron (a, to the right and

a‘ to the left), the indices i and j must belong to the set {a,b,

..} and thus

CPol@i|¥o> = ¥ <alh|b><¥ olata,|¥o>

(2.234)

ab

Using
Agdy = Say — A504

to move ai to the nght, we have
<P olazas|Po> = bar

Po| Po> _ CP olazag]|'¥ o>

(2.235)

The second term on the right is zero since ai 1s trying to create an electron

in ,, which is already occupied in |¥o>. Since <¥o|‘¥o> = 1, we finally have

CP o|O,|%o> = ¥. <alh|b>Sq, = ¥. <alhlay
ab

a

(2.236)

in agreement with our previous result in Table 2.5.
For the sum of two-electron operators, we have

(PC 2|¥o> =>

1

» Cij [KID <P olafajaya,|¥ o>

ijkl

(2.237)

By the same argument we used for one-electron operators, the indices i, j, k, 1

must belong to the set {a, b,...},

1

(PoC a|%o> =. Y <abled ><Wolatabasa|¥o>
abed

(2.238)

Our strategy, as before, is to move ai and af to the right until they operate

on |¥o),
<P olajafaga,|¥ o> = Osa 'P olaia,|¥ o> _ <Polatazaja,|¥ o>
= SpaSacX¥ o| Yo» _ bra

¥ ofa,a3|'¥ o>

— b5eK VP olaiago> + <Polataga.ap|¥o>
= b4d0ae — 5pcOaa< Vo|

= SraSac — Op

PV o> + SpeK VP olaaat|¥ o>

aa

We thus get two terms; in the first term we set c = a and d = b, and in the
second term we set c = bandd =a,

1

<P l62|%o> = 5) <ab|ab) — <ab|bay
ab

in agreement with our previous result in Table 2.6.

(2.239)

MANY-ELECTRON

WAVE

FUNCTIONS

AND

OPERATORS

97

Exercise 2.30 Show that
C¥10,|%o>

= » Cilh|7><¥ olata,ala,|¥o>
y

= <rlhlay

by moving aj and a, to the right.
Exercise 2.31

Show that
N
CP110.|"o>

= > <rb| |aby
b

Hint: first show that
<P olata,atata,a,|¥ o> = 5, Sat

olala,|? o> _ 5, Oa<E olata,|Yo>

+ 5,1 5a4<E oafay|'¥ o> — bi SaX¥ olatay|Y o>
then refer to Exercise 2.27.

2.5 SPIN-ADAPTED

CONFIGURATIONS

We have described the spin of a single electron by the two spin functions
a(w) = x and B(w) = B. In this section we will discuss spin in more detail
and consider the spin states of many-electron systems. We will describe
restricted Slater determinants that are formed from spin orbitals whose
spatial parts are restricted to be the same for a and f spins (ie, {x;} =
{w,o, ,8}). Restricted determinants, except in special cases, are not eigenfunctions of the total electron spin operator. However, by taking appropriate
linear combinations of such determinants we can form spin-adapted configurations, which are proper eigenfunctions. Finally, we will describe unrestricted determinants, which are formed from spin orbitals that have

different spatial parts for different spins (i.e., {y,} = {w7a, WPB}).
2.5.1 Spin Operators

The spin angular momentum of a particle is a vector operator S,

§=s,i+syjts,k

(2.240)

where i, j, and & are unit vectors along the x, y. and z directions. The squared
magnitude of $ is a scalar operator

VP =F F=Nr452 483

(2.241)

98 MODERN QUANTUM

CHEMISTRY

The components of the spin angular momentum
relations

[s,, Sy] = is,.

[s,, S,] = is,

satisfy the commutation

[s,, 8] = is,

(2.242)

The complete set of states describing the spin of a single particle can be
taken to be the simultaneous eigenfunctions of s? and a single component

of S, usually chosen to be s,,

s*|s.m.> = (5 + 1)|s, m.>

(2.243a)

s,s, m,> = m,|s, m,>

(2.243b)

where s is a quantum number describing the total spin and m, is a quantum
number describing the z component of the spin. The possible values of s
are 0, }, 1,3.... and m, has 2s + 1 possible values —s, —s+ 1, -s+2,...,
s—~ I, s. Anelectron is a particle with s = } and m, = +4. Thus the complete
set of states describing the spin of the electron are

1,2

=o

(2.244a)

(2.244b)

3, -2> =|B>
These spin states are eigenfunctions of s? and s,,

slay = Zla>,

—-s7|B> = 3|B>

(2.245a)

sx> = 30>,

— s,{B> = —4]6>

(2.245b)

but are not eigenfunctions of s, and s,,

syja> = 3[B>,

SB> = 5a

(2.245¢)

sla) = 5 [6>,

3,8) = — 5 {a>

(2.245d)

Instead of using s, and s,, it 1s often more convenient to work with the
“step-up” and “step-down” ladder operators, s, ands

, defined as

$4 = 5, + isy

(2.246a)

s

(2.246b)

=s, —is,

These operators increase or decrease the value of m, by one,
s,|e> = 0,

4|B> =|

(2.247a)

s {> =[B>,

s |B> =0

(2.247b)

Using the commutation relations (2.242), the expression (2.241) for s? can
be rewritten as

s’=s,s

~—s,+5?

(2.248a)

s?=s_s, +s,+8?

(2.248b)

MANY-ELECTRON

WAVE

FUNCTIONS

AND

OPERATORS

99

Exercise 2.32 a) Derive (2.247) from (2.245); b) Derive (2.248).

Exercise 2.33 Find the 2 x 2 matrix representations of s?, s,, 5,4, and s_
in the basis {a>, |B>. Verify the identities analogous to (2.248a,b) for these
matrix representations.

Exercise 2.34 Using

[s?, s,] = 0.

the

commutation

relations

(2.242),

show

that

In a many-electron system, the total spin angular momentum operator
is simply the vector sum of the spin vectors of each of the electrons

Y=

N

i=1

Ki)

(2.249)

From this relation it is evident that the components of the total spin and

the ladder operators are analogous sums of one-electron operators
N

F,=

>

s,(i)

I=x,y,z

(2.250a)

i=1

Lfx=¥

N

s3(i)

it

(2.250b)

The total squared-magnitude of the spin,
il

2

5

4

N

Vv

YV i) 8)
PS S=Yf1 g=1

=P,f
-%,+F2
=F_L.+G,4F2
is the sum of one-electron operators (the diagonal terms
sum of two-electron operators (the cross-terms i ¥ /).

(2.251)
1 = j) plus the

In the usual nonrelativistic treatment, such as considered in this book,

the Hamiltonian

does not contain any spin coordinates and hence both

¥? and “. commute with the Hamiltonian.

[H, £7] =0=[#%,F.]

(2.252)

Consequently, the exact eigenfunctions of the Hamiltonian are also eigenfunctions of the two spin operators,

S7|O> = S(S + I>

(2.253a)

F \®> = Ml)

(2.253b)

where S and Mg are the spin quantum numbers describing the total spin
and its z component of an N-electron state |). States with S = 0, 5, 1, 3,.-.

100 MODERN QUANTUM CHEMISTRY

have multiplicity (2S + 1) = 1, 2,3, 4,... and are called singlets, doublets,

triplets, quartets, etc. Approximate solutions of the Schrédinger equation
are not necessarily pure spin states. However, it is often convenient to constrain approximate wave functions to be pure singlets, doublets, triplets, etc.
Any single determinant is an eigenfunction of Y, (see Exercise 2.37).
In particular

S Ndi

ted = (N* — NN,

HO = Mslying

>

(2.254)

where N* is the number of spin orbitals with » spin and N® is the number of
spin orbitals with f spin. However, single determinants are not necessarily

eigenfunctions of #. As we will discuss in the next subsection, by combining
a small number of single determinants it is possible to form spin-adapted
configurations that are correct eigenfunctions of 47.

Exercise 2.35 Consider an operator .o that commutes with the Hamiltonian. Suppose |®) is an eigenfunction of ¥ with eigenvalue E. Show that
s/|®> is also an eigenfunction of # with eigenvalue E. Thus if |) is
(energetically) nondegenerate, then ./|®) is at most a constant multiple of

|) (i.e. /|®> = al) and hence |) is an eigenfunction of /. In case of

degeneracies, we can always construct appropriate linear combinations of
the degenerate eigenfunctions of # that are also eigenfunctions of 7.
Exercise 2.36 Given two nondegenerate eigenfunctions of a hermitian operator «/ that commutes with % i-e., sf |¥,) = al¥,), o|¥) =
a|¥2), a, ~ a, show that (V,|%|¥,) = 0. Thus the matrix element of the
Hamiltonian between, say, singlet and triplet spin-adapted configurations
is zero.
Exercise 2.37 Prove Eq. (2.254). Hint: Use expansion (2.115) for a Slater
determinant and note that /,, since it is invariant to any permutation of the
electron labels, commutes with Y,.

2.5.2 Restricted Determinants and Spin-Adapted Configurations
As we have seen in Subsection 2.2.1, given a set of K orthonormal spatial
orbitals {y,|i=1,2,...,K} we can form a set of 2K spin orbitals
{w|i = 1,2,...,2K} by multiplying each spatial orbital by either the o or
B spin function

La 1(X) = Wi(ra(@)

Yadx) = WAN B()

i=1,2,...,K
2

(2.255)

Such spin orbitals are called restricted spin orbitals, and determinants formed
from them are restricted determinants. In such a determinant a given spatial

101

FEF F

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

Vs

Ya

Vs

Ye
Hi

['w>

=

| ¥,

¥, ¥,

¥, Y, ¥, >

Figure 2.11

A singlet closed-shell determinant.

orbital yy, can be occupied either by a single electron (spin up or down) or
by two electrons (one with spin up and the other with spin down). It is convenient to classify the types of restricted determinants according to the
number of spatial orbitals that are singly occupied. A determinant in which
each spatial orbital is doubly occupied is called a closed-shell determinant
(see Fig. 2.11). An open shell refers to a spatial orbital that contains a single
electron. One refers to determinants by the number of open shells they
contain.
All the electron spins are paired in a closed-shell determinant, and it is
not surprising that a closed-shell determinant is a pure singlet. That is, it is
an eigenfunction of “? with eigenvalue zero,
SW Waa W, “>

= O(0+

Dlwabab a, -)=0

(2.256)

as shown in Exercise 2.38. The simplest example of a closed-shell determinant is the Hartree-Fock ground state wave function of minimal basis H,,

Ho> = Wits> = Dh

(2)]2 > (a1) B(2) — BCL)o(2))

(2.257)

where we have expanded out the determinant. The spin part of this wave
function is just the singlet spin function of a two-electron system. The doubly

excited state [¥{{> = [22> is, of course, also a singlet.
Exercise 2.38 Prove Eq. (2.256). Hints:

1)

7? =S7_f,4+9,+

¥2,

2) as a result of Eq. (2.254) it is sufficient to show / ,|Wy, ---> = 0, 3) use

expansion (2.115) for the determinant, and note the “ , commutes with the
permutation operator, 4) s,yo = 0, 5) finally, s, wf = yo, but the determinant vanishes because it has two indentical columns.

102 MODERN QUANTUM CHEMISTRY

We now consider open-shell restricted determinants. Open-shell determinants are not eigenfunctions of ”, except when all the open-shell electrons
have parallel spin, as in Fig. 2.12. As an illustration, let us consider the four
singly excited determinants that arise in the minimal basis H, model (see
Eq. (2.76)). The open-shell determinants

[23> =|2 T> = — 277 [h yal) — WoL (2)JBU)B(2) (2.258a)
PP2> =|1 2> = 27? [ 2(2) — Poi (2)Jo(a(2)——(2.258b)
are eigenfunctions of ? with eigenvalue 1(1 + 1) = 2 and thus are both
triplets. On the other hand, the determinants

[¥2> = |21>

(2.259a)

f¥?> = |1 2

(2.259b)

are not pure spin states. However, by taking appropriate linear combinations
of these determinants we can form spin-adapted configurations, which are
eigenfunctions of “7”. In particular, the singlet spin-adapted configuration is

|PPT> = 2° HF> + [7D

= 2-1/1 2> + |2 1d)

bhal2) + Wid a(1)]2~ “(aD B(2) — B)o(2))
Th
= 277

(2.260)

and the triplet spin-adapted configuration is

[82> = 27 1(¥2y — 2)

= 271112) —|2D)

Dal2) — Wi(2W(D)]2-“/7(ee(DB(2) + BOa(2))

frit
Hort

= 2771

Va

Vs

v3

Vo

Ye

yt

yl

[Y=
% vede
]vs?
Figure 2.12

[Y= lob vedesve

Doublet and triplet restricted single determinants.

(2.261)

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

103

As expected, the spin part of |*¥7) is identical to the spin part of the closedshell wave function (2.257) since both wave functions are singlets.

Exercise 2.39 Using 4? = 4_S, + ¥,+ 2,
singlet while |*7), |‘¥7> and |?) are triplets.

show that |"Pf)> is a

Exercise 2.40 Show that
CPE

PD

CWA

PPD

=

hy,

+

ho

+ Jia

+ Ky,

= hy, + haz + Jia — Kia

Note that the energy of the triplet is lower than the energy of the singlet.

Why is this to be expected from the space parts of the two wave functions?

Let us generalize the above results for minimal basis H,. In Chapters 4
and 5 we use singlet spin-adapted configurations that arise as a result
of single and double excitations from a closed-shell Hartree-Fock ground
State,

[o> = |1T +++ aa bB-++>

(2.262)

The procedure for finding the appropriate linear combinations of singly and
doubly excited determinants to form spin-adapted configurations is beyond
the scope of this book: we shall merely quote the results. A variety of methods
are available for constructing spin eigenfunctions. An authoritative and clear
description of many of these methods has been given by Paunz.?
The singlet spin-adapted configuration corresponding to the single
excitation in which an electron has been promoted from spatial orbital y,
to spatial orbital y, is

|!E> = 271 E> + ED)

(2.263)

Note that if a= ! and r = 2, this expression reduces to the minimal basis
result (2.260).
For double excitations, a number of different types of singlet spinadapted configurations can occur. They are presented in Table 2.7. The spinadapted configuration corresponding to the situation that both electrons
come from the same spatial orbital and go into the same spatial orbital is
|' Wz.
This is the generalization of the doubly excited state (|¥7}> = |22>)
aa
of minimal basis H,. If two electrons come from the same spatial orbital but
go to different spatial orbitals, the appropriate spin-adapted configuration is
|'Wzs>. If two electrons come from the different spatial orbitals but go to
the same spatial orbital, the appropriate spin-adapted configuration is
|'‘Wz>. Finally, for the situation that both electrons come from different
spatial orbitals and go to different spatial orbitals there are two linearly

independent spin-adapted configurations, |4Y75> and |?'¥73).

104

MODERN

QUANTUM

CHEMISTRY

Table 2.7 Doubly-excited singlet spin-adapted configurations
Ss

ye
b—h—

CNR = ND

a
S

bg

ie

Fi

IN rs = 2° -u NSE)15 + [D)SF

a
s

b—s

Fr—h—

[!Sc,> = 27" 2()9G5> + [ED)
=

=

_

a —*—
So
ro

|p
o—}

b

a —+*—

=(12)7! 2(2 (3)

ab.

ab.

+ 2|"3>
ab.

_

[es

ab

+

pees

@b.

+

[ws5>
ab

_

E>)
ab.

PeiE> = 2((ab> + [PE + [Wad + [WeED)

2.5.3 Unrestricted Determinants

With restricted spin orbitals and restricted determinants, the spatial orbitals
are constrained to be identical for « and f spins. For example, the restricted
Hartree-Fock (RHF) ground state of the Li atom is
|? Prar>

=

Wir

W20>

(2.264)

as shown in Fig. 2.13. The spatial description of the 1 sx electron is forced to
be identical to that of the 1sf electron. This is a real constraint since the 1 sa
electron has an exchange interaction with the 2sa electron, whereas the 1sf
electron does not. The 2sa electron spin “polarizes” the 1s shell. The 1sx and
1sB electrons will experience different effective potentials and would “prefer”
not to be described by the same spatial function. Intuitively, we expect that
if this constraint is relaxed by using different orbitals for different spins,

|Pune> = WisdiW3s>

—t—

—H-*.
RHF

(2.265)

—_{— Yes

Vor
—

a

tw i be
UHF

Figure 2.13 Relaxation of a restricted single determinant to an unrestricted single determinant
for the Li atom

MANY-ELECTRON WAVE FUNCTIONS AND OPERATORS

105

we will obtain a lower energy. This is indeed the case. The wave function
(2.265) is an example of an unrestricted determinant. It is, in fact, the unrestricted Hartree-Fock (UHF)

ground state wave function of the Li atom.

Unrestricted determinants are formed from unrestricted spin orbitals.
Unrestricted spin orbitals have different spatial orbitals for different spins.
Given a set of K orthonormal spatial orbitals {7},

Wil

(2.266)

= 6,

and a different set of K orthonormal spatial orbitals {yh

(2.267)

(wily?) = 6,
such that the two sets are not orthogonal,

(2.268)

<Ui|We> = Sif

where S$” is an overlap matrix, we can form 2K unrestricted spin orbitals as

Xai-1(X) = We(a(co)
Xailx) = YRO)B()

i=1,2,...,K
>

(2.269)

As shown in Exercise 2.1, the 2K unrestricted spin orbitals form an orthonormal set, in spite of the fact that the « and f spatial orbitals are not
orthogonal.
Unrestricted determinants are not eigenfunctions of “*. Moreover, they
cannot be spin-adapted by combining a small number of unrestricted determinants as is the case for restricted determinants. Thus the UHF ground state

rrr l:
wt [i

(2.265) of the Li atom is not a pure doublet as is the RHF ground state (2.264).
Nevertheless, unrestricted wave functions are commonly used as a first
approximation to doublet and triplet states.
Figure 2.14 shows a representation of an unrestricted wave function,
which is approximately a singlet. Note that N* = N*. The « and £ orbitals

\

| v=

a B,a7h,a 7s
lyf Vv, Me Wa Ys >

Figure 2.14 An unrestricted determinant
approximately a singlet.

that is

106 MODERN QUANTUM CHEMISTRY

are drawn as nondegenerate for emphasis. Unrestricted singlets frequently
collapse to the corresponding restricted singlets, Le., to a closed-shell state.
In our minimal basis H, problem, for example, the closed-shell ground state

is |v 11> and at normal bond lengths the energy is raised rather than lowered

by using different spatial orbitals for the two electrons. However, when

the

bond length is very large, one electron is effectively around one hydrogen
atom, and the other electron, around the other hydrogen atom, should have
a very different spatial description. Thus at large bond lengths, the energy is
lowered by using an unrestricted rather than a restricted description, as we
shall see in the next chapter.
Tf N,= Ng, +1, then an unrestricted determinant is approximately a
doublet (see Fig. 2.15). An unrestricted doublet is often used as the first
description of free radicals with one unpaired electron such as CH;. An
approximate triplet determinant has two more « electrons than f electrons
as shown in Fig. 2.16.
If |1>, |2, |3>, etc. are exact singlet, doublet, triplet states etc. then the
unrestricted states in Figs. 2.14, 2.15, and 2.16, can be expanded as

(2.2702)

o
F
>
[S
cl
+
>
f3
cl
+
y
f1
ch
=
>

+>
]6
c3
+
>
|4
c3
+
>
|2
c3
=
Py
°
-4+
)
7
3
+
>
5
c
+
>
[3
c3
=
BW)

(2.2706)
(2.2706)

Thus an unrestricted wave function is contaminated by higher, not lower,
multiplicity components. If the leading term in the above expansion is
then

one can describe,

to a good

approximation,

tH
++I:
ttHt

dominant,

Ve

>

i

;

y B

—

_.

tw> =| yr yF ys yey)

Figure 2.15 An unrestricted determinant
that is approximately a doublet.

ys

unrestricted

——
——
vi

a

B

—-

y2
=|yPy
sye >
[>v>voy
Figure 2.16 An unrestricted determinant
that is approximately a triplet.

MANY-ELECTRON

WAVE FUNCTIONS AND OPERATORS

107

determinants as doublet. triplet, etc. The expectation value of ? for an
unrestricted determinant is always too large because the contaminants have
larger values of S. In particular, it can be shown that

NON
Sune = (SY? Dexacr + N¥ — » > [Sif|?
ij
where we have assumed, as always, that N* > N? and where
a2 _
LF

rE Ka01

=

NB

(“*)

a _
(~“*

(2.271)

AB
+

(2.272)

'

In spite of spin contamination, an unrestricted determinant is often used as

a first approximation to the wave function for doublets and triplets because
unrestricted wave functions have lower energies than the corresponding
restricted wave functions.

Exercise 2.41 Consider the determinant [K) = |¥iW{> formed from
nonorthogonal spatial orbitals, <W7|y4> = S34. a. Show that |K) is an eigenfunction of ¥? only if ¥j = 4. b. Show that (K|¥?|K)> = 1 — |S%4|? in

agreement with Eq. (2.271).

NOTES
1. B.

T.

Sutcliffe,

Fundamentals

of computational

quantum

chemistry,

in

Computational

Techniques in Quantum Chemistry, G. H. F. Diercksen, B. T. Sutcliffe, and A. Veillard (Eds.),
Reidel, Boston, 1975, p. 1.

2. R. Paunz, Spin Eigenfunctions, Plenum, New York, 1979.

FURTHER

READING

Avery, J., Creation and Annihilation Operators, McGraw-Hill, New York, 1976. Chapter 2
formulates a number of quantum mechanical approximations, including the HartreeFock approximation, in the language of second quantization.
Flurry, R. L. Jr., Synnnetry Groups, Prentice-Hall, Englewood Cliffs, New Jersey, 1980. An

excellent introduction to chemical applications of group theory. Our text assumes familarity with only the most elementary group theoretical ideas and notations.
Mattuck, R. D., 2nd ed., A Guide to Fernman Diagrams in the Many-Body Problem, McGrawHill, New York, 1976. Chapter 7 introduces second quantization using a more sophusticated point of view than adopted here.
McWeeny, R. and Sutcliffe, B. T., Methods of Molecular Quantum Mechanics, 2nd ed.,
Academic

Press, New

York,

1976. Discusses the rules for evaluating matrix elements

between Slater determinants formed from nonorthogonal spin orbitals. This book also
contains a concise introduction to methods for obtaining spin eigenfunctions.

Slater, J. C., Quantum Theory of Matter, 2nd ed., McGraw-Hill, New York, 1968. Chapter 11
discusses determinantal wave functions and derives expressions for matrix elements
between determinants in a somewhat different way than we have done

CHAPTER

THREE
THE HARTREE-FOCK APPROXIMATION

The Hartree-Fock approximation, which is equivalent to the molecular
orbital approximation, is central to chemistry. The simple picture, that
chemists carry around in their heads, of electrons occupying orbitals is in
reality an approximation, sometimes a very good one but, nevertheless, an
approximation—the Hartree-Fock approximation. In this chapter we describe, in detail, Hartree-Fock theory and the principles of ab initio Hartree-

Fock calculations. The length of this chapter testifies to the important role
Hartree-Fock theory plays in quantum chemistry. The Hartree-Fock approximation is important not only for its own sake but as a starting point
for more accurate approximations, which include the effects of electron
correlation. A few of the computational methods of quantum chemistry
bypass

the Hartree-Fock

approximation,

but

most

do

not,

and

all

the

methods described in the subsequent chapters of this book use the HartreeFock approximation as a starting point. Chapters 1 and 2 introduced the
basic concepts and mathematical tools important for an indepth understanding of the structure of many-electron theory. We are now in a position
to tackle and understand the formalism and computational procedures associated with the Hartree-Fock approximation, at other than a superficial level.
In addition to the basic formalisms of Hartree-Fock theory, this chapter
includes a number of ab initio calculations. These calculations are not included as a review of available computational results, but as a means of
illustrating fundamental ideas. The importance of these calculations to an
understanding of the formalisms of this and later chapters cannot be overemphasized. To illustrate the Hartree-Fock approximation, we have performed calculations of each of the quantities discussed in the text (total
108

THE HARTREE-FOCK APPROXIMATION

109

energies, ionization potentials, equilibrium geometries, dipole moments, etc.),
using a standard hierarchy of basis sets (STO-3G, 4-31G, 6-31G* and
6-31G**) and a standard collection of molecules (H,, CO, N2, CH,, NH3,
H,O, and FH). We thus illustrate the formalism and the accuracy or inaccuracy of the Hartree-Fock approximation with these calculations. In
later chapters, we use the same molecules and the same basis sets to illustrate
the formalisms of those chapters. In this way we can compare calculations
from chapter to chapter to see how a perturbation calculation improves the
Hartree-Fock dipole moment of CO, to see how a Green’s function caiculation improves the Hartree-Fock ionization potentials of N,, etc. The calculations are intimately related to our discussion of the formal methods of
quantum chemistry.
In addition to these larger calculations, we have used two smaller ab
initio models to illustrate theory. The minimal basis model of H2, which
we introduced in the previous chapter, is applied ubiquitously throughout
the book. To specifically illustrate the machimery of Hartree-Fock selfconsistent-field (SCF) calculations, we use the minimal basis model of HeH*.
This model is perhaps our most important means of describing the SCF
procedure. Appendix A contains a derivation of formulas for all the integrals

required in this HeH* calculation, and Appendix B contains a short
FORTRAN program for performing ab initio Hartree-Fock calculations on
any two-electron diatomic molecule using the STO-3G basis set. Included
is the detailed output for the calculation on HeH*. The program is written
so that it can be easily understood by anyone who has followed the text
and has a minimal knowledge of FORTRAN. While it is simple, this program
contains the essential ideas (but not the details) of large ab initio packages
such as Gaussian 80.’ Appendices A and B and Subsection 3.5.3 are intended
to make explicit the basic manipulations of the SCF procedure and take

some of the mystery out of such calculations.
In Section 3.1 we present the Hartree-Fock eigenvalue equations and
define and discuss associated quantities such as the coulomb, exchange, and
Fock operators. The results of this section are presented without derivation
as summary of the main equations of Hartree-Fock theory.
Section 3.2 constitutes a derivation of the results of the previous section.
The order of presentation of these two sections is such that the derivations
of Section 3.2 can be skipped if necessary. Fora fuller appreciation of HartreeFock theory, however, it is recommended that the derivations be followed.
We first present the elements of functional variation and then use this
technique to minimize the energy of a single Slater determinant. A unitary
transformation of the spin orbitals then leads to the canonical Hartree-Fock
equations.
Section 3.3 continues with formal aspects of Hartree-Fock theory. We
derive and discuss two important theorems associated with the HartreeFock equations: Koopmans’ theorem and Brillouin’s theorem. The first

110 MODERN QUANTUM CHEMISTRY

theorem constitutes an interpretation of the Hartree-Fock orbital energies
as ionization potentials and electron affinities. The second theorem states
that the matrix element between a Hartree-Fock single determinant and
determinants which differ by a single excitation is zero. This theorem 1s
important in multideterminantal theories. Finally, in preparation for perturbation theory (Chapter 6), we define a Hartree-Fock Hamiltonian such
that determinants formed from the Hartree-Fock spin orbitals become exact
eigenfunctions of this Hamiltonian.
Section 3.4 is the most important section of this chapter. Here we derive
the Roothaan equations, which allow one to calculate Hartree-Fock solutions
for the ground state of closed-shell molecules. To solve the Hartree-Fock
equations, it is necessary to give explicit form to the spin orbitals. This book
uses two sets of spin orbitals. The restricted closed-shell set of spin orbitals
leads to restricted closed-shell wave functions via the Roothaan equations.
An unrestricted open-shell set of spin orbitals leads to unrestricted open-shell
wave functions via the Pople-Nesbet equations as discussed in a later
section. In this section, the general spin orbital formulation of the Hartree-

Fock equations is first reduced to a spatially restricted closed-shell formulation, by replacing the general spin orbitals by a set of restricted closed-shell
spin orbitals. A basis set is then introduced; this converts the spatial integrodifferential closed-shell Hartree-Fock equations to a set of algebraic equations, the Roothaan equations. The rest of the section then constitutes a
detailed discussion of the Roothaan equations, their method of solution
(the self-consistent-field (SCF) procedure), and the interpretation of the
resulting wave functions.
Section 3.5 contains a detailed illustration of the closed-shell ab initio
SCF procedure using two simple systems: the minimal basis set descriptions
of the homonuclear (H) and heteronuclear (HeH *) two-electron molecules.
We first describe the STO-3G minimal basis set used in calculations on these
two molecules. We then describe the application of closed-shell Hartree-Fock
theory to H,. This is a very simple model system, which allows one to examine
the results of calculations in explicit analytical form. Finally, we apply the
Roothaan SCF procedure to HeH*. Unlike H,, the final SCF wave function

for minimal basis HeH * is not symmetry determined and the HeH* example

provides the simplest possible illustration of the iterative SCF procedure.
The description of the ab initio HeH* calculation given in the text is based on
a simple FORTRAN program and the output of a HeH* calculation found
in Appendix B. By following the details of this simple but, nevertheless, real
calculation, the formalism of closed-shell ab initio SCF calculations is made
concrete.

Section 3.6 describes general aspects of the polyatomic basis sets used in
many current calculations. The choice ofa basis set for quantum chemical calculations is mainly an art rather than a science, but the principal unifying concepts involved in the choice of a basis set are described. In addition, the

THE HARTREE-FOCK APPROXIMATION

111

basis sets of Pople and co-workers, used in the calculations of this book, are
explicitly defined.
In Section 3.7 we perform a number of ab initio calculations to illustrate
the application and the results of the closed-shell SCF procedure. Our principal aim is to give the reader a feeling for a few of the problems to which
ab initio SCF calculations can be applied, and the accuracy that can be
expected of such Hartree-Fock calculations. To systematize these applications, we apply a standard hierarchy of basis sets to each problem.
In the final Section 3.8, we leave the restricted closed-shell formalism

and derive and illustrate unrestricted open-shell calculations. We do not
discuss restricted open-shell calculations. By procedures that are strictly
analogous to those used in deriving the Roothaan equations of Section 3.4,
we derive the corresponding unrestricted open-shell equations of Pople and
Nesbet. To illustrate the formalism and the results of unrestricted calculations, we apply our standard basis sets to a description of the electronic
structure and ESR spectra of the methyl radical, the ionization potential of
Ng, and the orbital structure of the triplet ground state of O2. Finally, we describe in some detail the application of unrestricted wave functions to the improper behavior of restricted closed-shell wave functions upon dissociation.
We again use our minimal basis H, model to make the discussion concrete.

3.1 THE HARTREE-FOCK

EQUATIONS

In this section we summarize the main results obtained in a derivation of the
Hartree-Fock equations. We do this so that the somewhat involved details
of the derivation given in the next section (Section 3.2) can be skipped, if
desired.
For our purposes, we can equate Hartree-Fock theory to single determinant theory,” and we are thus interested in finding a set of spin orbitals

{x,} such that the single determinant formed from these spin orbitals

|Po> = xaX2 °° Lake °° Xw>

(3.1)

is the best possible approximation to the ground state of the N-electron
system described by an electronic Hamiltonian #. According to the varia-

tional principle, the “best” spin orbitals are those which minimize the elec-

tronic energy

1
Ey = (PH)o> = ¥ <alhlad + 2% <ab| |ab>
1

=) <alhla> + 5 ¥ [aal bb] — [ab| ba]
a

By a procedure

outlined

(3.2)

ab

in Section

3.2, we can systematically

vary

the

spin orbitals {y,}, constraining them only to the extend that they remain

112

MODERN QUANTUM CHEMISTRY

orthonormal,

<XalX%o> = Sa

(2.3)

until the energy E, is a minimum. In doing so (in a formal way) one obtains
an equation that defines the best spin orbitals, the ones that minimize Ep.
This equation for the best (Hartree-Fock) spin orbitals ts the Hartree-Fock
integro-differential equation

h(x) + ¥ IS ax, brit frat) — xf dx, 8 Q42)rid at
bt#a

= €aXa1)

(3.4)

where

h(1) = -5vi - yf

41a

(3.5)

is the kinetic energy and potential energy for attraction to the nuclei, of a
single electron chosen to be electron-one. The orbital energy of the spin
orbital y, is €,.

3.1.1 The Coulomb and Exchange Operators
The two terms in Eq. (3.4) involving sums over b are those that in single
determinant Hartree-Fock theory represent electron-electron interactions.

Without these terms,

h(L)xAL) = €ara(1)

(3.6)

would simply be a one-electron Schrédinger equation for the spin orbital
States of a single electron in the field of the nuclei. The first of the two-electron
terms is the coulomb term, which is also present in Hartree theory—a theory
which uses a Hartree product wave function rather than an antisymmetrized
Hartree product (Slater determinant) wave function. The second two-electron
term is the exchange term, which arises because of the antisymmetric nature
of the determinantal wave function.

The coulomb term has a simple interpretation. In an exact theory, the

coulomb interaction is represented by the two-electron operator r;;'. In
the Hartree or Hartree-Fock approximation, as Eq. (3.4) shows, electronone in y, experiences a one-electron coulomb potential

v=

b#a

fdxabal2Prid

(3.7)

Let us consider this potential. Suppose electron 2 occupies y,. The twoelectron potential r;7 felt by electron 1 and associated with the instantaneous

THE HARTREE-FOCK APPROXIMATION

113

position of electron 2 is thus replaced by a one-electron potential, obtained
by averaging the interaction rj; of electron 1 and electron 2, over all
space and spin coordinates x, of electron 2, weighted by the probability
dx. |y,(2)|? that electron 2 occupies the volume element dx, at x2. By
summing over all b # a, one obtains the total averaged potential acting on
the electron in y,, arising from the N — 1 electrons in the other spin orbitals.
Associated with this interpretation it is convenient to define a coulomb
operator

Idl) = fax2 x2 rit

(3.8)

which represents the average local potential at x, arising from an electron
in ¥;The exchange term in (3.4), arising from the antisymmetric nature of the
single determinant, has a somewhat strange form and does not have a simple
classical interpretation like the coulomb

term. We can, however, write the

Hartree-Fock equation (3.4) as an eigenvalue equation

[mc

+)

b#a

Al)—

¥ 2s [est

ba

= €Xa(1)

(3.9)

provided we introduce an exchange operator
# ,(1), defined by its effect when

operating on a spin orbital y,(1),

HN AL) = | fans sb orednsa)| xeA1)

(3.10)

This is to be compared with the previous result (3.8) for the coulomb operator,

IAel) = j fax. rived | ral)

G11)

Operating with #%,(1) on y,(1) involves an “exchange” of electron 1 and
electron 2 to the right of rj2' in (3.10), relative to (3.11). Unlike the local
coulomb operator, the exchange operator is said to be a nonlocal operator,

since there does not exist a simple potential %,(x,) uniquely defined at a
local point in space x,. The result of operating with %,(x,) on y,(x,) depends
on the value of y, throughout all space, not just at x,, as is evident from (3.10).
One could not, for example, draw contour plots of the exchange potential
as one can for the coulomb potential. For an electron in y, the expectation
values of the coulomb and exchange potentials J, and .#%, are just the
coulomb and exchange integrals described in the last chapter, i.e.,

<x)
FAI) |xa(1)> = fax, Ax, ¥3(Vxd)riz x6(2)x0(2) = [aa|bb]

(3.12)

Crd HD |e)? = [dx de xF(Dya(1)rrd FQxd2) = [ab|ba] (3.13)

114 MODERN QUANTUM CHEMISTRY

3.1.2. The Fock Operator
The Hartree-Fock equation, as we have written it up to this point, is

a +) All)- 2d sa) [rst
b#a

b#a

= Eyal1)

(3.14)

This is of the eigenvalue form. However, the operator in square brackets
appears to be different for every spin orbital y, on which it operates (because
of the restricted summation over b # a). Inspecting Eqs. (3.10) and (3.11),
it is obvious, however, that

t

[F.01) — #21) ]xa(1) = 0

(3.15)

It is thus possible to add this term to (3.14), eliminate the restriction on the
summation, and define a Fock operator f by

f (1) = hl) + » All) — X41)

(3.16)

so that the Hartree-Fock equations become

f\Xa> = Ealta>

(3.17)

This is the usual form of the Hartree-Fock equations. The Fock operator
f(1) is the sum of a core-Hamiltonian operator h(1) and an effective oneelectron potential operator called the Hartree-Fock potential v"*(1),

HPL) =) A(1) — (1)

(3.18)

f (1) = h(1) + v#F(1)

(3.19)

b

That is,

Sometimes it is convenient to write the exchange potential in terms of
an operator Y,,, which, operating to the right, interchanges electron 1 and
electron 2. Thus

H(Uya(1) = | fax, rb evitza®) ra
ns0)| Xa(1)

(3.20)

= h(1) + ¥ fbx. xB (2Qri2 — Aradyo2)

(3.21)

= | fans

Wrz;

The Fock operator is thus written, using P,2, as

F(1) = h(L) + vFF(L)
b

The Hartree-Fock equation
S\xa>

= Eal%a>

(3.22)

THE HARTREE-FOCK APPROXIMATION

115

is an eigenvalue equation with the spin orbitals as eigenfunctions and the
energy of the spin orbitals as eigenvalues. The exact solutions to this integrodifferential equation correspond to the “exact” Hartree-Fock spin orbitals.
In practice it is only possible to solve this equation exactly (i.c., as an integrodifferential equation) for atoms. One normally, instead, introduces a set of
basis functions for expansion of the spin orbitals and solves a set of matrix
equations, as will be described subsequently. Only as the basis set approaches
completeness, i¢., as one approaches the Hartree-Fock limit, will the spin
orbitals that one obtains approach the exact Hartree-Fock spin orbitals.
While (3.22) is written as a linear eigenvalue equation, it might best be
described as a pseudo-eigenvalue equation since the Fock operator has a
functional dependence, through the coulomb and exchange operators, on the
solutions {y,} of the pseudo-eigenvalue equation. Thus the Hartree-Fock
equations are really nonlinear equations and will need to be solved by
iterative procedures.
Exercise 3.1 Show that the general matrix element of the Fock operator
has the form

<xilflg> = <ilhli> + » [ij|bb] — [ib] bj] = <ilh|s> + x <ib||jb>

3.2 DERIVATION

OF THE

HARTREE-FOCK

(3.23)

EQUATIONS

In this section we derive the Hartree-Fock equations in their general spin
orbital form, i-e., we obtain the eigenvalue equation (3.17) by minimizing
the energy expression for a single Slater determinant. The derivation makes
no assumptions about the spin orbitals. Later, we will specialize to restricted
and unrestricted spin orbitals and introduce a basis set, in order to generate
algebraic equations (matrix equations) that can be conveniently solved on a
computer. In the meantime, we are concerned only with the derivation of
the general integro-differential equations (the Hartree-Fock eigenvalue
equations), the nature of these equations, and the nature of their formal
solution. To derive the equations we will use the general and useful technique
of functional variation.
3.2.1

Functional Variation

Given any trial function ®, the expectation value E[®] of the Hamiltonian
operator # is a number given by

E[®] = <@|4#|>

(3.24)

We say that E[®] is a functional of ® since its value depends on the form of

116 MODERN QUANTUM CHEMISTRY

a function, ie., the function ®, rather than any single independent variable.
Suppose we vary ® by an arbitrarily small amount, by changing the parameters upon which ® depends, for example. That is,

®> ® + 66

(3.25)

The energy then becomes

E[® + 60] = (+ 566|x|6 +4 5)

--+
}
by
[5
a
Bl
+
@>
4|
|.
6@
{<
+
®]
E[
=
= E[6] + 6E+---

(3.26)

where 6E, which is called the first variation in E, includes all terms that are
linear, i.e., first-order, in the variation 6@, Notice that we can treat “d” just

like a differential operator, ie, 5¢®|#|®> = (60/9 |©) + <6|#|6®). In

the variation method, we are looking for that ® for which E[®] is a minimum.

In other words, we wish to find that © for which the first variation in E[®]

is zero, i.e,

5E =0

(3.27)

This condition only ensures that E is stationary with respect to any variation
in ®. Normally, however, the stationary point will also be a minimum.
We will illustrate the variational technique by rederiving the matrix
eigenvalue equation of the linear variational problem given in Subsection
1.3.2. Given a linear variational trial wave function,
N

|®> = ¥ c|¥>
i=1

(3.28)

we want to minimize the energy

E = @|#|®) = ¥ ckc<¥ ||P)
Ls]

(3.29)

subject to the constraint that the trial wave function remains normalized,
Le.,

<6|6> —1= d che <¥|'P-> —1=0
ij

(3.30)

Using Lagrange’s method of undetermined multipliers described in Chapter
1, we therefore minimize, with respect to the coefficients c;, the following
functional

L = @|H#\by — E((G|G) — 1)
= » che <¥,|H#|¥> — e(¥ c¥e,<¥;|¥> — i)

(3.31)

THE HARTREE-FOCK APPROXIMATION

117

where E is the Lagrange multiplier. Therefore, we set the first variation In
£ equal to zero.

6L =) bce
CP | HV) — EY bc¥e<¥,|¥>
ij

ij

+) chic PIH|P> — EY chic X¥;|¥;> =O —
ij

(3.32)

ij

Since E is real (¥ is real), after collecting terms and interchanging indices,
we get

Y bc¥ b Hic; — ES,<,| + complex conjugate = 0
(3.33)
i
j
where H;; = <‘Y,]#/|¥;>. The linear expansion functions |¥;> are not as-

sumed to be orthonormal, but are assumed to overlap according to
<¥,|'P> = Si

(3.34)

Since éc# ts arbitrary (c¥ and c; are both independent variables), the quantity
in Square brackets in (3.33) must be zero, or
j

j

He = ESc

(3.35)

Essentially the same result (with S = 1 and real coefficients) was previously
obtained in Subsection 1.3.2. The functional variation technique thus leads
to the same result as is obtained by differentiating with respect to the coefficients. Functional variation is a more general technique, however, and
we now proceed to derive the Hartree-Fock equations using it.

3.2.2. Minimization of the Energy of a Single Determinant

Given the single determinant |o> = |y1%2°°* %aXe"**X%n>» the energy
Eo = (¥o|#|¥%> is a functional of the spin orbitals {y,}. To derive the

Hartree-Fock equations we need to minimize E,[{y,}] with respect to the
spin orbitals, subject to the constraint that the spin orbitals remain ortho-

normal,

fax, x8(y0(1) = [a]b] = oun

(3.36)

That is, the constraints are of the form

(3.37)

[a/b] — 64 =0

We therefore consider the functional “[{y,}] of the spin orbitals
F[{x0}]

=

Eol{xat]

~~

N

N

Y

Y

a=1

b=1

&([a|b]

~~

Onn)

‘

(3.38)

118 MODERN QUANTUM CHEMISTRY

where Ey is the expectation value of the single determinant |'¥o>,

El {%.}] = x [alhla] +5 >)

y [aa|bb]—[ab|ba]

2 a= 1 b=1

(3.39)

and the &,, constitute a set of Lagrange multipliers. Because ¥ is real and
[a]b] = [b|a]*, the Lagrange multipliers must be elements of a Hermitian
matrix
fba

=

es,

(3.40)

Exercise 3.2. Prove Eq. (3.40).
Minimization of Ep, subject to the constraints, is thus obtained by
minimizing &. We therefore vary the spin orbitals an arbitrary infinitesimal
amount, i.e.,

Xa

Xa + Oa

(3.41)

and set the first variation in & equal to zero,
N

N

6L =5Eo— YY. &[alb] =0
a=1b=1

(3.42)

This follows directly from Eq. (3.38) since the variation in a constant (6,,) is
zero. Now

S[a|>] = [6xal x0] + [xa] dx0]

(3.43)

and

SEo= ¥ [Sxalhlve] + Lxalhl8xe]
N

N

DY

+

a=1

N

Y [Sxexal exe) + [%e6%a| X0x0] + Lxa%e|Ox0x0] + Lxa%al 206%0]

b=1
N

3%, 2 [Sxaxel Xora) + [%a6x01 26X01 + [xaxe]dxe%a] + [xa%0|%05%0]
(3.44)
a

1

Exercise 3.3 Manipulate Eq. (3.44) to show that

7

x [Sxalh|xa} + 5

5 [5%a%a| %0x0] ~ [oxaxe| %o%al

a=1 b=1

+ complex conjugate

THE HARTREE-FOCK APPROXIMATION

119

Also
»

Epa

[Sxalxe]

+

[%al 5x51)

=

» Eval OX%al Xo]

+

»

ExbLXo| OXa]

=

»

+

»

ek [oxalxe]*

Eral OXal Xo]

= ¥ esaL5%al%] + complex conjugate
ab

(3.45)

As a result of the above exercise and Eq. (3.45), the first variation in
of Eq. (3.42) becomes
N

N

N

© Y [6xa%a|x0%0] — [6x0%0| x0Xa
6L = Y [dzdhlxal + a=1b=1
a=1

~

N

N

>

>

a=1b=1

Eval OXal Xo] + complex conjugate

=0

(3.46)

We can use definitions (3.10) and (3.11) for the coulomb
operators to write this result in the form
N

N

and exchange
N

sv =) fax, ana¢)| htt) + YA) — HD zall) — Ye eu) |
(3.47)

+ complex conjugate = 0

Since dy*(1) is arbitrary, it must be that the quantity in square brackets is

zero for all a. Therefore,

[aay +)

N

b=1

All) - x6) frat

=P

N

b=1

axl)

a=1,2,...,N

(3.48)

The quantity in square brackets above is just our definition of the Fock
operator f(1); therefore, the equation for the spin orbitals takes the form
N

I \%a> =

Y

b=1

EpalXe>

(3.49)

This result is perhaps surprising at first glance since it is not in the canonical
(standard) eigenvalue form of Eq. (3.17). The reason is that any single determinant wave function |9> formed from a set of spin orbitals {y,} retains
a certain degree of flexibility in the spin orbitals; the spin orbitals can be
mixed among themselves without changing the expectation value Ey =

<¥|H#/|¥%o>.

Before obtaining the canonical form of the Hartree-Fock

equations, we need to consider unitary transformations of the spin orbitals
among themselves.

120

MODERN QUANTUM

CHEMISTRY

3.2.3 The Canonical Hartree-Fock Equations
Let us consider a new set of spin orbitals {y/} that are obtained from an
old set {y,} (those of Eq. (3.49)) by a unitary transformation,
Xa = > XU 5,
b

(3.50)

A unitary transformation, which satisfies the relation

uUt=U"!

(3.51)

is one which preserves the orthonormality property. That is, if we start with
a set {y,} of orthonormal spin orbitals, the new set {y/,} will also be orthonormal. Let us define a square matrix A

mM)

x(t):

aa { M2)

wl)

2)

oss

12)

xn)

> rn

052)

AN) xo(N) --- xe) 2+ aN)
such that the wave function [o> is just the normalized determinant of this
matrix

[o> =(N!)7! 2 det(A)

(3.53)

Using definition (3.50) for the transformed orbitals and the rules for ordinary
multiplication, it becomes clear that the matrix A’ which corresponds to A but
contains the transformed spin orbitals 1s
A’'=AU=

_

mM)

xD

es

xD) \

/U1,

Uyz

-°*

Uy

xi(2)

x2(2)

f

xn(2)

Ua

U22

vce

Un

ua(N)

xa)

ut

xn)

Uns

Una

te

Uny

WC)
212)

a(t)
x22)

.

WD)
xn(2)

AN) X(N) ~~

YM)

(3.54)

Therefore, since
det(AB) = det(A) det(B)

(3.55)

the determinant of transformed spin orbitals is related to the determinant
of the original spin orbitals by
or, equivalently

det(A’) = det(U) det(A)

(3.56)

[o> = det(U)|¥o>

(3.57)

THE HARTREE-FOCK APPROXIMATION

121

Now, since

UU=1

(3.58)

we have

det(U'U) = det(U) det(U) = (det(U))* det(U) = |det(U)|? = det (1) = 1
(3.59)
Therefore,

det(U) = ei#

(3.60)

and the transformed single determinant |‘¥o> of Eq. (3.57) can at most differ
from the original determinant |’9> by a phase factor. If U is a real matrix
then this phase factor is just + 1. Because any observable property depends
on |'P|’, for all intents and purposes, the original wave function in terms of

the spin orbitals {7,} and the transformed wave function in terms of the spin

orbitals {y,} are identical. For a single determinant wave function, any
expectation value is therefore invariant to an arbitrary unitary transformation of the spin orbitals. Thus the spin orbitals that make the total energy
stationary are not unique, and no particular physical significance can be
given to a particular set of spin orbitals. Localized spin orbitals, for example,
are not more “physical” than delocalized spin orbitals.
We can use the invariance of a single determinant to a unitary transformation of the spin orbitals to simplify Eq. (3.49) and put it in the form of an
eigenvalue equation for a particular set of spin orbitals. First, however, we
need to determine the effect of the above unitary transformation on the Fock
operator f and the Lagrange multipliers ¢,,. The only parts of the Fock
operator that depend on the spin orbitals are the coulomb and exchange
terms. The transformed sum of the coulomb operators is

¥ FN) =¥ [axe 2Qrid x2)

=z b Ui | faxsx#Qyridx2)
But

(3.61)

i

Y URUeq = (UU) = 5a

(3.62)

Y Fal) = ¥ [axe Win) = YAM

(3.63)

so that

Thus the sum of coulomb operators is invariant to a unitary transformation
of the spin orbitals. In an identical manner it is easy to show that the sum of
exchange operators, and hence the Fock operator itself, is invariant to an

122

MODERN

QUANTUM

CHEMISTRY

arbitrary unitary transformation of the spin orbitals, ie.,

Ff’) =f)

(3.64)

We now need to determine the effect of the unitary transformation on
the Lagrange multipliers ¢,,. Multiplying Equation (3.49) by <z,| shows that
the Lagrange multipliers are matrix elements of the Fock operator
N

Ctdf a> = Y bea %e|%p> = bea
b=1

(3.65)

Therefore,

tin = fbx, ASAD
=Y ULVa fdxxX0s Dual)
=) Use a»

(3.66)

or in matrix form

e' = UteU

(3.67)

From (3.40), ¢ is a Hermitian matrix. It is always possible, therefore, to find
a unitary matrix U such that the transformation (3.67) diagonalizes s. We
are not concerned with how to obtain such a matrix, only that such a matrix

exists and is unique. There must exist, then, a set of spin orbitals {7} for
which the matrix of Lagrange multipliers is diagonal.

ffa> = Fal %a>

(3.68)

The unique set of spin orbitals {y,} obtained from a solution of this eigenvalue equation is called the set of canonical spin orbitals. We henceforth
drop the primes and write the Hartree-Fock equations as

Ff \ita> = balha>

(3.69)

The canonical spin orbitals, which are a solution to this equation, will
generally be delocalized and form a basis for an irreducible representation
of the point group of the molecule, ie., they will have certain symmetry
properties characteristic of the symmetry of the molecule or, equivalently,
of the Fock operator. Once the canonical spin orbitals have been obtained
it would be possible to obtain an infinite number of equivalent sets by a
unitary transformation of the canonical set. In particular, there are various
criteria (see Further Reading) for choosing a unitary transformation so that
the transformed set of spin orbitals is in some sense localized, more in line
with our intuitive feeling for chemical bonds.

THE HARTREE-FOCK APPROXIMATION

3.3 INTERPRETATION OF SOLUTIONS
HARTREE-FOCK EQUATIONS

123

TO THE

In order to solve the Hartree-Fock equations it is necessary to introduce a
basis set and solve a set of matrix equations. Before doing so, however, there
are certain aspects of the eigenvalue equation and its solutions that are
independent of any basis, and it is appropriate to discuss them at this point.

3.3.1

Orbital Energies and Koopmans’ Theorem

For an N-electron system, minimization of the energy of the determinant

|'Wo> = |x1%2 °° * Xa%n‘* * Xw> leads to an eigenvalue equation f|y,> = &,|%,>

for the N occupied spin orbitals {y,}. The Fock operator has a functional
dependence on these occupied spin orbitals, but once the occupied spin
orbitals are known the Fock operator becomes a well-defined Hermitian
operator, which will have an infinite number of eigenfunctions, i.e.,

j=t2,...,0

flp=ely>

(3.70)

Exercise 3.4 Use the result of Exercise 3.1 to show that the Fock opera-

tor is a Hermitian operator, by showing that f,; = ¢x,|f|z,> is an element ofa
Hermitian matrix.

Each of the solutions |y,> of (3.70) has a spin orbital energy ¢;. The N
spin orbitals with the lowest orbital energies are just’ the spin orbitals
occupied in |'¥,> for which we use the indices a, b,.... The remaining
infinite number of spin orbitals with higher energies are the virtual or unoccupied spin orbitals, which we label with the indices r, s,.... Our main

interest here is to obtain expressions for the orbital energies £, and £, and to
_ investigate what physica! significance we can attach to these orbital energies.
Multiplying (3.70) by <x,|, shows that the matrix representation of the
Fock operator in the basis of spin orbital eigenfunctions is diagonal with
diagonal elements equal to the orbital energies.
xl tlxp

=

Kulp

= £0;

(3.71)

Using expression (3.16) for the Fock operator, the orbital energies can be

expressed as

& = (nd fad = Cad + Ls — Hui

= Calhliad + Y Cal Solas» — Caltelis>
= <ilhli> + > <ib|ib> — <ib|bi>

= <ilhli> + » <ib| |ib>

(3.72)

124

MODERN QUANTUM

CHEMISTRY

where, from definitions (3.10) and (3.11) of the exchange and coulomb
operators, we have used

<ul Fulaj> = <ik Lik = [ii] kk]

(3.73)

xl Hlajs> = <ik|> = [ik] kj]

(3.74)

In particular then
N

£, = Calhla> + », <ab| |ab>
b=
N

& = Crhir> + >

b=1

<rb||rb>

(3.75)
(3.76)

Now, since,

<aa| jaa) = 0

(3.77)

& = Calhla> + } <ab|ab> — <ab|bay

(3.78)

é, = Crfhlr> + ¥ <rb[rb> — <rb| bry

(3.79)

we can rewrite these results as
bta

b

Let us examine these last two expressions. The orbital energy «, represents
the energy of an electron in the spin orbital |y,>. From (3.78) this energy is

the kinetic energy and attraction to the nuclei (<a|h|a>) plus a coulomb

(<ab|ab) and exchange (— <ab|ba)) interaction with each of the remaining
N — 1 electrons in the N — 1 spin orbitals |y,>, where b # a. As we have
seen before, the integral ¢ab|ba) is nonzero only if the spins of the electrons

in |y,> and |y,> are parallel. In the general spin orbital formulation given

here, we have not specified the spins of the electrons, so the general term
<ab|ba> remains for all electron-electron interactions, even though some
of these integrals will be zero.
The result for £, is as might be expected, but the formula (3.79) for the
virtual spin orbital energy «, has a different character. It includes the kinetic

energy and nuclear attraction of an electron in |y,>, ie. <r|h|r>, as expected,
but includes coulomb (<rb|rb>) and exchange (—<rb| br) interactions with

all N electrons of the Hartree-Fock ground state |W), ie., interactions with
all N electrons in the spin orbitals {y,|b = 1, 2,..., N}. Itis as ifan electron
had. been added to |‘¥p> to produce an (N + 1)-electron state and «, represented the energy of this extra electron. This is exactly the case. We will
return to this point when we describe Koopmans’ theorem. First, we want
to relate the occupied orbital energies ¢, to the total energy Ep.

THE HARTREE-FOCK APPROXIMATION

125

If we simply add up the orbital energies ¢, of Eq. (3.75) for each of the
N electrons in the ground state |" >, we get

N
N
NON
Ye = ¥ <alhla> + ¥ » <ab||ab>

The correct expectation value Ey = CP ||P o>
(2.112), for example, is

for this state, from

1a

N

Eo = Y <alhlay + 5%. Y <ab]|ab>
It is thus apparent that

(3.80)
Eq.

(3.81)

Y

Ey #) &

(3.82)

and the total energy of the state |‘¥)> is not just the sum of the orbital energies.
The reason is as follows. The energy £, includes coulomb and exchange
interactions between an electron in x, and electrons in all other occupied
spin orbitals (in particular, y,). But ¢, includes coulomb and exchange
interactions between an electron in y, and electrons in a!l other occupied
spin orbitals (in particular, y,). Thus when we add &, and & we include the
electron-electron interactions between an electron in y, and one in ¥,,
twice. The sum of orbital energies counts the electron-electron interactions
twice. This is the reason for the factor 4 in the correct expression (3.81) for
the total energy E, relative to the sum of orbital energies (3.80).
If the total energy is not the sum of orbital energies what physical significance can we attach to orbital energies? The answer is provided by
investigating the process of adding or subtracting an electron to the N-

electron state |Wo> = |"¥o> = |x1%2°*' %e°** Xy>- Suppose

removing

an electron from the spin orbital 7, to produce

we consider

the (N — 1)

electron single determinant state [|”~'W.> = |yix%2°** %c-1Xet1 °° LNs
where the remaining N — 1 spin orbitals in |”~ *W,> are identical to those in
|“W.>. In second quantization, this would be accomplished by annihilating
an electron in x,, so that to within a sign,

yw

= af’Po>

(3.83)

The ionization potential of |¥W> for this process is

IP = *"1E, — %Eo

(3.84)

where *~!'E, and “Ey are the expectation values of the energy of the two
relevant single determinants.

"Eo = WH

|"%o>

NOTE, = (NP

GAN

(3.85)
WY

(3.86)

126 MODERN QUANTUM CHEMISTRY

Depending from which

spin orbital 7, we remove an electron, the state

|’- 1.) may or may not represent the ground state of the ionized species.
Since |"~ "> is a different state from |“Wo>, one could not in general expect

its optimum spin orbitals to be identical with those of |“¥.>. With our
assumption that the spin orbitals are identical, however, we can calculate
the energy difference between the two states. From the rules of the last
chapter, the energy of a single determinant is
occ

1

occ

occ

(3.87)

E=) <ihliy +5 XD Salli
ij

i

where the sums go over all spin orbitals occupied in the determinant. Thus

1

(3.88)

“Eo = Y <alhlay +5 YY <abl aby

where the indices a, b, ... refer to the spin orbitals occupied in |"%)>. With
this convention, we have

NIE.=

¥ <alhla> +5

ote

Y

& <abl aby

ate

b#¥e

(3.89)

The ionization potential is the difference between these two results

IP ="-1E.— NE,
1

= —<elh|c> — 5

S <abllaby 3

1

alb =c}

1

bla=c]}

<abllaby

1

= —<¢lh|c> — 5 2 <ac| lac) — 5 2 <cb| |eb>
= —<¢lhlc> — x <cb| |eb>

(3.90)

Comparing this with the definition (3.75) of an occupied spin orbital energy,
we see that the ionization potential for removing an electron from y, is just
the negative of the orbital energy «,

IP ="-16, —%E, = —¢,

(3.91)

Thus occupied spin orbital energies in the single determinant approximation
represent the energy (with opposite sign) required to remove an electron
from that spin orbital. Orbital energies ¢, are generally negative and ionization potentials are positive.
Exercise 3.5 Show that the energy required to remove an electron from
7%. and one from 74 to produce the (N — 2)-electron single determinant

[X74a> is —&, — &4 + <cd|cd> — <cd|de).

THE HARTREE-FOCK APPROXIMATION

127

Now let us consider the process of adding an electron to one of the virtual

spin orbitals y, to produce the (N + 1)-electron single determinant |"* *¥") =

\%%1%2 °°" %n>» Where again the remaining spin orbitals are identical to
those in |“ >. In second quantization, this would be accomplished by
creating an electron in y,
\X* twry = al|*¥o>

(3.92)

The electron affinity of |"¥)> for this process is

EA = "Ey —%*1EF

(3.93)

where ‘*1E* is the energy of the single determinant |‘**"),
N+1 pr

_

CN

pr ge [N+ try

(3.94)

As in the ionization process, the optimum spin orbitals of the (N + 1)electron single determinant will not, in general, be identical with those of
|“W_>. However, with the assumption that they are identical, the electron
affinity is readily calculated.
Exercise 3.6 Use Eg. (3.87) to obtain an expression for %* +E’ and then

subtract it from ‘Ep (Eq. (3.88)) to show that

NE —N*1ET = —<rlh|ry — Y <rb| |b)
b

With the result of the above exercise and Eq. (3.76), we see that the
electron affinity for adding an electron to the virtual spin orbital 7, is just
the negative of the orbital energy of that virtual spin orbital, ie.,

EA = “Eo —N*1ET = —e,

(3.95)

This result is consistent with our previous observation that «, included
interactions with all N other electrons of the ground state |“W)> and thus
describes an (N + 1)th electron. If ¢, is negative (ie. if |¥**¥"> is more

stable than |"¥,>), the electron affinity is positive.

The above results were first obtained by Koopmans. We are now in a
position to state Koopmans’ theorem.
Koopmans’ Theorem Given an N-electron Hartree-Fock single determinant |“W> with occupied and virtual spin orbital energies ¢, and ¢,, then
the ionization potential to produce an (N — 1)-electron single determinant
|’— 1.) with identical spin orbitals, obtained by removing an electron from
spin orbital y,, and the electron affinity to produce an (N + 1)-electron
single determinant |"**¥*) with identical spin orbitals, obtained by adding
an electron to spin orbital y,, are just —s, and —e,, respectively.

128

MODERN

QUANTUM

CHEMISTRY

Koopmans’ theorem thus gives us a way of calculating approximate
ionization potentials and electron affinities. This “frozen orbital” approximation assumes that the spin orbitals in the (N + 1)-electron states, i.e., the
positive and negative ions if |’¥)> is a neutral species, are identical with
those of the N-electron state. This approximation neglects relaxation of the
spin orbitals in the (N + 1)-electron states, ie., the spin orbitals of [YY

are not the optimum spin orbitals for |Y~*¥,) or |¥*1¥">. Optimizing the

spin orbitals of the (N + 1)-electron single determinants by performing a
separate Hartree-Fock calculation on these states would lower the energies
N-1F and %*'E" and thus the neglect of relaxation in Koopmans’ theorem
calculations tends to produce too positive an ionization potential and too
negative an electron affinity. In addition, of course, the approximation of a
single determinant wave function leads to errors, and the correlation effects,

which one obtains in going beyond the Hartree-Fock approximation, will
produce further corrections to Koopmans’ theorem results. In particular,
correlation energies are largest for the system with the highest number of
electrons. Therefore, correlation effects tend to cancel the relaxation error

for ionization potentials, but add to the relaxation error for electron affinities. In general, Koopmans’ ionization potentials are reasonable first approximations to experimental ionization potentials and we shall be discussing
a number of such calculations later in this chapter. Koopmans’ electron
affinities are unfortunately often bad. Many neutral molecules will add an
electron to form a stable negative ion. Hartree-Fock calculations on neutral
molecules, however, almost always give positive orbital energies for all the
virtual orbitals. Electron affinities are considerably more difficult to calculate than ionization potentials and we will not be concerned, to any extent,

with electron affinities in this book.

3.3.2

Brillouin’s Theorem

The Hartree-Fock equation (3.70) produces a set {y;} of spin orbitals. The
single determinant | >, formed from the N spin orbitals {y,} with the
lowest orbital energies, is the Hartree-Fock approximation to the ground
state. As discussed in the last chapter, there are many other determinants

that can be formed from the set {y;}. Having derived the form of the Fock

operator, we are now in a position to prove a theorem about a subset of
these determinants. This subset is the set of singly excited determinants |'¥5
obtained from |)> by a single replacement of x, with x, (Fig. 2.7). In a
multideterminantal representation of the exact ground state |®,), it is these
determinants which we might expect, a priori, to give the leading correction

to the Hartree-Fock ground state |¥ o>,

|Po> = co|¥o> + > cf[PE> + ---

(3.96)

THE HARTREE-FOCK APPROXIMATION

129

If we consider only the singly excited determinants as corrections, then the
coefficients c”, are determined from the variational principle by diagonalizing

the Hamiltonian matrix in the basis of the states {Wp, {‘¥Z}}. Consider for
a moment the matrix eigenvalue problem involving one singly excited state
(cere

CHIH %o>

wibehes

(e)

CKAEIKD

ca

= &> (2)

Ca

(3.97)

The mixing of the two states depends on the off-diagonal element (¥ ||".
This matrix element is obtained by using the rules for evaluating matrix
elements between determinants, and the result can be read directly from
Tables 2.5 and 2.6.

(Pl

|Y> = <alhlr> + ¥° <ab} |rb>

(3.98)

b

The right-hand side of this equation can be simplified; as Exercise 3.1 shows,
matrix elements of the Fock operator are given by

Kaif
ly = <ilhli> + 3 <ib| | jb>

(3.99)

Therefore,
<P

ll

=

<xal f\xe>

(3.100)

The matrix element that mixes singly excited determinants with |W p> is thus
equal to an off-diagonal element of the Fock matrix. Now, by definition,
solving the Hartree-Fock eigenvalue problem requires the off-diagonal

elements to satisfy ¢y,|fly;> = 0, @ # j). One can then say that solving the
Hartree-Fock eigenvalue equation is equivalent to ensuring that |») will
not mix with any singly excited determinants. The lowest solution to (3.97)
is thus

Eo

0

( 0 exe

\

fi

Mo) = F2(6)

(6.101)

The Hartree-Fock ground state is in this sense “stable” since it cannot be
improved by mixing it with singly excited determinants. One then expects
doubly excited determinants |'¥73 to provide the leading and most important
corrections to |‘¥>. This does not mean that there are no singly excited
determinants |'¥%> in an exact ground state |®)>. They can mix indirectly

with |¥)> through the doubly excited determinants by way of the matrix
elements (¥%|2¢|'¥23> and ¢¥75|9¢|¥o>. The important result we have just
derived is termed Brillouin’s theorem.
Brillouin’s Theorem

Singly excited determinants |'¥%) will not interact

directly with a reference Hartree-Fock determinant |'P 5), Le., (Yo|a7|¥, =0.

We will have the opportunity to use this theorem many times in later chapters.

130 MODERN QUANTUM CHEMISTRY

3.3.3 The Hartree-Fock Hamiltonian

Until now the Hartree-Fock approximation has been viewed as an approximation in which the Hamiltonian is exact but the wave function is approximated as a single Slater determinant. For later use in the perturbation theory
of Chapter 6, we now preview a different but equivalent view of Hartree-Fock
theory that focuses on the Hamiltonian.
We have not solved the exact electronic Schrédinger equation

H|®y> = E|®o)

(3.102)

but rather we have used the variational principle to find an approximation

|Wo> to {®>>. We now ask the question, “Is there some approximate N-

electron Hamiltonian and eigenvalue equation that we have solved exactly,
i.e., is there an approximate Hamiltonian for which |W) is an exact eigenfunction?” The answer is “Yes.” The Hartree-Fock Hamiltonian is

(3.103)

Ho= ¥ fli)
where (i) is a Fock operator for the ith electron.

Exercise 3.7 Use definition (2.115) of a Slater determinant and the fact
that #) commutes with any operator that permutes the electron labels, to
show that |'¥,> is an eigenfunction of % with eigenvalue 2 £4. Why does
H#, commute with the permutation operator?
As the above exercise shows, |‘¥)> is an eigenfunction of a Hartree-Fock
Hamiltonian with an eigenvalue that is not the Hartree-Fock energy Eo,
but the sum of orbital energies } ¢,. We can in fact show that any single
a

determinant formed from the set {7;} of eigenfunctions of the Fock operator,
f, is an eigenfunction of #%, with eigenvalue equal to the sum of the orbital
energies of the spin orbitals included in the determinant. In the context of
perturbation theory, which is extensively discussed in Chapter 6, we have
obtained a complete set of eigenfunctions to an unperturbed Hamiltonian
H, which can form the basis for a perturbation expansion of the exact

energy,

6, = EQ + EV + EP

+-:

(3.104)

The unperturbed zeroth-order energy is just

E® = x Ey

(3.105)

H|¥o> = EO'|¥o>

(3.106)

where

THE HARTREE-FOCK APPROXIMATION

131

If
H=Hi+tV

(3.107)

then the perturbation / is
V=KH-— Ho

=Y m+ Y Yyt-Y so
N

N

i=1

=

N

i=1

N

N

N

i=1 j>i

i=1

Y rgi-

y>i

N

¥ oF

(3.108)

i=1

or just the difference between the exact electron-electron interaction and
the sum of the Hartree-Fock coulomb and exchange potentials. We can now
evaluate the Hartree-Fock energy as
Ey = (Yl

|¥o> =

Hol fo|¥o> + <Pol/|Po>

= 6, + ol /|%o> = EO + EP

(3.109)

where <‘V,|/|‘¥o> has been defined as the first-order energy in the expansion (3.104) for the exact energy. In Chapter 6 we will primarily be concerned

with finding the second-order energy EY) and other higher-order energies.
Exercise 3.8 Use expression (3.108) for

#, expression (3.18) for the

Hartree-Fock potential v“*(i), and the rules for evaluating matrix elements

to explicitly show that (¥|¥|%o> = —3 >. ¥ <ab||ab> and hence that E{)
ab

cancels the double counting of electron-electron repulsions in Ef?) =} e,
to give the correct Hartree-Fock energy E,.

3.4 RESTRICTED CLOSED-SHELL
THE ROOTHAAN EQUATIONS

6

HARTREE-FOCK:

So far in this chapter we have discussed the Hartree-Fock equations from
a formal point of view in terms of a general set of spin orbitals {y;}. We are
now in a position to consider the actual calculation of Hartree-Fock wave
functions, and we must be more specific about the form of the spin orbitals.

In the last chapter we briefly discussed two types of spin orbitals: restricted
spin orbitals, which are constrained to have the same spatial function for
a (spin up) and f (spin down) spin functions; and unrestricted spin orbitals,
which have different spatial functions for a and § spins. Later in this chapter
we will discuss the unrestricted Hartree-Fock formalism and unrestricted
calculations. In this section we are concerned with procedures for calculating
restricted Hartree-Fock wave functions and, specifically, we consider here

132 MODERN QUANTUM CHEMISTRY

only closed-shell calculations. Our molecular states are thus allowed to
have only an even number N of electrons, with all electrons paired such that
n= N/2 spatial orbitals are doubly occupied. In essence this restricts our
discussion to closed-shell ground states.? For describing open-shell ground
states we will use the unrestricted formalism of the last section of this chapter.
To describe open-shell excited states we also use unrestricted Hartree-Fock
theory. The restricted open-shell formalism is somewhat more involved than
our restricted closed-shell or unrestricted open-shell formalism, and we do
not describe restricted open-shell Hartree-Fock calculations in this book.
An excellent introduction to such calculations is contained in the book by
Hurley, suggested for further reading at the end of this chapter.

3.4.1 Closed-Shell Hartree-Fock: Restricted Spin Orbitals
A testricted set of spin orbitals has the form

(x) = W (r)a(@)

3.110

G10)

70) twipte

and the closed-shell restricted ground state is
(Po> = Ix1X2 "* Yw-1tn> = Way

Wa

Wnj2¥nj2>

(3.111)

We now want to convert the general spin orbital Hartree-Fock equation
fMyx1) = ¢,7,(1) to a spatial eigenvalue equation where each of the occupied

spatial molecular orbitals {y,|a= 1,2,...,.N/2} is doubly occupied. The

procedure for converting from spin orbitals to spatial orbitals was described

in Subsection 2.3.5; we must integrate out the spin functions. Let us first

apply this technique to the Hartree-Fock equation
I(x Dxi(K1) = 8x(%1)

(3.112)

The spin orbital 7,(x,) will have either the a or B spin function. Let us assume
a; identical] results will be obtained by assuming f,
A(x Wilt Jaleo) = € W(t Ja(o,)

(3.113)

where e;, the energy of the spatial orbital y; is identical with e;, the energy
of the spin orbital y,;. Multiplying on the left by a*(@,) and integrating over
spin gives
| fa

aro) foto)

W(t.) = eV ;(r,)

(3.114)

To proceed we must evaluate the left-hand side of (3.114). Let us write the
spin orbital Fock operator as

Fe) = hee) + Y fds XedriA — Prades)

(3-115)

THE HARTREE-FOCK APPROXIMATION

133

so that (3.114) becomes
| feo aro for,yato,)

+ly

W(t,) =

fate

arto yhiryalo,)| W(t)

dor, dx, o*(c,)¥2(x,)ri7(1 =F nen)

= eb {r,)

W(t.)

(3.116)

If we let f(r,) be the closed-shell Fock operator

(3.117)

$e) = [deo o(er,)flx,)olor,)
then
f(t Ws (rs) = hs)

(01) + > fades, dx, O* (004) K(X a)ri2 X(X2)0(o,)W (1)

_ » fac, dx,

(CO

MK)

77 Xl 1)a()W (2)

= 6, ,(t,)

(3.118)

where we have performed the integration over dw, in the expression involving h(r,) and used Y,, to generate the explicit exchange term. Now, if
we have a closed-shell, the sum over occupied spin orbitals includes an equal
sum over those with the & spin function and those with the f spin function
N

N/2

N/2

¢

¢

t

yay4¢Y

(3.119)

and therefore

SO Wr ,) = hv)
N/2

+ Yo fideo, deo, de, oo, WHEN or tVele doz)

{t1)

N/2

+ »

fae, doo, dr, o*(, WF 2)B*(o2)ri2

(1)
W.(F2)B(@2)a(,)W

fae, daw, dr, «*(c DEE 2)0*(CO2)r 72 WF

Jal, )o(co2W) (2)

N/2

~ >
N/2

ft2)
~ YF fideo, deog de, oo WEE Board Vel )B(@,)a(@2)f
= Wr)

(3.120)

We can now perform the integrations over dw, and dw. The last term of
(3.120) disappears because of spin orthogonality. This reflects the fact that
there is only an exchange interaction between electrons of parallel spin. The

134

MODERN QUANTUM CHEMISTRY

two coulomb terms are equal and thus one obtains
S(t Wr)

= Ar Wr)

Ni/2
+ E > far,

*(r)riz

aca |vfeo

N/2
_ | >

fae, We(r2)r1: 2W ie] W(r1)

(3.121)

= 6 Ar,)
The closed-shell Fock operator thus has the form,
N{2

= heey) + Y [dea WX) 2—ArDridvelta)
fey)

(3.122)

or, equivalently,
N/2

Sf) = h(1) + & 2I,(1) — K,(1)

(3.123)

where the closed-shell coulomb and exchange operators are defined by

Jol) = [drs VAQr2V.2)

(3.124)

K, (UW) = | far, HrOri24.0)| wa(1)

(3.125)

These equations are quite analogous to those for spin orbitals, except for
the factor of 2 occurring with the coulomb operator. The sum in (3.122) is,
of course, over the N/2 occupied orbitals {y,}. The closed-shell spatial
Hartree-Fock equation is just

(3.126)

f(y (1) = eb (1)

The closed-shell Hartree-Fock energy was derived in Subsection 2.3.5
as an example of the transition from spin orbitals to spatial orbitals. For

the closed-shell determinant, |'¥9> = Wi. --* Waa

* Wn2¥nj2>, it is

Ey = (¥|H|¥o> = 2 ¥ (hla) + ¥ ¥ 2(aa| bb) — (ab| ba)
a

ab

Was ~ Kas
=2V a hua t+ UY
ab

(3.127)

It remains to convert the expression for orbital energies in Eq. (3.72) to the
closed-shell spatial orbital form.

Exercise 3.9 Convert the spin orbital expression for orbital energies,
N

i= Cxadh|x> + 2 xixal [Xite>

THE HARTREE-FOCK APPROXIMATION

135

to the closed-shell expression
N/2

€: = (Wlhlb,) + ¥ 2(ii|bb) — (ib|b) =,
b

N/2

+ Y Wy, -— Ky
b

(3.128)

With the results of this last exercise we now have closed-shell expressions
for most quantities of interest. Let us examine these, for a moment, in the
context of our minimal basis H, model.

é.

4

o—t——*
We can evaluate the total energy by inspection. Each of the two electrons
has kinetic energy plus attraction to the nuclei of h,, = (W, |hly4). In addition
there is the coulomb repulsion between the two electrons J,, = (Wivs |W).
There are no exchange interactions since the two electrons have antiparallel
spins. The Hartree-Fock energy is thus
Eo

=

2hiy

+

Jit

(3.129)

This is an agreement with (3.127) since J;; = K,,.
One can evaluate the orbital energies similarly.

To evaluate 6, we need only add up the interactions of the circled electron.
It has kinetic energy and nuclear attraction h,, and a coulomb interaction
J,, and, therefore,

&y

=h,,

+

J

44

(3.130)

¢, —f_|—_

=e

We could do the same for any occupied orbital energy. For virtual orbitals,
as we have seen before, the orbital energy corresponds to the interactions of
an extra (N + 1)th electron, in agreement with Koopmans’ theorem. For
the minimal basis model, we must keep the two electrons of |¥ o> and evaluate
the interactions of the extra electron in the virtual orbital y., as shown
below.

136

MODERN

QUANTUM

CHEMISTRY

The circled electron has kinetic energy and nuclear attraction h,. It has two
coulomb interactions J,,, with each of the other two electrons, and an
exchange interaction — K,,, with the electron of parallel spin. Thus
8) =

hy,

+

242

—

Kir

(3.131)

Both of the results are in agreement with the general expression for closedshell orbital energies obtained in Exercise 3.9.

3.4.2 Introduction of a Basis: The Roothaan Equations
Now that we have eliminated spin, the calculation of molecular orbitals
becomes equivalent to the problem of solving the spatial integro-differential
equation
SO Wit.)

= ery)

(3.132)

One might attempt to solve this equation numerically; numerical solutions
are common in atomic calculations. No practical procedures are presently
available, however,

for obtaining

numerical

solutions

for molecules.

The

contribution of Roothaan* was to show how, by introducing a set of known
spatial basis functions, the differential equation could be converted to a set
of algebraic equations and solved by standard matrix techniques.
We, therefore, introduce a set of K known basis functions {o,(r)| p=

2,...,K}
pansion

and expand the unknown
K

Vi= Y Cub,
H=1

1,

molecular orbitals in the linear ex-

1=1,2,...,K

(3.133)

If the set {¢,} was complete, this would be an exact expansion, and any
complete set {¢,,} could be used. Unfortunately, one is always restricted, for
practical computational reasons, to a finite set of K basis functions. As such,

it is important to choose a basis that will provide, as far as is possible, a
reasonably accurate expansion for the exact molecular orbitals {,}, particularly, for those molecular orbitals {y,} which are occupied in |‘¥o> and
determine the ground state energy Ej. A later section of this chapter discusses
the questions involved in the choice of a basis set and describes some of the
art of choosing a basis set. For our purposes here, we need only assume that

{¢,} is a set of known functions, As the basis set becomes more and more

complete, the expansion (3.133) leads to more and more accurate represen-

tations of the “exact” molecular orbitals, i.e., the molecular orbitals converge
to those of Eq. (3.132), the true eigenfunctions of the Fock operator. For any

finite basis set we will obtain molecular orbitals from the truncated expansion
(3.133), which are exact only in the space spanned by the basis functions

($,:

From (3.133), the problem of calculating the Hartree-Fock molecular
orbitals reduces to the problem of calculating the set of expansion coefficients

THE HARTREE-FOCK APPROXIMATION

137

C,;- We can obtain a matrix equation for the C,; by substituting the linear
expansion (3.133) into the Hartree-Fock equation (3.132). Using the index
v, Bives

SOY Cid) = 6: Y Crd MD

(3.134)

By multiplying by 4*(1) on the left and integrating, we turn the integrodifferential equation into a matrix equation,

¥ Cu far SSG) =D Co fdr, 6G)

135)

We now define two matrices.
1. The overlap matrix S has elements

(3.136)

Sy = [dr, 68006.)

and is a K x K Hermitian (although usually real and symmetric) matrix.
The basis functions {¢,}, although assumed to be normalized and linearly
independent, are not in general orthogonal] to each other and, hence, overlap

with a magnitude 0 < |S,,| < 1, ie. the diagonal elements of S are unity and

the off-diagonal elements are numbers less than one in magnitude. The sign
of the off-diagonal elements depends on the relative sign of the two basis
functions, and their relative orientation and separation in space. If two
off-diagonal elements approach unity (in magnitude) ie. approach complete
overlap, then the two basis functions approach linear dependence. Because
the overlap matrix is Hermitian, it can be diagonalized by a unitary matrix,
as we will have occasion to do, later. The eigenvalues of the overlap matrix
can be shown to be necessarily positive numbers and, hence, the overlap
matrix is said to be a positive-definite matrix. Linear dependence in the basis
set is associated with eigenvalues of the overlap matrix approaching zero.
The overlap matrix is sometimes called the metric matrix.
2. The Fock matrix F has elements

Fy = far, OR FDE)

(3.137)

and isalsoa K x K Hermitian (although usually real and symmetric) matrix.
The Fock operator f(1) is a one-electron operator, and any set of one-electron
functions defines a matrix representation of this operator. We have previously discussed matrix elements of the Fock operator with spin orbitals.
The Fock matrix F is the matrix representation of the Fock operator with

the set of basis functions {¢,}.

With these definitions of F and S we can now
Hartree-Fock equation (3.135) as

FCy=€YSyCy;
B
Be

write the integrated

i=1,2,...,K

(3.138)

138 MODERN QUANTUM CHEMISTRY

These are the Roothaan equations, which can be written more compactly as
the single matrix equation

FC = SCe

(3.139)

where C isa K x K square matrix of the expansion coefficients C,,;
Ci.

Ci2

7s

Cix

ca| 1

C2

0

Ok

Cyr

Cx2

«°*

Cx

(3.140)

and ¢ is a diagona} matrix of the orbital} energies ¢,,
€1
e=

=|

9

&2

-

0

(3.141)

&x

Note that from (3.133) and (3.140) it is the columns of C which describe the
molecular orbitals, i.e., the coefficients describing y, are in the first column of

C, those describing y, are in the second column of C, etc.

Exercise 3.10 Show that C'SC = 1. Hint: Use the fact that the molecular

orbitals {y;} are orthonormal.

At this point the problem of determining the Hartree-Fock molecular
orbitals {y;} and orbital energies ; involves solving the matrix equation
FC = SCs. To proceed, however, we need an explicit expression for the
Fock matrix. It is first of ail necessary, however, to introduce the concept

of a density matrix.

3.4.3 The Charge Density
If we have an electron described by the spatial wave function w,(r), then the
probability of finding that electron in a volume element dr at a point r is

\W.(r)|? dr. The probability distribution function (charge density) is |y,(r)|?.

If we have a closed-shell molecule described by a single determinant wave
function with each occupied molecular orbital y, containing two electrons,
then the total charge density is just
N/Z

(3.142)

pl) =2 ¥ WH?

such that p(r)dr is the probability of finding an electron (any electron) in
dr at r. The integral of this charge density is just the total number of electrons,
N/2

N/2

f drp(r)=2 >. f dr |W}? =2 Y 1=N

(3.143)

THE HARTREE-FOCK APPROXIMATION

139

For a single determinant, these equations show that the total charge density
is just a sum of charge densities for each of the electrons.

by

oe

-

ee

Exercise 3.11 Use the density operator f(r)= >

o(r; — r), the rules for

evaluating matrix elements in Chapter 2, and the rules for converting from

spin orbitals to spatial orbitals, to derive (3.142) fron} p(r)= (PF |A(r)|Po>-

Let us now insert the molecular orbital expansion (3.133) into the
expression (3.142) for the charge density,
N/2

p(t) = 2 >) weer Walr)
N/2

=2 2 » Cx O50) D, Cua? AF)
N/2

| ,(ro*(r)

= > 2 » Cu

=F Pv

(3.144)

PFO)

where we have defined a density matrix or, as it is sometimes called, a charge-

density bond-order matrix

N/2

Py=2> CuC%

(3.145)

From (3.144), given a set of known basis functions {¢,,}, the matrix P specifies
completely the charge density p(r). It is directly related to the expansion
coefficients C by (3.145), and we can characterize the results of closed-shell
Hartree-Fock calculations either by the C,, or by the P,,.
Exercise 3.12 A matrix A is said to be idempotent if A7 = A. Use the

result of Exercise 3.10 to show that PSP = 2P, i.e, show that 4P would be

idempotent in an orthonormal! basis.

Exercise 3.13 Use
operator to show that

the expression

(3.122)

for

the closed-shell

Fock

f(r) = hr) + ne

=h(r,)+5 »

Pig | Sas P3(F2)(2— P,2)ri2 ‘oe

(3.146)

The result of the above exercise expresses the Fock operator in terms of
the density matrix. We can use this expression to indicate in an intuitive way
how the Hartree-Fock procedure operates. We first guess a density matrix

140 MODERN QUANTUM CHEMISTRY

P, i.e., we guess the charge density p(r) describing the positions of the electrons. Later we will say something about how to obtain such a guess. We
then use this charge density to calculate an effective one-electron potential

vF(r,) for the electrons according to (3.146). We thus have an effective one-

electron Hamiltonian (the Fock operator), and we can solve a one-electron
Schrédinger-like equation to determine the states {;} of an electron in the
effective potential. The new one-electron states (molecular orbitals y,) can
then be used to obtain a better approximation to the density, using (3.142),
for example. With this new charge density we can calculate a new HartreeFock potential and repeat the procedure until the Hartree-Fock potential
(and, consequently, an effective electrostatic field) no longer changes, i.e.,
until the field which produced a particular charge density (by solving a
one-electron Schrédinger-like equation, the Hartree-Fock eigenvalue equation) is consistent (identical) with the field which would be calculated from
that charge density (using (3.146)). This is why the Hartree-Fock equations
are commonly called the self-consistent-field (SCF) equations. This is a way
of viewing the physics involved in solving the Roothaan equations. To return
to the actual algebraic procedure, we need an explicit expression for the
Fock matrix F.

3.4.4 Expression for the Fock Matrix
The Fock matrix F is the matrix representation of the Fock operator
N/2

f(l) = h(i) + ¥ 2,0) — K,(4)

(3.147)

in the basis {¢,}, ie.,

Fy = dry $20)f()4,0)
= fdr, d2(h()p,(1) + ¥ far, GX Q)E29.(1) — Ka()}6,0)
Nj2
= He + ¥ 2(uv|aa) — (ual av)

(3.148)

where we have defined a core-Hamiltonian matrix

Heer= [dey b2(Hh(1)$,(1)
The elements of the core-Hamiltonian

(3.149)

matrix are integrals involving the

one-electron operator h(1), describing the kinetic energy and nuclear attrac-

tion of an electron, i.e.,

h(i) =

1 vi->
2

—_—__
ZA

A ri —R,|

(

3.150

)

THE HARTREE-FOCK APPROXIMATION

141

Calculating the elements of the core-Hamiltonian matrix thus involves
the kinetic energy integrals

(3.451)

Ty = [ars OHNE -39214,0)

and the nuclear attraction integrals
prec!
uv

=

*
x00]

far,

_—

2

Ir,

ZTA
_

R,|

Jo

(

3.152

)

where

Heer’ = T,, + Veet

(3.153)

Given a particular basis set {f,}, the integrals of T and V""" need to be

evaluated and the core-Hamiltonian matrix formed. The core-Hamiltonian
matrix, unlike the full Fock matrix, needs only to be evaluated once as it
remains constant during the iterative calculation. The calculation of kinetic
energy and nuclear attraction integrals is described in Appendix A.
To return to expression (3.148) for the Fock matrix, we now insert the
linear expansion for the molecujar orbitals (3.133) into the two-electron

terms to get

Ni;2

Fi = Here + YY C,,Cz[2(uv|od) — (ualov)]
a

ha

= Heer + ¥Ao P,o[(uv|o4) — 5(uAlov)]

= He +G,,

(3.154)

where G,, is the two-electron part of the Fock matrix. This is our final
expression for the Fock matrix. It contains a one-electron part H°°* which
is fixed, given the basis set, and a two-electron part G which depends on
the density matrix P and a set of two-electron integrals

(uv| 40) = far, de, $1),

(1)ri2' 64(2)h.(2)

(3.155)

Because of their large number, the evaluation and manipulation of these
two-electron integrals is the major difficulty in a Hartree-Fock calculation.
Exercise 3.14 Assume

that the basis functions are real and use the

symmetry of the two-electron integrals [(uv|Ac) = (vu|4c) = (Aol|uv), etc.]
to show that for a basis set of size K = 100 there are 12,753,775 = O(K‘/8)
unique two-electron integrals.

Because the Fock matrix depends on the density matrix,

F =F(P)

(3.156)

142 MODERN QUANTUM

CHEMISTRY

or, equivalently, on the expansion coefficients,

F=F(Q
the Roothaan

(3.157)

equations are nonlinear, i.e.,

F(QC = SCe

(3.158)

and they will need to be solved in an iterative fashion. Before considering
how such iterations should proceed, we need to discuss the solution of the
matrix equation

FC = SCe

(3.159)

at each step in the iteration. If S were the unit matrix (i.e., if we had an orthonormal basis set), then we would have

FC =Ce

(3.160)

and Roothaan’s equations would just have the form of the usual matrix
eigenvalue problem, and we could find the eigenvectors C and eigenvalues
s by diagonalizing F. Because of the nonorthogonal basis, we need to reformulate the eigenvalue problem FC = SCz.

3.4.5 Orthogonalization of the Basis
The basis sets that are used in molecular calculations are not orthonormal
sets. The basis functions are normalized, but they are not orthogonal to each
other. This gives rise to the overlap matrix in Roothaan’s equations. In order
to put Roothaan’s equations into the form of the usual matrix eigenvalue
problem, we need to consider procedures for orthogonalizing the basis
functions.
If we have a set of functions {¢,,} that are not orthogonal, i.e.,

far $3006.09 = S,,

(3.161)

then it will always be possible to find a transformation matrix X (not unitary)
such that a transformed set of functions {¢’,} given by

¢.=>X,¢,

w=1,2,...,K

(3.162)

do form an orthonormal set, i.e.,

Jar d70)0,6) = 5,y

(3.163)

THE HARTREE-FOCK APPROXIMATION

143

To derive the properties of X, we substitute the transformation (3.162) into
(3.163) to get
;

far $d.) = [ae ly xz6rt0 b Kestalt
=D YX, [ar $30b.0Xey
Ac

=

»

»

Aca

XE SreXov

= Suv

(3.164)

This last equation can be written as the matrix equation

X'Sx =1

(3.165)

and defines the relation that the matrix X must satisfy if the transformed

orbitals are to form an orthonormal set. As we shall see later, X must also

be nonsingular, i.e., it must possess an inverse X~!. We now proceed to show
how to obtain two different transformation matrices X. Since S is Hermitian
it can be diagonalized by a unitary matrix U,

UtSU =s

(3.166)

where s is a diagonal matrix of the eigenvalues of S.

Exercise 3.15 Use the definition of S,, = { dr pi@, to show that the
eigenvalues of S are all positive. Hint consider ) S,,ci = s,c,, multiply by

ci* and sum, where c’ is the ith column of U.

v

There are two ways of orthogonalizing the basis set {¢,} in common use.
The first procedure, called symmetric orthogonalization, uses the inverse
square root of S for X

X =S-t? = Us

2yt

(3.167)

If you will recall from the discussion of functions of a matrix in Chapter 1,

we can form S~'/? by diagonalizing S to form s, then taking the inverse
square root of each of the eigenvalues to form the diagonal matrix s~ ‘/? and

then “undiagonalizing” by the transformation in (3.167). If S is Hermitian
then S~!/? is also Hermitian. Substituting (3.167) into (3.165),
S7 1266-12 §-1/2g1/2
$0 = 4
(3.168)

shows that X = S~!/? is indeed an orthogonalizing transformation matrix.

Since the eigenvalues of S are all positive (Exercise 3.15), there is no difficulty

in (3.167) of taking square roots. However, if there is linear dependence or
near linear dependence in the basis set, then some of the eigenvalues will
approach zero and (3.167) will involve dividing by quantities that are nearly

144 MODERN QUANTUM CHEMISTRY

zero. Thus symmetric orthogonalization will lead to problems in numerical

precision for basis sets with near linear dependence.
A second way of obtaining an orthonormal set of basis functions is called

canonical orthogonalization. It uses the transformation matrix

X = Us" 1/2

(3.169)

that is, the columns of the unitary matrix U are divided by the square root
of the corresponding eigenvalue

Xj, = U;j/s}'”

(3.170)

Substituting this definition of X into (3.165) gives

X*SX = (Us

¥/?)*§Us" 1? = s7V/?UtSUs"

2? = gs

@gg7 1/2 = 10

(3.171)

showing that X = Us” !/? is also an orthogonalizing transformation matrix.

It appears, from (3.170), that this orthogonalization procedure will also
entail difficulties if there is linear dependence in the basis set, i.e., if any of
the eigenvalues s, approach zero. We can circumvent this problem with
canonical orthogonalization, however. In the matrix eigenvalue problem
(3.166), we can order the eigenvalues in any way in the diagonal matrix s,
provided we order the columns of U in the same way. Suppose we order the
positive eigenvalues s; in the order s, > s, > s, >°- +. Upon inspection we
may decide that the last m of these are too small and will give numerical
problems. We can then use as a transformation matrix, the truncated

matrix X,

-X=

U4 ,4/s}!?

1/2
Vaslss

U;,2/s3!?

Ux.4/s}?

a

U4

=m SK 2m

Vaa/sa 2...

12m
U2.K-m/Sk-

Te

Ux n= ml SK m

Ux,2/83!?

(3.172)

where we have eliminated the last m columns of X to give the K x (K — m)
matrix X. With this truncated transformation matrix, we get only K — m
transformed orthonormal basis functions
K

>v=1 Xb
b=

4=1,2,...,.K—m

(3.173)

These would span exactly the same region of space as the original set,
provided the eliminated eigenvalues were exactly zero. In practice, one often
finds linear dependence problems with eigenvalues in the region s,; < 107+
(depending, of course, on the machine precision of the calculation). In
eliminating the columns with these eigenvalues one is “throwing away” part
of the basis set, but only a very small part.
One way of dealing with the problem of a nonorthogonal basis set would
thus be to orthogonalize the functions {¢,} to obtain the transformed basis

THE HARTREE-FOCK

APPROXIMATION

145

functions {¢’,} and work with these orthonormal functions throughout. This

would eliminate the overlap matrix S from Roothaan’s equations, which
could then be solved just by diagonalizing the Fock matrix. This would

mean, however, that we would have to calculate all our two-electron integrals

using the new orbitals or else transform all the old integrals (jv| 4c) to set
(u’v’|2’o’). In practice this is very time consuming, and we can solve the same
problem in a more efficient way. Consider a new coefficient matrix C’ related
to the old coefficient matrix C by
C=x"'cC

C=xXC

(3.174)

where we have assumed that X possesses an inverse. This will be the case if
we have eliminated linear dependencies. Substituting C = XC’ into the
Roothaan equations gives

FXC’ = SXC'e

(3.175)

Multiplying on the left by X* gives

(X'FX)C’ = (X'SX)C'e

(3.176)

If we define a new matrix F’ by
F’ = XtFX

(3.177)

FC =Ce

(3.178)

and use (3.165), then

These are the transformed Roothaan equations, which can be solved for
C’ by diagonalizing F’. Given C’, then C can be obtained from (3.174).
Therefore, given F, we can use (3.177), (3.178), and (3.174) to solve the
Roothaan equations FC = SCs forC ands. The intermediate primed matrices
are just the Fock matrix and expansion coefficients in the orthogonalized
basis, i.e.,

Wi=

K
u=1

Cid,

1=1,2,...,K

Puy = fades SFG.)

(3.179)

(3.180)

Exercise 3.16 Use (3.179), (3.180), and (3.162) to derive (3.174) and (3.177).
3.4.6

The SCF Procedure

With the background of the previous sections we are now in a position to
describe the actual computational procedure for obtaining restricted closedshell Hartree-Fock wave functions for molecules, i.e., wave functions |Po>-

Some authors restrict the term Hartree-Fock solution to one that is at the

146 MODERN QUANTUM CHEMISTRY

Hartree-Fock limit, where the basis set is essentially complete, and use the
term self-consistent-field (SCF) solution for one obtained with a finite,
possibly small, basis set. We use the terms Hartree-Fock and SCF interchangeably, however, and specifically refer to the Hartree-Fock limit when
necessary. The SCF procedure is as follows:

1. Specify a molecule (a set of nuclear coordinates {R,}, atomic numbers

{Z,}, and number of electrons N) and a basis set {¢,}.

2. Calculate al! required molecular integrals, S,,, Ho", and (uv| Ao).

3. Diagonalize the overlap matrix S and obtain a transformation matrix X
from either (3.167) or (3.169).
4. Obtain a guess at the density matrix P.
5. Calculate the matrix G of equation (3.154) from the density matrix P
and the two-electron integrals (4v| 0).
6. Add G to the core-Hamiltonian to obtain the Fock matrix F = H®* + G.
7. Calculate the transformed Fock matrix F’ = XtFX.
8. Diagonalize F’ to obtain C’ and s.
9. Calculate C = XC’.
10. Form a new density matrix P from C using Eq. (3.145).
11. Determine whether the procedure has converged, i.e., determine whether
the new density mnatrix of step (10) is the same as the previous density
matrix within a specified criterion. If the procedure has not converged,
return to step (5) with the new density matrix.
12. If the procedure has converged, then use the resultant solution, represented by C, P, F, etc., to calculate expectation values and other quantities
of interest.

We will describe the calculation of expectation values like the energy, dipole
moment, etc., and other quantities of interest like population analyses shortly
(Subsection 3.4.7) but let us first consider some of the practical questions
involved in each of the twelve steps.
Within the Born-Oppenheimer approximation, what we have done in
the above procedure is to determine an electronic wave function |'¥o> (and
hence an electronic energy E,) for a collection of N electrons in the field of
a set of M point charges (the M nuclei with charges Z ,). By adding the classical nuclear-nuclear repulsion to the electronic energy we will have a total
energy as a function of a set of nuclear coordinates {R,}. By repeating the
calculation for different nuclear coordinates we can then explore the potential
energy surface for nuclear motion. A common calculation is to find the set
{R,,} which minimize this total energy; this is a calculation of the equilibrium
geometry of a molecule. The procedure is valid for any collection of point
charges. In particular, “supermolecule” calculations, which use a set of
nuclear charges representative of more than one molecule, are common for
exploring, for example, intermolecular forces.

THE HARTREE-FOCK APPROXIMATION

147

Having chosen a set of nuclear coordinates, the calculation ofa restricted

closed-shell single determinant wave function is then completely specified
by the set of basis functions {¢,,}. As such, this is an example of an ab initio
calculation which makes no approximation to the integrals or the electronic
Hamiltonian, but is completely specified by the choice of a basis set and the
coordinates of the nuclei. The choice of a basis set is more of an art than a
science. One is obviously limited by computer facilities, budget, etc. to a
rather small, finite set of functions. One must, therefore, be rather judicious

in the choice of a basis set. Only Slater- and Gaussian-type functions are
currently in common use. If one uses a very small set of functions per atom,
then Slater-type functions give definitely superior energies. As the number of
functions per atom increases, the clear cut superiority of Slater-type functions
is somewhat diminished. As well as the ability of the basis set to span the
function space, however, one has to consider, for practical reasons, the time

required to evaluate molecular integrals. Most polyatomic calculations now
use Gaussian orbitals because of the speed with which integrals can be
evaluated, and in this book we will emphasize Gaussian basis functions.
Basis functions are discussed in Section 3.6 of this chapter, and the 1s STO-3G
basis is discussed in Subsection 3.5.1, prior to its use in model calculations
on H, and HeH™*.
Having

defined a basis set, one

then needs

to calculate

and

store a

number of different types of integrals. Appendix A describes molecular
integral evaluation using Gaussian basis functions; we will only mention a
few pertinent points here. The overlap integrals and the one-electron integrals
that are needed for the core-Hamiltonian and one-electron expectation
values, described later, are relatively trivial compared to the two-electron
repulsion integrals, primarily because of the much smaller number of oneelectron integrals. The major difficulty of a large calculation is the evaluation
and handling of large numbers of two-electron integrals. If there are K basis
functions, then there will be of the order of K*/8 (see Exercise 3.14) unique
two-electron integrals. These can quickly run into the millions even for small
basis sets on moderately sized molecules. The problem is not quite this bad
since many integrals will be effectively zero for large molecules, as the
distance between basis functions becomes large. A number of integrals may
also be zero because of molecular symmetry. There will almost always be,
however, too many two-electrons integrals to store them all in main computer
memory. One common procedure is to store all nonzero integrals in random
order on an external magnetic disk or tape, associating with each integral a
label identifying the indices y, v, 4, and c.
In the last subsection we described two ways of orthogonalizing the
basis set or deriving a transformation X, which enables one to solve

Roothaan’s equations by a diagonalization. The use of K = S~?/? is con-

ceptually simple, and only in unusual situations, where linear dependence

148

MODERN

QUANTUM

CHEMISTRY

in the basis set is a problem, does one need to use canonical orthogonaliza-

tion. With canonical orthogonalization, columns of X = Us” 1/? can just be

dropped to give a rectangular matrix. If m columns of X are deleted, one
will effectively be using a basis set of size K — m and one will obtain K — m
molecular orbitals y,, i.e., F’ will be a (K — m) x (K — m) matrix and C’ will
be a K x (K — m) matrix, with columns describing the K — m molecular
orbitals in terms of the original K basis functions.
The simplest possible guess at the density matrix P is to use a null (zero)
matrix. This is equivalent to approximating F as H°°* and neglecting all
electron-electron interactions in the first iteration. This is a very convenient
way of starting the iteration procedure. It corresponds to approximating
the converged molecular orbitals by those describing a single electron in the
field of the nuclear point charges. The molecular orbitals for the N-electron
molecule may be quite different from those for the corresponding oneelectron molecule, however, and the SCF procedure will often not converge
with the core-Hamiltonian as an initial guess to the Fock matrix. A semiempirical extended Hiickel type calculation, with an “effective” F, is often
used for an initial guess at the wave function and, commonly, provides a
better guess than just using the core-Hamiltonian. There are clearly many
ways one could generate an initial guess.

The major time-consuming part of the actual iteration procedure is the
assembling of the two-electron integrals and density matrix into the matrix
G in step (5). If the integrals are stored in random order with associated
labels on an external device, then as they are read into main memory one
uses the label, ie., the indices x, v, J, and o identifying the integral, to deter-

mine which elements of the density matrix to multiply by and to which elements of the G matrix the products must be added, according to the
expression for the G matrix given by Eq. (3.154).
In most calculations, the matrix operations in steps (6) to (10) are not
time consuming relative to the formation of the G matrix, provided one uses
an efficient diagonalization procedure.
Because the Roothan equations are nonlinear equations, the simple
iteration procedure we have outlined here will not always converge. It may
oscillate or diverge, possibly because of a poor initial guess. If it oscillates,
averaging successive density matrices may help. If it does converge, it may
do so only slowly. With two or more successive density matrices, various
extrapolation procedures can be devised. Convergence problems are not
unusual, but also are not a major problem for many calculations. The iterative
procedure we have described is perhaps the simplest procedure one might
try, but it also is somewhat naive. A number of other techniques have been

suggested for ensuring or accelerating convergence to the SCF solution.

One, of course, requires a criterion for establishing convergence, and it
is not uncommon simply to observe the total electronic energy of each

iteration and require that two successive values differ by no more than a

THE HARTREE-FOCK APPROXIMATION

149

small quantity 5. A value of 6 = 107 © Hartrees is adequate for most purposes.
We will show shortly that the energy of each iteration can be calculated
without due expense. Alternatively, one might require convergence for
elements of the density matrix, by requiring the standard deviation of successive density matrix elements, i.e., the quantity

[x7 S08 — rae |
.

.

1/2

woy

to be less than 6. A value of 6 = 10~* for the error in the density matrix
will usually give an error in the energy of less than 107© Hartrees.
We have only been able to touch on a few aspects of the SCF procedure.
Research efforts by many groups and large numbers of man-years of programming have gone into the large computer programs, which are currently
available, for performing ab initio SCF calculations.

3.4.7 Expectation Values and Population Analysis
Once we have a converged value for the density matrix, Fock matrix, etc.,
there are a number of ways we might use our wave function |) or analyze
the results of our calculation. Only some of the more common quantities
will be discussed.
The eigenvalues of F’ are the orbital energies ¢,. As we discussed when
describing Koopmans’ theorem, the occupied orbital energies ¢, constitute
a prediction of ionization potentials and the virtual orbital energies ¢, constitute a prediction of electron affinities. The values of —¢, are commonly a
reasonable approximation to the observed ionization potentials, but —¢, is
usually of little use, even for a qualitative understanding of electron affinities.

The total electronic energy is the expectation value Ey = ¢¥|#|'¥ o>

and, as we have seen a number of times now, it is given by
N/2 N/2

N/[2

Eo =2¥

hat ¥ ¥ We —

a

a

Kav

ob

(3.181)

With definition (3.147) of the Fock operator, we have
N/2

’

&4

= Soa

=

Noa

+

Y

2J ab —

Ka

(3.182)

b

and, therefore, we can write the energy as
N/2

N/2

Eo = ¥ (haa + faa) = Y; haa + €a)

(3.183)

This is a convenient result; if we substitute the basis function expansion
(3.133) for the molecular orbitals into this expression, we obtain a formula
for the energy, which is readily evaluated from quantities available at any

150 MODERN QUANTUM

CHEMISTRY

stage of the SCF iteration procedure, i.e.,

1
Eo = 5D Pull + Fy)
ria

HOY

(3.184)

Exercise 3.17 Derive Equation (3.184) from (3.183)
If Ey is calculated from (3.184) using the same matrix P as was used to
form F, then E, will be an upper bound to the true energy at any stage of
the iteration and will usually converge.monotonically from above to the
converged result. If one adds the nuclear-nuclear repulsion to the electronic
energy E, one obtains the total energy E,,.

Em =Eo+

A

yy

B>A

ZaZ
Rap

(3.185)

This is commonly the quantity of most interest, particularly in structure determinations, because the predicted equilibrium geometry of a molecule occurs
when E,,, is a minimum.
Most of the properties of molecules that one might evaluate from a
moiecular wave function, such as the dipole moment, quadrupole moment,
field gradient at a nucleus, diamagnetic susceptibility, etc., are described by
sums of one-electron operators of the general form
N

(3.186)

O,= x h(i)

where h(i) is not necessarily the core-Hamiltonian here, but any operator
depending only on the coordinates of a single electron. From the rules for
matrix elements, expectation values for such operators will always have the
form
N/2

{O1:> = C¥ [0,2 = ¥ WalhlWa) = Y Prav|h|

(3.187)

so that, in addition to the density matrix, we need only evaluate the set of

one-electron integrals (y\h|v) to calculate one-electron expectation values.

We will use the dipole moment to illustrate such a calculation.
The classical definition of the dipole moment of a collection of charges
q; with position vectors r; is

a= Daw,

(3.188)

The corresponding definition for a quantum mechanical calculation on a

molecule is

N

B=

(¥,

-Yyy, Yo) +¥Z,R,
t=1

A

(3.189)

THE HARTREE-FOCK

APPROXIMATION

151

where the first term is the contribution (quantum mechanical) of the electrons,
of charge —1, and the second term is the contribution (classical) of the
nuclei, of charge Z,, to the dipole moment. The electronic dipole operator
is —}®., ;, a sum of one-electron operators. Therefore, using (3.187), we
have

z= —-DL YP, Olt) +
HOV

ZR,

A

(3.190)

this is a vector equation with components (for example the x component)
given by

be = —LY Prox) + ¥ ZX 4
HY

A

(3.191)

and to calculate the dipole moment we need in addition to P only the dipole
integrals

(xb) = Fae, oF 19,00)

(3.192)

with corresponding values for the y and z components.
The charge density

PW) = YY Pv
HOY

PR)

(3.193)

representing the probability of finding an electron in various regions of
space, is commonly pictured by contour maps for various planes drawn
through the molecule. There is no unique definition of the number of electrons
to be associated with a given atom or nucleus in a molecule, but it is still
sometimes useful to perform such population analyses, Since
N/2

N=2) f drly(v)|?

(3.194)

divides the total number of electrons into two electrons per molecular orbital,
by substituting the basis expansion of y, into (3.194), we have

N=DY Py Sy => (PS), = rPS
uy

(3.195)

B

and it is possible to interpret (PS),,,, as the number of electrons to be associated with ¢,. This is called a Mulliken population analysis. Assuming the
basis functions are centered on atomic nuclei, the corresponding number of
electrons to be associated with a given atom in a molecule are obtained by
summing over all basis functions centered on that atom. The net charge
associated with an atom is then given by
ga=Z,-

¥

PS),

(3.196)

nea

where Z , is the charge of atomic nucleus A; the index of summation indicates
that we only sum over the basis functions centered on A.

152 MODERN QUANTUM CHEMISTRY

The definition (3.195) is by no means unique. Since tr AB = tr BA,

N =) (S’PS'~%),,,

(3.197)

H

for any a. With « = 1/2, we have

N =)(S'?PS'7)_ => P.,
“

(3.198)

“

where we can show that P’ is the density matrix in terms of a symmetrically
orthogonalized basis set,

pr) => >¥ PON)Ol0)

(3.199)

#,{r) = > (S- ), Ol)

(3.200)

The diagonal elements of P’ are commonly used for a Léwdin population
analysis

ga=Za—

(3.201)

> (S*?PS"),,

pea

Exercise 3.18 Derive the right-hand side of Eq. (3.198), ic, show that
a = 1/2 is equivalent to a population analysis based on the diagonal elements
of P’.
None of these population analysis schemes is unique, but they are often
useful when comparing different molecules using the same type of basis set
for each molecule. The basis sets must be “balanced” as can be illustrated
by a simple example. It is possible to have a complete set of basis functions
by placing them all at one center, on oxygen, for example, in an H,O calculation. A population analysis would then suggest that the H atoms in water
have a charge of +1 and that all the electrons reside on the oxygen. This
example makes it obvious that care must be used in assigning physical
significance to any population analysis.

3.55 MODEL

CALCULATIONS

ON H, AND

HeH*

We have discussed and will subsequently discuss a number of formal mathematical procedures associated with solutions to the many-electron problem.
The ideas and concepts that we are presenting may appear to be rather
formidable and difficult to the uninitiated. With only a formal presentation,
it is unlikely that this situation would be radically altered. We want, for the
reader’s benefit, to avoid the burden of endless formalism, without hint of
application. We particularly feel that what appears at the outset as a somewhat obscure formal theory is usually made clear by application to a simple,
but nevertheless realistic, model system. In this section we apply the closedshell Hartree-Fock procedure to the model systems H, and HeH*.

THE HARTREE-FOCK APPROXIMATION

153

The two-electron molecules H, and HeH* are prototypes for homonuclear and heteronuclear diatomic molecules. We will consider both mole-

cules in the approximation of a minimal basis set, ie. a basis set {,}

consisting of only two functions, one on each nucleus. The limitation of these
models is only in the basis set (and the usual assumption of a nonrelativistic,
Born-Oppenheimer electronic Hamiltonian). Larger basis sets would lead to
correspondingly more accurate results. Since both molecules are simple twoelectron systems, essentially exact calculations, corresponding to an infinite
basis set, will be available for comparison with our very approximate calculations. Before describing these calculations, however, we need to intro-

duce the basis set that we will be using.

3.5.1

The 1s Minimal STO-3G

Basis Set

In Section 3.6 we will describe basis sets for the general polyatomic molecule
calculation, including s, p, and d-type basis functions. Here we introduce
some of the basic ideas involved in the choice of a basis set, by describing
basis functions of the 1s type, i.e., those that will be used in our simple calculations on H, and HeH *. Better calculations would use many 1s functions
and/or 2p, 3d, etc. functions in the basis set {¢,}. The extension of most of
the concepts introduced here, for 1s functions, to the general case is fairly
straightforward.
Inastrictly mathematical sense many different kinds of basis set functions
¢, could be used. A variety of choices have been suggested but only two
types of basis functions have found common use. The normalized 1s Slatertype function, centered at R,, has the form

P(r — Ra) = (C3/n)'7e

Bal

(3.202)

where ¢ is the Slater orbital exponent. The normalized 1s Gaussian-type func-

tion, centered at R,, has the form

8
OSF (a, r — Ry) = (20/7)?/4e-oBaP

(3.203)

where a is the Gaussian orbital exponent. The 2p, 3d, etc. Slater and Gaussian
functions are generalizations of (3.202) and (3.203) that have polynomials in
the components of r — R, (x — X4, etc.) multiplying the same exponential
(e~*) or Gaussian (e~*”) fall-off. The orbital exponents, which are positive
numbers larger than zero, determine the diffuseness or “size” of the basis
functions; a large exponent implies a small dense function, a small exponent
implies a large diffuse function. The major differences between the two functions e~* and e~*” occur at r = 0 and at large r. Atr = 0, the Slater function

has a finite slope and the Gaussian function has a zero slope,

[d/dr e~*],-9 #0
[d/dr e~*"},-5 =0

(3.204)
(3.205)

154 MODERN QUANTUM CHEMISTRY

At large values of r, the Gaussian function e~*” decays much more rapidly

than the Slater function e~".

For electronic wave function calculations one would prefer to use the
Slater functions. They more correctly describe the qualitative features of the
molecular orbitals y, than do Gaussian functions, and fewer Slater basis
functions than Gaussian basis functions would be needed in the basis function
expansion of ,, for comparable results. It is possible to show, for example,
that at large distances molecular orbitals decay as wy; ~ e *”, which is of the
Slater rather than the Gaussian form. In particular, the exact solution for

the 1s orbital of the hydrogen atom is the Slater function (z)~'/2e7".

The reason why one considers Gaussian functions at all is that, in an

SCF calculation, one must calculate of the order of K*/8 two-electron inte-

grals (uv|Ac). These integrals are of the form

(Havel Acoy) = [dts der OMI
OE iZEL)E2)

(3.206)

where $4 is a basis function on nucleus A, ie., centered at R,. The general
integra! involves four different centers: R,, Ry, Rp, and Rp. Evaluation
of these four-center integrals is very difficult and time-consuming with

Slater basis functions. These integrals are relatively easy to evaluate with
Gaussian basis functions, however. The reason is that the product of two
is Gaussian functions, each on different centers, is, apart from a constant,
a 1s Gaussian function on a third center. Thus
O93 (a, © — Ry)OiS(B, © — Re) = K apo

(p, § — Rp)

(3.207)

where the constant K 4, is

K gy = (248/[(a + B)x})°" exp[—aB/(@ + B)[R4—Rgl”]

(3.208)

The exponent of the new Gaussian centered at Rp is

p=at+f

(3.209)

and the third center P is on a line joining the centers A and B,

Rp = (eR, + BRz)/(@ + B)

(3.210)

This relationship is shown in Fig. 3.1
Exercise 3.19 Derive Eq. (3.207)

As a result of (3.207), the four-center integral in (3.206) immediately

reduces, for 1s Gaussians, to the two-center integral

(Havel Aen)

= KapKcp far,

,

dr, O73 (p, 1 — Rp)riz O92(G F2 — Ro)

These integrals can be readily evaluated as described in Appendix A.

(3.211)

THE HARTREE-FOCK APPROXIMATION

Figure 3.1 The

product

of two

1s Gaussians

is a third

155

1s Gaussian.

One is thus faced with somewhat of a dilemma. Two-electron integrals
can be calculated rapidly and efficiently with Gaussian functions, but
Gaussian functions are not optimum basis functions and have functional
behavior different from the known functional behavior of molecular orbitals.
One would prefer to use better basis functions. One way around this problem
is to use as basis functions fixed linear combinations of the primitive Gaussian

functions #$*. These linear combinations, called contractions, lead to contracted Gaussian functions (CGF),

L
orn

~~ R,)

=

d

p=

4, PC * (Coys

r—

R,)

(3.212)

where L is the length of the contraction and d,,, is a contraction coefficient.

The pth normalized primitive Gaussian #S* in the basis function ¢{°* has a
functional dependence on the Gaussian orbital exponent (contraction exponent) «,,. By a proper choice of the contraction length, the contraction
coefficients, and the contraction exponents, the contracted Gaussian function
can be made to assume any functional form consistent with the primitive
functions used. If the primitive functions are all 1s Gaussians at the same

center, then @C°F can only be of s-symmetry. Although we will not pursue

such possibilities, if the primitive functions were allowed to reside on different

centers, the expansion (3.212) could in principle describe any basis function.
The idea behind the use of contracted Gaussian functions is to choose in
advance

the contraction

length, contraction

coefficients, and

contraction

exponents that fit the right-hand side of (3.212) to a desirable set of basis
functions poor and then to use these fixed functions in molecular wave func-

tion calculations. That is, the contraction coefficients, etc. are not allowed

156 MODERN QUANTUM CHEMISTRY

to change in the course of an SCF calculation. The two-electron integrals

(uv|4c) for the contracted basis set functions {¢€°F} can, from (3.212), be

evaluated as sums of rapidly calculated two-electron integrals over the
primitive Gaussian functions.
By proper choice of the contraction parameters one can thus use basis
functions that are approximate atomic Hartree-Fock functions, Slater-type
functions, etc. while still evaluating integrals only with primitive Gaussian
functions. A procedure that has come into wide use is to fit a Slater-type
orbital (STO) to a linear combination of L = 1, 2, 3, . .. primitive Gaussian
functions. This is the STO-LG procedure (the procedure is commonly
referred to as STO-NG, but since N represents the number of electrons
everywhere in this book, we prefer an alternative symbol). In particular,
STO-3G basis sets are often used in polyatomic calculations, in preference
to evaluating integrals with Slater functions. We will use STO-3G basis sets
for our model calculations on H, and HeH*. We need to explicitly consider

the form that the contraction (3.212) takes if

@{SF is to approximate a 1s

Slater-type function.
Let us first consider fitting a Slater function having Slater exponent
€=1.0.

Later

we

will return to consider

other exponents.

We

will only

consider contractions up to length three so that the three fits we seek to
find are

OTC = 1.0, STO-1G)= $F (011)

(3.213)

PISF(C = 1.0, STO-2G) = dy 26FF (012) + do2G13 (22)

(3.214)

PFSF(C= 1.0, STO-3G) = diz fF(a13) + dosh B(a23) + dgahTs(%sa)

(3.215)

where the @¢°F (¢ = 1.0, STO-LG) are the basis functions that approximate

*

as best as possible a Slater-type function with € = 1.0. We therefore need to
find the coefficients d,,, and exponents «,,, in (3.213) to (3.215) that provide
the best fit. The fitting criterion is one that fits the contracted Gaussian
function to the Slater function in a least-squares sense, i.e., we seek to minimize the integral

I= f dt [@S(C = 1.0, 1) — OS9FC= 1.0, STO-LG,n]?

(3.216)

Equivalently, since the two functions in this equation are normalized, one
maximizes the overlap between the two functions, i.e., one maximizes

S= fdr d(C= 1.0, f) $SSF(C= 1.0, STO-LG, r)

/

(3.217)

For the STO-1G case there are no contraction coefficients, and we only
need to find the primitive Gaussian exponent « which maximizes the overlap

= (n)~ (20/n)?/* f dr e-te-?

(3.218)

THE HARTREE-FOCK APPROXIMATION

157

Table 3.1 Overlap of a 1s Slater function
(€ = 1.0) and a 1s Gaussian function

S= [dr PEC = 1.0) dEF(o)
a

Ss

01
0.2
0.3
0.4
0.5

0.8641
0.9673
0.9772
0.9606
0.9355

Soptimum = 0.270950

This overlap is shown in Table 3.1. The optimum fit occurs for « = 0.270950
and is shown in Fig. 3.2a. The corresponding radial distribution functions

(4xr?|¢,.()|?) are compared in Fig. 3.2b. Notice the different behavior near

the origin and the more rapid fall-off of the Gaussian function at large r.
The overlaps S of (3.217) can be maximized for the STO-2G and STO-3G
cases also and, if one does so, the optimum fits are as follows:

CSF(C = 1.0, STO-1G) = PEF (0.270950)

(3.219)

CSF(C — 1.0, STO-2G)
= 0.67891469F (0.151623) + 0.4301 2969F (0.851819)

(3.220)

SOFC = 1.0, STO-3G) = 0.44463569F(0.109818) + 0.535328 6SF (0.405771)
(3.221)
SF (2.22766)
+ 0.1543
29

SLATER

05

5

10

15

20

25

Radius (a.u.)

30

35

40

10

20

30

40

50

Radius (a.u.)

60

70

Figure 3.2. Comparison of a Slater function with a Gaussian function: a) least squares fit of
a 1s Slater function (€ = 1.0) by a single STO-1G 1s Gaussian function (# = 0.270950); b)

comparison of the corresponding radial distribution functions (4zr?|¢ ,,(7)|’).

60

158 MODERN QUANTUM CHEMISTRY

SLATER

O

Re)

1.0

1S

20

25

Radius

(a.u.)

30

3.5

40

Figure 3.3 Comparison of the quality of the least-squares fit of a 1s Slater function (€ = 1.0)
obtained at the STO-1G, STO-2G, and STO-3G levels.

Figure 3.3 illustrates the improvement

of the fit to a Slater 1s function

(C = 1.0) obtained by increasing the number of Gaussians in the contraction
(.e., upon going from STO-1G to STO-2G to STO-3G).

Exercise 3.20 Calculate the values of $(r) at the origin for the three

STO-LG contracted functions and compare with the value of (x)~ 1? for a
Slater function (¢ = 1.0).

°

The STO-LG fits to a Slater function, given in Eqs. (3.219) to (3.221), are
for a Slater exponent of ¢ = 1.0. How does one obtain a fit to a Slater function with a different orbital exponent? The orbital exponents are scale
factors which scale the function in r, ie, they expand or contract the function, but do not change its functional form. Because the scale factors mul-

tiply r as follows,

e1

e War

(3.222)
/

the proper scaling is

C/E = [or/a]'/?

(3.223)

The appropriate contraction exponents « for fitting to a Slater function with
orbital exponent ¢ are thus

a = a(t = 1.0) x 0?

(3.224)

THE HARTREE-FOCK

APPROXIMATION

159

If the Slater exponent doubles, the contraction exponents should be multiplied by a factor of four. This scaling procedure is quite general and contraction parameters need only be determined once for a given type of basis
function ¢°. Ifa different scale factor for PC
is required, the contraction
exponents ‘can be appropriately scaled. The usual description of the STO3G basis set includes a standard set of Slater orbital exponents ¢, for basis
functions centered on particular atoms. For example, the standard exponent
for the 1s basis function of hydrogen is € = 1.24. This is larger than the

= 1.0 exponent of the hydrogen atom, since the hydrogen 1s orbital in
average molecules is known to be “smaller” or “denser” than in the atom.
Using the scaling relation (3.224), the standard STO-3G basis function for
hydrogen becomes,

CGF(C = 1,24, STO-3G) = 0.4446359F(0.168856) + 0.535328FF (0.623913)
+ 0.154329p9F (3.42525)

(3.225)

This is the basis function we will use for H in our following calculations.

3.5.2 STO-3G H,
In Subsection 2.2.5 we presented our minimal basis H, model, which has
only one occupied molecular orbital and one virtual molecular orbital.
With the description of the 1s minimal STO-3G basis set given in the last
subsection we are now in a position to illustrate ab initio Hartree-Fock
calculations on H,. The model is simple but extension to larger basis sets is
relatively straightforward and most of the aspects of Hartree-Fock theory
that we wish to illustrate here are independent of the actual size of the basis
set. Unfortunately, however, the model is too simple to be able to illustrate

the iterative nature of the SCF procedure. In the next subsection we describe
a minimal basis calculation on HeH™*, in order to illustrate this aspect of
Hartree-Fock theory.
In this subsection, we describe restricted closed-shell calculations on the

ground state of H,. As we will see, there is a very basic deficiency in such
calculations at long bond lengths. Later in this chapter, when we describe
unrestricted open-shell calculations, we will return to minimal basis H, and
partially correct this deficiency. Some of the results obtained here will also
be used in later chapters when we use the minimal basis H, model to illustrate procedures that go beyond the Hartree-Fock approximation.
According to the steps involved in an SCF calculation, as outlined in
Subsection 3.4.6, we must first of all choose a geometry for the nuclear frame-

work. We will use the coordinate system of Fig. 2.5 with an internuclear
distance R = {R,,| equal to the experimental value of 1.4 atomic units (Bohr).
Our basis set is the standard STO-3G basis set, consisting of two functions
@, and ¢, where each of these functions is a contraction of three primitive
Gaussians such that each constitutes a least-squares fit to a Slater function

160

MODERN

QUANTUM

CHEMISTRY

with orbital exponent € = 1.24, as previously illustrated in Eq. (3.225). That is,

8
alt) = (C2/my2e

(3.226)

Sr Pal
halt) = (C2 /n)7e7
C= 1.24

It ts important to remember, however, that each basis function has the definite form of (3.225) and that, while the functions approximate Slater functions, there is no approximation being made, other than the Hartree-Fock

approximation, once the basis functions are chosen. The next step in the
SCF calculation involves the evaluation of all integrals over the basis set

{,}, Le, Sy, H30", and the two-electron integrals (uv| Ac). All these integrals

can be evaluated using formulas developed in Appendix A. Consider the
overlap integral,

Sp. = Pde GoOF(r — Ry
PS

— Ry)

(3.227)

Substituting the general contraction (3.212), this integral reduces to the sum
of overlap integrals involving primitive Gaussians. That is,
L

Suv =

far

»

L

L

dFO5.

py»

r— R,)

x

q=

dy PE" (qys

r— R,)

(3.228)

=Pp=1 q=1DY GydaSpq

In a similar manner, if other integrals over primitive Gaussian functions are
evaluated using the methods of Appendix A, they can be summed to give
integrals over any specific contracted function of interest, such as that of
(3.225). One finds that the overlap S,, for the functions ¢, and 2 of minima]
basis H, at R = 1.4 a.u. is 0.6593. The overlap matrix is thus

1.0
S= (6650

0.6593
1.0 )

(3.229)

At longer bond lengths the overlap S,, would decrease towards zero. At
R=O the overlap S,, is, of course, 1.0.
Exercise 3.21 Use definition (3.219) for the STO-1G function and the
scaling relation (3.224) to show that the STO-1G overlap for an orbital
exponent ( = 1.24 at R = 1.4a.u., corresponding to result (3.229), is S,. =
0.6648. Use the formula in Appendix A for overlap integrals. Do not forget
normalization.

THE HARTREE-FOCK APPROXIMATION

161

The elements HjS° of the core-Hamiltonian are the sum of elements

T,, describing the kinetic energy and elements describing the coulomb

attraction of an electron for the first nucleus (V},) and the second nucleus

(V2,). From Appendix A these integrals can be calculated to be

0.7600 0.2365
= (o336s 0 7600)
— 1.2266 —0.5974
i
(casera oas3s)
—0.6538 —05974
2
V = (“O50
“th 2266)

(3.230)

(3.251)

=

o

3

(3.252)

If the basis functions were the hydrogen atom solutions (x) ‘/2e~’, then T, ;
would be 0.5, the kinetic energy of an electron in the hydrogen atom, and

Vi, = V3, would be — 1.0, the potential energy ofan electron in the hydrogen

atom. The present values reflect the larger exponent € = 1.24, which leads
to a “smaller” orbital than in the hydrogen atom. The electron is therefore
closer to the nucleus, leading to a more negative value of the potential energy
(—1.2266), and it “travels faster to avoid collapsing into the nucleus,” leading
to a larger kinetic energy (0.7600). The energy of a hydrogen atom in this

basis is just T,, + V}, = 0.7600 — 1.2266 = —0.4666 a.u. to be compared

with the exact value of —0.5 a.u. If an electron in ¢, were somehow to be
localized exactly at the position of nucleus 1, its attraction for nucleus 2
would be —1/1.4 = —0.7143. The actual value of this attraction, shown in

Fig. 3.4, is Vi, = —0.6538, at R = 1.4 a.u. As the internuclear distance R
increases, Vj, will converge asymptotically to — R~!. The off-diagonal elements
of T and V™" cannot be given such simple classical interpretations and they
constitute the basic quantum mechanical effects of bonding. As the internuclear distance R becomes large, the off-diagonal elements go to zero.
The core-Hamiltonian matrix is the sum of the above three matrices,

He = T EVE 4 vio (

—1.1204
—0.9584

“tie
—1.1204

(3.233)

Figure 3.4 Attraction of an electron for an
adjacent nucleus.

162 MODERN QUANTUM CHEMISTRY

This is the Hamiltonian matrix for a single electron in the field of the nuclei,
in this case for HZ. Solving the matrix eigenvalue problem

HC = SCe

(3.234)

would lead to the orbital energies and molecular orbitals of H}. For other
cases such as H,O, it would lead to the orbitals energies and molecular
orbitals of H,O**, which are not of particular interest.
Of the 2* = 16 possible two-electron integrals (jv|4c) in the minimal
basis model, there are only four unique values,

(616116141) = (6262 (G22) = 0.7746 a.u.

($191 |622) = 0.5697 au.

(6261 |101) = (6262 |62,) = 0.4441 a.u.
(626124) = 0.2970 au.
The

other integrals are related to the above

(3.235)

by simple interchange

of

indices, for example, (yv| Ao) = (uv|o4) = (Ao| uv). The one-center integrals

($191|¢1¢1) and ($,62\¢2.) just represent the average value of the
electron-electron repulsion of two electrons in the same 1s orbital. The twocenter integral (¢,¢, |¢2@,) is the repulsion between an electron in an orbital

on center 1 and an electron in an orbital on center 2. Its value, which is

0.5697 a.u. at R= 14a.u, will tend to 1/R as the internuclear distance R
increases. The other two integrals do not have classical interpretations. They
both go to zero at long bond lengths as the overlap S,, goes to zero. Having
calculated all basic integrals we could proceed to solve Roothaan’s equations
by the procedure we have previously given, ie., guess at the density matrix,
form the Fock matrix, transform the Fock matrix to a basis of orthonormal
orbitals, diagonalize the transformed Fock matrix, etc. Our minimal basis
model for H, is, however, simple enough that the solutions to Roothaan’s
equations are determined by simple symmetry arguments. The canonical

molecular orbitals will form a representation of the point group of the
molecule. That is, for a homonuclear diatomic they can be labeled as having
the symmetry o,, o,, 2,, 7, etc. With our minimal basis set there are only
two molecular orbitals. The lowest energy one willibe the occupied molecular
orbital, a bonding orbital of o, symmetry,

Wi = [2(1 + S12)] 7b, + $2)

(3.236)

The virtual molecular orbital will be the corresponding antibonding combination of o,, symmetry,

We = [201 — $,2)]17 (1 — $2)

(3.237)

.

THE HARTREE-FOCK APPROXIMATION

163

The final coefficient matrix for this problem is, therefore,
,2))])7*'??
S
+
0
2
2
(
_
+ S,2
C= (ot

[20 — S,,)]7'?

(3.238)

—[2(1 _ sn)

and the final density matrix is

4 8y)7*)

— (14+ 8y)7)

egy

p= (his

yaa

Sia

(

fi

4

i)

(3.239)

If a density matrix other than the above were actually used for an initial
guess in the SCF procedure and the iterations carried out, the procedure
would converge to this symmetry determined solution.

Exercise 3.22 Derive the coefficients [2(1+5S,,)]~'? and [2(1 —
S,2)]~'” in the basis function expansion of y, and wy, by requiring y, and

y, to be normalized.

Exercise 3.23 The coefficients of minimal basis HZ are also determined
by symmetry and are identical to those of minimal basis H,. Use the above
result for the coefficients to solve Eq. (3.234) for the orbital energies of

minimal basis H} at R = 1.4 a.u. and show they are

€, = (HS + HSF)/(1 + Sy) = — 1.2528 an.
— HF)/(1 — S14) = —0.4756 a.u.

& = (HS

Exercise 3.24 Use the general definition (3.145) of the density matrix to
derive (3.239). What is the corresponding density matrix for Hj ?

Exercise 3.25 Use the general definition (3.154) of the Fock matrix to
show that the converged values of its elements for minimal basis H, are
Fy, = Fy, = HY

++

+ (bids loi)

S12)" *[5(¢161|¢161) + (¢161|b2¢2)

~ 3(6162|¢1¢2)]

= ~—0.3655 a.u.

Fy = Fa, = HS9° + (L + S42)” "[—3(6161|262) + (6161 |$1¢2)

+ 3(¢162|¢1¢2)] = —0.5939 an.
Exercise 3.26 Use the result of Exercise 3.23 to show that the orbital
energies of minimal basis H,, that are a solution to the Roothaan equations

FC = SCea, are

&, = (Fy, + Fy2)/(l + $12) = —0.5782 a.u.

& = (Fy, — F,2)/A — $,2) = +0.6703 au.

164 MODERN QUANTUM

CHEMISTRY

Exercise 3.27 Use the general result (3.184) for the total electronic
energy to show that the electronic energy of minimal basis H, is
Eo =(Fi, + AST + Fy. + HS)/1 + S,2) = —1.8310 au.
and that the total energy including nuclear repulsion is

Exe: = — 1.1167 a.u.
The results of the last three exercises have described the results of a
minimal basis H, calculation in terms of integrals and matrices evaluated
over members of the basis set {¢,,} rather than over members of the set of
solutions {y,;}. That is how any actual calculation would be performed; the

molecular orbitals y, are not known until the calculation is completed. For
a discussion of the SCF results or for use of the SCF results in subsequent
treatments of correlation effects, it is convenient to transform the basic

integrals in terms of the functions {¢,,} to corresponding integrals in terms
of the functions {y,}. Since we know the relation between the two sets of
functions, i.e.

w=

K

%

H=1

Cid,

1=1,2,...,K

(3.240)

YS CHC, Hi

(3.241)

The transformations proceed as follows

h,, = (Wilh) =

HOY

(Wid |Web) = Y Y Y > CXC, CHC.
Hv

|40)

Ao

(3.242)

The two-index transformation of (3.241) is relatively easy and requires no
more than the multiplication of K x K matrices. The four-index transformation of the two-electron integrals, however, is a very time consuming
process. An optimum algorithm for performing the transformation requires
the O(K*) multiplications. This is an order of K more difficult than any step
in the complete SCF calculation. If the transformed two-electron integrals
are not required, they certainly should not be calculated. On the other hand,
most formulations for proceeding beyond the Hartree-Fock approximation,
and all those considered in this book, require integrals over molecular
orbitals. For our minimal basis H, model, the transformation is, of course,
not difficult. The nonzero transformed elements of the core-Hamiltonian
and two-electron integral matrix that result are
hy

=

(Wilhhy,)

=

Jip =Witkh Iwi)

—1.2528

a.u.

= 0.6746 a.u.

Jiz=With [Yow2) = 0.6636 a.u.

hy

=

(Wally)

=

—0.4756

a.u.

Jo. = (WoW2 (WoW) = 0.6975 a.u.
Ki2=

(Vivo |vov) = 0.1813 a.u.

.

THE HARJREE-FOCK APPROXIMATION

165

As we've described before, h,, is the kinetic energy and nuclear attraction
of an electron in yj, h2, is the same for an electron in W2, J,, is the coulomb
interaction of the two electrons in W,, J. is the coulomb interaction of two

electrons in W>, J,2 is the coulomb interaction of an electron in w, and another electron in wy , and —K,, is the exchange interaction between an

electron in yy, and an electron with the same spin in ¥.
The transformed Fock matrix, f,, = (W,|f|W,) is by definition diagonal,
with diagonal elements equal to the orbital energies. The closed-shell orbital
energies, as derived in Exercise 3.9, are given by

— Ka

(3.243)

+ J), = —0.5782 au.

(3.244)

&) = hy. + 2U,2 — Ky. = +0.6703 au.

(3.245)

6 =h, + ¥ 2
b

For our minimal basis model, these are

&, =hy,

Note that ¢, 4 h,, + J,9, since it is a virtual orbital and describes the energy
of an electron in the (N + 1)-electron system, as discussed in conjunction
with Koopmans’ theorem. Appendix D contains the values of these orbital
energies, as well as the two-electron integrals J,,, etc., as a function of bond
length. Using the values of these integrals it will be possible, here and in later
chapters, to investigate the behavior of a number of many-electron quantities
for H,, as a function of bond length.
The total electronic energy of the ground state is

Eo = 2h, + Jy, = —1.8310 a.u.

(3.246)

The total energy, including nuclear repulsion, is

Ex = Eg + 1/R = — 1.1167 a.u.

(3.247)

Since the energy of a hydrogen atom in this basis is —0.4666 a.u., the predicted

dissociation

energy

of H,

is 2(—0.4666) + 1.1167 = 0.1835 au. =

4.99 eV. This is to be compared with the experimental dissociation energy of
4.75 eV. The agreement is remarkably good: even though the calculated
energy of H, is much above the exact value. there is a compensating inexact
treatment of the hydrogen atom.
The above dissociation energy is in good agreement with experiment,
but to explore fully the dissociation question it is necessary to investigate
the full potential surface. By repeating the above calculations for different
values of the internuclear distance one obtains the potential curve shown in
Fig. 3.5, which is to be compared with the essentially exact results of Kolos
and Wolniewicz.* The minimal basis restricted Hartree-Fock calculation
does not go to the limit of two hydrogen atoms as R goes to infinity. This
result may at first be surprising. This totally incorrect behavior is not specific

166 MODERN QUANTUM CHEMISTRY
a6
0.5

04

3

LS

=ra
a

1

—™

=

ul

03

02

or
0.0

50

60 Rau)

-0.1
-0.2
Figure 3.5 Restricted Hartree-Fock potential curve for STO-3G
the accurate results of Kolos and Wolniewicz.

(¢ = 1.24)H, compared with

to H,. Ifone stretches any bond for which the correct products of dissociation
must be represented by open-shell wave functions, then restricted closedshell calculations must necessarily give the wrong limit. For H, the products
of dissociation are two localized hydrogen

atoms;

that is, one electron is

localized near one of the protons and the other electron is localized near the
other distant proton. In the restricted calculation, however, both electrons
are forced to occupy the same spatial molecular orbital ¥,. This molecular
orbital is symmetry determined, having the form of (3.236). Therefore,
independent of the bond length, both electrons are described by exactly the
same spatial wave function and have the same probability distribution
function in 3-dimensional space. Such a description is inappropriate for two
separated hydrogen atoms. A restricted closed-shell Hartree-Fock calculation, which restricts electrons to occupy molecular orbitals in pairs, cannot,

therefore, properly describe dissociation unless the products of dissociation
are both closed-shells.
We can investigate the dissociation behavior in an analytical way by
using the results of Exercises 3.25 and 3.27. As R — 00, the two-center nuclear

attraction of Fig. 3.4 goes to zero and H%%* + T,, + V},, the energy of a

hydrogen atom in the basis (— 0.4666). All other integrals go to zero as R>
oo, except the one-center electron-electron repulsion integral (¢1¢,|¢1))-

°

THE JIARTREE-FOCK APPROXIMATION

167

One therefore obtains

limit E,..(R) = limit 2H3%° + 3(¢1¢,|¢1¢1)
R>o

R>o

{l

= 2E(H) + 4(¢141|¢1¢1)
—0.9332 + 0.3873

= —0.5459 au.

The limit, rather than being twice the energy of a hydrogen atom in the same
basis (2E(H)), includes the spurious term 3(¢,¢,|¢1¢,). This spurious term
arises because, since both electrons occupy the same spatial orbital, there
remains even at infinity some electron-electron repulsion. Alternatively, the
products of the dissociation are not just 2H-, but also include, incorrectly,
H™ and H*. The energy of H™ includes contributions from the electronelectron repulsion integral (¢,¢1|¢1¢,). Another way of looking at this is
that a molecular orbital wave function is equivalent to a valence bond wave
function in which equal weight is given to covalent terms and ionic terms.
Since the wave function is symmetry determined, the ionic terms remain,
even on dissociation. We will return to the dissociation question when we
consider unrestricted Hartree-Fock calculations.
The poor behavior of restricted closed-shell Hartree-Fock calculations
upon dissociation to open-shell products does not detract from their utility
in the region of equilibrium. The calculated equilibrium geometry is that at
which E,,, is a minimum with respect to the coordinates of the nuclei. Table
3.2 shows the value of this energy for internuclear distances in the vicinity of
the experimental bond length of 1.4 a.u. The calculated minimum energy
occurs at 1.346 a.u. This is in error by 4% and errors of similar magnitude
can be expected for equilibrium geometries of other molecules at this level
of approximation.
Before leaving minimal basis H, (at least, temporarily), we want to use
the model to illustrate exponent optimization. We have been using a standard
exponent of €¢ = 1.24. These orbital exponents are nonlinear parameters upon
which our wave function depends. By the variational principle, the best wave
Table 3.2 Energy of minimal basis STO3G H; as a function of bond length
R (au.)

E, (a.u.)

1.32
1,34
1.36
1.38
1.40

—1.11731
— 1.11750
— 1.11745
—1.11719
—1,11672
Reg = 1.346 au.

168 MODERN QUANTUM CHEMISTRY

Table 3.3 Optimization of the Slater exponent for minimal basis STO-3G H, at
R=1.4

au.

¢

E,. (a-u.)

1.0

— 1.08164

11
1.2
13

~ 1.11089
~ 1.11912
—1,10714

Coptimum = 1.19
function of a given form is the one in which the energy has been minimized
with respect to all wave function parameters. Because the orbital exponents
are nonlinear parameters, however, there is no computationally easy way of
determining their optimum values. Rather than go to the expense of finding
their optimum values by performing many calculations with different orbital
exponents it is common to choose reasonable “standard” values, such as our

STO-3G value of 1.24 for the 1s orbitals of hydrogen. The size of the basis is
increased if greater accuracy is desired. Nevertheless, it is sometimes necessary or desirable to optimize exponents if for no other reason than to determine what a “reasonable” value might be. Table 3.3 shows values of the total
energy for minimal basis H, at R = 1.4 for a range of values of the 1s Slater
exponent ¢. The optimum exponent is 1.19 at R = 1.4 a.u. This optimum value
will change with bond length and will be different for hydrogen atoms in
other molecules.

One

finds, however, that optimum

values for a range of

molecules are commonly larger than 1.0 (the exact hydrogen atom value),
and the standard STO-3G value of 1.24 was chosen as representative of
optimum value in a number of small molecules. The optimum value of 1.19
for H, means that the hydrogen molecule is in a sense “smaller” than the
sum of 2 hydrogen atoms. This is common in chemical bonding—the
attraction of the bonding electrons for two nuclei, rather than one, contracts
the electron cloud.

3.5.3 An SCF Calculation on STO-3G HeH*
The two-electron molecules H, and HeH* are prototypes for homonuclear
and heteronuclear diatomic molecules. We have just finished describing

restricted Hartree-Fock

calculations

on minimal

basis STO-3G

H,,

and

we now do the same for minimal basis STO-3G HeH*. The limitation of
these minimal basis models for describing two-electron systems lies solely
in the basis set. Larger basis sets would lead to correspondingly more
accurate results, but the minimal basis is adequate for illustrating the points
we wish to make. The extension to larger basis sets is straightforward.

THE HARTREE-FOCK APPROXIMATION
8

169

Although the minimal basis sets are very small, one can describe results
that are “exact” within the one-electron space spanned by these basis functions. In particular, using the minimal basis sets, we can explore any number
of different computational approaches and compare the results with the
“exact” results for the same basis. In later chapters we will be using the
same minimal basis STO-3G H, and HeH* models to illustrate configuration
interaction calculations,

perturbation

theory calculations, etc. The

results

obtained there will be compared with the “exact” results for the same basis
and the Hartree-Fock calculations of this chapter.
One of the deficiencies of the minimal basis H, model was that, with
only two basis functions, the molecular orbitals were symmetry determined
and the model could not be used to illustrate the iterative nature of the
SCF procedure. Because HeH* is heteronuclear it has less symmetry than
H, and the molecular orbitals for the minimal basis model are not determined
by symmetry. As such, restricted Hartree-Fock calculations on HeH* provide essentially a complete illustration of the principles involved in solving
the Roothaan equations.
The singly charged helium hydride molecular ion has been known for
many years from mass-spectroscopic studies. It is of interest in astrophysical
problems, as the product of the B decay of HT, in scattering of protons off
helium, and for a number of other reasons associated with its simplicity.
There seems to be, however, little direct experimental evidence for the struc-

ture of its various electronic states. Very accurate calculations by Wolniewicz®
show that its ground state has an equilibrium bond length of 1.4632 a.u. and
an electronic binding energy of 0.0749 a.u. (2.039 eV). The ground state
dissociates to a helium atom and a proton

HeH *(X'X) - He('S) + H*

(3.248)

rather than to He* + H, since the ionization potential of He (24.6 eV) is
larger than

the electron affinity of a proton

(13.6 eV). Alternatively,

the

electron affinity of He* is larger than the electron affinity of H*. The
exact energies of the various species involved are given in Table 3.4. Since
Table 3.4 Exact
species

energy

Species

H*

H
Het
He

HeH* (R = 1.4632 a.u.)

of

H

and

He

Energy (a.u.)

0.0

—-0.5
—2.0
— 2.90372"

— 2.97867"

*C. L. Pekeris, Phys. Rev. 115: 1217 (1959).
> L. Wolniewicz, J. Chem. Phys. 43: 1807 (1965).

170 MODERN QUANTUM CHEMISTRY

the products of dissociation are closed-shells, we expect a restricted Hartree-

Fock calculation to behave correctly at large bond lengths, unlike the behavior exhibited in the case of H>.
To perform an SCF caiculation, we first choose a geometry for the
nuclei. We let the helium nucleus be nucleus 1 with position vector R, and the

hydrogen nucleus be nucleus 2 with position vector R,, so that |R, — R| =

R,.=R
is the internuclear distance. We will use the exact internuclear
distance so that R = 1.4632 a.u. We then need to specify the basis set, which
in our case is the STO-3G minimal basis set consisting of a 1s basis function
on each of the two nuclei,

Oy = (CR/mye7 eR

(3.249)

Salee7PI
ho = (C3/myi2

(3.250)

These basis functions are each a contraction of three primitive Gaussians,

with the contraction coefficients of (3.221), and contraction exponents which

are those of (3.221) scaled by multiplying by the square of either ¢, or £5. It
remains only to specify the Slater exponents {, for He and (, for H. The
standard STO-3G exponent for H in molecular environments is {, = 1.24
which is the value that we used in our minimal basis H, calculations. No
such standard STO-3G exponent for He has been recommended, however.
In choosing exponents for molecular calculations it is common to use exponents obtained by minimizing the energy of a calculation on the isolated
atom using the same basis set. These are sometimes called “best atom”
exponents. For H the best atom exponent is 1.0. If one performs a restricted
Hartree-Fock calculation on the He atom using a basis set consisting of
only one Slater orbital, (¢>/2)'/2e7
", one finds that the best atom exponent is
27/16 = 1.6875. The derivation of the value 27/16 is a common textbook
example’ of the variational principle. Since HeH* has a net positive charge,
we expect, however, that the electron cloud is considerably contracted relative to that for the free atoms He and H. For illustrative purposes we will use
the standard STO-3G value of ¢, = 1.24 for H and let the standard value
for He be €, = 1.6875 x 1.24 = 2.0925 which, like the value for H, is also a
factor of 1.24 larger than the best atom value. Figure 3.6 shows our coordinate
system and basis functions for the HeH* calculation. As described previously,
each of the STO-3G basis functions of Fig. 3.6 or Eqs. (3.249) and (3.250) is
the sum of the three primitive Gaussians.
The next step in our calculation, or most ab initio calculations, is the

evaluation of the required integrals over the set of basis functions. Appendix
A describes how the integrals can be evaluated for 1s Gaussian functions
and gives explicit formulas for all integrals involving only 1s Gaussians.
Appendix B gives a FORTRAN listing, and output for our HeH* case, ofa
small program which illustrates the complete steps involved in solving the
Roothaan equations and which is capable of performing minimal basis

THE HARTREE-FOCK APPROXIMATION

Figure 3.6 Coordinate
calculation.

system

and

basis

functions

for the minimal

basis

STO-3G

171

HeH*

Gaussian calculations on any two-electron diatomic molecule. We will only
give some of the results here and refer the reader to the output or program
in Appendix B, when necessary. From Appendix A, the overlap of the two
basis functions decreases exponentially with the internuclear distance. At
the internuclear distance R = 1.4632 a.u. its value is S,, = S,, = 0.4508.
This overlap is smafier than that in H, mainly because the He orbital is
smaller and more localized than a corresponding H orbital. The overlap
matrix is, therefore,

1.0

$= (Sis0s

0.4508

1.0

)

(3.251)

The kinetic energy matrix is

T= (Caer
0.1670

0.7600)
0.7600

(3.252)

The T,;, value is, of course, identical to that in H, since we are using the
same exponent. The T,, value, which describes the kinetic energy of an
electron in the 1s orbital around He, is much larger than that for H, reflecting
the larger orbital exponent of the He orbital, which in turn reflects the larger

nuclear charge of He. The smafler the average distance of electron from the
nucleus, the larger is its kinetic energy.

172. MODERN QUANTUM CHEMISTRY

The matrix of nuclear attraction energy to nucleus 1 (the He nucleus) is

—4.1398
V = (oT h000
1 _

— 1.1029
13682)

(8.253)

The one-center attraction of an electron in ¢, for its own nucleus (— 4.1398)
is naturally larger in magnitude that the attraction of an electron in the
distant function ¢, for this nucleus (— 1.2652). This last two-center integral
becomes —2/R at large internuclear distances. The off-diagonal element, the
attraction for the helium nucleus of an electron described by the product
distribution ¢,(1)¢,(1), is the quantum mechanical term responsible for
chemical bonding.
The matrix of nuclear attraction energy to nucleus 2 (the H nucleus) is
similar to the above, but smaller in magnitude because of the smaller nuclear
charge of the proton.
—0.6772

2

“= (roars

—0.4113

-

(3.254)

266)

The V3, element is the same as that for H,. The function ¢, with its larger
exponent is relatively localized about the He nucleus and V7, = is close to
its asymptotic value of —1/R = —0.6834.
Having obtained the kinetic energy and nuclear attraction integrals,
we can now form the core-Hamiltonian matrix

Hu

core _

Tv

yi

tweety

2_

2.652
—26527

(cis

—1.1

8)

-1.7318

(3.255)

As we have stated before, this is the correct Hamiltonian matrix for a single
electron in the field of the nuclear point charges. The solution of a Roothaanlike equation for the core-Hamiltonian

H°"°C = SCe

(3.256)

would lead to the molecular orbitals and orbital energies (and, in this case,

total electronic energies) for the one-electron molecule HeH* *. The effect
of electron-electron repulsion on the molecular orbitals and orbital energies,
within the single determinant approximation, is in the matrix G which must
be added to H°* to obtain the Fock matrix F.
The final remaining integrals to be calculated are the two-electron re-

pulsion integrals. Of the 2+ = 16 possible integrals (uv|o), there are only

six unique integrals,

($191]¢1¢1) = 13072 au.

($262|61¢1) = 0.6057 a.u.

($2¢1| 144)

(¢262|6261)

= 0.4373 au.

= 0.3118 a.u.

($2612) = 0.1773 au. — ($262| 262) = 0.7746 a.u.

THE HARTREE-FOCK APPROXIMATION

173

The one-center integrals (¢,¢,|¢1,) and (¢2¢2|¢2¢2) are the repulsions

between an electron in ¢, (or ¢2) and another electron in the same*orbital
¢, (or $2). The average distance between two electrons in the “smaller”
function @, is less than that between two electrons in the “larger” and more
diffuse function $2, and thus (¢,¢,|¢1¢,) is larger than ($,62|¢2¢2). The
two-center integral (¢2¢2|61¢1) is the repulsion between an electron in
@, and an electron in ¢,. This has the asymptotic value 1/R as the internuclear distance becomes large. The other three integrals do not have simple
classical interpretations.

We now have all the integrals needed for our SCF calculation on HeH*.

Prior to beginning the iterations, however, we need to derive a transformation
matrix to orthonormal basis functions,

$, => Xd,

(3.257)

There are many transformations X that we might use to derive an ortho-

normal set of functions {¢j,}. The Schmidt procedure, discussed in Chapter
1, uses the following matrix

miatidt = (,1
XechSchm

(1.0 + —0.5052030
S7,)2"?\ __ 0.0
— ,)'
,/(1_ S$2
—S,v/a
1.1

3

258)

Exercise 3.28 Show that the above transformation produces orthonormal basis functions.

Two other orthonormalization procedures, that we have previously
described, require diagonalizing the overlap matrix. Diagonalizing a 2 x 2
matrix can be accomplished by the methods outlined in Subsection 1.1.6.
For the overlap matrix, the eigenvalues are simply s, = 1 + S,, = 1.4508
and s, = 1 — $,, = 0.5492. The unitary matrix which performs the diagonalization is

U=

2“12

(5

py

_pay-4e

(3.259)

To derive the symmetric and canonical orthogonalization transformations
we need the matrix

.

-1/2 _(%1 p29

0.8302 0.0
ain) (Co
153)

( 0

_

260

(8.260)

Symmetric orthogonalization then uses the transformation matrix
xX

= eo

symmetric = S

l/2

Use

-1/2qst

—

1.0898

(_cos96

—0,.2596

1.0898

)

(3.261)

174 MODERN QUANTUM CHEMISTRY

(a) Schmidt

(b) symmetric

4%
(¢) cananical

Figure 3.7 Three orthogonalization procedures:
a) Schmidt; b) symmetric; c) canonical.

whereas, Canonical orthogonalization uses the transformation matrix
Xcanonicat = Us

Wer 1/2 —

0.5871

0.9541

(ser

post)

(3.262)

The relationship between these three orthogonalizations is shown in Fig.
3.7. The angle @ between the original basis functions is given by cos @ = S,>.
Schmidt orthogonalization leaves the first basis function alone and produces
a second orthogonal to it. Symmetric orthogonalization produces two new
functions, which most closely resemble the original basis functions. It does
this by opening up the angle between the vectors to 90°. Canonical orthogonalization produces one vector which bisects the angle between the original
vectors and a second vector orthogonal to the first. We will use canonical
orthogonalization so that the transformed basis functions are

¢', = 0.58716, + 0.58714,
$', = 0.95416, — 0.9541¢,

(3.263)
(3.264)

We are now ready to begin the SCF iteration procedure. We first need
an initial guess at the density matrix. It is convenient to use the null matrix.
This is equivalent to neglecting all electron-electron interaction (setting G
equal to the null matrix) and using the core-Hamiltonian as a first guess at
the Fock matrix

core. (~ 26527
Fou
= (cian

— 1.3472
“ins)

(3.265)

THE HARTREE-FOCK APPROXIMATION

175

This is the easiest initial guess to obtain, but may be a poor one in more
complicated situations. The next step is to transform the Fock matrix to the
canonically orthonormalized basis set.

~—2,.4397
F’ = X'FX -(
—0.5158

— 13387)
— 1.5387

(3.266)

Diagonalizing this matrix, Le., solving

FC =Ce

(3.267)

gives a unitary matrix of coefficients

_

{0.9104

=

— 2.6741

C= (Catse

0.4136

patos)

(3.268)

and two eigenvalues

.

( 00

0.0

- 083)

269

(3.269)

The coefficients of the original basis functions are then

0.9291
C=xC=
(Casoe

—0.6259
vans)

(

3.270

)

Equations (3.270) and (3.269) gives the orbitals and orbital energies of
HeH* *, which we are using as a first guess at the orbitals and orbital energies
of HeH*. Note that the lowest molecular orbital y, is composed mainly of
¢, (coefficient = 0.9291) with only a little mixing of ¢, (coefficient = 0.1398).
With no electron-electron repulsion the electrons tend to congregate near the
He nucleus with its higher nuclear charge. The effect of adding electron-

electron repulsion, as we iterate further, will be to moderate this effect and
“smear” the electrons out a bit, so as to decrease the electron-electron
repulsion.

From (3.270) we can now form our first real guess at the density matrix

_= (nr

0.2599

00)
0.0391

271
(3.271)

The diagonal elements of P show (only qualitatively) how most of the electron
density is in the vicinity of the He rather than the H nucleus. A better appreciation of this would be obtained by a population analysis. The density
matrix of (3.271) is not that of HeH* * (it differs by a factor of 2) but that of
two noninteracting electrons in the field of the nuclei.
From P we can now form a guess at G,

G= (3740
0.3740

09890)
0.9890

272
(3.272)

176

MODERN QUANTUM

CHEMISTRY

and a new Fock matrix

F-H""4G= (- 1.3904

“oer

—0.9732

—0.7429

(3.273)

Because of the positive electron-electron interaction, represented by the
positive elements of the matrix G of (3.272), the elements of this new Fock
matrix are considerably less negative than our original core-Hamiltonian
guess (3.265). We can now solve the eigenvalue problem with this latest
Fock matrix to get a new guess at C and P, and repeat the whole procedure
until self-consistency is obtained. Appendix B contains a program for doing
this, and the program output for our current example of minimal basis STO3G HeH*. This output should be followed in conjunction with our description here.
Table 3.5 shows the elements of the density matrix and the corresponding
electronic energy as a function of the iteration number. As the iterations
proceed, charge builds up around H and decreases around He. To provide

a variational value of the energy at each iteration, the formula

1
Ey = > Y Y Py AAiy
“wy

+ Fy)

(3.274)

must use the same density matrix P as was used to form F. Thus the energy
should be calculated immediately after forming a new F, not immediately
after forming a new P. Table 3.5 shows the energy converging monotonically
from above. Because the energy is a variational quantity, the relative error
in the energy is less than that in the wave function or density matrix.
The final wave function and orbital energies are

0.8019

—0.7823

-15975

0.0

c= (Cssce

Table 3.5 Density

068)

.~ ( 0.0

017)

and

energy

matrix

electronic

during the iterative process (STO-3G HeH*)
Iteration

Pu

Pi

P»,

Ey (a.u.)

1

1.7266

0.2599

0.0391

—4.141863

2
3

1.3342
1.2899

0.5166
= 0.5384 =

0.2000
0.2247

— 4.226492
—4.227523

5
6

1.2862
1.2861

0.5402
0.5402

=—-0.2269
0.2269

—4.227529
—4,227529

4

1.2864

0.5400

0.2267

~4.227529

(3.275)

(3.276)

THE HARTREE-FOCK APPROXIMATION

177

The lowest orbital, the occupied orbital y,, is a bonding orbital as
evidenced by the same sign for the two coefficients. It is still composed
mainly of the He function ¢,. The virtual orbital y, is an antibonding orbital
with opposite signs for the coefficients. It has a heavier weight for the H
function @, as is necessary if it is to be orthogonal to y,. Koopmans’ theorem
allows us to predict an ionization potential and electron affinity. The predicted ionization potential is large (1.5975 a.u. = 43.5 eV) as should be the
case for a cationic species. The predicted electron affinity (0.0617 au. =
1.7 eV) is positive, and the calculation predicts that HeH* will bind an

electron. This does not mean that HeH

dissociation products of HeH*

will be a stable molecule, since the

(i.e., He + H*) bind an electron much

more strongly (the electron affinity of H* is greater than the sum of the
electron affinity and the dissociation energy of HeH*).
A Mulliken population analysis can be obtained from the diagonal elements of PS. Such a population analysis associates 1.53 electrons with ¢,
and 0.47 electrons with ¢2. The net charge is then + 0.47 on He and +0.53
on H. The formal charge of +1 is thus predicted to be divided more or less
equally between the two atoms. A Lowdin population analysis can be obtained from the primed matrices, that is, the matrices associated with the

orthonormal basis {¢j,}. The number of electrons associated with the hy-

drogen orbital is

P43, = (S'/?PS"/”),, = 2(S"7C)?, = 0.5273

(3.277)

This predicts a similar separation of charge, with net charges of + 0.53 and
+0.47 on the He and H, respectively. Note the reversal.
The total energy of HeH* is obtained by adding the nuclear repulsion
2/R to the electronic energy, to give — 2.860662 a.u. From our basic integrals
it is also possible to determine the energies of H, He*, and He. The energy
of the H atom in this basis is the same as that used in the H, calculation,

ie, T2, + V2. = —0.4666 a.u. The energy of the one-electron atom He*

in the basis is similarly T,, + Vi, = — 1.9755 au. The He atom has two
electrons in @, and, in addition to the kinetic energy and attraction to the
helium nucleus, the energy contains a contribution from the electron-electron
repulsion of the two electrons. The He atom energy is thus 2(T,, + V},) +
($1¢1{611). These energies are shown in Table 3.6 for comparison with
exact results in Table 3.4.
From the results in Table 3.6 it is possible to calculate dissociation
energies for the processes
HeH* > He + H*

AE = 0.2168 a.u.

(3.278)

HeH* > He* +H

AE = 0.4168 a.u.

(3.279)

The calculations correctly predict that HeH*

shells He + H*

will dissociate to the closed-

rather than the open shells He* + H. The dissociation

energy of 0.2168 a.u. = 5.90 eV is quite a bit larger than the correct value

178 MODERN QUANTUM CHEMISTRY

Table 3.6 Energies for H and He species
with the STO-3G basis set (¢, = 2.0925,
¢, = 1.24)

Ht
H
Het
He
HeH*

Species

Energy (a u.)

(R = 1.4632 a.u.)

0.0
—0.466582
— 1.975514
—2.643876
— 2.860662

of 2.04 eV. This is mainly because our He exponent of 2.0925, while reasonable for the HeH* molecule, is quite a bit larger than the best value of 1.6875
for the dissociation product, the He atom. The He energy is tco high, relative to the HeH* energy.
Figure 3.8 shows the whole potential curve for our standard exponents,
and also shows .he essentially exact results of Wolniewicz. The calculated
STO-3G equilibrium bond length is 1.3782 a.u., which is in fair agreement
with the accurate results, even though the well depth is much too large.
Unlike the difficulty encountered in H, (Fig. 3.5), the dissociation behavior
0.8
0.7
06

3=

0.5

i

03

2
\

o4

=~

02

a

o.l

=

Ct©O
Exact

(Wolnewicz)
20

-0.0
05

“0.1

25

30

3.5 Rau)

~~

-0.2
-03
Figure 3.8 Restricted Hartree-Fock potential curve for STO-3G (Cy, = 2.0925, (,, = 1.24)HeH*
compared with the accurate results of Wolniewicz.

THE HARTREE-FOCK APPROXIMATION

179

is correct since the products of dissociation are closed shells. We can look
at this dissociation analytically as we did for H,. As the bond length is
stretched, the coefficient of g; in yw, increases and the coefficient of @2 in Wy,
decreases. The electrons concentrate more and more at ound the He nucleus.
In the limit, yy, becomes just ¢,. The virtual orbital y2, to be orthogonal to
y/,, correspondingly becomes pure 5, that is

10
=
Cre (Co

00
9)

3.2
(6.280)

The corresponding density matrix is

2.0

Pro =(Co

0.0

a0)

(3.281)

The total electronic energy as R > co can be evaluated by setting all twocenter integrals to zero. The only remaining integrals are T,,, T22, V11, V32,

($161| 6161), and (¢262|$262)-

Exercise 3.29 Use expression (3.184) for the electronic energy, expression (3.154) for the Fock matrix, and the asymptotic density matrix (3.281)
to show that
E,(R > 0) = 27;, + 2Vi, + (611|P1¢1)
This is just the proper energy of the He atom, for the minimal
discussed previously in the text.

basis, as

The calculations on HeH* described here used a standard set of exponents. A better procedure would have been to optimize exponents at each

internuclear distance. If we had done so, the He exponent €, would have
decreased towards the best atom value of 1.6875 as we increased R. The
value of the H exponent would have decreased to zero at large R (since in

the products of dissociation both electrons reside on the He, the only way
the H basis function can contribute at large R is by being extremely diffuse
and extending over to the region of the He nucleus). Since there are only two
exponents in this problem, it would have been reasonably easy to optimize
exponents, for example, just by iteratively optimizing each one in sequence.
In the general problem, with many orbital exponents, finding a minimum

involves searches on a many-dimensional surface with possibly many local
minima. One does not routinely optimize exponents in these larger problems.

Having described restricted closed-shell Hartree-Fock calculations in
conjunction with the H, and HeH* model systems, we now want to illustrate
the results of more realistic calculations on polyatomic molecules. We do
this not to provide a review of current calculations, but rather to illustrate
the main ideas behind all calculations of the closed-shell restricted HartreeFock type, and to provide some feeling and intuition for how well (or how

180 MODERN QUANTUM CHEMISTRY

badly) such calculations compare with experiment. We will restrict our calculations to H,, Nz. and CO and molecules in the ten-electron series CH,4,
NH, H,O, and FH. For each of these we will use a hierarchy of well-defined
basis sets. Prior to describing the results of such calculations, however, we
need to discuss the general question of polyatomic basis sets and describe
the specific basis sets we will be using.

3.6 POLYATOMIC

BASIS SETS

There are probably as many basis sets defined for polyatomic calculations
as there are quantum chemists. The choice of a basis set is not nearly the
black art, however, that it may first appear. In our sample calculations we
will use a reasonably well-defined hierarchy of basis sets starting with a
minimal STO-3G basis and proceeding through the 4-31G basis, which
effectively doubles the number of functions, the 6-31G* basis, which adds
d-type functions to heavy atoms C, N, O, and F and finally, the 6-31G**
basis, which, in addition to d-type functions for heavy atoms, adds p-type
functions to hydrogen. By performing electronic structure calculations on a
small variety of molecules, using this hierarchy of basis sets, it is possible to
gain some insight into the size and characteristics of a basis set needed to
obtain a given level of calculational accuracy.
The above basis sets have been introduced by Pople and collaborators
(see Hehre et al. in Further Reading at the end of this chapter) and have
been used extensively, by a number of workers for calculations on a large
variety of molecules. Apart from a few instances, all the calculations in this

book use the STO-3G, 4-31G, 6-31G", and 6-31G"" hierarchy of basis
sets. By restricting our example calculations to a very limited set of mol-

ecules and the above basis sets, we are attempting to illustrate in a systematic way how specific attributes of a basis set affect calculated quantities.
We are not attempting to provide a general review of current calculations.
Such a review would be out of date very quickly. While the basis sets we use
are not necessarily optimum, and may themselves be out of date shortly,
they do have characteristics that can be used to illustrate all basis sets.
Our purpose in this section is to explicitly define the STO-3G, 4-31G,
6-31G*, and 6-31G** basis sets that we will be using in this and subsequent
chapters. In the process, however, we will describe attributes that are characteristic of most of the basis sets that are in current use, and we will introduce
some of the notation and some of the mechanics of defining and choosing a
basis set. In particular, we first present a general treatment of contraction.
3.6.1

Contracted Gaussian Functions

In Subsection 3.5.1, when we defined the 1s STO-3G

basis set of our model

calculations, we indicated some of the ideas pertinent to the concept of contraction. We review these briefly. There are two main considerations in the

THE HARTREE-FOCK APPROXIMATION

181

choice of a basis. The first is that one desires to use the most efficient and
accurate functions possible, in the sense that the expansion

We=

K

y Cui yp
i

(3.282)

will require the fewest possible terms for an accurate representation of the
molecular orbitals y;. From this consideration, Slater functions are better
than Gaussian functions. The second consideration in the choice of a basis
set is the speed of two-electron integral evaluation. Here Gaussian functions
have the advantage. By tsing a basis set of contracted Gaussian functions
one can in a Sense have one’s cake and eat it too. In this procedure, one lets
each basis function be a fixed linear combination (contraction) of Gaussian

functions (primitives). Prior to a calculation one chooses the exponents of
the primitives and the contraction coefficients so as to lead to basis functions
with desired qualities. The contracted basis functions might be chosen to
approximate Slater functions, Hartree-Fock atomic orbitals, or any other
set of functions desired. Integrals involving such basis functions reduce to
sums of integrals involving the primitive Gaussian functions. Even though
many primitive integrals may need to be calculated for each basis function
integral, the basis function integrals will be rapidly calculated provided the
method of computing primitive integrals is very fast.
To avoid confusion with a multitude of ¢’s we will use the symbol g
here for a normalized Gaussian function. A contraction thus has the form.
L

oe F(r — Ry) = a» douG A% pu» ¥ — Rp)

(3.283)

where «,,, and d,,, are the contraction exponents and coefficients and L is
the length of the contraction. The normalized Gaussian primitive functions
are of the 1s, 2p, 3d, . . . type,

gia, 0) = (803/23)! 4e-@"
Gop, ¥) = (12809/203)'/4xe"

(3.284)
(3.285)

934,,(% 0) = (204807 /13)!4xye7 2”

(3.286)

The simplifications that occur for integral evaluation using these functions
do not appear for the 2s, 3p, .... Gaussians, and so any basis function of s
symmetry, for example a 2s or 3s Slater function, will be expanded in only
1s Gaussians, with similar restrictions on the other symmetry

types. The

origins Rp of the primitives in (3.283) are almost always equal to R,. Different

origins for the primitives in a contraction are used only with Gaussian lobe
basis sets. In these basis sets one approximates s, p, d, .. . functions as com-

binations of spherical 1s Gaussians (lobes) placed appropriately in space.
For example, a 2p Gaussian orbital can be approximated as closely as desired

182 MODERN QUANTUM CHEMISTRY

by two 1s Gaussian lobes of opposite sign placed an infinitesimal distance
apart. We will not be concerned with Gaussian lobes here.
A common way of determining contractions is from the results of atomic
SCF calculations. In these atomic calculations one uses a relatively large

basis of uncontracted Gaussians, optimizes all exponents, and determines
the SCF coefficients of each of the derived atomic orbitals. The optimized
exponents and SCF coefficients.can then be used to derive suitable contraction exponents and contraction coefficients for a smaller basis set to be used

in subsequent molecular calculations. Let us first illustrate this with s-type
basis functions for hydrogen. Huzinaga® has determined coefficients and
exponents of Gaussian expansions that minimize the energy of a hydrogen
atom. With four Gaussian functions he obtains

W1, = 0.50907g, (0.123317, r) + 0.474499) (0.453757, r)
+ 0.13424g,,(2.01330, r) + 0.01906g,,(13.3615.r)

(3.287)

The basis set is an uncontracted basis consisting of four functions of s-type
symmetry, ie., it is a (4s) basis. A contracted basis set derived from this
would use the four Gaussian functions as primitives and contract them to
reduce the number of basis functions. There are a number of ways the above
four primitives might be contracted. One usually uses disjoint subsets of
primitives so that no primitive appears in more than one basis function.
From evidence on molecular calculations, it appears that a useful contraction scheme is one which leaves the most diffuse primitive uncontracted and
contracts the remaining three primitives into one basis function, with contraction coefficients just equal to the above coefficients (SCF coefficients in
the general case). That is,

(rt) = g;,(0.123317, r)
(3.288)
bolt) = N[0.47449g
; (0.453757, r) + 0.13424g, ,(2.01330, r)
, (13.3615, r)]
+ 0.01906g
= 0.817238g,,(0.453757, r) + 0.231208g,,(2.01330, r)
+ 0.032828g,,(13.3615, r)
(3.289)
In the last equation, the contraction coefficients have been properly renormalized. This scheme leads to a contracted basis set of two s-type functions,

ie, a [2s] contracted basis set, coming from a (4s) uncontracted basis set.
This defines a (4s)/[2s] contraction.

Huzinaga also determined relatively large uncontracted Gaussian (9s5p)
basis sets, with optimized exponents, for the first-row atoms Li to Ne.
Dunning? has suggested useful contractions of these. As an example of the
procedure, consider a [3s2p] contracted basis for the oxygen atom. We are
going to contract the nine primitives of s type into three basis functions. On
inspecting the atomic SCF calculation we find that one of the nine primitives

THE HARTREE-FOCK APPROXIMATION

183

contributes strongly to both the 1s and 2s orbitals of the oxygen atom; this
function is left uncontracted.

lt) = 91s(9.5322, r)

(3.290)

The two primitives, which are most diffuse, make a negligible contribution
to the 1s atomic orbital but are the chief contributors to the 2s atomic orbital.
They are contracted to give the second basis function,

o2(r) = N[0.59566g,,(0.9398, r) + 0.525769 ,,(0.2846, r)]
= 0.563459g, (0.9398, r) + 0.497338g,,(0.2846, r)

(3.291)

where 0.59566 and 0.52576 are the coefficients of these primitives in the 2s
atomic orbital of the atomic SCF calculation. The last basis function consist
of the remainder of the nine primitives,
$3(r) = N[0.14017g,,(3.4136, r) + 0.35555g,,(27.1836, r)
+ 0.143899, (81.1696, r} + 0.042879, (273.188, r)
+ 0.008979, (1175.82, r)+ 0.00118g,,(7816.54, r)]
= 0.241205g,,(3.4136, r) + 0.611832g,,(27.1836, r)
, (81.1696, r) + 0.07377191,(273.188, r)
+ 0.247606g
+ 0.015436g, (1175.82, r) + 0.002031g1,(7816.54, r)

(3.292)

where 0.14017, 0.35555, etc, are the coefficients of these primitives in the 1s
atomic orbital of the atomic SCF calculation.
In a similar way, the five primitives of p-type symmetry are contracted
to two basis functions. Here the most diffuse p-function is left uncontracted,

Gilt) = g2,(0.2137, r)

(3.293)

and the remaining four primitives are contracted using the SCF coefficients
of the 2p atomic orbital

2(t)= N[0.49376g>,(0.7171, r) +.0.31066g2,(2-3051, r)
+0.09774g2,(7-9040, r) +-0.01541g, (35.1832, r)]
=0.627375g,,(0.71706, x) +0.394727g>,(2.30512, r)
+0.124189g.,(7.90403, r) +0.019580g2,(35.1835, r)

(3.294)

This (9s5p)/[3s2p] contraction reduces the number of basis functions
from 24 to 9. Remember the p,, p,, and p, are included for each p orbital
exponent. A calculation with either basis set would give almost identical
results in a calculation on the oxygen atom, however. The loss of variational
flexibility in molecular calculations is not extreme either. For example, a
calculation on the water molecule using the fully uncontracted (9s5p/4s)°

basis set gives an energy of — 76.0133, whereas the [3s2p/2s] contracted
basis gives an energy of — 76.0080, only 0.007% above the much larger
calculation. Because the cost of an SCF calculation increases with the fourth

184

MODERN

QUANTUM

CHEMISTRY

power of the number of basis functions, the reduction from 32 functions to
13 furctions is impressive.
3.6.2

Minimal Basis Sets: STO-3G

A minimal basis set is a relatively inexpensive one, which can be used for
calculations on quite large molecules. It is minimal in the sense of having
the least number of functions per atom required to describe the occupied

atomic orbitals of that atom. This is not quite accurate, since one usually
considers 1s, 2s and 2p, i.e. five functions, to constitute a minimal basis
set for Li and Be, for example, even though the 2p orbital is not occupied in

these atoms. The 2sp (2s and 2p), 3sp, 4sp, 3d, ..., etc. shells are considered
together. The minimal basis set thus consists of 1 function for H and He,
5 functions for Li to Ne, 9 functions for Na to Ar, 13 functions for K and Ca,

18 functions for Sc to Kr, ... , etc. Because the minimal basis set is so small,

it is not one which can lead to quantitatively accurate results. It does,
however, contain the essentials of chemical bonding and many useful qualitative results can be obtained with it.
Because of the small number

of functions in a minimal basis set, it is

particularly important that these functions be of near optimum form. This
immediately rules out a single Gaussian function. One would prefer to use
Slater functions or functions that closely resemble the known shape of
atomic orbitals. A significant advance in minimal basis calculations came
with the development of computer programs like “Gaussian 70,” which
could reproduce the results of minimal basis Slater orbital calculations using
contracted Gaussian functions. The STO-LG method uses a contraction of
L primitive Gaussians for each basis function, where the contraction coefficients and exponents are chosen so that the basis functions approximate
Slater functions. We have already discussed the 1s STO-3G basis set in
Subsection 3.5.1.
The calculations in this book are restricted to a smal number of molecules, all of which include only the first row atoms up to fluorine Although
the STO-LG method has been extended to second row atoms, we will only
consider its formulation, and the formulation of the other basis sets which

follow, for first row atoms and, in particular, for H, C, N, O, and F. We are
therefore interested in the expansion of the 1s, 2s, and 2p Slater functions in
a set of primitive Gaussians
L

tC

= 1.0) =

> 4, 1sG1s(%i,15)
i=1
L

(3.295)

oe FC = 1.0) =

Y 4; 259 15(%i,2sp)
i=l
L

(3.296)

d

(3.297)

oser(c

= 1.0) =

4; 2pG2pl%i,2sp)

THE HARTREE-FOCK APPROXIMATION

185

where the contraction coefficients (d’s) and exponents (a’s) are to be obtained
by a least-squares fit which minimizes the integrals

Jar Cosy— o6SF@)P
and

fae [ote— o59Fm? + far Lo%l0— o59"0P
One of the unique aspects of the STO-LG method and the fitting procedure

is the sharing of contraction exponents in 2sp, 3sp,... shells. Thus the
exponents in (3.296) and (3.297) are constrained to be identical and the 28 and

2p fits are performed simultaneously as indicated by the second integral
above. The reason for this constraint is that if 2s and 2p functions have the
same exponents, then they have the same radial behavior, and during the
radial part of the integral evaluation they can be treated as one function.
That is, all integrals involving any sp shell are treated together and one
radial integration is sufficient for up to 256 = 4* separate integrals. This
grouping of basis functions by shells with shared exponents leads to considerable efficiency in integral evaluation. The general STO-LG procedure
uses contraction lengths up to L = 6. The longer the length of the contraction,
however, the more time is spent in integral evaluation. It has been empirically
determined that a contraction of length 3 is sufficient to lead to calculated
properties that reproduce essentially all the valence features of a Slater
calculation, and STO-3G has become the de facto standard for minimal
basis calculations. Table 3.7 gives the STO-3G contraction exponents and
coefficients of Eqs. (3.295) and (3.297). In the general notation, the STO-3G

contraction is (6s3p/3s)/[2s1p/1s].

Once the least-squares fits to Slater functions with orbital exponents

¢ = 1.0 (Table 3.7) are available, fits to Slater functions with other orbital

exponents can be obtained by simply multiplying the o’s in (3.295) to (3.297)
by (7. It remains to be determined what Slater orbital exponents ¢ to use in
electronic structure calculations. Two possibilities might be to use “best
atom” exponents (¢ = 1.0 for H, for example) or to optimize exponents in
each calculation. The “best atom” exponents might be rather a poor choice

Table 3.7 STO-3G contraction exponents and coefficients
for 1s, 2s, and 2p basis functions
1,

ais

Isp

do.

a2,

0.109818
0.405771

0.444635
0.535328

0.0751386
0.231031

0.700115
0.399513

0.391957
0.607684

2.22766

0.154329

0.994203

—0.0999672

0.155916

186 MODERN QUANTUM CHEMISTRY

Table 3.8 Standard

STO-3G

exponents

Atom

fis

Casp

H
Li
Be
B
Cc
N
Oo
F

1.24
2.69
3.68
4.68
5.67
6.67
7.66
8.65

—
0.75
1.10
1.45
1.72
1.95
2.25
2.55

for molecular environments, and optimization of nonlinear exponents is
not practical for large molecules, where the dimension of the space to be
searched is very large. A compromise is to use a set of standard exponents
which are the average values of exponents optimized for a set of small molecules. The recommended STO-3G exponents are shown in Table 3.8.
The STO-LG basis is not the only possible minimal basis of course.
Stewart,'! for example, has determined fits of contracted Gaussian functions
to individual Slater functions, without the constraint of sharing exponents
in a shell. Rather than use Slater functions or fits to Slater functions, a
reasonable choice is contracted basis functions which closely approximate
the individually determined Hartree-Fock atomic orbitals of the atom.
Calculations suggest, however, that Slater functions with near optimum
exponents are better than these Hartree-Fock atomic orbitals for a minimal
basis; orbitals in molecules may be rather different than those in the constituent atoms.

3.6.3

Double Zeta Basis Sets: 4-31G

A minimal basis set has rather limited variational flexibility particularly if
exponents are not optimized. The first step in improving upon the minimal
basis set involves using two functions for each of the minimal basis functions—a double zeta basis set. The best orbital exponents of the two functions
are commonly slightly above and slightly below the optimal exponent of the
minimal basis function. This allows effective expansion or “contraction” of
the basis functions by variation of linear parameters rather than nonlinear
exponents. The SCF procedure will weight either the coefficient of the dense
or diffuse component according to whether the molecular environment
requires the effective orbital to be expanded or “contracted.” In addition,
an extra degree of anisotropy is allowed relative to an STO-3G basis since,
for example, p orbitals in different directions can have effectively different
sizes.

THE HARTREE-FOCK APPROXIMATION

187

The 4-31G basis set is not exactly a double zeta basis since only the
valence functions are doubled and a single function is still used for each
inner shell orbital. It may be termed a split valence shell basis set. The inner
shells contribute little to most chemical properties and usually vary only
slightly from molecule to molecule. Not splitting the inner shell functions
has some effect on the total energy, but little effect on dipole moments,
valence ionization potentials, charge densities, dissociation energies, and
most other calculated quantities of chemical interest. The 4-31G basis thus
consists of 2 functions for H and He, 9 functions for Li to Ne,“13 functions
for Na to Ar, ..., etc. For hydrogen the contractions are
=

¢15(8)

x

d;, isG1s(%j,15» r)

Pis(t) = Gis(Ois, ¥)

(3.298)

(3.299)

The outer hydrogen function 4, is uncontracted and the inner hydrogen
function ¢{, is a contraction of three primitive Gaussians. Apart from small
numerical differences in deriving the contraction coefficients and exponents,
the above basis functions are identical to the (4s)/[2s] functions of (3.288)
and (3.289). That is, the 4-31G basis is not fit to any particular functional
form but is derived by choosing the form of the contraction and then minimizing the energy of an atomic calculation by varying the contraction
coefficients and exponents. The 4-31G acronym implies that the valence
basis functions are contractions of three primitive Gaussians (the inner
function) and one primitive Gaussian (the outer function), whereas the inner
shell functions are contractions of four primitive Gaussians. Hydrogen, of
course, does not have inner shells.
For the atoms Li to F, the contractions are
4

As in the STO-3G

¢i,(¥)

=

2X

dh isG1s(i,1s5 r)

(3.300)

2,(r)

=

x

d; 2s91s(%, 2sp? r)

(3.301)

35(¥)

—
=

G1s(&2sp> r)

(3.302)

2,{t)

=

x

(3.303)

o,(t)

=

Gap Oops r)

dj 2p92p(%, 2sp> r)

(3.304)

basis, the 2s and 2p functions share exponents for

computational efficiency. Given the above functional forms, the contraction

coefficients d,,, d5,, d3,, d2,, and d3, and the contraction exponents «,,,
Msp and a5, were explicitly varied “until the energy of an atomic SCF
calculation reached a minimum. Unlike the STO-3G basis, which was

188 MODERN QUANTUM CHEMISTRY

Table 3.9 Standard
scale factors

4-31G

valence

shell

Atom

¢

c"

H
Cc
N
Oo
F

1.20
1.00
0.99
0.99
1.00

1.15
1.04
0.98
0.98
1.00

obtained by a least-squares fit to known functions, or a general contraction
scheme based on contraction of previously determined uncontracted atomic
calculations, the 4-31G basis sets were determined by choosing the specific
form (3.300) to (3.304) for the contractions and then optimizing all contraction parameters. That is, the basis set was obtained by contraction first, then
optimization, as opposed to optimization first, then contraction. In our
general notation, the 4-31G contraction is written as (8s4p/4s)/[3s2p/2s].

The basis consists of inner shell functions, inner valence functions, and outer
valence functions. These are contractions of 4, 3, and 1 primitive functions,

respectively.

Since the basis set is obtained from atomic calculations, it is still desirable
to scale exponents for the molecular environment. This is accomplished by
defining an inner valence scale factor ¢’ and an outer valence scale factor ¢”

and multiplying the corresponding inner and outer o’s by the square of these
factors. Only the valence shells are scaled. Table 3.9 gives a set of standard
4-31G scale factors. Only those for H differ significantly from unity, although
the outer carbon functions are somewhat denser than in the atom.

Exercise 3.30 A 4-31G basis for He has not been officially defined.
Huzinaga,® however, in an SCF calculation on the He atom using four
uncontracted 1s Gaussians, found the coefficients and optimum exponents
of the normalized 1s orbital of He to be
Oye

Cui

0.298073

0.51380

1.242567
5.782948

0.46954
0.15457

38.47497

0.02373

Use the expression for overlaps given in Appendix A to derive the contraction
parameters for a 4-31G He basis set.

THE HARTREE-FOCK APPROXIMATION

189

3.6.4 Polarized Basis Sets: 6-31G* and 6-31G**
The next step in improving a basis set could be to go to triple zeta, quadruple
zeta, etc. If one goes in this direction rather than adding functions of higher
angular quantum number, the basis set would not be well balanced. In the
limit of a large number of only s and p functions, one finds, for example,
that the equilibrium geometry of ammonia actually becomes planar. The
next step beyond double zeta usually involves adding polarization functions,
i.e., adding d-type functions to the first row atoms Li-F and p-type functions
to H. To see why these are called polarization functions, consider the hydrogen atom. The exact wave function for an isolated hydrogen atom is
Just the 1s orbital. If the hydrogen atom is placed in a uniform electric field,
however, the electron cloud is attracted to the direction of the electric field,
and the charge distribution about the nucleus becomes asymmetric. It is
polarized. The lowest order solution to this problem is a mixture of the
original 1s orbital and a p-type function, i.e. the solution can be considered
to be a hybridized orbital. A hydrogen atom in a molecule experiences a
similar, but nonuniform, electric field arising from its nonspherical environment. By adding polarization functions, i.e., p-type functions, to a basis set
for H we directly accommodate this effect. In a similar way, d-type functions,
which are not occupied in first row atoms, play the role of polarization
functions for the atoms Li to F. The 6-31G* and 6-31G** basis sets closely
resemble the 4-31G basis set with d-type basis functions added to the heavy
atoms (*) or d-type functions added to the heavy atoms, and p-type functions
added to hydrogen (**). It has been empirically determined that adding
polarization functions to the heavy atoms is more important than adding
polarization functions to hydrogen. The hierarchy of our basis sets is thus
STO-3G, 4-31G, 6-31G*, and 6-31G**.
The 6-31G* and 6-31G** basis sets are formed by adding polarization
function to a 6-31G basis. The form of the 6-31G contractions are identical
to those of the 4-31G basis, except that the inner shell functions (1s only, for

Li to F) become a contraction of six primitive Gaussians rather than four.
The 6-31G optimization was performed from the beginning and so the
valence functions are not identical to those of the 4-31G basis, but are very

similar. The 6-31G and 4-31G basis sets give almost identical results for
valence properties although the 6-31G basis gives lower energies, because
of the improvement in the inner shell.
The d-type functions that are added to a 6-31G basis to form a 6-31G*
basis are a single set of uncontracted 3d primitive Gaussians. For computational convenience there are “six 3d functions” per atom—3d,,.,

3d,,,

3d,,, 3dyy, 3d,,, and 3d,,. These six, the Cartesian Gaussians, are linear
combinations of the usual five 3d functions—3d,,, 3d,2_,2, 3d,z, 3d_,, and

3d,. and a 3s function (x? + y” + z?). The 6-31G* basis, in addition to adding

polarization functions to a 6-31G basis, thus includes one more function of

190 MODERN QUANTUM CHEMISTRY

s-type symmetry. The contraction is thus (11s4p1d/4s)/[4s2p1d/2s] and the

basis set includes 2 functions for H and 15 functions for Lito F. A standard
Gaussian exponent for the six 3d functions of « = 0.8 has been suggested
for C, N, O, and F.
The 6-31G** basis differs from the 6-31G* basis by the addition of one
set of uncontracted p-type Gaussian primitives for each H. A standard
Gaussian exponent of « = 1.1 has been suggested for these functions. The

6-31G** contraction is thus (11s4p1d/4s1p)[4s2p1d/2s1p] and each hydrogen
now includes five basis functions.
Exercise 3.31 Determine the total number of basis functions for STO3G, 4-31G, 6-31G*, and 6-31G** calculations on benzene.

Calculations at the 6-31G* and 6-31G** level provide, in many cases,
quantitative results considerably superior to those at the lower STO-3G and

4-31G levels. Even these basis sets, however, have deficiencies that can only

be remedied by going to triple zeta or quadruple zeta, adding more than one
set of polarization functions, adding ftype functions to heavy atoms and
d-type functions to hydrogen, improving the basis function description of
the inner shell electrons, etc. As technology improves it will be possible to
use more and more accurate basis sets.

3.7 SOME ILLUSTRATIVE
CALCULATIONS

CLOSED-SHELL

In this section, we illustrate results that are characteristic of Hartree-Fock
calculations on the ground state of closed-shell molecules. Now that we
have discussed polyatomic basis sets and the closed-shell restricted HartreeFock procedure, we are in a position to appreciate the results and the
methodology of sample SCF calculations. The results of an extremely large
number of SCF calculations are now available in the literature; we make
no attempt to review these calculations. Instead, we apply a well-defined
hierarchy of basis sets to a small set of “typical” molecules, and use these
calculations to illustrate the order of accuracy expected in the general SCF
calculation. By restricting our calculations to a few well-defined basis sets
and a small set of molecules, we will be able to apply the various methods of
later chapters, which go beyond the Hartree-Fock approximation, to the
same collection of basis sets and molecules, In this way, we hope to give a
more systematic illustration of the results obtained from the many computational methods of quantum chemistry than would be possible by
simply reviewing selected results available in the literature. Thus our purpose
here, in addition to illustrating SCF results themselves, is to display HartreeFock values of a small number of calculated quantities, for comparison with

THE HARTREE-FOCK APPROXIMATION

Table 3.10 Standard
calculations

geometries

Molecule

Bond length (a.u.)

H,
co
N,
CH,
NH;
H,O
FH

1.400
2.132
2.074
2.050
1.913
1.809
1.733

used

191

in

Bond angle

109.47
106.67°
104.52°

.

better values obtained in later chapters. In some cases, the Hartree-Fock
results of this section are even qualitatively wrong, but, as we shall see later,
these errors are corrected by including the effects of correlation.
The molecules we will use henceforth are H,, isoelectronic N, and CO,
and the ten-electron series, CH,, NH,, H,O, and FH. The standard geometries at which all calculations, unless otherwise indicated, have been carried

out are shown in Table 3.10. These “experimental” values are close but not
always identical to values obtained in the “best” or most recent structure
determination. The small set of molecules we have chosen cannot, of course,

illustrate the total wealth of chemistry being approached by ab initio calculations. They do illustrate, however, some of the interesting quantities
that can be derived from an SCF calculation. When we discuss open-shell
calculations in the next section, we will introduce a few additional molecules.
For the most part, however, the illustrative calculations in this book are
performed on the molecules of Table 3.10.

3.7.1 Total Energies
Perhaps the primary quantity available in any ab initio calculation is the
total energy. The total energy is the electronic energy (the output of the
quantum mechanical calculation) plus the classical nuclear repulsion energy.
In the SCF approximation, the electronic energy is variational and the
“better” the basis set, the lower is the total energy. As the basis set becomes
more and more complete the total energy approaches the Hartree-Fock
limit. This limit can sometimes be estimated from large basis set calculations.
By the variational principle, the Hartree-Fock-limit energy is still above the
“exact” energy, which here can be taken as the energy obtained from an
exact solution to the nonrelativistic Schrédinger equation in the BornOppenheimer approximation. In very accurate calculations on the atoms
He, Be, etc., proper account must be taken of relativistic and Born-Oppenheimer corrections when comparing these “exact” energies with experimental

192 MODERN QUANTUM

CHEMISTRY

ones. For most purposes in quantum chemistry these corrections can be
assumed to be negligible and “exact” results equated to experimental results.
Tables 3.11 to 3.13 show the total energies obtained for the molecules
of Table 3.10 using the four basis sets, STO-3G, 4-31G, 6-31G*, and 6-31G**.
H, has no inner shells, or heavy atoms for d-type polarization functions, so
the 6-31G* basis set is equivalent to the 4-31G basis set for this molecule.
Similarly, N, and CO have no hydrogen atoms to add p-type polarization
Table 3.11 SCF total energies
H, with the standard basis sets

(a.u.)

of

Basis set

Energy

STO-3G
4-31G
6-31G**
HF-limit®

—1.117
—1127
~1.131
—1.134

* J. M. Schulman and D. N. Kaufman, J. Chem.

Phys. 53: 477 (1970).

Table 3.12 SCF total energies (a.u.) of Nz
and CO with the standard basis sets
Basis set

N,

co

STO-3G
4-31G
6-31G*
HF-limit’

— 107.496
— 108.754
— 108.942
— 108.997

— 111.225
— 112.552
“412.737
— 112.791

* p. C. Hariharan and J. A. Pople, Theoret. Chim.

Acta 28: 213 (1973).

Table 3.13 SCF total energies (a.u.) for the ten-electron
series with the standard basis sets
Basis set

CH,

NH,

H,0

FH

STO-3G

—39.727

—55.454

— 74.963

—98.571

6-31G*
6-31G**
HF-limit*

— 40.195
— 40.202
~40.225

— 56.184
— 56.195
— 56.225

— 76011
— 76.023
— 76.065

— 100.003
—100.011
~ 100.071

4-31G

— 40.140

— 56.102

“Pp. C. Hariharan and J. A. Pople,

(1973).

— 75.907

Theoret.

—99.887

Chim. Acta 28: 213

THE HARTREE-FOCK APPROXIMATION

193

functions to, so the 6-31G** basis set is equivalent to the 6-31G* basis set
These absolute energies in themselves are rather uninteresting; chemical
energetics is concerned with energy differences not absolute energies.
Exercise 3.32 Use the results of Tables 3.11 to 3.13 to calculate, for
each basis set and at the Hartree-Fock limit, the energy difference for the

following two reactions,

.

N, + 3H,
> 2NH,
CO+3H,>CH,+H,O

AE =?
AE=?

Are the results consistent for different basis sets? Does Hartree-Fock theory
predict these reactions to be exoergic or endoergic? The experimental

hydrogenation energies (heats of reaction AH°) at zero degrees Kelvin are
—18.604 kcal mol~! (N,) and —45.894 kcal mol7! (CO), with 1 a.u. of
energy equivalent to 627.51 kcal mol™!.
Differences in the zero-point vibrational energies of reactants and
products also contribute to reaction energies. From the experimental
vibrational spectra, the 3N-6 (or 3N-5) zero-point energies (hv9/2) for the
relevant molecules (with degeneracies in parenthesis) are:
Molecule

hy,/2 (kcal mol~*)

H,
N;

6.18
3,35

NH,

1.35
2.32(2)

co
H,O

3.08
2.28
5.13
5.33

4.77

CH,

4.85(2)
1.86(3)
2.17(2)
4.14

4.2(3)

Calculate the contribution of zero-point vibrations to the energy of the
above two reactions. Is it a reasonable approximation to neglect the effect
of zero-point vibrations?
Unfortunately, energy differences satisfy no variational principle, and it
is often difficult to estimate the error in an energy difference. Provided
equivalent basis sets are used for each species, the error in an energy difference
will be, however, much less than the error in the corresponding absolute

194 MODERN QUANTUM CHEMISTRY

energies. As the last exercise shows, the SCF approximation often gives valid
qualitative results for an energy change, even the energy change involved in
a chemical reaction. In the general case, however, some estimate of the
changes in correlation energies will be necessary for valid quantitative results.
3.7.2 lonization Potentials

Koopmans theorem provides the theoretical justification for interpreting
Hartree-Fock orbital energies as ionization potentials and electron affinities.
For the series of molecules we are using, the lowest virtual orbital always
has a positive orbital energy, and thus Hartree-Fock theory predicts that
none of these molecules will bind an electron to form a negative ion. HartreeFock almost always provides a very poor description of the electron affinity,
and we will not consider the energies of virtual orbitals further.
The occupied orbital energies, on the other hand, commonly provide a
reasonable first description of ionization potentials. Except for the interesting
case of N,, Koopmans’ ionization potentials for our series of molecules are
in reasonable agreement with experiment.
The molecule H, has only one occupied orbital. The negative of the
energy of this occupied orbital for the various basis sets is shown in Table 3.14,
and all the H, orbitals are shown in Fig. 3.9. A small change in the occupied
orbital energy is observed in going beyond the minimal basis set, but beyond
the minimal basis the orbital energy remains fixed at — 0.595 Hartrees. The
predicted ionization potential of +0.595 Hartrees is only in error by ~2%.
In Table 3.14, as well as in subsequent tables, all ionization potentials are
vertical rather than adiabatic. A vertical transition is one in which the final
state has the same nuclear geometry as the initial state, rather than its own
equilibrium nuclear geometry (adiabatic transition). The excellent agreement
between the Koopmans’ value and the experimental value arises because of
fortuitous cancellation of the correlation and relaxation effects, which are
neglected in the Koopmans’ approximation. Correlation has no effect on
Table 3.14 Ionization potential (a.u.)
H, obtained via Koopmans’ theorem
Basic set

of

Tonization potential

STO-3G
431G
6-31G**

0.578
0.596
0.595

Near-HF-limit*
Experiment

0.595
0.584

* J. M. Schulman and D. M. Kaufman, J. Chem.

Phys. 53: 477 (1970).

195

Orbital

Energy (a.u.)

THE HARTREE-FOCK APPROXIMATION

STO-3G

6-31G**

4-31G

Figure 3.9 Orbital energies of H,.

the final one-electron HZ but lowers the energy of the initial H, state.
Relaxation, on the other hand, lowers the energy of the final H} state. These
two effects very nearly cancel in this example.
Table 3.15 shows the first two Koopmans’ ionization potentials of CO.
The highest occupied molecular orbitals of this molecule are the bonding
So and 17 orbitals formed mainly from linear combinations of the 2p orbitals
Table 3.15 The first two ionization potentials (a.u.) of CO obtained via Koopmans’
theorem
Ion symmetry

Basis set

2y

211

STO-3G

0.446

0.554

4-31G
6-31G*
Near-HF-limit*
Experiment

0.549
0.548
0.550
0.510

0.640
0.633
0.640
0.620

°W.M.

Huo, J. Chem. Phys. 43: 624 (1965).

196 MODERN QUANTUM CHEMISTRY

of the individual C and O atoms. Ionization of an electron from the 5o
orbital leads to an ion of 7£ symmetry while ionization of an electron from
the 1x orbital leads to an ion of 71 symmetry. A primary question in the
ionization of CO, as well as in the ionization of isoelectronic N,, is whether

the first ionization removes an electron from the 5o or the 1z orbital. In the
Hartree-Fock approximation, the equivalent question is whether the 5o or
1x orbital is the highest lying occupied orbital.
For CO, the calculations agree with experiment in predicting that the

So orbital lies above the Iz orbital. The usual argument, which rationalizes

this result, is that, while 2po orbitals on C and O interact more strongly than
the corresponding 2pz orbitals on C and O and a bonding o orbital would
normally lie below a corresponding bonding x orbital, the 5o orbital is
“pushed” up by interaction with the lower 4c antibonding orbital formed
from 2s orbitals on C and O. In any event, the results of ab initio SCF calculations are in good agreement with experiment.
The molecule N, is isoelectronic with CO and has a similar orbital
structure.

Unlike

CO,

whereas,

the “correct”

however,

a fundamental

problem

arises

in using

Koopmans’ theorem to interpret its ionization spectra. Table 3.16 compares
calculated Koopmans’ ionization potentials for N, with experiment, and
Fig. 3.10 shows the calculated orbital energies. The first point to notice is
that the STO-3G calculation is not in agreement with calculations using
better basis sets and calculations at the Hartree-Fock limit. The STO-3G
calculation predicts the 30, orbital to be higher lying than the 17,, orbital,
Hartree-Fock

result is that

the 17, orbital

is the

highest occupied orbital. As Fig. 3.10 shows, in homonuclear N,, unlike

heteronuclear CO, the 36,(5¢ in CO) orbital has a different symmetry than
the 20,(40 in CO) orbital and, hence, the interaction which pushes these

two orbitals apart is missing in N,, but present in CO. This argument can
Table 3.16 The first two ionization potentials (a.u.) of N,
theorem

obtained via Koopmans’

Ion symmetry

Basis set

2x

TI

STO-3G

0.540

0.573

4-31G

0.629

0.621

6-31G*
Near-HF-limit*
Experiment

0.630
0.635
0.573

°p. E. Cade, K.D. Sales, and A.C.
Chem. Phys. 44: 1973 (1966).

0.612
0.616
0.624
Wahl,

J.

197

ait
aura

Orbital

Energy

(a.u.)

THE HARTREE-FOCK APPROXIMATION

-15.5
-18.6
-15.7

STO-3G

4-316

6-31G*

Figure 3.10 Orbital energies of Nj.

be used to rationalize why Hartree-Fock calculations predict the highest
occupied orbital to be of x symmetry in N3, but of o symmetry in CO.
The second and most important point of Table 3.16 is that the “correct”
Hartree-Fock results are in qualitative disagreement with experiment. In

the molecular orbital Hartree-Fock model, the 17, orbital is the highest
occupied orbital, yet the lowest experimental ionization potential corresponds to the production of an ion with £, symmetry. This implies a breakdown of the simple orbital picture of ionization. The Hartree-Fock picture
is an approximation. For the case of N, this approximation is not sufficiently
accurate for even a qualitative understanding of the ionization phenomena.
As we shall see in Chapters 4 and 7, when the single determinant HartreeFock model is replaced by a multideterminantal model, with its associated
inclusion of correlation effects, theoretical calculations and experiment
ultimately agree on the ionization spectra of N3.
Table 3.17 shows the calculated and experimental results for the first
ionization potential of molecules in the ten-electron series, CH,, NH, HO,
and FH. The largest basis set gives ionization potentials that are all slightly
larger than experimental values, with the agreement becoming slightly

worse aS one moves to the right in the periodic table. The correct ordering
FH > CH, > H,O0 > NH; is reproduced, except with the minimal basis set.
Figure 3.11 shows all the occupied orbitals and the first virtual orbital for
this ten-electron series, using the largest 6-31G** basis set. The lowest

198 MODERN QUANTUM CHEMISTRY

Table 3.17 The lowest ionization potentials (a.u.)
of the ten-electron series obtained via Koopmans’

theorem

Basis set

CH,

STO-3G
4-31G
6-31G*
6-31G**
Near-HF-limtt
Experiment

0.518
0.543
0.545
0.543
0.5467
0.529

NH,

H,0

0.353
0.391
0.414
0.500
0.421
0.498
0.421
0.497
—0.428—s«OO.507*
0.463
0.400

FH

0 464
0.628
0.628
0.627
~—0.650*
0.581

* W. Meyer, J. Chem. Phys. 58: 1017 (1973).
» A. Rauk, L. C. Allen, and E. Clementi, J. Chem. Phys.

52: 4133 (1970).

© B. J. Rosenberg and J. Shavitt, J. Chem. Phys. 63: 2162

(1975).

Orbital Energy

(a.u.)

¢ P. E. Cade and W. M. Huo, J. Chem. Phys. 47: 614 (1967).

-10.0
-200
-30.0

CH,

NH,

-H,0

FH

Figure 3.11 6-31G** orbital energies of the ten-electron series

THE HARTREE-FOCK APPROXIMATION

199

molecular orbital is essentially the 1s inner-shell atomic orbital of the heavy
atom. The second molecular orbital is comprised mainly of the 2s orbital
of the heavy atom, particularly as one moves to the right in the periodic
table. In FH this molecular orbital is very atomic in nature and has much
of the character of an inner shell. The average energy of the three highest
occupied orbitals also decreases slightly as one moves to the right in the
periodic table, but the individual energies of these three orbitals are determined by the symmetry of the system. That is, the reason CH, does not have
the lowest ionization potential, in line with the trend in the rest of the series,
is that the tetrahedral symmetry causes these three orbitals to be degenerate.
If CH, was distorted from its tetrahedral symmetry, its first ionization
potential would decrease.
Figure 3.12 shows all the orbital energies of H,O, using our four standard
basis sets. In this as in other examples, the occupied orbital spectrum is
nearly invariant to the basis set once the basis set is of double zeta quality
or better. The minimal basis set leads to ionization potentials that are
significantly different from those given by better basis sets.
The Koopmans’ approximation to ionization potentials provides a
valuable qualitative tool for interpreting and making assignments to ex-

40
3.5
3.0
25
20
1.8
16
14
1.2
10

N

Orbital Energy

(a.u.}

perimental spectra. Like any other Hartree-Fock result, however, it is not

STO-3G

4-3IG

6-3IG*

6-3IG**

Figure 3.12 Occupied and virtual
orbital energies of H,O.

200 MODERN QUANTUM CHEMISTRY

truly quantitative and, in some cases, it may even give an incorrect qualitative picture.

3.7.3 Equilibrium Geometries
Perhaps the most common use of electronic structure calculations is to
predict the equilibrium geometry of molecules. In the Born-Oppenheimer
approximation, the total energy, as a function of the coordinates of the nuclei,
defines a potential surface. The motion of the nuclei on this potential surface defines the possible chemical reactions, the molecular vibrations, etc.

The points on the potential surface of most immediate interest are the
Stationary points. The saddle points define transition states, and the minima
define equilibrium geometries. Although one would like to know the complete details of the potential surface, this quickly becomes an impossible
task as the number of nuclei and the 3N-6 degrees of freedom increase. For
moderate-sized molecules, however, it may still be possible to find the potential surface minimum. This constitutes a prediction of chemical structure.
In cases where the number of degrees of freedom is very large, it may be
sufficient to fix certain geometric variables at their standard or expected
values and optimize only the geometric variables for which little a priori
information is available.
Since one cannot, in general, obtain a potential surface which is close
to the exact Born-Oppenheimer surface, the best that can be hoped for is a
potential surface which is closely parallel to the exact surface. As our discussion of minimal basis H, (c.f. Fig. (3.5)) has shown, the potential surface
obtained from a closed shell restricted Hartree-Fock calculation will not be
parallel to, nor even qualitatively resemble, the exact potential surface in
regions of the surface characterizing the stretching and breaking of a bond
if, as is the usual

case, the dissociation

products

have

open

shells. The

restricted closed-shell Hartree-Fock procedure is thus inappropriate for the
general exploration of a potential surface. In most cases, however, the
restricted Hartree-Fock potential surface is “reasonably” parallel to the exact
surface near the region of a minimum. That is, restricted Hartree-Fock
predictions of equilibrium geometries provide reasonably valid approximations to experimental] values.
The problem of finding an equilibrium geometry is equivalent to the
mathematical problem of nonlinear unconstrained minimization. Historically, there have been a number of different methods used for such minimizations. An inefficient, but conceptually simple, procedure is the line search.
Here one varies only one variable at a time until a minimum for that variable
is obtained. One cycles through all of the variables a number of times,
varying each one in sequence, until the optimum values no longer change.
If there is a large coupling between variables, this procedure may converge

THE HARTREE-FOCK APPROXIMATION

Table 3.18 SCF
(a.u.) of Hz

201

equilibrium bond lengths

Basis set

Bond length

STO-3G

oe

1.346

4-31G

1 380

6-31G**

1.385
1401

Experiment

very slowly. Other procedures depend on knowing the first derivatives and
possibly the second derivatives of the energy with respect to the nuclear
coordinates. These are much better procedures but require an evaluation
of a number of derivatives. In the past these derivatives have been calculated numerically, but there are now a number of programs that can
calculate these derivatives by efficient analytical procedures and use them
to generate equilibrium geometries automatically. Appendix C discusses
the basic ideas behind these important developments.
Table 3.18 gives the calculated equilibrium bond lengths of H, with
our standard basis sets. The calculated bond length of 1.385 a.u. obtained
from using the 6-31G** basis set is close to the Hartree-Fock limit value.

The error of 0.016 a.u. (~ 1%) in the bond length is not uncharacteristic of

what can be expected from a good ab initio SCF calculation, although the
average absolute error is more commonly ~0.02—0.04 a.u.
Table 3.19 gives the calculated bond lengths for CO and N, and Table
3.20 the calculated bond lengths for CH,, NH3, H,O, and FH. The error at
the Hartree-Fock limit is somewhat larger for a distance between two
heavy atoms than it is for an X-H distance. In these, as in most other mole-

cules, bond lengths predicted by Hartree-Fock limit calculations are too
Table 3.19 SCF equilibrium bond lengths
(a.u.) of N, and CO
Basis set

N,

co

STO-3G
4-31G

2.143
2.050

2.166
2.132

Near-HF-hmit

2.013°

2.081°

6-31G*

2.039

Experiment

2.074

“P. E. Cade, K D. Sales,
Chem. Phys. 44: 1973 (1966)

’W.

M.

Huo,

2.105

J. Chem,

and

2.432

A

C.

Wahl, J.

Phys. 43: 624 (1965).

202. MODERN QUANTUM CHEMISTRY

Table 3.20 SCF equilibrium bond lengths (a.u.) of
the ten-electron series
Basis set

CH,

NH,

H,0

FH

STO-3G
431G

2.047
2.043

1.952
1.873

1.871
1.797

1.807
1.742

Near-HF-limit
Experiment

2.048"
2.050

6-31G*
6-31G**

1.791
1,782

1.897
1.897

2.048
2.048

1.776¢
1,809

1.890?
1.912

1.722
1.703

1.6967
1.733

2 W. Meyer, J. Chem. Phys. 58: 1017 (1973).
+ A. Rauk, L. C. Allen, and E. Clementi, J. Chem. Phys.

52: 4133 (1970).

*B. J. Rosenberg, W. C. Ermler, and 1. Shavitt, J. Chem.

Phys. 65: 4072 (1976).

4P_E. Cade and W. J. Huo, J. Chem. Phys. 47: 614 (1967).

short. The average error in a bond length predicted by poorer basis sets,
such as the minimal STO-3G basis set, is larger than for basis sets at the
Hartree-Fock limit, and is commonly ~0.05~0.10 a.u.
Values for the calculated bond angles in NH; and H,O are shown in
Table 3.21. There is quite reasonable agreement (~1°—2°) at the HartreeFock limit. These bond angles are not particularly good at the double zeta
(4-31G) level, and it appears that d-type functions in the basis set are necessary
for a quantitative description of the angle in these molecules. If the limit is
taken of adding only s- and p-type functions to a basis set for NH3, the
predicted geometry becomes planar! This illustrates the necessity of a
balanced basis set.

Table 3.21 SCF

for NH, and H,O

equilibrium

Basis set

bond

angles

NH;

H,0

STO-3G
4-31G

104.2
115.8

100.0
111.2

6-31G**
Near-HF-hmit
Experiment

107.6
107.2°
106.7

106.0
106.1°
104.5

6-31G*

107.5

° A. Rauk, L. C. Allen,
J. Chem. Phys. 52: 4133 (1970).

’B.

J.

Rosenberg, W

105.5

and

E.

Clementi,

C. Ermler, and I. Shavitt,

J. Chem, Phys. 65: 4072 (1976).

THE HARTREE-FOCK

APPROXIMATION

203

eo

As with any other calculated quantity, the predictions of equilibrium
geometries obtained from the ab initio SCF procedure cannot provide truly
quantitative agreement with experiment. Nevertheless, such geometries
almost always give the correct trends when comparing a series of related
molecules; the a priori prediction of chemical structure has been one of the

most successful aspects of Hartree-Fock calculations. The book by Hehre
et al. (see Further Reading) critically evaluates the performance of SCF
calculations in predicting equilibrium geometries, with many examples.

3.7.4 Population Analysis and Dipole Moments
An ab initio SGF calculation produces a one-electron charge density p(r)

describing the probability of finding an electron, ie.

p(t) =) » PrP DOr)

(3.305)

This charge density is commonly plotted as a contour map for visual interpretation of the charge density. Alternatively, one would like to have more
quantitative characterizations of the charge density. One way of doing this
is to calculate the moments of the charge—dipole moment, quadrupole
moment, etc. In addition, chemists would like to ascribe portions of the
charge to specific atoms in line with their intuitive notions. As we have
described previously, there is no rigorous way of doing this. Nevertheless, a
population analysis may sometimes be useful for interpretive purposes. As
an illustration of such an analysis, Tables 3.22 and 3.23 contain the net
positive charge on each of the hydrogens in the 10-electron series, from
either a Mulliken or a Léwdin population analysis. In agreement with
standard electronegativity arguments, the hydrogen atom becomes more
positively charged as one goes to the right in the periodic table. Very little
can be said about the absolute magnitude of these charges, however. It is
particularly dangerous to compare numbers for different basis sets. For
example, a 6-31G* calculation on CH, compared to an STO-3G calculation

Table 3.22 A Mulliken SCF population
analysis for the ten-electron series. The
entries are the net charges on the hydrogens
Basis set

CH,

NH,

H,0

FH

STO-3G
4-31G
6-31G*
6-31G**

0.06
0.15
0.16
0.12

0.16
0.30
0.33
0.26

0.18
0.39
0.43
0.34

0.21
0.48
0.52
0.40

204

MODERN

QUANTUM

CHEMISTRY

Table 3.23 A Léwdin SCF population analysis for the ten-electron series. The entries
are the net charges on the hydrogens
Basis set

CHa

NH;

H,0

FH

STO-3G
4-31G
6-31G*
6-31G**

0.03
0.10
0.16
0.11

0.10
0.20
0.27
0.18

0.13
0.28
0,36
0.23

0.15
0.36
045
0.27
——

on NH, would predict the CH bond in methane to be more polar than the
NH bond in ammonia. Since one adds orbitals only to hydrogen atoms in
going from the 6-31G* to 6-31G** basis set, the 6-31G** basis set always
assigns more electrons (less positive charge) to the hydrogens than does the
6-31G* basis set. In spite of problems, a population analysis can be a useful
interpretive device when used properly.
Calculations of the dipole moment of CO are shown in Table 3.24. This
particular calculation has had an interesting history, since there has been
considerable disagreement as to the proper sign of the dipole moment. The
correct experimental result is that the negative end of the molecule is carbon,
not oxygen as simple electronegativity arguments would suggest. Although
a minimal basis set gives the right sign, all SCF calculations with a basis set
of double zeta quality or better predict the wrong sign. The difficulty arises
because of the relatively small magnitude of the dipole moment, a result of
the cancellation of two large and opposite contributions. One contribution
is that of net charge which, in line with electronegativity arguments, has
oxygen more negative. In addition, however, there is a lone pair of electrons
on carbon, directed away from the bond. This asymmetry of the charge on

carbon leads to an additional contribution to the dipole moment, which is

Table 3.24 SCF dipole moment (a.u.) of
CO for the standard basis sets. A positive

dipole moment corresponds to C7~O*
Basis set

Dipole moment

STO-3G
4-31G
6-31G*
Near-HF-lumit*®

0.066
—0,237
—0.131
—0,110

Experiment

0,044

* A. D. McLean and M. Yoshimine, Intern. J.
Quantum Chem. 15: 313 (1967).

THE HARTREE-FOCK APPROXIMATION

fable 3.25 SCF dipole moments (a.u.) for

the ten-electron
basis sets

series

Basis set

NH,

H,0

FH

STO-3G
4-31G
6-31G*
6-31G**
Near-HF-limit
Experiment

0.703
0.905
0.768
0.744
0.653%
0.579

0.679
1.026
0.876
0.860
0.785
0.728

0.507
0.897
0.780
0.776
~—(0.764°
0.716

C.

and

* A.

Rauk,

L.

Allen,

and

the

Chem. Phys. 52: 4133 (1970).
+B. J. Rosenberg and 1. Shavitt,

63: 2162 (1975).

°P. E. Cade and W. M. Huo,
45: 1063 (1966).

E.

standard

Clementi,

205

°

J.

J. Chem. Phys.
J.

Chem,

Phys.

opposite to the first contribution. The cancellation, leading to a small posi-

tive (C”O*) dipole moment, is not reproduced with sufficient accuracy in
the SCF calculations. As we shall see in the next chapter, this disagreement

between theory and experiment disappears when proper account is taken of
correlation effects.
Table 3.25 contains the calculated dipole moments for NH,

H2O, and

FH using our standard basis sets. Only at the 6-31G* level and beyond is
the proper trend H,O > FH > NH; reproduced. At the Hartree-Fock
limit the calculated dipole moments are somewhat too large, but the trend
is well reproduced. The 6-31G** basis set still appears to be inadequate for
accurate calculation of dipole moments, since the values obtained with it
are still rather distant from Hartree-Fock-limit values.

3.8 UNRESTRICTED OPEN-SHELL
THE POPLE-NESBET EQUATIONS

HARTREE-FOCK:

At the beginning of this chapter we derived and discussed formal properties
of the Hartree-Fock equations independent of any particular form for the
spin orbitals. We then introduced a set of restricted spin orbitals and have
since been concerned solely with restricted closed-shell calculations of the
type

|Prur> = wis

ms)

(3.306)

Obviously, not all molecules, nor all states of closed-shell molecules, can be
described by pairs of electrons in closed-shell orbitals, and we now need to

206 MODERN QUANTUM CHEMISTRY

generalize the previous closed-shell formalism to accommodate situations
in which a molecule has one or more open-shell (unpaired) electrons. That
is, we need to consider unrestricted wave functions of the type

Punr> = Wis +>

(3.307)

In the previous chapter we gave a preliminary description of open-shell
determinants (Section 2.5); we now obtain the SCF equations for unrestricted
calculations.
In dealing with open-shell problems, there are two common approaches:
the restricted open-shell, and the unrestricted open-shell Hartree-Fock
procedures. In the restricted open-shell formalism, all electrons, except
those that are explicitly required to occupy open-shell orbitals, occupy
closed-shell orbitals. The advantage of this procedure is that the wave functions one obtains are eigenfunctions of the spin operator £?. The disadvantage is that the constraint of occupying orbitals in pairs raises the variational
energy. In addition, the spatial equations defining the closed- and open-shell
orbitals of restricted open-shell Hartree-Fock theory are somewhat more
involved or at least less straightforward than the spatial equations of unrestricted Hartree-Fock theory. For treating open-shells our emphasis is on
unrestricted calculations—mainly for reasons of simplicity and generality.
As we have discussed previously, a restricted Hartree-Fock description
is inappropriate at long bond lengths for a molecule like H,, which dissociates to open-shell species. This problem can be solved to a certain extent
by using an unrestricted wave function at long bond lengths. In addition to
describing unrestricted wave functions for “true” open shells (doublets,
triplets, etc.), we will spend some time in this section analyzing the “singlet”
dissociation problem with our minimal basis H, model. An unrestricted
wave function will allow a closed-shell molecule like H, to dissociate to
open-shell atoms.
In this section, then, we first introduce a set of unrestricted spin orbitals

to derive the spatial eigenvalue equations of unrestricted Hartree-Fock
theory. We then introduce a basis set and generate the unrestricted PopleNesbet matrix equations, which are analogous to the restricted Roothaan
equations. We then perform some sample calculations to illustrate solutions
to the unrestricted equations. Finally, we discuss the dissociation problem
and its unrestricted solution.

3.8.1

Open-Shell Hartree-Fock: Unrestricted Spin Orbitals

The general Hartree-Fock eigenvalue equation, in terms of spin orbitals, is

S(WMyxC) = ex)

(3.308)

What we want to do now is to introduce the specific unrestricted form for the
spin orbitals {y;} and derive, from the above general Hartree-Fock equation,

THE HARTREE-FOCK APPROXIMATION

207

the spatial equations which determine the unrestricted spatial orbitals. The
procedure that we use here is quite analogous to that of Subsection 3.4.1,
where we derived the spatial equations determining restricted spatial orbitals.
We will not repeat all details of the derivation.
Analogous to Eg. (3.110) for restricted spin orbitals, an unrestricted set
of spin orbitals has the following form

(x) =

{YMHo)

100)= trp

3,309

eae)

That is, electrons of « spin are described by a set of spatial orbitals {y7| j =
1,2,..., K}, and electrons of 8 spin are described by a different set of spatial

orbitals {y/4| j = 1, 2,..., K}. In our previous restricted case Wj = pf = ,.

We are now allowing electrons of « and f spin to be described by different
spatial functions.

To derive the spatial equations defining {y7} and {y/4}, we need to insert

Eq. (3.309) for the spin orbitals {y;} into the general Hartree-Fock equation
(3.308) and integrate out the spin variable w. For simplicity, we will concentrate on the equation defining yj and use the symmetry between a and B
spins to write down the corresponding equations defining y/. Substituting
Eq. (3.309) into Eq. (3.308) leads to
SOU)

e(@1) = eF(r)e(;)

(3.310)

Now, ¢; is the energy of the spin orbital x, = ya. Since the spin orbitals for
electrons of « and f spin have different spatial parts, their energies will also
be different. In the above case ¢; = 7. There will be a corresponding set of

orbital energies {e?| j = 1, 2,..., K} for electrons of 8 spin. Thus

SDYFE 10) = EFYWF(ts Joo)

(3.311)

If we now multiply this equation by «(a ) and integrate over spin we get

FAQs) = eA)

FPOUWIA) = eG)

(3.312)
(3.313)

as the spatial equations defining the spatial orbitals yj and wf. The spatial

Fock operators {7(1) and f#(1) are defined by

S71) = [deo, (coy) flry, ©)a(,)

(3.314)

FP) = [dor Bo.)fer, o)B(o)

(3.315)

We could use the spin orbital definition (3.115) of f(r1, @,) to perform
these integrations and work out explicit formulas for f* and f°. Alternatively,
we can just write down expressions for f* and f* by considering the possible

208 MODERN QUANTUM CHEMISTRY

+ ttl

interactions defined by any unrestricted determinant,

+
+
yf

The operator {%(1) is the kinetic energy, nuclear attraction, and effective
potential of an electron of « spin. The effective interactions of an electron of
spin include a coulomb and exchange interaction with all other electrons
of « spin plus only a coulomb interaction with electrons of 8 spin. Thus
Ne

NA

F*Q) = hd) + Y (I) — KG] + Y JE)

(3.316)

where the two sums in this equation are over the N* orbitals ¥2 occupied by

electrons of a spin and the N* orbitals y* occupied by electrons of f spin.

The kinetic energy and nuclear attraction are independent of spin so h(1)

is identical to the corresponding operator of the restricted case. The electrons
of a spin see a coulomb potential J? and an exchange potential — K?Z coming
from each of the N* electrons of « spin occupying the orbitals ¥3, plus a cou-

lomb potential J’ coming from each of the N’ = N — N* electrons of 8

spin occupying the orbitals
2. The sum over the N* orbitals yz in the above
equation formally includes the interaction of an « electron with itself. However, since

(3.317)

[Ja(1) — Ki) ]¥20) = 0

this self-interaction is eliminated. The corresponding Fock operator for
electrons of f spin is
NA

N=

£1) = hl) + ¥ (yea) — KA] + YJ)

(3.318)

The unrestricted coulomb and exchange operators are defined in analogy
to our previous definitions (3.124) and (3.125) of the restricted coulomb and

THE HARTREE-FOCK APPROXIMATION

209

exchange operators. That is,

(3.319)

Jal) = des VF QrizW2)

KX) = | fades Ws orévaa| (1)

»

= | f dr, WF (2)rizYA; wie] y(1)

(3.320)

The definitions of J® and K® are strictly analogous to the above.
From the definitions (3.316) and (3.318) of the two Fock operators f*
and f*, we can see that the two integro-differential eigenvalue equations
(3.312) and (3.313) are coupled and cannot be solved independently. That

is, f* depends on the occupied f orbitals, ¥#, through J®, and f* depends on

the occupied « orbitals, ¥7, through J%. The two equations must thus be
solved by a simultaneous iterative process.
Exercise 3.33 Rather than use the simple technique of writing down

f°(1) by inspection of the possible interactions, as we have done above, use

expression (3.314) for f*(1) and explicitly integrate over spin and carry
through the algebra, as was done in Subsection 3.4.1 for the restricted closedshell case, to derive
Ne

f*) = AC) + & [y2d) — Ke] +

née

8)

Now that we have derived the unrestricted Hartree-Fock equations,
we can write down expressions for the unrestricted orbital energies, total
unrestricted energy, etc. First, we need to define a few terms. The

kinetic

energy and nuclear attraction of an electron in one of the unrestricted orbitals

Ww? or Wf is the expectation value

he, = (welhy7) or hi = Plnbp?)
The Coulomb interaction of an electron in 7 with one in ? is

Jip = JSR = VII) = WHI) = WMD
The corresponding coulomb
spin are

(3.321)

(3.322)

interactions between electrons of the same

JH = WWD = WWD

= WIE WG

(3.323)

and

JEP = (WESIP) = WHE WS) = PLE WHY)

(3.324)

210 MODERN QUANTUM CHEMISTRY

The exchange interactions between electrons of parallel spin are

Ki= WAKA = W4AIKIWD = WG)

(3.325)

KEP = WALKSIWD = WAKES) = Whbs Ge)

(3.326)

and

There is, of course, no exchange interaction between electrons of opposite

spin.

The total unrestricted electronic energy can now be written down just
by considering all the contributing energy terms,
N&

NB

a

a

1%

N&

1 NB

NB

N=

NB

Eo =i
Mia t+ Do hha +5pL LUS-Ka+; 2 deh — Ki)
+ > Je
ab

(3.327)

The summations with upper limit N* are summations over the occupied
orbitals y2 or W2. A similar convention holds for orbitals occupied by electron
of £ spin. The factor of4 in the third and fourth terms eliminates the double
counting in the free summation. The self-interaction disappears since
Jo%_ Kaz— JbB_ K 88— () as Egs. (3.323) to (3.326) verify.

o>

Exercise 3.34 The unrestricted doublet ground state of the Li atom is

= |Wi(14(2)Y¥4(3)>.

a tht, +h. + J

Show

— KY, + J

that

the

+ I.

energy

of this state

is Ey =

Exercise 3.35 The unrestricted orbital energies are 7 = (w3|f7|7) and

ef = (Wl

Wh). Show that these are given by
No

NB

= hi +> (JE — KB) +>

of = hh, + UE — KE) + Dee
NB

N@

Derive an expression for Ey in terms of the orbital energies and the coulomb
and e> change energies.

3.8.2 Introduction of a Basis: The Pople-Nesbet Equations
To solve the unrestricted Hartree-Fock equations (3.312) and (3.313), we
need to introduce a basis set and convert these integro differential equations

to matrix equations,'* just as we did when deriving Roothaan’s equations.
We thus introduce our set of basis functions {¢,|u= 1,2,...,K} and

THE HARTREE-FOCK APPROXIMATION

211

expand the unrestricted molecular orbitals in this basis, »
K

yt= 3 Cid,

1=1,2,...,K

(3.328)

K

i=1,2,...,K

(3.329)

n=l

we= > Chg,
u=1

The two eigenvalue equations (3.312) and (3.313) guarantee that the sets of

cigenfunctions {y7} and {y*} individually form orthonormal sets. There is
no reason, however, that a member of the set {y7} need be orthogonal to a
member of the set {y?}. Even though the two sets of spatial orbitals overlap
with each other, the set of 2K spin orbitals {y,} will form an orthonormal set,
either from spatial orthogonality (aa and ££ case) or spin orthogonality

(af case).

Substituting the expansion (3.328) for the orbitals yj into the « HartreeFock equation (3.312) gives

Y CUPMO(M = FY CHAD

(3.330)

if we multiply this equation by #*(1) and integrate over the spatial coordinates of electron-one, we get

v FAC =e DS,.C

f= 1,2,...,K

(3.331)

where S is the overlap matrix (c.f. Eq. (3.136)) and F* is the matrix repre-

sentation of f* in the basis {¢,},

Fi, = far fd)

(3.332)

Identical results can be obtained for f orbitals. The algebraic equations in
(3.331) and the corresponding equations for f orbitals can be combined into
the two matrix equations,

F°C* = SC’e"
FC? = SCs?

(3.333)
(3.334)

These twe- equations are the unrestricted generalizations of the restricted
Roothaan equations (c.f. Eq. (3.139)) and were first given by Pople and Nesbet. The matrices s* and
are diagonal matrices of orbital energies (c.f. Eq.
(3.141)). The K x K square matrices C* and C* have as columns the expansion
coefficients for ¥f and w (c.f. Eq. (3.140)). These equations can be solved in
a manner similar to the way Roothaan’s equations are solved, except that,
since F* and F* depend on both C* and C*, the two matrix eigenvalue problems must be solved simultaneously. We will return to the solution of these
equations after we have described unrestricted density matrices and the
explicit form of F2, and F#,.

212 MODERN QUANTUM CHEMISTRY

3.8.3 Unrestricted Density Matrices
We continue here with the generalization of our previous results for restricted
closed-shell wave functions. If an electron is described by the molecular
orbital y/2(r), then the probability of finding that electron in a volume element

dr at r is |(r)|? dr. The probability distribution function (charge density)
is |W2(r)|?. If we have N* electrons of o spin, then the total charge density

contributed by these electrons is

Ne

pn) => YA)?

(3.335)

The corresponding charge density contributed by electrons of B spin is
NB

pA(r) =» ey)?

(3.336)

and the total charge density for electrons of either spin is the sum of these

pi(r) = pr) + p*(r)

(3.337)

Integrating this equation leads, as expected, to

f de p7(r) = N = N@ + NP

(3.338)

In an unrestricted wave function, electrons of a and f spin have different
spatial distributions (p* # p*), and it is convenient to define a spin density

p*(r) by

p(t) = p(t) — pA(r)

(3.339)

From the above definition of the spin density, it is clear that in regions of
space where there is a higher probability of finding an electron of « spin than
there is of finding an electron of B spin the spin density is positive. Alternatively, the spin density is negative in regions of space where electrons of f
spin are most prevalent. The individual densities p* and p* are, of course
positive everywhere. The spin density is a convenient way of describing the
distribution of spins in an open-shell system.

Exercise 3.36 Use definitions (3.335) and (3.336) and Eq. (2.254) to show
that the integral over all space of the spin density is 2¢7,».
By substituting the basis set expansions (3.328) and (3.329) of the « and
B molecular orbitals into the expressions (3.335) and (3.336) for the « and B
charge densities, one can generate matrix representations (density matrices)
of the a and f charge densities,
N=

PO =P vw? =X d Prd, Mo?)

(3.340)

THE HARTREE-FOCK APPROXIMATION

Ne

P(r) = Y YA@)? = VY Pi

WPr(e)

213

(3.341)

where the density matrix P* for « electrons and the density matrix P? for B
clectrons are defined by
N@

In addition

to these two

Ply = » Chia(Cra)*

(3.342)

Ph,= 5 C8(CE,)

(3.343)

matrices,

density

one can, of course,

define,

in

analogy to our previous definitions, a total density matrix and a spin density
matrix. That is,

= P* + PP
PS . p* — pe

(3.344)
(3.345)

Exercise 3.37 Carry through the missing steps that led to Eqs. (3.340)
to (3.343).
Exercise 3.38 Show that expectation values of spin-independent sums
N

of one-electron operators 2

h(i) are given by

=1

CO) = 2 2 Protv|h|y)
for any unrestricted single determinant.
Exercise 3.39 Consider the following spin-dependent operator which
is a sum of one-electron operators,
N

p=2 ¥ Sr, — R)s-(i)
i=1

Use the rules for evaluating matrix elements, given in Chapter 2, to show
that the expectation value of f° for any unrestricted single determinant is

<p*> = p*(R) = ur(PSA)
where

Ay = O2(R)}(R)
This matrix element is important in the theory of the Fermi contact contribution to ESR and NMR coupling constants.

214 MODERN QUANTUM CHEMISTRY

Having defined the unrestricted density matrices P*, P?, P?, and P* we

will now use these definitions to give explicit form to the unrestricted Fock

matrices F* and F*.

3.8.4 Expression for the Fock Matrices
To obtain expressions for the elements of the matrices F* and F*, we simply
take matrix elements in the basis {¢,} of the two Fock operators f* (Eq.
(3.316)) and f# (Eq. (3.318)), and use expressions (3.322) to (3.326) for matrix
elements of the coulomb and exchange operators. That is,

= far, ox PO0)
No
= HS + ¥ [6,| W6D —(d.4ZIVIO] + x¥ (Suh WAV)

Fh, = fdes bt S4,(1)

Ne

NB

= HS + ¥ [duds Ways) — (Owe Weed] + D (Gd. |Wav)

(3.346)
(3.347)

To continue, we substitute the basis set expansions of y/“ and w4 to get
NE

= Hore 4 x x y C3,(C2.)*[(ev]oA)—(uafovy]
+ YY CCE.) *uv |)
Aca

= Her+y Y Pt [(uv|oa)—(udlov)] +>. Y Ph (uv| od)
Ao

As

= AR'+) Y Pi (uv |oa)— Py(ua|ov)
Ao

(3.348)

*

Ne

Fy = His+> YY Cha Coa)*[(uv|o4)— (ud lov) +E. YY< Chal Co0)*(uev 02)
= His +30), Phel(Hv|o4)—(uA|ov)] +2! Pae(uv| oA)
Aca
lo

A

Ao

=H + 3D PL (unload) — Ph(uilov)

ae

(3.349)

If one compares these expressions with the corresponding restricted closedshell expression (3.154), one sees that the coulomb term is identical and
depends on the total density matrix. The difference is only that here one has
Separate representations of the a and f density matrices rather than, as in
the closed-shell case,

Pz, = P28, = 4 PI,

(3.350)

The coupling of the two sets of equations is made explicit in the above
expressions, i.e., F* depends on P? (through the total density matrix P*) and

F* similarly depends on P*.

THE HARTREE-FOCK

APPROXIMATION

215

3.8.5 Solution of the Unrestricted SCF Equations
Ihe procedure for solving the unrestricted SCF equations is essentially
identical to that previously described for solving the Roothaan equations.
An initial guess is required for the two density matrices P* and P? and hence
P’. An obvious choice is to set these matrices to zero and use H® as an
initial guess to both F¢ and F’. If this procedure is followed, the first iteration

will produce identical orbitals for « and
spin, i.e., a restricted solution. If,
however, N* ¥ N*, then all subsequent iterations will have P* # P* and an
unrestricted solution will result.
Given approximations to P* and P*, at each step of the iteration, we can
form F* and F*, solve the two generalized matrix eigenvalue problems

(3.351)
(3.352)

F*C2 = SCs"
F°C! = SC’e?

for C* and C*, and then form new approximations to P* and P*. Because of

the coupling of the two equations, one cannot obtain a self-consistent solu-

tion to the x equations without at the same time obtaining a self-consistent
solution to the # equations, although at any one iteration step the two
matrix eigenvalue problems (3.351) and (3.352) can be solved independently;

the coupling is in the formation of the Fock matrices. Solving the matrix
eigenvalue problem will involve knowing a transformation matrix X to an
orthonormal basis set, forming F” = X'F°X, diagonalizing F” to get C*,
and then forming C* = XC’, etc., just as in the restricted closed-shell case.
Exercise 3.40 Substitute the basis set expansion of the unrestricted
molecular orbitals into Eq. (3.327) for the electronic energy Ey to show that
Eo=

1

5d

“uy

core

[Putin

a

a

+ PiyFiy

+ PEF oy

Before going on to describe sample unrestricted calculations, an impor-

tant point should be noted about solutions to the Pople-Nesbet equations
for the special case N* = N°, i.e, for the case where a molecule would normally be described by a restricted closed-shell wave function. For this case,

there exists the possibility of two independent solutions to the Pople-Nesbet
equations. The first solution is a restricted solution. If P* = P*’ = $P, then
F* = F* = F and the Pople-Nesbet equations degenerate to the Roothaan

equations. When N* = N°, a restricted solution to the Roothaan equations is

a solution to the unrestricted Pople-Nesbet equations. This restricted solution
always exists and necessarily results if an initial guess P* = P* is used. For
N* = N®, however, in addition to the restricted solution there may also exist
a second unrestricted solution of lower energy. The restricted solution constrains the density of « electrons to equal the density of f electrons, but under

216 MODERN QUANTUM

CHEMISTRY

certain conditions (which we shall consider in the last subsection of this
chapter) relaxing this constraint will result in an unrestricted solution of

lower energy for which P* is not equal to P’,. When N* = N®, under certain

conditions there exists a second solution, the unrestricted solution to the PopleNesbet equations. In seeking this second solution, it is imperative that an

initial guess P*# P? be used or the equations will necessarily yield the
restricted solution. Even if an unrestricted initial guess is used, there is still
the possibility that iteration will lead to the restricted solution. When two
solutions exist, the initial guess will strongly determine to which solution

the iterations lead.

,

One normally uses unrestricted wave functions to describe open-shell
states of molecules for which N* 4 N*, and the above considerations are
not of concern. When, however, one uses unrestricted wave functions as a
solution to the dissociation problem, as we shall subsequently do, the
possibility of two solutions is of supreme importance.
3.8.6

Illustrative Unrestricted Calculations

An interesting example of the use of unrestricted wave functions occurs for
the methyl radical CH,. This molecule has D3, symmetry, ie, it is planar
with bond angles of 120°. The CH internuclear distance is taken to be
2.039 a.u. The simplest description of the electronic structure of this radical
is a restricted Hartree-Fock description, shown in Fig. 3.13. The unpaired

Figure 3.13 Restricted Hartree-Fock description of the planar
methyl radical.

THE HARTREE-FOCK APPROXIMATION

217

electron is in an open-shell x orbital, which in a minimal basis description
would be a pure 2p orbital on carbon. The remaining electrons are paired in
co orbitals. In this restricted Hartree-Fock description, the spin density p‘(r)
Is everywhere positive, except in the plane of the molecule where it is zero
because of the node in the z orbital. Because all o electrons are paired, the
spin density is just

pt) = Wl?

.

(3.353)

where yw, is the x molecular orbital containing the unpaired electron.
The above description, while simple, is not in agreement with experimental results. In an electron spin resonance (ESR) experifnent on the methyl
radical, measurements were made of a4 and a‘, the coupling constants for
the hydrogen and carbon nuclei. These ESR coupling constants are a direct
measure of the spin densities at the position of the respective nuclei,

a4(Gauss) = 1592p*(R,)

(3.354)

a°(Gauss) = 400.3p°(RQ)

(3.355)

The experimental measurements of a" and a give not only the magnitude
but also the sign of the spin density. It is found that the spin density at the
H nucleus is negative, and the spin density at the C nucleus is positive.
Unfortunately, the restricted Hartree-Fock description predicts the coupling

constants a" and a“ to be both zero. If the molecule were vibrating so that

part of the time the molecule had a bent C;, geometry, then the restricted
description would allow nonzero spin densities at the nuclei. But these spin
densities and the associated coupling constants would always be positive.
Thus the negative spin density at the positions of the hydrogen nuclei cannot
be explained by a restricted Hartree-Fock description.
The simplest way of obtaining the correct qualitative result is to use an
unrestricted Hartree-Fock description. The electrons of Fig. 3.13 that are
paired in a o orbital have different interactions with the unpaired electron,
ie, the electrons of « spin have a coulomb and exchange interaction with
the unpaired electron while the electrons of B spin have only a coulomb
interaction. There is thus good reason why the « and f electrons of the
sigma system should have different energies and occupy different spatul
orbitals. If, indeed, one does relax the constraint of paired electrons, by using
the Pople-Nesbet equations, the unrestricted solution shown in Fig. 3.14 ts
found. This unrestricted wave function does not have the o electrons paired
and as such there will be net nonzero spin density in the sigma system, tt
particular, at the positions of the carbon and hydrogen nuclei. Unrestrict «dl
calculations (Table 3.26), show that the spin density is positive at the carbon
nucleus and negative at the hydrogen nuclei, as also shown in the figutr,
This result is commonly explained by the use of two rules: an “intraatomi
Hund’s rule”, which postulates that electrons tend to have parallel spiis on
the same atom, and a rule which States that the spins of electrons in orbitul

218 MODERN QUANTUM CHEMISTRY

Figure 3.14 Unrestricted Hartree-Fock
description of the planar methyl radical.

Table 3.26 Unrestricted SCF spin densities and hyperfine
coupling constants for the methyl radical using the standard
basis sets. A value of <7) = 0.75 corresponds to a pure
doublet
Spin density
(a.u.)

Basis set
STO-3G
4-31G
6-31G*
6-31G**

Experiment

Coupling constant
(Gauss)

c

H

a

dt

<f?>

+0.2480
+0.2343
+0.1989
+0.1960

— 0.0340
— 0.0339
—0.0303
—0.0296

+99.3
+938
+79.6
+785

—54.2
—54.0
—48.3
—47.1

0.7652
0.7622
0.7618
0.7614

+383

—23.0

0.75

that overlap to form a chemical bond tend to be antiparallel. Negative spin
density in the vicinity of the hydrogen nuclei results from application of these
two rules.
Table 3.26 shows the results of ab initio calculations of the CH; hyperfine
coupling constants. The correct qualitative results are obtained—a positive
spin density at the carbon nucleus and a negative spin density at the hydrogen
nuclei. The magnitudes of the spin densities are too large, however. They

THE HARTREE-FOCK APPROXIMATION

219

are in error by about a factor of 2 for the 6-31G** basis set. Without performing more extensive calculations, it is difficult to know whether the source
of the error is in the basis sets or in the neglect of correlation. The standard
basis sets we are using were derived primarily for the description of valence
properties, and they may not be adequate near a nucleus. In particular,
Gaussian functions are known to be poor at their origin. Also, the basis
sets that we are using contain only a single function for the mner-shell of
carbon.
The table also contains expectation values of Y?. One of the deficiencies
of an unrestricted calculation is that it does not produce a pure spin state.

The ground state of the methyl radical is a doublet with <7) = S(S + 1) =3.

The unrestricted calculations produce a doublet wave function, which is
contaminated with small amounts of a quartet, sextet, etc, as discussed
in Section 2.5. The expectation values of ? are close to the correct value of
3, showing that these contaminants are not large.
Exercise 3.41

Assume

the unrestricted

Hartree-Fock

(UHF)

calcula-

tions of Table 3.26 contain only the leading quartet contaminant. That is,

Pour = (7% + co*

If the percent contamination is defined as 100c3/(c? + c3), calculate the per-

cent contamination of each of the four calculations from the quoted value
of <S?).

We have previously used Koopmans’ theorem to calculate the first two
ionization potentials of Nj. As we saw at that time, calculations at the
Hartree-Fock limit, or with our best (6-31G*) basis set, incorrectly predict
the 711, state of NZ to be lower in energy than 2, state of NZ. That is,
the highest occupied orbital of N. is calculated to be the 17, orbital rather
than the 3¢, orbital. There are two reasons why Koopmans’ theorem might
make the wrong prediction: neglect of correlation or neglect of relaxation.
We can test the second alternative by explicitly performing Hartree-Fock
calculations on the 7I1, and 7X, state of NJ. Koopmans’ theorem calculations
assume the orbitals of these two states to be identical to those of ground
state Nj. By performing separate unrestricted calculations on these two
doublet states of N3, we will be allowing the orbitals to relax to their optimum
form. The ionization potentials can then be obtained by subtracting the total
restricted energy of the N, ground state from the total unrestricted energy
of each of the NZ ions.
Table 3.27 shows the results of 6-31G* calculations on the '2, state of
N, and the 72, and II, states of N}. To compare with experimental vertical
ionization potentials, all the calculations were performed at the equilibrium
geometry(R = 2.074a.u.) of ground state N,. These calculations still predict

that the II, state has a lower energy than the 72, state in disagreement with

220 MODERN QUANTUM CHEMISTRY

Table 3.27 SCF

calculations

on

the ground

state of N, (restricted) and two states of NZ

(unrestricted) with a 6-31G* basis set. Vertical
(R, = 2.074 a.u.) ionization potentials are
shown,

and

experimental

parenthesis

values

are

Total Energy

Tonization Potential

State

(a.u.)

(a.u.)

N'E,)

—108.94235

N31)

N3(?Z,)

in

"

— 108.37855

0.564 (0.624)

— 108.36597

0.576 (0.573)

experiment. This is therefore an indication that the qualitative disagreement
of experiment with Koopmans’ theorem ionization potentials for N2 is a

result

lack

of the

of inclusion

of correlation

effects.

Later,

inclusion

of

correlation effects will verify this.
Our final example of ab initio unrestricted calculations is O,. This
molecule has unpaired spins and is paramagnetic. The first brilliant success
of molecular orbital theory was the explanation of why O,, with an even

orbliais

8

orbitals

Orbital

Energy (a.u.)

@

-1.6
-1.8
-20.71

-20.73

-20.75
~-20.77

Figure 3.15 Unrestricted occupied
molecular orbitals of 0,072, , R =
2.281 a.u.) with a 6-31G* basis set.

THE HARTREE-FOCK APPROXIMATION

number

221

of electrons, does not have all its electrons paired. The molecular

orbitals of homonuclear diatomics are ordered 10,, 1¢,, 26,, 26,, (30,, 17,)
Ix,, 30,. The last two electrons of O, go into the doubly degenerate antibonding Ix, orbital. By Hund’s rule, these two electrons go into separate
Ix, orbitals with their spins parallel so as to enjoy the negative exchange
interaction. This, therefore, leads to a final *Z; state. The occupied orbitals

of an unrestricted 6-31G* calculation on O3, for a bond length of 2.281 a.u.,

are shown in Fig. 3.15. The “open-shell” alpha electrons in the Iz, orbital
“push” down (stabilize) the « orbitals relative to the 8 orbitals because of
exchange interactions that are present only between electrons of the same

spin. Ina restricted description, all but the 1x, orbitals would be constrained
to be paired. Note how the order of the Iz, and 3a, orbitals are reversed
for electrons of « and f spin.
To complete our discussion of unrestricted Hartree-Fock theory, we will
use our minimal basis H, model to investigate the description of bond
dissociation by unrestricted wave functions.
3.8.7

The Dissociation Problem and Its Unrestricted Solution

The unrestricted

wave function

is normally used to describe open-shell

states—doublets, triplets, etc., as in the examples of the last subsection. Under

certain circumstances, however, it may be appropriate to use an unrestricted
wave function to describe states that are normally thought of as closed-shell
singlets. For the ground state ofa molecule like H, the restricted formulation,

with electrons paired, is the usual description. As we shall shortly see, it is

also the only appropriate Hartree-Fock description under certain conditions.
At very large bond lengths, however, one is really trying to describe two
individual hydrogen atoms. A proper description will have one electron on
one H atom and the other electron on the other H atom, i.e., the two electrons
will have quite different spatial distributions. They should not have identical
spatial distributions as is implied by a restricted wave function, which places
both electrons in the same spatial orbital. It would thus appear that at
equilibrium distances we want a restricted wave function, but at large bond
lengths we want an unrestricted wave function. In a sense, we will be able
to have our cake and eat it too. As was discussed in the previous subsection,
there may exist two solutions to the unrestricted equations of Pople and
Nesbet when N* = N°, The restricted solution of Roothaan’s equations is
necessarily a solution to the Pople-Nesbet equations. It only remains to
discover whether there is a second truly unrestricted solution that is lower
in energy than the restricted solution. We shall find that for normal geometries there is not always an unrestricted solution. If, however, we stretch
a bond which cleaves homolytically, like the bond in H, (H.-H + H)
but unlike the bond in HeH* (HeH* > He + H*), then an unrestricted
solution will always exist at large bond lengths. The unrestricted solution

222 MODERN QUANTUM CHEMISTRY

accomodates the unpairing of electrons inherent in the breaking of the bond.
To see this explicitly, we will investigate wave functions for our minimal basis
model of H,.

We could numerically solve the Pople-Nesbet equations for minimal
basis STO-3G H,, just as we have solved them for CH;, Nz, and O,. An
appropriate unrestricted initial guess would be required if the iterations were
to lead to an unrestricted solution rather than to the restricted solution. The
transition from a restricted to an unrestricted wave function will be more

transparent, however, if, rather than obtain a numerical solution to the
Pople-Nesbet matrix equations, we formulate the problem in an analytical
fashion.

The restricted molecular orbitals of minimal
determined and given by

basis H, are symmetry

Ww, = [20 + S,2)J7* 7b, + 2)
wo = [21 — S,2)]7 4d, — 2)

(3.356)

(3.357)

Since the minimal basis model has only two basis functions with coefficients
that can be varied and since molecular orbitals are constrained to be normalized, the minimal basis model has, in the general case, only one degree

of freedom. An unrestricted solution, unlike the restricted solution, is not
symmetry determined and a convenient way of incorporating this one degree

of freedom into unrestricted calculations is to write the unrestricted occupied
molecular orbitals y% and w4 as linear combinations of the restricted symmetry determined orbitals y, and w,, as follows:
Wi = cosOw, + sin,

(3.358)

v4 = cos Ow, — sin0w,

(3.359)

The single degree of freedom here is in the angle 0. It is sufficient to consider
values of 0 between 0° and 45°. The value 0 = 0 corresponds to the restricted solution ¥7 = 4 = ~, and nonzero values of 0 correspond to
unrestricted solutions y% # 4. The unrestricted virtual orbitals are given by
4 = —sinOw, + cos0y,

(3.360)

W45 = sin OW, + cosOp,

(3.361)

Exercise 3.42 Show that the set of a orbitals {y7, w$} and the set of
B orbitals {yf, w4} form separate orthonormal sets.
If we substitute

the basis

set expansions

(3.356) and (3.357)

into

the

previous four equations, we will obtain basis set expansions for the unrestricted molecular orbitals. The occupied molecular orbitals, which are the

THE HARTREE-FOCK APPROXIMATION

223

only ones we need consider from now on, are given by

Wi = C161 + C2b2

Wi = cab, + C1br

(3.362)

(3.363)

where

c, = [20 + S42)] 7? cos6 + [201 — S12)] 47 siné =

(3.364)

C2 = [2(1 + S,2)}7*/? cos@ — [2 — $42)]"*/? sin@

(3.365)

By allowing ¥, to mix with w, in the definition of the unrestricted
occupied orbitals (Eqs. (3.358) and (3.359)), we allow the weights of @, and
¢, in the basis set expansions of 4 and 4 to vary as shown by Eqs. (3.362)
and (3.363). If @ = 0, the wave function is just the restricted wave function

with c, = c, = [2(1 + S,2)]~'”. As @ increases from zero, c, gets larger and

c2 gets smaller or, equivalently, { acquires a larger admixture of ¢, and
W4 acquires a larger admixture of #2. If S,, = 0 as is appropriate for large
internuclear distances, then in the limit of @ = 45° we have c, = 1, c, = 0, and

Vee lo = 4s:
1=¥2

$4, =0

(3.366)

This is the result we desire for two separate H atoms—an electron with o
spin in ¢, and an electron with £ spin in ¢2.
We thus characterize molecular orbitals for minimal basis H, by the
single parameter @. At one extreme, 8 = 0 corresponds to the restricted solution where the occupied molecular orbital is an equal mixture of ¢, and @).
At the other extreme, 0 = 45° corresponds to an unrestricted solution for
isolated hydrogen atoms. Intermediate value of @ correspond to unrestricted

solutions where 7 is mainly ¢, and yf is mainly ¢,. Figure 3.16 gives a
qualitative picture of the unrestricted molecular orbitals of H, as a function
of 6. While we have derived this picture using the minimal basis, the figure
is qualitatively correct for H, with any basis set.
We have seen that for the ground state of a closed-shell molecule like
H, it appears possible to define unrestricted wave functions which have the
qualitatively correct behavior that we expect for the dissociation process,
It remains to relate these unrestricted wave functions to solutions of the
Hartree-Fock equations. If we solve the Pople-Nesbet equations, will a nonzero value of @ be obtained? To investigate this question, we need to determine the energy as a function of 0.
The electronic energy of an unrestricted single determinant wave function for H,,

[o> = Wx(DP4Q)>

(3.367)

224

«eK A

MODERN QUANTUM

CHEMISTRY

¥

vy

Figure 3.16 Qualitative behavior of unrestricted molecular orbitals ¥7 and ¥f for H, as a
function of 6.

is just the Kinetic energy and nuclear attraction of each electron, plus the
coulomb repulsion between the two electrons. That is,
Eo = CP o|/|Po> =hi,

+hh,

+ JF,

= (Wilh) + (WHA) + Wis [ViVD

(3.368)

Substituting the expansions (3.358) and (3.359) into this expression, we can
write the electronic energy, as a function of 0, in terms of molecular integrals
of the restricted problem

E,(0) = 2cos? 6h,, + 2sin? 0hz. + cos* OJ,,
+ sin*0J,. + 2 sin? @ cos? 0(J,2 — 2K,2)

(3.369)

If @ = 0, the unrestricted energy just reduces to the restricted energy

E,(O) = 2hy, + Ja

(3.370)

The first derivative of the unrestricted energy with respect to 0 is

dE,(0)/d0 = 4cos6 sin [hz — hy, + sin? 0J22 — cos” OJ,
+ (cos? @ — sin? #)(J4.—2K,2)]

(3.371)

To find the values of 8 which solve the Pople-Nesbet equations, i.e., to

find the values of @ which make the unrestricted energy stationary, we set

THE HARTREE-FOCK

APPROXIMATION

224

the first derivative of the unrestricted energy to zero,

dE,(0)/d0 = AB =0

(3.372)

where

,

(3.373)

A = 4cos@ sin @
and
B=

hy2—hy,

+ sin?

OJ 22 —cos”

OJ 44 +(cos?

@—sin?

ANY 12 —2K,2)

(3.374)

There are thus two ways the energy could be stationary:
1. A =0. This is the restricted solution. The condition is satisfied if @ = 0.
2. B=0. This is the unrestricted solution. The condition is satisfied and

there exists an unrestricted wave function only if there is a solution to:

cos?0 =n

(3.375)

where

n=(hz2—hyy tJ 22—J 12 +2K 2)

11 + J 22-29 12+4K 12)

(3.376)

This last equation is obtained by setting B of Equation (3.374) to zero. This

equation has a solution only if the internuclear distance and basis functions,

and hence the molecular integrals h,,, h22, etc., are such that 7 lies between

zero and one, Le, 0 <9 < 1.

Exercise 3.43 Use the molecular integrals given in Appendix D to show

that no unrestricted solution exists for minimal basis STO-3G H, at R =
1.4a.u. Repeat thecalculationforR = 4.0a.u. andshowthat an unrestricted
solution exists with @ = 39.5°. Remember that ¢, =hy, + J1, and e, =
hag + 212 — Ki2.

To proceed with the analysis let us investigate the nature of the restricted
solution (0 = 0) by evaluating the second derivative of the energy (at the
restricted solution),

d?E,(0)/d0"}g-9 = Eo(O) = 4(h22 — ya — Jas + Jia — 2K12)
= 42, — &, — J,2 — Ky2)
(3.377)
The nature of the restricted solution is determined by this second derivative.
If EG(0) > 0, it is an energy minimum. If E,(0) < 0, it is an energy maximum.
If E9(0) = 0, i-e., if
hy

— hy

= Ju

— Ja + 2K

(3.378)

then the restricted solution is a saddle point. Substituting this last saddle
point condition into Eq. (3.376), we findthat 7 = lat the saddle point. Using
the molecular integrals of Appendix D we can investigate the behavior of

226

MODERN QUANTUM

CHEMISTRY

E,(6)

a) Small

R

°

6

E,(6)

b)

Large

R

°

8

Figure 3.17 Qualitative behavior of the
unrestricted energy of H, as a function
of 8 for small and large internuclear
distances: a) small R; b) large R.

Eo(0) and y as a function of bond length. At short bond lengths
E%(0) > 0
and 7 > 1. As the bond length increases both EG(0) and y decrease mono-

tonically, until they reach a limit at R = 00 of Eg(0) = —1/2 (¢,¢,|¢1¢4)

and 9 = 1/2. At a transition point, which occurs in the vicinity of R = 2.3 a.u.,
the second derivative EG(0) becomes negative and simultaneously 7 becomes
less than 1. The behavior of the solutions is therefore as follows: At short
bond lengths y > 1, the restricted solution is a true minimum, and no unrestricted solution exists. On increasing the bond length the value of y
decreases until, at a distance
of approximately 2.3 a.u., 7 becomes 1 and a
saddle point occurs in the energy. This transition point defines the onset of
an unrestricted solution. At a bond length beyond this, the restricted solution (0 = 0) is actually a maximum in the energy as shown in Fig. 3.17. When
an unrestricted solution exists (y < 1), the value of 7 can be equated to
cos? @. As the bond length becomes larger and larger, 6 gives to the limit of
45° appropriate to isolated hydrogen atoms. A potential curve for STO-3G
H, showing the two solutions is shown in Fig. 3.18. The unrestricted energy
goes smoothly to the limit of two hydrogen atoms calculated with the same

basis set, ie., 2(,|h|¢,). The restricted energy goes to a limit 1/2(¢,¢,|¢191)

above the right result. Also shown in Fig. 3.18 is the essentially exact result
of Kolos and Wolniewicz.5 The hydrogen atom energies used in the figure
(— 0.4666 and —0.5) are obtained with the basis sets employed in the respective methods, Thus, both curves go to zero at large R. The corresponding
curves for a 6-31G** basis set are shown in Fig. 3.19.
The “correct” dissociation of H,, which we have obtained by using an
unrestricted

wave

function,

is not free of faults.

The

unrestricted

wave

0.04
0.02

0.00
2

ZS

~002

—

-0.04

WW
a

0.08

I
“x,

-0.08

=

<x

WwW

10

14

18

22
RHF

286/30
;

34
Yo

7

,

c

Riau)
Po

a:
(Kolos-Wolniewicz)
|

010
-O.12
0.14
-0.16

0.18

0.06
0.04

0.02
—

2

Zz

0.00
0.02

=lw

-0.04

1

-0.06

ru]

=

x

w

/

os
,

0.10

/-= Exact

7/

/ (Kolos-Wotniewicz)

-0.12
-0.14
-0.16
0.18

Figure 3.19 6-31G** potential energy curves for H2.

227

228

MODERN QUANTUM CHEMISTRY

function is not a pure singlet as one would like it to be. The energy goes to
the correct limit but the total wave function does not, as we shall now see.

In the limit R > oo, the molecular orbitals become W% = ¢, and Wf = ¢,
and the unrestricted single determinant |Wo> of Eq. (3.367) becomes

(3.379)

limit |¥o> = |1(1)62(2)>
Roa

This, however, is not the correct form for a singlet wave function in which

electrons occupy different spatial orbitals ¢, and 2.
(2.260), the singlet wave function should be

In analogy to Eq.

limit [o> = 2°76
(1) b2(2)> + [6218129]

(3.380)

The orbitals are correct but the total wave function is not. An alternative
way of looking at this problem is obtained by substituting the expansions
(3.358) and (3.359) for the unrestricted molecular orbitals into the single

determinant |‘¥9> and expanding the determinant
'Po> = Wwivt>

= cos? AlWid> — sin? OW 22>

— (2)'/? cos@ sin O[|Wiv2> _ [Wo 11/2)?

= cos? Ol,.> — sin? Ol 22>

—(2)"? cosé sin 6|*¥?>

(3.381)

Here, |*7> is the singly excited triplet configuration defined in Eq. (2.261).
The closed-shell determinants )/iW1> and )y2f2> are, of course, singlets.
An unrestricted single determinant for the ground state of H, is thus not a
pure singlet but is contaminated by a triplet. The mixing of the doubly
excited determinant |y.)2>, with |W,,> allows the dissociation to go to
the correct limit, but the triplet contaminant is required if the final wave
function is to be a single determinant. As R > oo the triplet contamination
increases until it represents 50% of the wave function,

limit 'Po> = 1/2[id> — oad — PHD]

(3.382)

Although the correct dissociation energy is obtained using an unrestricted
wave function, the poor wave function will limit the desirability of using,
near the dissociation limit, an unrestricted single determinant as a starting
point for configuration interaction or perturbation calculations.
Exercise 3.44 Derive Eq. (3.379) from Eq. (3.382).
We have only discussed the restricted Hartree-Fock dissociation problem for the minimal basis model of H,. The ideas presented are not limited

to H,, however, and very similar effects will occur for other closed-shell
systems when a bond is stretched. In H,, the onset of unrestricted solutions

THE HARTREE-FOCK APPROXIMATION

229

occurs beyond the equilibrium distance but in the general case there may
even be unrestricted solutions at the experimental geometry. By an extension of our analysis, it is possible to derive general conditions under which
there exists an unrestricted solution lower in energy than the closed-shell
restricted solution (Thouless, 1961).

NOTES
1. J. S. Binkley, R. A. Whiteside, R. Krishnan, R. Seeger, H. B. Schlegel, D. J. Defrees,
and J. A. Pople, Gaussian 80, program #406, Quantum Chemistry Program Exchange,

Indiana University. More recent versions, such as Gaussian 88, are available via Professor #

John Pople of Carnegie-Melion University.
2. Hartree-Fock theory in special cases, such as for restricted open-shell wave functions,
involves a multideterminantal wave function. Since we will be concerned only with un-

restricted open-shell wave functions, all Hartree-Fock wave functions will be single determinants.
3. In principle it 1s possible to use the procedures to be discussed in this section to obtain
restricted closed-shell excited states, but there is no general way of keeping such calculations
from converging to the ground state Wo) if the excited state has the same symmetry as the
ground state.
4. C. C. J. Roothaan, New developments in molecular orbital theory, Rev. Mod. Phys. 23:
69 (1951).
5. W. Kolos and L. Wolniewicz, Improved theoretical ground-state energy of the hydrogen
molecule, J. Chem. Phys. 49: 404 (1968).
6.

L. Woilniewicz, Variational treatment of the HeH* 10n and the B-decay m HT, J. Chem.

Phys. 43: 1087 (1965).
7. ¥.N, Levine, Quantum Chemistry, Allyn and Bacon, Boston, 1974, p. 190,
8. S. Huzinaga, Gaussian-type functions for polyatomic systems. 1, J Chem. Phys. 42: 1293
(1965).
9. T. H. Dunning, Gaussian basis functions for use in molecular calculations. I. Contraction
of (9sSp) atomic basis sets for the first-row atoms, J. Chem. Phys. 53: 2823 (1970).

10. The slash here separates heavy atom (Li-Ne) basis functions from hydrogen atom basis
functions.
11. R. F. Stewart, Small Gaussian expansions of Slater-type orbitals, J. Chem Phys. 52: 431
(1970).
12. J. A. Pople and R. K. Nesbet, Self-consistent orbitals for radicals, J. Chem. Phys. 22: 571
(1954).

FURTHER

READING

Cook, D. B., Ab Initio Valence Calculations in Chemistry, Wiley, New York, 1974. This book
is a good source of information on the practical aspects of perfoiming ab initio selfconsistent-field calculations,

Davidson, E. R. and Feller, B., Basis set selection in molecular calculations, Chem. Rev.
86: 681 (1986). This article describes and compares the performance of a variety of
Gaussian basis sets that are m common use.
England, W., Salmon, L. §., and Ruedenberg, K., Localized MO’s: A bridge between chemical

intuition and molecular quantum mechanics, in Topics in Current Chemistry, SpringerVerlag, 1971; Caldwell, D. and Eyring, H., Localized orbitals in spectroscopy, Adv.
Quantum Chem. 11: 93 (1978). These two references discuss the invariance of HartreeFock orbitals to a unitary transformation, and the physical interpretation of particular

230 MODERN QUANTUM CHEMISTRY
transformations. A particular concern of many quantum chemists is transformations
which localize the orbitals.

Hehre, W. J., Radom, L., Schleyer, P. v. R., and Pople, J. A., Ab Initio Molecular Orbital
Theory, Wiley, New York, 1986. This excellent book contains a simple account of

molecular orbital theory focusing on computational techniques and the Gaussian series
of software programs. Numerous applications to chemical problems are discussed. Chapter 4 describes the STO-3G,

4-31G, 6-31G*, and 6-31G** basis sets used in many of

our illustrative calculations, as well as others (e.g. 3-21G and 6-311G*") that are now

in common use.
Hurley, A. C., Introduction to the Electron Theory of Small Molecules, Academic Press, New
York, 1976. The restricted open-shell Hartree-Fock procedure, which we have not expanded upon is described.
i
Melius, C. F. and Goddard, W. A. IIE, Ab initio effective potentials for use in molecular quantum mechanics, Phys. Rev. A10: 1528 (1974); Kahn, L. R., Baybutt, P., and Truhlar, D. G.,
Ab initio effective core potentials: Reduction of all-electron molecular structure calculations to calculations involving only valence electrons, J. Chem. Phys. 65: 3826 (1976).
For calculations involving atoms beyond the second long row of the periodic table, it is
common to exclude inner-shell electrons from the calculation and to introduce an effective
one-electron potential (a pseudo-potential) which accounts for these electrons. These two
papers describe an ab initio procedure for deriving such a pseudo-potential.
Ohno, K. and Morokuma, K., Quanturn Chemistry Literature Data Base, Elsevier, New
York, 1982. This book contains a bibliography of ab initio calculations for 1978-1980,
with more than 2500 literature citations, Since 1982, annual updates of this data base
are being published in J. Mol. Structure (THEOCHEM).

Pulay, P., Analytical derivative methods in quantum chemistry. Adv. Cherm. Phys. 69: 241

(1987). Recent advances in the calculation of first, second, and higher-order derivatives

of both SCF and correlated energies with respect to the internuclear coordinates are
reviewed.
Richards, W. G., Walker, T. E. H., and Hinkley, R. K., A Bibliography of ab initio Molecular
Wave Functions, Oxford University Press, 1971; Supplement

for 1970-73,

Richards,

W. G., Walker, T. E. H., Farnell, L., and Scott, P. R. (1974); Supplement for 19741977, Richards, W. G., Scott, P. R., Colbourn, E. A., and Marchington, A. F. (1978);
Supplement for 1978-1980, Richards, W. G., Scott, P. R., Sackwild, V., and Robins,

S. A. (1981). These books provide an essentially complete catalogue of published
ab initio calculations.
Schlegel, H. B., Optimization of equilibrium geometries and transition structures. Adv. Chem.
Phys. 67: 249 (1987). A number of algorithms for finding stationary points of potential
surfaces using derivatives of the energy with respect to internuclear coordinates are
discussed.

Thouless, D. J., The Quanturn Mechanics of Many-Body Systems, Academic Press, New
York, 1961. The transition from a restricted to an unrestricted wave function is part of
the Hartree-Fock stability problem and is closely related to the random phase approx-

imation. The original source of information on this problem is this book.

CHAPTER

FOUR

CONFIGURATION INTERACTION

As we have seen in the last chapter, the Hartree-Fock approximation, while
it is remarkably successful in many cases, has its limitations. An example of
where it predicts qualitatively incorrect results is the ordering of the ionization potentials of N2. Moreover, the restricted HF method cannot describe
the dissociation of molecules into open-shell fragments (e.g., H,— 2H).

While the unrestricted HF procedure does give a qualitatively correct
picture of such dissociations, the resulting potential energy curves (or, in

general, surfaces) are not accurate. The rest of this book will focus on a
variety of procedures for improving upon the Hartree-Fock approximation.

We will be interested in obtaining the correlation energy (E,,,,), which is
defined as the difference between the exact nonrelativistic energy of the
system (&) and the Hartree-Fock energy (Eo) obtained in the limit that the

basis set approaches completeness

Ecos

=

&o ~~ Eo

(4.1)

Because the Hartree-Fock energy is an upper bound to the exact energy, the
correlation energy ts negative.
In this chapter we consider the method of configuration interaction (CI)
for obtaining the correlation energy. Of all the approaches considered in
this book, CI is conceptually (but not computationally!) the simplest. The
basic idea is to diagonalize the N-electron Hamiltonian in a basis of Nelectron functions (Slater determinants). In other words, we represent the
23)

232 MODERN QUANTUM CHEMISTRY

exact wave function as a linear combination of N-electron trial functions
and use the linear variational method. If the basis were complete, we would
obtain the exact energies not only of the ground state but also of all excited
states of the system. In order to limit the size of this chapter, we will not
consider CI calculations of excited-state energies.
In principle, CI provides an exact solution of the many-electron problem.
In practice, however, we can handle only a finite set of N-electron trial
functions; consequently, CI provides only upper bounds to the exact energies.
How can we obtain a suitable set of N-electron trial functions? As we have
seen in Chapter 2, given some arbitrary set of 2K one-electron spin orbitals,
2K\
.
.
we can construct ( »)

different N-electron Slater determinants. Unfortu-

nately, even for small molecules and moderately sized one-electron basis
sets, the number of N-electron determinants is truly enormous. Thus even
if one uses a finite one-electron basis, one usually must truncate the trial
function in some way and use only a fraction of all possible N-electron

functions.
We will begin this chapter by constructing determinantal trial functions
from the Hartree-Fock molecular orbitals, obtained by solving Roothaan’s
equations. It will prove convenient to describe the possible N-electron
functions by specifying how they differ from the Hartree-Fock wave function
‘Yo. Wave functions that differ from ‘Yo by n spin orbitals are called n-tuply
excited determinants. We then consider the structure of the full CI matrix,

which is simply the Hamiltonian matrix in the basis of all possible Nelectron functions formed by replacing none, one, two, . . . all the way up to
N spin orbitals in ¥ 9. In Section 4.2 we consider various approximations to
the full CI matrix obtained by truncating the many-electron trial function
at some excitation level. In particular, we discuss, in some detail, a form of
truncated CI in which the trial function contains determinants which differ
from
yo by at most two spin orbitals. Such a calculation is referred to as
singly and doubly excited CI (SDCI).
In Section 4.3 we present the results of numerical calculations which
serve to illustrate various aspects of the general theory. In Section 4.4 we
introduce natural orbitals which have the important property that they lead
to the most rapidly convergent CI expansion. In Section 4.5 we briefly
discuss another approach to limiting the length of the CI expansion called
the multiconfiguration self-consistent field (MCSCF) method. The basic idea
of this approach is to use the variation principle to determine the orbitals
used in the CI expansion. One considers a trial wave function containing
relatively few determinants and optimizes not only the expansion coefficients
but also the orbitals. Finally, in Section 4.6 we examine a serious deficiency
of all forms of truncated CI that makes the approach inapplicable to large
systems and highlights the need for the alternate approximation schemes to
be discussed in subsequent chapters.

CONFIGURATION

INTERACTION

4.1 MULTICONFIGURATIONAL WAVE FUNCTIONS
THE STRUCTURE OF THE FULL CI MATRIX

233

AND

For the sake of simplicity, we assume in this chapter that our molecule of
interest has an even number of electrons and is adequately represented, to a
first approximation, by a closed-shell restricted HF determinant, |¥>. Suppose we have solved Roothaan’s equations in a finite basis set and obtained
a Set of 2K spin orbitals {y;}. The determinant formed from the N lowest
As we have seen in Chapter 2, we gan form, in

energy spin orbitals is Po).

addition to | o>, a large number of other N-electron determinants from the
2K spin orbitals. It is convenient to describe these other determinants by
stating how they differ from |W >. Thus the set of possible determinants

include |), the singly excited determinants |¥%> (which differ from |¥)>

in having the spin orbital x, replaced by ,), the doubly excited determinants
\Wrs>, etc, up to and including N-tuply excited determinants. We can use
these many-electron wave functions as a basis in which to expand the exact
many-electron wave function |p). If | > is a reasonable approximation to
|®,>, then we know from the variation principle that a better approximation
(which becomes exact as the basis becomes complete) is

Po)
= color + D coed + D caeles
a<b
r<s

+ Yo cibel toed +d)
a<b<c

cibealWibea>to 7*

a<b<c<d

r<s<t

(42a)

r<s<t<u

This is the form of the full CI wave function. The restrictions on the summation indices (e.g., a < b,r < s, etc.) insure that a given excited determinant
is included in the sum only once. When doing formal manipulations it is
sometimes convenient to remove this restriction and rewrite Eq. (4.2a) as

(ea) = alr +(4) Dalen +(55) ¥ cals
1

2

1

1

2

(i ) Yes wad + ii
(5
abe

2

Yorn

+--+

abcd

rst

(4.2b)

rstu

A factor (1/n!)? is included in front of the summation involving n-tuply
excited determinants to insure that a given excitation is really counted but
once.

For

example,

the

unrestricted

summations

include the following terms
rs

|\uprs

Ca Ess,

>

ce | Pes

,

sr

cS

lupsr

PS,

>

and

for double
sr

excitations

|\psr

cele,

Now, if we require the coefficient cj, to be antisymmetric with respect 'o the
interchange of a and b or r and s just as the wave functions, then all four

234

MODERN

QUANTUM

CHEMISTRY

terms are equal. Thus the factor of 1/4 insures that each determinant is
counted only once.
How many n-tuple excitations are there? If we have 2K spin orbitals,
N will be occupied in |‘¥)> and 2K — N will be unoccupied. We can choose
_
{N
.
n spin orbitals from those occupied in |'¥> in ( ) ways. Similarly, we can
n
.
.
.,
.
(2K choose n orbitals from the 2K — N virtual orbitals in
N ways. Thus
n
_ [N\f2K —N
.
the total number of n-tuply excited determinants is ( )(
h
) Even
n
for small molecules and one-electron

basis sets of only moderate size, the

number of n-tuply excited determinants is extremely large for all n except
0 and t. A significant number of these determinants can be eliminated
(although in most cases not enough!) by exploiting the fact that there is no

mixing of wave functions with different spin (ie. «P| > = 0 if [¥;> and

|W ,> have different spin). Suppose we are interested in the singlet states of a
molecule. Then we can immediately eliminate from the trial function those
determinants which do not have the same number of x and £ spin orbitals
(i.e, keep only those which are eigenfunctions of /, with eigenvalue 0).
Moreover, as we have seen in Section 2.5, by taking appropriate linear
combinations of these remaining determinants we can form spin-adapted
configurations which are eigenfunctions of
?. Thus if we are interested in
singlet states we need only include singlet spin-adapted configurations in the
trial function. Although actual calculations always use spin-adapted configurations, it will be convenient, however, to develop the formalism in terms of
determinants, since the resulting expressions have a simpler structure.
Given the trial function of Eq. (4.2) we can find the corresponding
energies by using the linear variational method. As we have seen in Chapter 1,
this consists of forming the matrix representation of the Hamiltonian in the
basis of the N-electron functions of expansion (4.2) and then finding the
eigenvalues of this matrix. This is called the full CI matrix, and the method
is referred to as full CI. The lowest eigenvalue will be an upper bound to the
ground state energy of the system. The higher eigenvalues will be upper
bounds to excited states of the system. Here we will focus only on the lowest
eigenvalue. The difference between the lowest eigenvalue (&,) and the
Hartree-Fock energy (E,) obtained within the same one-electron basis is
called the basis set correlation energy. As the one-electron basis set approaches
completeness, this basis set correlation energy approaches the exact correlation energy. The basis set correlation energy obtained by performing a full
CI is, however, exact within the subspace spanned by the one-electron basis.
Thus it constitutes a benchmark by which all other approaches to the
calculation of the correlation energy performed with the same basis set
should be judged. For a given one-electron basis set, full CI is the best that
one can do.

CONFIGURATION INTERACTION

234

To examine the structure of the full CI matrix it is convenient to rewrite

the expansion of Eq. (4.2) in a symbolic form

IDo> = Col%o> + Cs|S> + cp|D> + cz|T> + cglQ> +°°-

(4.3)

where |S) represents the terms involving single excitations, |D) represents

the terms involving double excitations, and so on. Using this notation, the
full CI matrix is presented in Fig. 4.1. The following observations are
important:

1. There is no coupling between the HF ground state and single excitations

(ie., <Wo/3¢[S> = 0). This is a consequence of Brillouin’s theorem (see
Subsection

3.3.2), which

states that all matrix

elements

of the form

<P o|9¢|¥2> are zero.
. There is no coupling between |'P,> and triples or quadruples. Similarly,
singles do not mix with quadruples. This is a consequence of the fact
that all matrix elements of the Hamiltonian between Slater determinants
which differ by more than 2 spin orbitals are zero. A corollary of this is
that the blocks that are not zero are sparse. For example, the symbol
<D|#|Q> represents

{DI2|Q> > (PRO | Pcie
For a matrix element of this type to be nonzero, the indices a and b must
be included in the set {c, d, e, f} and the indices r and s must be included
in the set {t, u, v, w}.
. Because single excitations do not mix directly with |¥5>, they can be
expected to have a very small effect on the ground state energy. Their
effect is not zero because they do mix indirectly; that is, they interact

with the doubles which in turn interact with |‘¥)>. Although they have

<Pol | Pol

[Po>

|Po>

[>
IS>

0
<S|#|S>

[ws
[D>

[¥aee>
IT>

[Pa
[Q>

<DD>

<DI24|T)
<TH#1T>

<Di27|Q>
<T#4|1Q>
(Q(#(Q>

<¥,|3¢|D)>
0
<S|ID> — <Sla?|T)

0
0

--+:

(S|¢|T)
> CHEE,
CDs#|D>
> (PSE)
Figure 4.1 Structure of the full Cl matrix. The matrix is Hermitian and only the upper triangle
is shown.

236 MODERN QUANTUM CHEMISTRY

almost negligible effect on the energy of the ground state, they do influence the charge distribution and, as we shall see later, single excitations

are needed for a proper description of one-electron properties such as
the dipole moment. The situation is entirely different for excitedelectronic states. In the calculation of the electronic spectra of molecules
the single excitations play the primary role.
. Because it is the double excitations that mix directly with |'¥9), it is to
be expected that these excitations play an important, and, for small
systems, a predominant role in determining the correlation energy.
Moreover, it turns out that quadruple excitations are more important
than triple or single excitations if one is concerned solely with the ground
state energy.

. All the matrix elements required for actual calculations can be found

using the rules described in Chapter 2. As mentioned previously, cal-

culations are performed using spin-adapted configurations. These have
been discussed in detail in Section 2.5 for singly and doubly excited
determinants. Some of the matrix elements in the CI matrix involving
these configurations are given in Table 4.1. They will be used several
times later in the book. You might like to test your facility with the rules
for evaluation of matrix elements and your stamina by checking the
entries in the table.

Table 4.1 Some matrix elements between singlet symmetry-adapted
configurations constructed from real orbitals
SINGLE EXCITATIONS
CW

(Fol3 |'¥i> = 0

— Eo|'Y8> =,

— €)6,s5an — (rs| ba) + 2(ral bs)

DOUBLE EX CITATIONS
CV
|'Paa> = Kya
CP 2['VE>

= 21/7(salra)

CY || ¥e,> = 21rd] ra)
CY [se |4855> = 3'/((ral sb) — (rb| sa))
CY
20 Ph)

= (ral sb) + (rb| sa)

OWa IH — Eol Vin) = 2(e, — €) + Jaa + Se ~ Wea + 2K,,

C Wale — Eol! Wis) = & + & — 28, + Jaa + Sis t+ Krys — 2950 — Wa + Kea + Kyo
CWC

— Eo|! Pt,

CAI

— Eol*¥%> = & + &s — Ba — & + San + Js — Kar

CPW

— Eol?¥25> = & + &s — Ea ~ && + San + Sis + Kas

= 26 — ba — &e + Se + Sob + Kan — 2S — Wea + Krp + Kea
— Ky, — Isp — Ssa — Sp ~ Sra + H Kop + Kea + Kip + Kea)

CAP CPP

= 8/4)"

+ Kys — Jp ~ Sea — Sr — Sra + 3K + Kea + Ky + Kya)
K a — Kea — Kip + Kea)

CONFIGURATION INTERACTION

237

4.1.1 Intermediate Normalization and an Expression for the
Correlation Energy
Now that we have examined the general features of the full CI matrix, we
will study the CI formalism in greater detail, as applied to the ground state
of the system. When |'¥ ,> is a reasonable approximation to the exact ground

State wave function |®,>, the coefficient c, in the CI expansion (see Eq. (4.2))

will be much larger than any of the others. It is convenient to write |)

an intermediate normalized form

in

[Por= [For + Lalo + 2 caeea
c<d
t<u

+

>
e<d<e

tu

ce

ypstue

eeae>

+

t<u<c

Because

>
e<d<e<f

tuowlyystuow

idep>

Codes

+

wee

(4.4

t<u<ou<w

(Dy IPod = 1+ Vay

+ ¥ (a4)?+
c<d
t<u

this wave function is not normalized. However, it has the property that

(4.5)

{¥o|Po> = 1

Given the intermediate normalized |®,> we can always normalize it, if we
so desire, by multiplying each term in the expansion by a constant (ie.,

|5> = c'|®p), chosen so that <®5|®,> = 1.)

As discussed in Chapter 1, an equivalent formulation
variation method is simply to write

of the linear

H|\Dy> = Eq|Py>

(4.6)

where |®,) is given by Eq. (4.4) and then successively multiply this equation
by «P|, P|, <2, etc. Before we do this, it is convenient to rewrite Eq. (4.6)

by subtracting E,|®,> from both sides to obtain
(#

- E,)|®o>

= (Eo _ E,)|®o>

(4.7)

= Ecor|Po>

where E,,,, is the correlation energy. If we multiply both sides of this equa-

tion by <‘¥,| we obtain
<P |

~

E,|®o>

=

Ecorr<¥o|Po>

=

(4.8)

core

where we have used the fact that |) is intermediately normalized. Now
consider the left-hand side of the equation. Using the expansion in Eq. (4.4),
we have

(Po|H# — Eq|®o> = CP of H# — Ep o(ltortde alP+

Y cup

t- |

c<d
t<u

=)c<d cP |r|")
t<u

(4.9)

238 MODERN QUANTUM CHEMISTRY

where we have used Brillouin’s theorem ({¥ ||P
= 0) and the fact that
triple and higher excitations do not mix with | > because they differ from
|\¥)> by more than two spin orbitals. Combining Eqs. (4.8) and (4.9) we have
the following explicit expression for the correlation energy:

Econ = , CaS Vl
a<b

[PG

(4.10)

r<s

Thus the correlation energy is determined solely by the coefficients of the
double excitations in the intermediate normalized CI function. This does
not mean that only double excitations need to be included for an exact CI
description of the ground state; the coefficients {cl3} are affected by the
presence of other excitations. To see this, multiply Eq. (4.7) by <‘¥%| to obtain

(PH — Eo|®o> = Ecore<¥i|Po>

Using the expansion for |®,> and Brillouin’s theorem this becomes

VCP
ct

— El¥e> + Ya
P HD
c<d
t<u

+

Yo

c<d<e

ceaek Pale Keds

t<u<v

ee eo

(4.11)

This expression can be simplified somewhat by taking into account the fact
that there are nonzero matrix elements between singles and triples only

when a equals c, d, or e and r equals t, u, or v. This allows us to rewrite Eq.
(4.11) as

Yi cK PH
ct

— El ¥o> + Y cea PH Va + Yo cate PHP ice
c<d
t<u

= Eon

e<d
t<u

(4.12)

The important point about this equation is that it contains, and hence
couples, the coefficients of the singles, doubles, and triples. If we continue

the above procedure by multiplying Eq. (4.7) by <‘P%|, «Pail, etc., we would

end up with a hierarchy of equations that must be solved simultaneously
to obtain the correlation energy. This set of coupled equations is extremely
large if all possible excitations are included. This is just another way of saying
that the full CI matrix is extremely large. After illustrating the formalism
developed so far, by applying it to minimal basis H,, we will return to the
problem of truncating the CI matrix to a manageable size.

Exercise 4.1 Obtain Eq. (4.12) from (4.11). It will prove convenient to
use unrestricted summations.
Let us consider the application of the above formalism to minimal
basis H. Since this is a two-electron system, full CI involves only single and
double excitations. Recall that in this model we have two molecular orbitals:
y, is the bonding orbital with gerade symmetry and yw, is the antibonding

CONFIGURATION INTERACTION

239

orbital with ungerade symmetry. The HF ground state wave function is
|\¥o>

=

lWits>

=

\11>

(4.13)

Since we have four spin orbitals (y, = 1, x7. = 1, y; = 2, ¥4 = 2) we can
form in addition to |¥)>, five other determinants namely, |12), |21>, |12),
|21, and |22)>. Using these determinants, the full CI wave function can be
written as

[Dy
> =|%o> +.c7|2T> + cF]12> + cF]12 + c3]21> + c??|22>

(4.14)

We can rewrite this in terms of spin-adapted configurations as follows.
Since the exact ground state is a singlet we know that only configurations
of singlet symmetry need be included in the expansion. The doubly excited
state is a closed-shell and hence a singlet. Out of the four singly excited

determinants |21), |12), [12>, [21> we can form one singlet state and three
triplets. The singlet state is (see Eq. (2.260))

w2> = 2-211) 4 J27)
Thus the spin-adapted expansion is

[®o> = [Pod + cif WT) + c77|22)

(4.15)

Finally, we can simplify the expansion further by taking into account

the spatial symmetry of the system. Both |¥,)> and |22) are of gerade sym-

metry while |'¥7) is of ungerade symmetry because it contains one orbital
with gerade and one with ungerade symmetry. Therefore, this single excita-

tion will not mix with [¥> or (22>. Thus we can write the CI expansion,
which is both symmetry and spin-adapted, as

ID) = |Wo> + 73 [22> = [Wo> + c23]}¥22>

(4.16)

Given this trial function, the variational method tells us that the corre-

sponding energy (6) is the lowest eigenvalue of the CI matrix

-(oere
CPM Fo>

Pole ii )
PVT

The required matrix elements are readily evaluated using the rules o
Chapter 2. Since the molecular orbitals are real, we have

CP | |Wo>=Eo=2hirtJis

(4.17a)

CV of H]}L27> = C1] [22> =(12|12)= Ky 2 = 33]
|% o> — (4.17)

(VFR
VID =2ha2+-J22

(4.17¢)

Using the HF orbital energies (see Eqs. (3.130) and (3.131))
&=hyy

tJ

&2 = hy, + 234. — Ki2

240

MODERN QUANTUM CHEMISTRY

the diagonal matrix elements can be rewritten as
Eo = 28, — Jay

(4.17d)

(P22 [22> = 20. — 42 + Jog + 2Ki2

(4.17e)

Having evaluated the matrix elements, it is a straightforward matter to
find the lowest eigenvalue of the matrix using the secular determinant or
unitary transformation approach discussed in Chapter 1. Here we wish to
solve the problem by a somewhat different but completely equivalent way,
that we shall use many times in this bqok. We start by substituting Eq. (4.16)
into Eq. (4.7):

(# — Eo)(|¥o> + cl¥i7>) = Ecor(|Po> + e|¥ID)

(4.18)

where we have written c for c??. Multiplying this equation by <¥o| we have
Ecorr

=

CCV

of H|P

TD

=

cK i2

(4.19a)

Similarly, multiplying by <‘?33] we have

CPF o> + CPIH — Eql'Pi7> = CEcors

(4.19b)

Defining

2A = (P74 — E,|P72> = eo — €1:) + Ji, + Jag — Wa + 2Ki2

(4.20)

where we have used the matrix elements in Eq. (4.17), we can rewrite Eq.
(4.19b) as

(4.21)

Ky. + 2Ac = CE cope

The two simultaneous equations (4.19a) and (4.21) can be combined into the
matrix equation
-

(c., 28)(C) ==E #ame(2)

4.22
(4.22

We could have obtained this result directly from the CI eigenvalue problem:
( Eo
Ki

Ky
P22

(2)

=€(“)

Cy

cy

BID

by simply subtracting
Eo

OV\{(co

0

Eg/\e1

from both sides, using the definition of 2A (Eq. (4.20)) and setting cp = 1
{intermediate normalization), 6 — Ey = E,,,,, and cy; =c. To obtain the
lowest eigenvalue we solve Eq. (4.21) for c:
c=

Ki
Ecorr

—

2A

CONFIGURATION INTERACTION

241

and substitute this into Eq. (4.19a) to obtain
Ecos

Kia

~ E..—_2A
comr

This equation is a quadratic equation for E,,,,, which can be solved for the
lowest root, Le.,
A — (A? + K?,)1?
(4.23)
corr =

This is the exact correlation energy of H, within the minimal basis set of
atomic orbitals.
Exercise 4.2 Using the secular determinant approach
lowest eigenvalue of the matrix

is given by Eq. (4.23).

0
K,,

show

that the
‘

Ki
2A

The exact energy of minimal basis H, is
6o = Eg + Econ = 2hyy + Ji, +A — (A? + Kj2)”

(4.24)

In contrast to Eo, this full CI energy properly describes the dissociation of
H,, as might be expected, since it is the exact energy in the basis. To see this,
recall that as R— oo, h,, = h,, > E(H), where E(H) is the energy of the
hydrogen atom in the basis and that all molecular orbital two-electron
integrals tend to 3(¢1¢,|¢1¢,), where ¢, is a hydrogenic orbital. It then

follows that A-+0 as R> 00 and hence E,o,,> —K12 = —3(¢1¢1|¢11)

which exactly cancels the long range limit of J,, thus ensuring that 6,
approaches 2E(H). The full CI, RHF, and UHF potential energy curves for
STO-3G H, are compared in Fig. 4.2. Note that although, in contrast to
RHF, UHF does describe dissociation properly, the UHF potential curve is
significantly different from the full CI one. For comparison the essentially
exact nonrelativistic results of Kolos and Wolniewicz are shown. Their
calculations, which exploit the simplifications inherent in a two-electron
system, use wave functions which explicitly contain the interelectronic distance (ie. 7,2). One can see that although full CI is exact in the STO-3G
basis, it gives a potential curve which does not agree very well with the
exact one. Although the full CI STO-3G well depth is greater than the exact
result, this does not imply that the variation principle has been violated. The
STO-3G full CI energy of H, and the STO-3G energy of the hydrogen atom
are both higher than the corresponding exact results. However, the STO-3G
potential energy curve is obtained by subtracting the energy of two isolated
H atoms from the energy of H, and thus need not be an upper bound to the
exact curve. The STO-3G UHF and full CI well depths are greater than the
exact result because the STO-3G basis is so poor for the hydrogen atom.

242 MODERN QUANTUM CHEMISTRY

002
000

/ 30
/

18

22

26.

34

Rau)

-002
=

-004

3

o

“"

-006

=
Ww
N

-008
b

=

WW

)

010

12

-014
-016

f

(Full

/:

Cl

-

-018
-020
Figure 4.2 STO-3G potential energy curves for H2.

Exercise 4.3 Calculate the coefficient of the double excitation (c) in the
intermediate normalized CI wave function at R = 1.4 a.u., using the STO-3G

integrals given in Appendix D. Show analytically that as R- ~,c— —1,
and hence that at large distances the Hartree-Fock ground state and the
doubly excited configuration have equal weight in the CI ground state.
Finally, show that the CI wave function, when normalized to unity, becomes

(at R = o)

2° "7(\b,$2> + |b241>)
where ¢, and ¢» are atomic orbitals on centers one and two, respectively.

4.2 DOUBLY

EXCITED

CI

For all but the smallest molecules, even with a minimal basis set, full CI is a

computationally impractical procedure. With a one-electron basis of moderate size, there are so many possible spin-adapted configurations that the
full CI matrix becomes impossibly large (e.g., its dimensionality is greater
than 10° x 10°). To obtain a computationally viable scheme one must trun-

CONFIGURATION INTERACTION

243

cate the full CI matrix or equivalently the CI expansion for the wave function.
A systematic procedure for accomplishing this is to consider only those
configurations which differ from the Hartree-Fock ground state wave function by no more than a predetermined number, say m, of spin orbitals. For
example, ifm = 4, then one would include single, double, triple, and quadruple excitations in the trial function. For full CI, m would be equal to the
number of electrons. The simplest version of this scheme includes only single
and double excitations out of |‘¥y>. The resulting ground state energy obtained from such a singly and doubly excited CI (SDCI) calculation is, of

course, variational, and for small molecules it gives the major fraction of
the correlation energy. As we shall see in Section 4.6, SDCI and, in fact, all

forms of truncated CI deteriorate as the number of electrons increases. In
spite of this deficiency, SDCI has been a popular approach to the calculation
of correlation energies. The effect of single excitations on the correlation
energy (but not on the charge distribution) is generally negligible but their
number is so much smaller than double excitations that they can be included
without complicating the calculations. Here, however, in order to keep the
formalism as simple as possible, we ignore single excitations.
We will discuss doubly excited CI (DCI) using a spin orbital basis, but
it should be kept in mind that actual calculations are performed using
spin-adapted configurations. The intermediate normalized DCI trial
function is
I®pcr> = [o> + > cealea>

(4.25)

exd

t<u

To obtain the corresponding correlation energy we substitute this into
Eq. (4.7)

(We -Fa Mo +3

wm) Econ (to +3 es

c<d

c<d

t<u

|

t<u

.

and successively multiply by <‘¥| and <‘P%3] to obtain
>
c<d

CACY

of 0|W>

=

coor

(4.26a)

t<u

CPA o> + Yi cea PGC — Eo| Peay = bE corr
c<d

(4.26)

t<u

These two equations, which are generalizations of Eqs. (4.19a} and (4.19b),
determine the correlation energy. By defining the matrices

(Baas = CPS2¢/%o>

(D),.s5, tcud =
(C),asb

=

P|
Cob

~~ E,|¥4>

(4.272)

(4.27b)
(4.27)

244 MODERN QUANTUM CHEMISTRY

Eqs. (4.26a) and (4.26b) can be rewritten as
Bie

=

(4.28a)

Econ

(4.28b)

B+ De =cE, ‘orr
which are equivalent to

je)
0

Bf

a

1

This is the matrix form of the DCI' equations. The correlation energy is the
lowest eigenvalue of the CI matrix

(, b)

which, as can be seen from the definitions in Eqs. (4.27a) and (4.27b), is simply
the matrix representation of the Hamiltonian in the basis {|'¥o>, ¥%3>} with
the Hartree-Fock energy E, subtracted from all diagonal elements.
Even for DCT it is not, in general, practical to include all possible double
excitations from |’>. Thus it is desirable to devise procedures for selecting
the most important configurations in advance. A simple way of investigating the importance of different doubly excited configurations is to examine
a perturbation treatment of this CI eigenvalue problem. If we solve Eq.
(4.28b) for e,
c=

-(D

~

LE goer)” 'B

and substitute the result into Eq. (4.28a) we obtain
Ecce

=

—B'(D

~

VE core)

'B

(4.30a)

Solving this matrix equation for E,,,, is completely equivalent to finding
the lowest eigenvalue of the CI matrix. Since E,,,, appears on both sides of
the equation an iterative procedure must be used. Since the correlation
energy is small compared to the difference between the energy of a doubly
excited configuration and E, (i.e., the diagonal elements of D), one can set
E.ore ‘corr = 0 On the right side of the equation to obtain the approximation

Ege

corr

= —B'D7'B

(4.30b)

This result can be used in the right-hand side of Eq. (4.30a) to obtain E%,,,

and so on until convergence is found. It is interesting to note that although
the first iteration result E,,,, is clearly an approximation to the DCI correlation energy and in fact is no longer an upper bound, as will be discussed
subsequently, it has an advantage over the exact DCI result in that it does
not deteriorate as the size of the system increases.

When the matrix D is very large, its inverse cannot be computed and
Eq. (4.30b) must be simplified further. In most cases, the largest elements of

CONFIGURATION INTERACTION

245

D occur on its diagonal. If we assume D is diagonal, its inverse is easily
obtained namely,

SacO rdsu
(D ~ )rasb, tcud =
(Pa) — Eol¥cs>

So that the correlation energy can be written as
CP [|<

Peon = — 2a
=

THI |Y o>

— Edvay

=

es

coor

rs

hab)

30

4.31

rs

where E,.., ( ) is the contribution of the double excitation |¥%3) to this
approximate correlation energy. Since it can be easily computed, it can be
used to identify the configurations that are likely to be most important in
the DCI expansion.

4.3 SOME

ILLUSTRATIVE

CALCULATIONS

In this section we present a variety of results obtained via CI, which serve to
illustrate the formalism of the previous sections. We begin by considering
the correlation energy of H, at R = 1.4 a.u,, calculated using basis sets of
increasing sophistication (See Table 4.2). Because H, is a two-electron
system, SDCI corresponds to full CI. Of particular interest is that single
excitations make an almost negligible contribution to the correlation energy.
fhe contribution of double excitations to the correlation energy is strongly
dependent on the quality of the basis. Note that even using a large basis of
10s, 5p and 1d Gaussian functions, the full CI correlation energy still does
not quite approach the essentially exact value obtained using the highly

Table 4.2 The correlation energy (a.u.) of H, at R = 1.4 a.u. in
a variety of basis sets
Basis set
STO-3G
4-31G
6-31G**

(10s, Sp, 1d)"

DCI

SDCI

Contribution of singles

— 0.02056
— 0.02487
—0.03373

0.02056
— 0.02494
— 0.03387

0
— 0.00007
— 0.00014

— 0.03954

Exact”

0.03969

—0,00015

—0.0409

“C.E. Dykstra (unpublished) using a large Gaussian basis described by J. M.
Schulman and D. N. Kaufman, J. Chem. Phys. 53: 477 (1970).
’ Obtained from the extremely accurate results of W. Kolos and L. Wolniewicz,

J. Chem. Phys. 49: 404 (1968).

246

MODERN

QUANTUM

CHEMISTRY

Table 4.3 Equilibrium
(a.u.) of H,

bond

length

Basis set

SCF

Full CI

STO-3G
4-31G
6-31G**

1.346
1.380
1.385

1.389
1.410
1.396

Exact*
°W

1.401
Kolos and L. Wolniewicz, J. Chem.

Phys. 49: 404 (1968).

004

/

002
=>
3
S

000

-004

t

-006

—

=

N

WW

£4

#16

22

26

34

Rau)

-002

zr
=

WW
nN

10

/
30

:

/

/

-006
-010
~0l2
-0.14
-0.16

Figure 4.3 6-31G** potential energy curves for H,.

accurate ground state energy calculated by Kolos and Wolniewicz. This is
primarily the result of the absence from the basis set of additional d orbitals
and orbitals of higher symmetry.
Table 4.3 presents the equilibrium bond lengths of H, obtained by
minimizing the energy as a function of the internuclear distance R. For all
basis sets the full CI results are better than the SCF ones. At the 6-31G**

level, the agreement with the exact results is better than 0.005 a.u.. Figure

CONFIGURATION INTERACTION

247

Table 4.4 The number of possible symmetry- and spin-adapted
configurations for BeH, at various excitation levels of Cl’
Excitation levels

Basis

SDCI (<2)

SDTCI (<3)

SDTQCI (<4)

Full CI

Minimal

20

36

56

65

Double zeta

146

728

2173

4544

“Kk. Hsu, R. P. Hosteny, and 1. Shavitt, unpublished results.

4.3 compares the entire potential energy curves obtained using RHF, UHF,

and full CI at the 6-31G** level. As seen from the STO-3G results (Fig. 4.2),

full CI correctly describes dissociation and significantly changes the UHF

well depth. Moreover, in contrast to Fig. 4.2, the 6-31G** full CI curve now

nearly parallels the exact result of Kolos and Woiniewicz.
BeH; is among the first systems for which full CI calculations have been
performed using nonminimal basis sets. Since it has six electrons, full CI
includes all excitations up to and including hextuples. The number of
symmetry- and spin-adapted configurations, which are obtained from either

a minimal or a double Zeta basis set of STO’s, when different levels of excitation are included in the trial function, is shown in Table 4.4. A double zeta

basis for BeH, is still a very small basis in the sense that it can give only
about 50% of the exact correlation energy. If this basis were augmented by
adding polarization functions, the numbers of configurations in Table 4.4
would increase considerably. For example, if a single set of p orbitals were
added to the hydrogens, the number of symmetry- and spin-adapted configurations needed for full CI would be 28,639. Such a basis would still give
only about 75% of the exact correlation energy. To obtain a greater fraction
of the correlation energy d orbitals on Be would be required.
Table 4.5 presents the correlation energy contributions from different
levels of excitation in BeH,. With either basis set, double excitations are
responsible for almost 98% of the full CI correlation energy. This result is
not general but is a Consequence of the relatively few electrons present in
BeH),. A particularly interesting point is the relative importance of triple
and quadruple excitations. It is seen that in the minimal basis they appear
equally important, but in the double zeta basis the quadruples are clearly
more important. In fact, mn calculations performed with a double-zeta (DZ)
basis augmented by polarization functions on the hydrogens (SDCI correlation energy = —0.098468 a.u.), the contribution to the correlation
energy due to triples is essentially the same as in the DZ result, but the
contribution due to quadruples almost doubles. Thus quadruple excitations
appear to be more important than triples for the correlation energy.

248

MODERN

QUANTUM

CHEMISTRY

Table 4.5 Correlation energy contributions
(a.u.) from different levels of excitation in
BeH,*

Excitation level

Minimal basis

Double zeta

14+2
3
4
5
6

— 0.030513
— 0.000329
— 0.000340
—0.0000001
— 0.00000002

—0,074033
— 0.000428
—0.001439
—0.000011
+ 0.000006

Total

— 0.031182

—0.075917

Exact correlation energy
*K. Hsu,
lished results.

R. P.

Hosteny,

—0.14
and

I. Shavitt,

unpub-

As we have discussed previously, full CI is impractical for large molecules using extended basis sets, and many CI calculations include only single
and double excitations. As an example, we consider the SDCI calculation on
H,0 performed by I. Shavitt and his coworkers. They used an extended
basis set of Slater-type orbitals (STO’s), consisting of 5s, 4p, and 2d orbitals
on the oxygen and 3s and 1p orbitals on the hydrogens (henceforth referred
to as the 39-STO basis). This basis set gives an SCF energy close to the
Hartree-Fock limit. In this basis, there are 4120 symmetry- and spin-adapted
configurations involving single and double excitations. Shavitt and coworkers examined a variety of properties including the potential energy
surface, ionization potentials, and dipole moment of H,O both at the SCF
and SDCI levels. Their results for the correlation energy obtained using
only double excitations (DCT) and both single and double excitations (SDCI)
are presented in Table 4.6. Notice that the inclusion of single excitations
Table 4.6 Correlation energy (a.u.) of H,O
at the experimental geometry calculated
with the 39-STO basls described in the
text*

vor
DcI

SDCI
Estimated full CI
Exact

*B.J

—0.2740

- 0.2756
—0.296 + 0.001
-0.37

Rosenberg and I. Shavitt, J. Chem. Phys.

63: 2162 (1975).

CONFIGURATION INTERACTION

249

Table 4.7 Equilibrium geometry and some
force constants of H,O using SCF and SDCI
calculations with the 39-STO basis described
in the text

R, (a.u.)
6.
Sarr
Soe

SCF*

spci*

Experiment?

1.776
106.1°
9.79
0.88

1.800
104.9°
8.88
0.81

1.809
104.5°
8.45
0.76

*B, J. Rosenberg, W. C. Ermler, and I. Shavitt,
J. Chem. Phys. 65: 4072 (1976).

» The force constants are in 10° dyn/cm, withangles

measured in radians. For original references see footnote a of this table.

changes the DCI correlation energy by only a very small amount (i.e., 0.6%).
The SDCI result gives almost 75% of the exact correlation energy. However, the exact correlation energy is different from the basis set correlation
energy which is the result that would be obtained if full CI were to be performed in the 39-STO basis. Since full CI is out of the question for such a
large basis, the resulting energy can only be estimated. An educated guess
for the basis set correlation energy is —0.296 + 0.001 a.u. Thus it seems
that SDCI gives about 93% of the basis set correlation energy.
Results for the equiliorium geometry and two force constants are
presented in Table 4.7. These were obtained by performing calculations at
36 molecular geometries, finding the equilibrium geometry and then fitting
the surface to a Taylor series about the equilibrium geometry, i.e.,
E(Ry, R2, 0) = E, + dfrr[(Ri —R+(R2-

R.)’] + 4 fooR2(0 — 6.)? +-°°
(4.32)

where R, and R,» are the two hydrogen-oxygen bond lengths, and @ is the
bond angle. A large number of additional force constants can be found in
their paper. From Table 4.7 it can be seen that the SDCI results agree much
better with experiment than the SCF ones. The fact that the agreement is
still far from perfect may be attributed to: 1) the one-electron basis not
being complete and 2) the SDCI approximation to full CI. The relative role
of these two factors can only be established by performing calculations with
larger basis sets and by treating correlation effects beyond the SDCI level.
We now turn to the calculation of ionization potentials (IP’s) within the
SDCI formalism. The results for H,O using the 39-STO basis are shown in
Table 4.8. The SDCI entry was obtained by performing separate SDCI
calculations on H,O and H,O* and subtracting the resulting energies. The

250 MODERN QUANTUM CHEMISTRY

Table 4.8 Lowest ionization potential (a.u.)
of water obtained using Koopmans’ theorem
and by performing SDCI caiculations both

on H,O

and H,O*

(The 39-STO basis

described in the text was used)*

Lowest IP of H,O
Koopmans’
SDCI
Experiment

0.507
0.452
0.463

* B. J. Rosenberg and I. Shavitt, J. Chem. Phys.
63: 2162 (1975).

SDCI result is a considerable improvement over the Koopmans’ theorem
value but is still not in complete agreement with experiment. A particularly
good test of any procedure for calculating ionization potentials is N, since
for this molecule Koopmans’ theorem predicts the incorrect ordering of the
first two ionization potentials. The SDCI results, obtained using a large
basis set of 6s, 4p, 3d, and 2f Slater-type functions on each nitrogen, are
shown in Table 4.9. We note that SDCI predicts the correct ordering of the
ionization potentials. These results are expected to be close to the SDCIlimit (ie., SDCI with a complete one-electron basis). Thus the discrepancies
with experiment are a reflection of the importance of higher excitations in
the CI wave function.
As a final example, we consider the calculation of first-order properties
as exemplified by the dipole moment. We have seen that single excitations
have an almost negligible effect on the correlation energy. However, their
inclusion is essential for a satisfactory description of the charge density and,
hence, for properties which are sensitive to this quantity. This point is well

Table 4.9 Ionization potentials (a.u.) of Nz
obtained using Koopmans’ theorem and by
performing a SDCI calculation on both N,

and Nj (A large basis consisting of 6s, 4p,
3d, 2f Slater-type orbitals was used)*
Orbital

Koopmans’

SDCI

Experiment

3a,
An,

0.635
0.615

0.580
0.610

0.573
0.624

*W.C.

Ermler and A.D

73: 2297 (1980)

McLean, J Chem

Phys.

CONFIGURATION INTERACTION

251

Table 4.10 The effect of single excitations on the
dipole moment (a.n.) of CO within an extended
STO basis’ (A positive dipole moment corre-

sponds to C"O*)
Wave function

Energy

Dipole moment

SCF
SCF + 138 doubles
SCF + 200 doubles
SCF + 138 doubles
+ 62 singles
Experiment

—~ 112.788
— 113.016
—~ 113.034
—~ 113.018

—0.108
— 0.068
—0.072
+0.030
+0.044

°F. Grimaldi, A. Lecourt, and C. Moser, Int. J. Quantum Chem. S81: 153 (1967).

illustrated by considering the dipole moment of CO (see Table 4.10). Recall
that a near-Hartree-Fock-limit calculation predicts the wrong sign of the
dipole moment of CO. As Table 4.10 shows, the situation is not rectified
even when the 200 most important double excitations are included in the
wave function. To obtain the correct sign one must include the single excitations. It is interesting to note that a better variational energy does not
necessarily imply an improved description for properties other than the
energy. The DCI calculation with 200 doubles has a lower energy than the
SDCI, but it still predicts the wrong sign for the dipole moment. Finally, in
Table 4.11 we present the dipole moment of H,O calculated using the
39-STO basis described previously. SDCI reduces the SCF error by about a
factor of one-half, but the result is still significantly different from experiment. This is probably a consequence of the absence of diffuse basis functions in the 39-STO basis.

Table 4.11 SCF and SDCI dipole moments
(a.n.) of H,O at the experimental geometry
calculated using the 39-STO basis discussed
in the text*
Dipole moment

SCF
SDCI
Experiment

0.785
0.755
0.728

° B. J. Rosenberg and I. Shavitt, J. Chem. Phys.
63: 2162 (1975).

252 MODERN QUANTUM CHEMISTRY

In summary, for the small molecules considered here, SDCI improves
SCF results considerably, but even using extended basis sets the agreement
with experiment is not completely satisfactory. It is difficult to ascertain
whether this is primarily due to the inadequacy of the basis sets or the SDCI
approach itself. As will be discussed in the Section 4.6, for larger systems
SDCI becomes increasingly poor due to inherent limitations of this method.

4.4 NATURAL ORBITALS AND
REDUCED DENSITY MATRIX

THE

ONE-PARTICLE

Up to this point we have focused on determinants and configurations formed
from a set of canonical Hartree-Fock orbitals. The resulting CI expansion
unfortunately turns out to be rather slowly convergent. It is clear, however,
that one can perform a CI calculation using N-electron configurations
formed from any one-electron basis. Therefore, it is of interest to ask whether
one can find a one-electron basis for which the CI expansion is more rapidly
convergent than it is with the Hartree-Fock basis, and thus be able to obtain

equivalent results with a smaller number of configurations. The set of
natural orbitals, introduced by P.-O. Léwdin,! forms such a basis.
In order to define natural orbitals, we now consider-_the first-order
reduced density matrix of an N-electron system. Given a normalized wave
function, ®, then ®(x,, ..., Xv) ®*(x,, ..., Xy) dx, °°: dxXy is the probability
that an electron is in the space-spin volume element dx, located at x,, while
simultaneously another electron is in dx, at x, and so on. If we are interested
only in the probability of finding an electron in dx, at x,, independent of
where the other electrons are, then we must average over all space-spin
coordinates of the other electrons, ie., integrate over x2, X3,..., X, to obtain
px)=N

fax, +++ dxXy O(Ky,.--, Xp) O*(X,, .. - , Xn)

(4.33)

p(x,) is called the reduced density function for a single electron in an Nelectron system. The normalization factor N is included so that the integral
of the density equals the total number of electrons,
fax, p(x,J=N

(4.34)

We now generalize the density function p(x,) to a density matrix (x,, x4)
defined as

WOK, 4) = Ni fd g = * dey, D0, Kay. KOM, Kay
The matrix

y(x,, x), which

depends

on two continuous

Xm) 4.35)
indices, is called

the first-order reduced density matrix or alternatively, the one-electron re-

CONFIGURATION INTERACTION

253

duced density matrix or simply the one-matrix. Note that the diagonal element
of the continuous representation of the one-matrix is the density of electrons
y%1, X1) = p(X)

Since »(x,, x) is a function of two variables, it can be expanded

orthonormal basis of Hartree-Fock spin orbitals {y;} as
YX, X41) = d YAK
yf

GF)

(4.36)

in the
(4.37)

where

Vig = fax, Ax, XF(K1)y%1, 1) X/0%4)

(4.38)

The matrix y formed from the elements {y;,;} is a discrete representation of
the one-matrix in the orthonormal basis {y;}.
Exercise 4.4 Show that y is a Hermitian matrix.
Exercise 4.5 Show that try = N.
Exercise 4.6 Consider the one-electron operator
N
i=1

a. Show that

C10, \0> = fdr, [hx )90%, Xia =a
where the notation [ ],,-x, means that x; is set equal to x, after h(x,)
has operated on y(x,, x4).
b. Show that

<O|O,|®> = trhy
where
hy = <ilh|j> = fax, EX Dh(K1) 7041)

Thus the expectation value of any one-electron operator can be expressed
in terms of the one-matrix.
In the special case that @ is the Hartree-Fock ground state wave function
fo, it can be shown from the definition (Eq. (4.35)) that

YF (x1, x1) = DY HalX F(x)

(4.39)

254 MODERN QUANTUM CHEMISTRY

where the sum runs over only the spin orbitals contained in ¥,. Thus the
discrete representation of the HF one-matrix is particularly simple—y"*
is diagonal with ones along the diagonal for those elements corresponding
to occupied spin orbitals and zeros for unoccupied spin orbitals,

yu’ =6;

if occupied
.

=0

(4.40)

otherwise

The diagonal elements of y"* can be regarded as occupation numbers:
one for occupied spin orbitals and zero for unoccupied spin orbitals.

is

Exercise 4.7 Recall that in second quantization a one-electron operator

€, = > @aljyata,
y

a. Show that
Vij =

(Plata\®.

b. Show that the matrix elements of y"* are given by Eq. (4.40).
In general, when ® is not ‘Wg, the discrete representation of the onematrix in the basis of HF spin orbitals is not diagonal. However, since y is

Hermitian, it is possible to define an orthonormal basis {n,}, related to {y,}

by a unitary transformation, in which the matrix representation of the onematrix is diagonal. The elements of the orthonormal set in which y is diagonal
are called natural spin orbitals. To make the above explicit, we start with
the relation between two orthonormal bases {y;} and {y;} (see Egs. (1.63)
and (1.65))

4i= 2 m(U')i = >
k

U4,

(4.41)

w= 2 XU yi

(4.42)

where U is a unitary matrix. Substituting Eq. (4.41) into Eq. (4.37), we have

1X1. X41) = Yo mx UK
GU phx)
ijkl

= Y nen (Y

kl

ij

(r,s)

n(x‘)

= ¥ ny (X, (UUant)(x1)
ki

= Vi mlx )Agnt(%))
HI

(4.43)

CONFIGURATION INTERACTION

255

where we have defined the matrix / as

A=UtyU

(4.44)

Now since y is a Hermitian matrix, it is possible to find a unique unitary
matrix U which diagonalizes y, i.e.,

diy = Sash

(4.45)

The corresponding spin orbitals {y,} given by Eq. (4.42) are the natural spin
orbitals. In terms of the natura! spin orbitals, we can write Eq. (4.43) as

yx, x4) =D Aino nF)

(4.46)

In analogy to the HF result of Eq. (4.39), A, is called the occupation number
of the natural spin orbital 7; in the wave function ®.

The importance of natural orbitals is tha,, in a certain sense, they give
the most rapidly convergent CI expansion. That is, to obtain a given accuracy

one requires fewer configurations formed irom natural orbitals than configurations formed from any other orthonormal! basis. It turns out that
only configurations that are constructed from natural orbitals with large
occupation numbers make significant contributions to the energy. Thus a
natural spin orbital with a negligible occupation number may be omitted
from the CI expansion without appreciably affecting the accuracy.
We shall not mathematically show why the use of natural orbitals is
expected to improve the convergence of the CI expansion. Rather, we illustrate this point using a numerical example. Shavitt and coworkers performed
the following interesting study for HO using the 39-STO basis described
in Section 4.3. First, they performed a CI calculation containing all 4120
symmetry- and spin-adapted singly and doubly excited configurations constructed from the canonical HF basis. From this wave function they obtained
the one-matrix and diagonalized it to determine the natural orbitals within
the SDCI approximation. Then they performed a parallel series of truncated
SDCTI calculations using both the canonical and natural orbitals in order
to answer the question, what is the minimum number of configurations
needed to recover a given percent of the SDCI correlation energy? The
answers are shown in Table 4.12. The faster convergence of the CI expansion
based on natural orbitals is apparent. To obtain 60% of the SDCI correlation
energy, one needs only 50 configurations formed from natural orbitals, as
compared with 140 canonically based configurations. However, it can be
also seen that the advantage of natural orbitals over canonical HartreeFock orbitals is only for relatively short expansions. It must be emphasized
that these results are basis-set dependent, and it is expected that the differences between natural orbitals and Hartree-Fock orbitals are even greater
for larger basis sets.

256 MODERN QUANTUM CHEMISTRY

Table 4.12 The number of symmetryand spin-adapted configurations _re-

quired to recover given fractions of the

SDCI correlation energy of H,O within
the 39-STO basis when canonical SCF
(MO) and natural orbitals (NO) are
used
Number of
Configurations

Percent of E.o,(SDCI)

MO

NO

20
40
60
80
90
99

14
52
140
351
617
1760

6
18
50
147
362
1652

* 1. Shavitt, B. J. Rosenberg, and S. Palalikit,
int. J. Quantum Chem. S10: 33 (1976).

Exercise 4.8 For the special case of a two-electron system, the use of
natural orbitals dramatically reduces the size of the full CI expansion. If ¥,
is the occupied Hartree-Fock spatial orbital and w,, r=2,3,..., K are
virtual spatial
the form

orbitals,

the normalized

~
|'Do> = elf

+

K

¥

r=2

full CI singlet wave

of [+

1
3

K

K

r=2

s=2

YY

function

has

eh eh

where the singly and doubly excited spin adapted configurations are defined
in Subsection 2.5.2.

a. Show that |'®,> can be cast into the form
K

K

¥ Cyl)
f= i=1 j=1
where C is asymmetric K x K matrix.
b. Show that

ri, xi) = 2 (CC),(viD 71) + vy).
y

CONFIGURATION INTERACTION

257

c. Let U be the unitary transformation which diagonalizes C

UtCU =d
where (d),; = 4,6,;. Show that

UtcclU = d?.

d. Show that

Mx, x) = Dd GEA’) + GAYE)
where
ci = LAU

Thus U diagonalizes the one-matrix, and hence ¢; are natural spatial
orbitals for the two-electron system.

e. Finally, since C is symmetric,

U can be chosen as real. Show

that in

terms of the natural spatial orbitals, |'@> given in part (a) can be re-

written as

K
['Do> =

x

d;

ta

’

and note that this expansion contains only K terms.

Now that we have seen that the use of natural orbitals improves the
convergence of the CI expansion, we are faced with the problem of how to
exploit this in actual calculations. The difficulty is that the one-matrix and
hence the CI wave function is required to calculate natural orbitals. Thus
we can obtain the natural orbitals only after the CI calculation is complete.
However, we clearly would like to have them before we start the calculation.

Fortunately, it turns out that approximate natural orbitals are almost as
good as the exact ones. There are several schemes that take advantage of
this; here we only mention the iterative natural orbital method of Bender
and Davidson.” In this approach one performs a series of small CI calculations. The configurations used in a given calculation are constructed from
natural orbitals obtained from the wave function of the previous calculation.

Thus one starts with a CI calculation involving a small number, say 50, of

the most important configurations constructed from canonical HartreeFock orbitals. Using the resulting wave function, the one-matrix is calculated
and then diagonalized to yield a set of approximate natural orbitals. Using
the most important of these natural orbitals (ic, those with the largest
occupation numbers}, one constructs a new set of 50 configurations; the
procedure is repeated until the natural orbitals and/or the energy has converged. In practice, only a few iterations are performed and, in fact, the
process often begins to diverge after several iterations.*

258

MODERN QUANTUM

CHEMISTRY

45 THE MULTICONFIGURATION SELF-CONSISTENT
FIELD (MCSCF) AND THE GENERALIZED VALENCE
BOND (GVB) METHODS
We have seen that the canonical Hartree-Fock orbitals are not the best
choice of orbitals for use in CI calculations. Let us consider a multideterminantal wave function, containing a relatively small number of configurations. What orbitals should we use in constructing these configurations so as
to obtain the best possible result? From the variation principle, it is clear
that we should vary the orbitals sp as to minimize the energy. This is the
central idea of the multiconfiguration self-consistent-field (MCSCF) method.
Thus the MCSCF wave function is a truncated CI expansion
|W mcscr> = d ¢,|¥1)

(4.47)

in which both the expansion coefficients (c,) and the orthonormal orbitals
contained in |‘¥;> are optimized. For a closed-shell system, if only one
determinant is included in the expansion (4.47), the MCSCF and HartreeFock methods become identical. The general equations, which must be
solved to obtain the MCSCF wave function are considerably more complicated than Roothaan’s restricted Hartree-Fock equations. Several
approaches to the MCSCF problem are discussed in a review by Wahl and

Das.*

In order to make the MCSCF method more explicit, we consider its
application to the ground state of H,. The simplest possible MCSCF wave
function for this molecule contains only two closed-shell configurations
|W ucscr> = calWaa>

+ Cal

a

>

(4.48)

The orthonormal orbitals y, and wy, can be expanded in a basis of atomic
orbitals as
Wi=> Cid,

i= A,B

(4.49)

The MCSCF energy is obtained by minimizing <P ycscr|/
| ucsce), Sub-

ject to the constraints

Walwa> = (ale>=1

CalWe> = 0

(4.50a)

and

ci + c=1

(4.50b)

to determine the optimum CI expansion coefficient (ie., either c, or cg) and
the optimum form of the orbitals y4 and w, (i-e., the optimum set of expansion coefficients C,;, i= A, B). In the minimal basis set description of H;,
yy, and W, are determined by symmetry (ie. they are just y, and wy.) and

CONFIGURATION INTERACTION

259

‘Pucscr iS identical to the full CI wave function. However, if an extended
basis set is used, the MCSCF energy will be above the full CI energy but
below the energy obtained from any two-configuration CI expansion based
on canonical Hartree-Fock orbitals.
We conclude this section by noting that the generalized valence bond

(GVB) wave function of W. A. Goddard III and coworkers* can be regarded

as a special form of an MCSCF wave function. The basic idea of the GVB
method is most simply illustrated by considering its application to H,. The
valence bond wave function of Heitler and London is

[Pvp> = (2(1 + S72)" /7[bi(1b2(2) + $1(2)h2(1)]2~ "/7(a(1)8(2) — (2) B(1))

(4.51)

where ¢, and ¢, are nonorthogonal atomic orbitalc ((¢,|¢2> = S12)
centered on nuclei 1 and 2, respectively. The GVB wave function has the
VB form

[Pove> = (2(1 + S?))~*/7[u(1)v(2) + u(2)o(1)]27 "/7(a(1)B(2) — (2) 8(1))

(4.52)

but the nonorthogonal GVB orbitals u and v (<u|v> = S) are determined
variationally. That is, the nonorthogonal orbitals u and v are expanded in a
basis set and the expansion coefficients are varied so as to minimize the
energy of |‘gyp>. Thus the GVB wave function is the self-consistent generalization of the VB wave function. The GVB approach has a number of
appealing features including the fact that it properly describes the dissociation
of molecules into open shell fragments. If the same set of basis functions
are used to expand the orthogonal MCSCF orbitals (¥, and w,) and the
nonorthogonal GVB orbitals (u and v), it can be shown (see Exercise 4.9)
that the simple two configuration MCSCF wave function of Eq. (4.48) and
the GVB wave function of Eq. (4.52) are identical.
Exercise 4.9 Consider the transformation

u = (a? +b?)

(ap, + bys)

v = (a? + 67)" (aw, — bs)
a. Show that

<uluy=<v]jvy=1

9 and

a? — b?
(uv
= S=
a*
+ b*”

b. Show that |¥oyp) in Eq. (4.52) can be rewritten as
|v ovp> = (a* + bY)

Lay (Ly 42)

~~ bb a(Lb a(2)]2~ "/7(a(1)8(2) — o¢(2)8(1))

260 MODERN QUANTUM CHEMISTRY

and conclude that this is identical to |Pycscr> in Eq. (4.48) if
Ca = (a* + b*)

/2q?

Cz = —(a* + bt) '/*b?.
As an application of the GVB method (or equivalently the MCSCF
method using two configurations) we present numerical results for H, using
the 6-31G** basis.° At R = 1.4a.u,, E,,,.(GVB) = — 0.0183 a.u. as compared
with the full CI result of — 0.0339 a.u. (ie, GVB gives 54% of the exact basis
set correlation energy). The GVB, RHF, UHF, and full CI potential energy
curves of H, are compared in Fig. 4.4. The GVB method properly describes
the dissociation of H, into hydrogen atoms. Moreover, the GVB potential
curve improves with increasing internuclear separation; when R is greater
than 3 a.u. the GVB and full CI results are virtually indistinguishable. This
is to be contrasted with the potential energy curve obtained from secondorder many-body perturbation theory (Chapter 6) using the UHF wave
function as the starting point (see Fig. 6.3). Second-order perturbation
theory gives a larger fraction of the correlation energy of H, at the equilibrium bond length than GVB. However, as R increases the potential curve

0.04

E(H,) - 2E(H) (a.u.)

0.02

0.00

14

18

22

26

30

/

34 Rau)

-0.02
-0.04
-0.06
-008
ef

-0.10

fy

rsoh
{Full
Cl

12
-014

(Kolos-Wolniewicz)

</

vol

<4

-O16

Figure 4.4 6-31G** potential energy curves for H).

CONFIGURATION INTERACTION

261

obtained using perturbation theory deteriorates and, in fact, approaches the

UHF result.

,

4.6 TRUNCATED CI AND THE
SIZE-CONSISTENCY PROBLEM
In chemistry one is interested in the relative energies of molecules of different size. For example, suppose we wish to calculate AE for the reaction
A+B3C

For our result to be meaningful, it is necessary to use approximation schemes
that are equally good, in a certain sense, for molecules with different numbers of electrons. To define in just what sense, let us consider a supermolecule
(dimer) composed of two identical but noninteracting molecules (monomers). Two monomers separated by a large distance will serve as an example
of such a dimer. Physically, it is clear that the energy of the dimer should be
just twice the energy of the monomer, since by assumption the monomers
do not interact. An approximation scheme for calculating the energy of
such a system that has this property is said to be size consistent. The HartreeFock approximation is the simplest example of such a theory: The HF
energy of a supermolecule composed of two noninteracting closed-shell
subsystems is just the sum of the HF energies of the subsystems. A more
general definition of size consistency is that the energy of a many-particle
system, even in the presence of interactions, becomes proportional to the
number of particles (N) in the limit N — oo. For example, the HF energy ofa
crystal is proportional to the number of constituent molecules although the
total energy is not simply N times the energy of an isolated molecule.
Full CI, as to be expected from a formally exact theory, is also size
consistent. Unfortunately truncated CI does not have this property. At
first, this may appear surprising since size consistency seems like a rather
modest requirement. This deficiency can however be understood by a simple
example. Consider a supermolecule composed of two noninteracting H
molecules. Why is it that the DCI energy of the supermolecule is not the sum
of the DCI energies of the two monomers? By definition the DCI wave
function of each of the monomers contains double excitations within the
monomer. If we restrict the supermolecule trial function to double excitations, we exclude the possibility that both monomers are simultaneously
doubly excited, since this represents a quadruple excitation in the supermolecule. Thus the supermolecule wave function truncated at the DCI
level does not have sufficient flexibility to yield twice the DCI monomer
energy.
Let us make this argument more quantitative by using our minimal
basis H, model. Assume that we have two minimal basis H, molecules that

262

MODERN QUANTUM CHEMISTRY

are separated by a large (infinite) distance. We can perform calculations on
the composite system as if it were one molecule, using the fact that all integrals involving a basis function on one monomer and a basis function on the
other monomer will be zero because of the large distance between the basis
functions, The results of a Hartree-Fock calculation are shown in Fig. 4.5.
Our notation is that 1, and 2, are the occupied and unoccupied molecular
orbitals localized on monomer 1. These are identical to yw, and W. of our
previous monomer calculation. In the same way, the molecular orbitals 1,
and 2, of monomer 2 are the usual o, and o, bonding and antibonding
orbitals formed from linear combinations of the two 1s basis functions for
that molecule. The Hartree-Fock ground state is the single determinant

(4.53)

[o> = [1,T,1212)

Any electron-electron repulsion integral involving both molecules, such as
(1,1, {121,), is zero, so that the Hartree-Fock energy of the dimer is just
twice the energy of one H, molecule

2E, = 2(2e, — J41)

(4.54)

where
Jiu=

(141, ]141,)

= (1212] 1212)

Now let us consider a doubly excited CI calculation. We can neglect
single excitations again, because of symmetry. There are two doubly excited
2

1

OO

¢

$4,

©

$5

2

——

22

ly

——

le

Li, >= (2 14S)"

(Hi*92)

[2>= (20-s,)"™ (¢\-¢,)
[1,> = (2U+s,
0"
| 2,)

=

_

(201 Si2 ))

-us

(sires)
2.42

Cg,

¢,)

Figure 4.5 Two minimal basis H,

molecules separated by infinity.

CONFIGURATION

INTERACTION

263

configurations that will mix with |¥,>, the configuration obtained by
exciting two electrons from the occupied orbital of n.onomer 1 to the unoccupied orbital of the same monomer and the correspor-ding configuration
for monomer 2
|Do> = |Po> + €,|2,2,11) + €2|1,1,2222)

2
33
= [o> + Y cl PTE
i=1

(4.55)

The doubly excited configuration
—t—2,

——2,

—-1,

1,

and any of the other doubly excited configurations will not mix because the
matrix elements involve only zero-valued integrals.

Exercise 4.10 Show that |1,1,2,2,) has a zero matrix element with any

of the configurations in Eq. (4.55).

The matrix element between |2,2,1,1,> and the Hartree-Fock ground

state is

<P ol

|21 2,1,1,5= CP H)EEEY

= (1,74) |2,2,> = [1121 ]1,2.) — [1121 |1121]
= (1,2, | 1,2,) = (1,2; [211,)
= K,,

which is the same as the matrix element between |‘¥,) and the other doubly
excited state. The two doubly excited states will not mix with each other as
they differ by four spin orbitals and, therefore, the CI matrix equation is

0
Ki,

Ky,
2A

Ki,

0

K,\/1
1
0 \Ve,] = 7Ecq(DCDI c,
2A

Cy

(4.56)

C2

where the excitation energy to the doubly excited configurations is 2A, as in
the monomer calculation. This CI equation for the dimer is to be compared
with Eq. (4.22) for the monomer. The matrix Eq. (4.56) contains the following
three simultaneous equations

K,.(c, + ¢€2) = “FeadCD

Ky, + 2Acy= *Eco,(DCDe,
Kia + 2c,= 2E.(ADCIc,

(4.57a)

(4.57b)
(4.57¢)

264

MODERN QUANTUM CHEMISTRY

From the last two of these it is evident that c, = c,, as to be expected from
symmetry. Solving for c, gives
=

K 12
st

1 = €2 = 3p (DCD — 2A

48)
58

and substituting this result into Eq. (4.57a) we have

°F

2K?
Cl = ;=—_?

coed ED = FE {DCD) — 2A

*

eo

If we solve the quadratic cauaionffor 7E,,. (DCI), we obtain
2 Ecor(DCT) = A ~ (A? + 2K?,)1/2
The corresponding monomer result (Eq. “

59

(4.60)

is

*Ecor(DCI) = 'Egor(exact) = A — (A? + Kj,)"/?

(4.61)

The deficiency of doubly excited CI, which we discussed at the beginning of
this section, is illustrated in these last two equations. The energy of two
noninteracting molecules is not twice the energy of one of them, calculated in
the same approximation. Thus doubly excited CI is not size consistent.
Moreover, DCI deteriorates as the size of the system increases; i.e., it

is a much worse approximation for large molecules than it is for small molecules. To see this, let us generalize the above analysis to N, instead of just
two, noninteracting H, molecules. The DCI wave function is
N

IDo> = [Woo + &

| PF

i=1

=

(4.62)

which is the appropriate generalization of Eq. (4.55). The corresponding CI
eigenvalue problem is
O

K,,
Ky,
:

K,,

Ky.

24
0
:

0

Ky.

**-

Kyi2\

0
=:
Wis)
:

0

0

O
0

.

- 2A]

/1

\fe,
fe

1

XE. (DCI|

:

\cy

Cy
c

(4.63)

:

cy

where “E,,,(DCI) is the DCI correlation energy for the N molecule system.

Again, the coefficients of the double excitations localized on the individual
molecules are identical:
c=, =

K 12

Ecos

(DCI — 2A

(4.64)

and the correlation energy, from the first row of the CI matrix, is
Eevee

(DC) = K,; y c= NKy2¢,

(4.65)

CONFIGURATION INTERACTION

265

(4.6 )

4.66

so that combining these equations gives
N

NKi
=

EeorDCD = ne DEN) = 2A

Finally, solving for %E,,,,(DCI), we have

NE__(DCI) = A — (A? + NK?2,)!/2

(4.67)

which is to be compared to the exact energy of N noninteracting minimal
basis H, molecules, viz.

NE. (exact) = N’E,,,,(exact) = N(A — (A? + K7,)"/?)

(4.68)

For small N the difference between the two energies is fairly small. For
example, for two STO-3G H, molecules both at R = 1.4 a.u,, 7E,,. (DCI) =

— 0.0406 a.u. while the exact basis set correlation energy is — 0.0411 a.u.e

However, for large N the discrepancy between the two results increases. In
particular the limiting behavior of ‘E,,,, (DCI) as N + © is
NE oor(DCI ~ — NK,

(4.69)

which means that the correlation energy per monomer vanishes in the limit
of large N, 1e.,
. NE. (DCT
lim, —SS———
= 0
4.70
N
(4.70)
Thus DCI is a completely useless approximation for the correlation energy
for a macroscopic system such as a crystal. The lack of size consistency demonstrated above is not only a property of DCI but of all forms of truncated
CI. For example, if we included both double and quadruple excitations in
the supermolecule trial function (DQCI), we would obtain the exact energy
only when N = 2 since DQCI corresponds to full CI in this case. As N
increases the discrepancy between E.,,.(DQCI) and ‘E,,,,(exact) grows,
but of course more slowly than the difference between %E,,,,(DCI) and
NE sore(exact). Nevertheless, as N + co the DQCI correlation energy per particle still vanishes.
In principle, no form of truncated CI is size consistent. In practice,
however, CI including quadruple excitations is effectively size consistent for
relatively small molecules containing less than, say, 50 electrons. Thus much
current research is directed towards finding efficient ways of performing CI
calculations in which the most important quadruple excitations are included.
Are there approximation methods for the correlation energy which are
rigorously size consistent? In fact, there are a number of such schemes and
they constitute the subject matter of much of the rest of this book.

Exercise 4.11 Use the integrals for STO-3G H, at R = 1.4.a.u., given

in Appendix D, to calculate %E,,,,(DCI)/N for N = 1, 10, and 100.

266

MODERN QUANTUM CHEMISTRY

Exercise 4.12 Show that full CI is size consistent for a dimer of noninteracting minimal basis H, molecules. A full CI calculation includes, in
addition to the excitations in Eq. (4.55), the quadruply excited state
[2,2,222.)

= PTD

|®o> = |Wo> + €4|2,2,1.12> + c[1,1,2.2> + €3|2,2,2222)
a. Show that the full CI matrix equation is

O

K,.

K,,

O

K,,

2A

O

0

2A

Kyla

O

Ky.

K,z

4A/

K,,

1

1
— 25

Ky,zfle.f

Cy]

9 "les]

\c;

~

C3

Go directly to part (e). If you need help return to part (b).

b. Show that c, = c, and hence E,,,, = 2K 12¢).
c. Show that

2E
3

d. Show that

*Ecorr - 4A"

_

1 TE

2K

— 4k

corr

e. Finally, show that
2 Ecorr corr = 2(A — (A? + K?,)"?)
which is indeed exact for the model.
It is interesting to note that we can express the coefficient of the quadruple excitation (c3) as the product of the coefficients of the double excitations:
2
3

3E

Ecort

corr

— 4A

_—

2K

2E,,,

corr

12€,

—

— 44 ~ ©)

2

where we have used results in parts (b), (c), and (d). This result is not true in
general but is a consequence of the fact that the two monomers are independent. However, it suggests that it might be reasonable to approximate the
coefficient of a quadruply excited configuration as a product of the coefficients of the double excitations that combine to give the quadruply excited
configuration. This idea plays a central role in the next chapter.
Exercise 4.13 Consider the exact basis set correlation energy of mini-

mal basis H, given in Eq. (4.23). Assuming that K?,/A? « 1 show that
1E

K?2

corr

(exact) = ——2
act)

2A

CONFIGURATION INTERACTION

267

Hint: (1 + x)'? = 1 + 4x when x « 1. This approximate result is the same

as the simplest expression for the correlation energy obtained via a form of
perturbation theory. Show that by expanding %E,,,,(DCI) in the same way,
assuming that NK?,/A? « 1, one obtains simply N times the above result.
This approximation is equivalent to a perturbation result for the correlation
energy of a supermolecule, and the form of the result is a reflection of the
fact that, in contrast to truncated CI, perturbation theory is size consistent

(see Chapter 6).

Exercise 4.14 DCI calculations have become relatively routine; there-

fore, it is of interest to ask whether one can correct the DCI

correlation

energy so that it becomes approximately size consistent. A simple prescription for doing this, which is approximately valid only for relatively small
systems, is to write
Ecorr

=

Egor

DCT)

+

AE paviason

where the Davidson correction is given by
AE paviason

=

(1

—~ CBE cor( DCT)

where Co is the coefficient of the Hartree-Fock wave function in the normalized DCI wave function. The Davidson correction can be computed without
additional labor since cg is available in a DCI calculation. Moreover, there
is numerical evidence that it leads to an improvement over DCI for relatively
small molecules.

For example,

for H,O,

using the 39-STO

basis and

the

Davidson correction, 0, = 104.6°, R, = 1.809 a.u., fpr = 8.54, and fo, = 0.80
(see Table 4.7). Also, the ionization potentials of N., using the same basis

as in Table 4.9 and the Davidson correction, are 0.575 a.u. (36,) and 0.617 a.u.
(1z,). The purpose of this exercise is to explore the nature of the Davidson
correction.

a. For the model of N independent minimal basis H, molecules, assume
that N is large, yet small enough that NK?,/A? is still less than unity. In
addition, remember that A >K,2. Using the identity (1 + x)!/? =

1+ 4x
— 4x? +--+ show that
N

Eorr(DCT)

——__**

~

2A

+

8A?

free

The term proportional to N? is spurious and is not present in the similar

expansion of ‘E,,,,(exact).

b. Show that

268 MODERN QUANTUM CHEMISTRY

c. Show that
Cy

~ K 12

2A

+

d. Show that
AE Davidson

=

—N?*K+

a

tere,

&

Finally, note that the Davidson correction exactly cancels the term
proportional to N? in the expansion of “E,,,,(DCI). However, spurious
terms containing higher powers of N still remain. For large N, the whole
analysis breaks down since NK?,/A? eventually becomes greater than unity.
For N = 1, E,,,,(DCI) is exact within the model, yet AEp,viacon 1S NOt Zero.
e. Numerically investigate the range of validity of the Davidson correction

for N independent H, molecules. Calculate ‘E,,,,(DCD/*E,,,(exact) and
(¥ Ecorr(DCT) + AE paviason)/ Ecorr(€Xact) for N =1,..., 20 using the values

of the two-electron integrals for R = 1.4 a.u. given in Appendix D. You
will find that the correlation energy calculated using the Davidson cor-

rection is within 1% of the exact value for 3 < N < 11. The DCI correlation energy, on the other hand, errs by 2.5% for N = 3 and by 10% for
N = 11. For N = 100, the correlation energy with and without the Davidson correction errs by 25% and 42%, respectively. Hint: show that
AE paviason

=

(NE cor( DCD)? /(N Ki

2 +

(SE.or(DCT

)*).

f. Calculate the Davidson-corrected correlation energy of H,O using
E.on(DCT) and co given by Saxe et al. (see Further Reading). Compare
your result with E,,,,,(DQCT) and the exact basis set correlation energy.
Exercise 4.15 The normalized full CI wave function for a minimal basis
H, molecule is

|®o> = (1 + c?)7 V7] 1T> + c(h + 7)”
7 [22>
where

c=

'E,,,,/K12.

Show

that

for N

independent

minimal

molecules, the overlap between the Hartree-Fock wave functions,

the exact normalized ground state wave function is

basis

H,

Wo, and

<Po[®.> = (1h + c?) M2
Using the values of the two-electron integrals for R = 1.4 a.u., given in

Appendix D, calculate (Yo|®,) for N = 1, 10, and 100. Note that this

overlap decreases quickly (in fact, exponentially) as N increases. Thus the
overlap between the Hartree-Fock and the exact wave functions of the system
exponentially approaches zero as the size of the system increases, even

CONFIGURATION

INTERACTION

269

though the Hartree-Fock energy is size consistent. Hint: Because the N
independent H, molecules are infinitely separated we can, for all intents and
purposes, ignore the requirement that the wave function of this system be
antisymmetric with respect to the interchange of electrons which belong to
different H, molecules. Thus we can write
N
|®y> ~ Il ((l + ce?)
i=1

7 11,1) + c(1 + c?)- 12122)

and

NOTES
1. P.-O. Léwdin, Quantum theory of many-particle systems. I. Physical interpretation by
means of density matrices, natura] spin orbitals, and cOnvergence problems in the method
of configuration interaction, Phys. Rev. 97: 1474 (1955).
2. C. F. Bender and E. R. Davidson, A natural orbital based energy calculation for helium
hydride and lithium hydride, J. Phys. Chem. 70: 2675 (1966).
3. K. H. Thunemann, J. Romelt, S. D. Peyersmhoff, and R. J. Buenker, A study of the convergence in iterative natural orbital procedures, Int. J. Quantum Chem. 11: 743 (1977).
4. A. C. Wahl and G. Das, The multiconfiguration self-consistent field method, in Methods
of Electronic Structure Theory, H. F. Schaefer III (Ed.), Plenum, New York, 1977, p. 51.
In addition to a survey of the formalism, this article contains a selection of numerical
results.
5. W. A. Goddard III, T. H. Dunning, Jr., W. J. Hunt, and P. J. Hay, Generalized valence
bond description of bonding in low-lying states of molecules, Acc. Chem. Res. 6: 368 (1973);
W. A. Goddard III and L. B. Harding. The description of chemical bonding from ab
initio calculations, Ann. Rev. Phys. Chem. 29: 363 (1978).
6. A. Voter and W. A. Goddard III, unpublished results.

FURTHER

READING

Bauschlicher, C. W. Jr. and Taylor, P. R., Benchmark full configuration-interaction calculations on H,O, F, and F-. J. Chem. Phys. 85: 2779 (1986). The full valence CI calculation
on water used a ‘“‘double-zeta plus polarization function”’ basis set (O basis: (9s5p)/[4s2p]

plus a set of d functions; H basis: (4s)/{2s] plus a set of p functions) and involved 6,740,280
configurations expanded into 28,233,466 determinants. Compare this with the 1981 calculations of Saxe et al. (see below). The full Cl energies are compared with those obtained
using various levels of the coupled cluster approximation, many body perturbation theory, and quadratic Cl in S. J. Cole and R. J. Bartlett, J. Chem. Phys. 86: 873 (1987) and
J. A. Pople, M. Head-Gordon and K. Raghavachari, J. Chem. Phys. 87: 5968 (1987).
Bruna, P. J., and Peyerimhoff, S. D., Excited state potentials, Adv. Chem. Phys. 67: 1 (1987).
Discusses recent advances in the calculation of excited states, focusing on potential

surfaces.
Knowles, P. J., and Handy, N. C., A new determinant-based full configuration interaction

270 MODERN QUANTUM CHEMISTRY
method, Chem. Phys. Lett. 111: 315 (1984). Describes the theoretical advances that
made the full CI calculations of Bauschlicher and Taylor (see above) possible.
Lowdin, P.-O., Correlation problem in many-electron quantum mechanics. Adv. Chem. Phys.
2: 207 (1959). A classic review article on the correlation problem.
Paunz, R., Spin Eigenfunctions. Plenum, New York, 1979. The last chapter of this monograph
contains an introduction to the unitary group approach to CI. This approach, which has
recently attracted much attention, provides a formalism for the efficient computation of
the Hamiltonian matrix elements between spin-adapted configurations.
Peyerimhoff,

S. D.

and

Buenker,

R. J., CI Calculations

of vertical excitation eriergies and

oscillator strengths for Rydberg and valence states of molecules, in Excited States in
Chemistry C. A. Nikolaides and D. R. Beck (Eds.), Reidel, Dordrecht, 1978, p. 79. A
survey of calculations of the electronic spectra of molecules using multireference doubleexcitation CI (MRD-CI). MRD-CI includes single and double excitations relative not
only to the Hartree-Fock wave function (‘¥) but also relative to other important
configurations (which may themselves be doubly excited with respect to ‘¥,). Thus
MRD-CI effectively includes higher than double (e.g., quadruple) excitations from ‘Vy
and hence can be essentially size consistent for moderate sized molecules. Other articles
found in this book are also recommended.
Roos, B, O., The complete active space self-consistent-field method and its applications in
electronic structure calculations. Adv. Chem. Phys. 69: 399 (1987). One of the most
successful methods for finding highly accurate wave functions. CASSCF is a variant of
MCSCF and uses ail the tricks of the trade (direct CI, unitary group approach, etc.) in
its implementation.
Roos, B. O. and Siegbahn, P. E. M., The direct configuration interaction method from
molecular integrals, in Methods of Electronic Structure Theory H. F. Schaefer II (Ed.),
Plenum, New York, 1977, p. 277. A discussion by the originators of an important method
in which the CI matrix is never explicitly constructed.
Saxe, P., Schaefer IIT, H. F. and Handy, N. C., Exact solution (within a double-zeta basis set)
of the Schrédinger electronic equation for water, Chem. Phys. Lett. 79: 202 (1981). This
fandmark paper compares the correlation energy of H,O obtained using DCI, SDCI,

SDTCI, DQCI, SDTQCTI, and full CI with results obtained using the coupled-cluster
approximation (see Chapter 5) and many-body perturbation theory (see Chapter 6).
The full CI calculation included 256,473 spin- and symmetry-adapted configurations!
Shavitt, I., The method of configuration interaction, in Methods of Electronic Structure Theory
H. F. Schaefer III (Eds), Plenum, New York, 1977 p. 189. An authoritative review by a
leader in the field discussing many aspects of CI (symmetry- and spin-adapted configurations, construction and diagonalization of the CI matrix, selection of configurations, etc.).
Shepard, R., The multiconfiguration self-consistent-field method, Adv. Chem. Phys. 69: 63
(1987). An authoritative discussion of MCSCF.

CHAPTER

FIVE
PAIR AND

COUPLED-PAIR

THEORIES

We saw in Chapter 4 that configuration interaction (CI) using only doubly
excited states (DCI) predicts that the correlation energy of N noninteracting
minimal basis H, molecules is proportional to N'/? as N becomes large.
Because the energy of a macroscopic system is an extensive thermodynamic
property, it must be proportional to the number of particles; thus DCT is
not a satisfactory procedure for treating large systems. For example, the
correlation energy per atom of a crystal obtained using DCI is zero! It is
clear that to describe correlation in infinite systems one must use methods
that yield energies that are proportional to the number of particles. Even for
finite systems, it is desirable to use approximations which give results that
can be meaningfully compared for molecules of different size. For example,
when studying the dissociation of a molecule one should use a method which
is equally good, in a certain sense, for the intact molecule and the resulting
fragments. Approximations, which have the property that the calculated
energies vary linearly with the number of particles as the size of the system
increases, are said to be size consistent. In the special case of a supermolecule
formed from N closed-shell noninteracting “monomers,” a size-cdnsistent

scheme yields a supermolecule energy which is just N times the monomer
energy.
Although size consistency seems like a modest requirement, all forms
of CI except full CI, which is of course exact, do not have this property. In
this chapter we consider pair and coupled-pair theories, which are size
consistent, and in the next chapter we discuss a form of perturbation theory,
which also has this property. The price one pays for size consistency is that
unlike DCI, pair and perturbation theories are not variational and the total
271

272 MODERN QUANTUM CHEMISTRY

electronic energy obtained using them can be lower than the true energy.

For example, pair theory can give, in certain cases, as much as 120% of the
correlation energy.
In Section 5.1 we describe the independent electron pair approximation
(IEPA). We use an approach that leads quickly to the computational formalism but which may give the misleading impression that IEPA is an
approximation to DCI. After showing what is involved in performing pair
calculations, we will return to the physical basis of the formalism and show
that in fact both IEPA and DCI are different approximations to full CI. In
Subsection 5.1.1 we describe a deficiency of the IEPA, not shared by DCI or
the perturbation theory of Chapter 6 namely, that the IEPA is not invariant
under unitary transformations of degenerate molecular orbitals. In Subsection 5.1.2 we present some numerical results which show that while the
IEPA is reasonably accurate for small atoms, it has serious deficiencies when

applied to larger molecules.
In Section 5.2 we consider how to go beyond the IEPA by incorporating
coupling between different pairs of electrons. We will discuss the coupled
pair many-electron theory (CPMET) which is also called the coupledcluster approximation (CCA). We then describe a number of simplifications
to this rather sophisticated approach; in particular, we consider the coupled
electron pair approximation (CEPA). Finally, in Subsection 5.2.4 we present some numerical applications of coupled-pair theories.
Since coupled pair theories are important but somewhat complicated,
in Section 5.3 we discuss, as a pedagogical device, the use of these methods
to calculate the energy of an N-electron system described by a Hamiltonian
containing only single particle interactions. This problem can easily be
solved exactly in an elementary way. However, by seeing how “high-powered” approaches work in a simple context, we will be able to gain insight
into the nature of these approximations. In particular, the relationship
between different many-electron theories will become clear. As a concrete
application of many-electron formalisms (CI, IEPA, CEPA, etc.) to a
system described by a one-electron Hamiltonian, we consider the resonance
energy of cyclic polyenes within the framework of Hiickel theory in Subsection 5.3.2. Our purpose here is not to advocate the use of Hiickel theory
or the use of many-electron methods to obtain the resonance energy.
Rather, we wish to exploit the analogy between the resonance energy and
the correlation energy and provide an analytically tractable model which
can be used to illustrate some of the computational aspects of various
many-electron approaches.

5.1 THE INDEPENDENT ELECTRON
APPROXIMATION (IEPA)

PAIR

We have seen in the last chapter that the correlation energy obtained from
the intermediate normalized (i.¢., (D|‘¥o> = 1) full Cl-wave function formed

PAIR AND COUPLED-PAIR THEORIES 273

by making all possible spin orbital excitations from the HF determinant is
Ecort

=

Y

YY

a<br<s

& ARO

Pia

7

=

ae

4

Y

rs

Ch 36

ol |

(5.1)

where c’j are the variationally determined coefficients of the doubly excited
determinants in the full CI wave function. Recall that the coefficients of
single excitations are absent because of Brillouin’s theorem, while triple and
higher excitations do not appear because the Hamiltonian contains at most
two-particle interactions. This expression suggests that we write.the total
correlation energy as a sum of contributions from each occupied pair of
spin orbitals,
EF scer

=

Y

a<b

Cab

(5.2)

with

Ca = DCX Poles
r<s

(5.3)

where e,, is the correlation energy resulting from the interaction of the pair
of electrons which, in the Hartree-Fock approximation, occupy spin orbitals
%_ and x,. Although the above decomposition is exact, it is also deceptive
since we need the full Cl wave function to obtain the coefficients ci. Thus
for an N-electron system, we must consider all the electrons to calculate
exactly e,, for the ab pair. Can we devise a scheme for approximating the
pair energy of each pair of electrons independently of other pairs? If so,
then in effect we could approximately reduce an N-electron problem to
N(N — 1)/2 two-electron problems. The independent electron pair approximation (IEPA) is such a scheme. The IEPA was introduced in quantum

chemistry, independently, by O. Sinanoglu' and R. K. Nesbet.? These

authors used different terminology and formulations, but their final results
are essentially equivalent. Sinanoglu called his theory the Many-Electron
Theory (MET) while Nesbet used the name Bethe-Goldstone Theory. In
addition, for reasons which will become apparent shortly, the IEPA has
been referred to as “pair-at-a-time” Cl.
How can we calculate the correlation energy associated with a pair of
electrons in spin orbitals a and b (ie., the pair energy e,,)? The simplest
approach is to forget about the remaining N — 2 electrons (i-e., leave them
in their HF spin orbitals) and let only the electrons in spin orbitals a and b
correlate by exciting them into the virtual orbitals. We construct a correlated wave function for the pair ab, denoted by ['¥,,>, by allowing the HF
wave function to interact with determinants formed by exciting only this
pair. If for the sake of simplicity we ignore single excitations (which as we
have seen in the last chapter have little effect on the correlation energy), the

pair function |¥

> is

[Yan>= [Woo + 2 ccalPaE>
r<s

(5.4)

274

MODERN

QUANTUM

CHEMISTRY

where, as usual, we use intermediate normalization. The energy of this wave
function, E,,, is just the sum of the HF energy and the pair correlation
energy,
Ew

=

CP

||P

o>

+

Cab

=

Eg

+

Cab

(5.5)

Thus the energy of this wave function is below the HF energy by the pair
correlation energy. To obtain the best possible energy for the above pairfunction, we use the linear variation method. Thus we coristruct the matrix

representation of the Hamiltonian in the subspace spanned by |¥,) and all
double excitations involving 7, and y, and then find the lowest eigenvalue
of this matrix. Equivalently, we substitute the expansion for |'¥,,> into
H|P

>

=

E.a|P

e>

(5.6)

to obtain

(o> +¥ ese )- Ea(N¥o) 43 esis»)
t<u

5.7)

t<u

We then multiply this equation successively by (|

and ¢‘P%§| to obtain

Eo t+ Yi cP ole | "i> = Ean

(5.8a)

CPB |Po> + Y CGE [Vie >ccs = Easceb

(5.8b)

t<u

and
t<u

Using Eq. (5.5), these equations become

D CaP| H|¥%> = Cap

(5.9a)

t<u

and

CPF |Po> + YD CLG
t<u

— Eo| thet, =

Canes

(5.9b)

Finally, one can rewrite these equations in matrix form by defining

(Dases.tu = (VGH — Eq|'¥i>

(5.10a)

|V o>
(Bus)rs = CPG

(5.106)

Cob

(5.10c)

(Cos)es

=

so that Eqs. (5.9a) and (5.9b) are equivalent to

0

BL\/1\_

Ba

Da

Cop

(1
oe

Cop

51
(

,

)

This matrix eigenvalue problem is solved for each of the N(N — 1)/2 pairs
of occupied electrons. The total correlation energy is then obtained by

PAIR AND COUPLED-PAIR THEORIES 275

adding up the respective pair energies,

Evor(IEPA) = ¥. cp

(5.12)

a<b

Although each pair energy e,, is obtained by doing a variational, Cl-type
calculation, the sum of the pair energies is not necessarily above the exact
correlation energy. The individual pair CI matrices are much smaller than
the DCI matrix and one never has to calculate matrix elements of the type
(‘Pi |2/|#t5> which couple the pairs ab and cd. The IEPA is computationally
equivalent to doing DCI for each pair separately; thus, it is sometimes
called “pair-at-a-time” CI. This terminology and the fact that the IEPA is
computationally simpler than DCI would appear to suggest that the IEPA
is an approximation to DCI. However, this is misleading and as we will see
in the next section, where we consider how to incorporate coupling between
different pairs, it is more appropriate to view the IEPA as an approximation
to full CI which is different from DCT.
Before we give a simple illustration of pair theory, we consider some
approximations to the pair equations in order to make contact with perturbation theory. If in Eq. (5.9b) we neglect coupling between excited determinants (i.¢., we keep only the term t=r and u=s in the summation),
we have

CPB Po + (Pal — Eq|'Pib>
cls = eaaCab

(5.13)

If we solve this equation for c{j, and substitute it mto Eq. (5.9a), we obtain
=—

{Pola eo |?

5.14

Ca = — 2. CBRL — El) — em

0.14)

Since e,, is small compared with the difference between the energies of the
HF and doubly excited states, it can be set equal to zero in the denominator,
so that we have

y= — mS

=~

wy

| HV

LAL

>?

5.15

2 rgb — Ea

e)

Since the correlation energy obtained using this approximation to the pair
energies,
cE or(EN)

=

XY

a<b

et

(5.16)

was derived by Epstein and Nesbet, e§N is called the Epstein-Nesbet pair
correlation energy. Since the total correlation energy using Epstein-Nesbet
pairs, with large basis sets, overestimates the correlation energy even more
than pair theory, it is only occasionally discussed in this book. Finally, if we

further approximate

the energy difference between

|‘¥o> and

|'P%> by

276 MODERN QUANTUM CHEMISTRY

differences in HF orbital energies,

CPI

— E,|'Pi> & & + & — a — &

(5.17)

then we obtain

yr
KP
lae|
Pa
>?
Cap
=
FO

_

r<s &q +

Ep —

)

& — E,

(5.18)

which is called the first-order pair energy and is the simplest possible approximation to pair theory. The correlation energy obtained using first-order
pairs is

|
>
e
l
e
l
e
e
K
¥,
¥
=
)
O
Say y
Fxg (F
a<b r<s &q + & —

& —

é€ &,

els!

a<br<s
&q + & — & — Es

519

As we will see in the next chapter, this expression is identical to the first
correction to the HF energy obtained within the framework of many-body
perturbation theory (ie., it is the second-order energy). Thus the simplest
form of perturbation theory immediately leads to a form of pair theory.
Exercise 5.1 The application of pair theory to minimal basis H, is trivial
since we are dealing with a two-electron system for which the IEPA is
exact, Le., it gives the full CI result obtained in the last chapter, viz.

* Ecore

corr

= A — (A? + K},)"?

where (see Eq. (4.20))
A = (€2 — €4) + 311

+ Jaz — 42

+ 2K 12)

a. Calculate the correlation energy using first-order pairs. Remember that
the summations in Eq. (5.19) go over spin orbitals (ic, a = 1,1 and

r = 2, 2). Show that

FO)

corr FO)

=

2
Ki2

5, — a)

~————_..

b. Approximate A in the exact correlation energy by &, — €, and recover
the first-order pair correlation energy by expanding the exact answer to
first order using the relation (1 + x)? ~ 1 + x/2.
As asimple illustration of pair theory we calculate the correlation energy
of a dimer consisting of two noninteracting minimal basis H, molecules.
Since H, contains only two electrons, pair theory is identical to full CI and
hence is exact for the monomer. Recall that we label the occupied and
virtual orbitals of the ith monomer as 1, and 2,, respectively, and that, since
the monomers are noninteracting, all two-electron integrals containing
orbitals from different subunits are zero. Since the dimer has the configuration

PAIR AND COUPLED-PAIR THEORIES 277

(1,)?(1,)?, we need to find six pair correlation energies, i.e, Crip C11 1,19
1,1,» €1,1,, and e,,7,. However, only two of these six pair energies are nonzero namely, e,,7, and e,,;,. To see this, consider the mixing of a doubly
excited state in which a pair, say (1,, 1,) is excited into the virtual orbitals

2, and 2,, with the HF ground state

CH ETE

= (1T 22D

~ {P=

Be

0

fi=jok=1

.
otherwise

(5.20)

Since this matrix element is zero unless both electrons are located within a
given subunit and unless they are excited to the virtual orbitals of the same
subunits, the pair function for (1,, 1,), is
[Pid =

'Po> + ci 2 ei ne»

(5.21)

The corresponding pair equations obtained from Eqs. (5.9a) and (5.9b) are
Kcr

== 1,1,

Ky. + 2Ach# = e1,7,c74'

(5.22a)

(5.22b)

where 2A = 2(€, — €,) + Ji, + J22 — 4J,, + 2K,.. These equations are
identical to the full CI equations of a single minimal basis H, molecule (see

Eqs. (4.19a) and (4.21)). Thus e,,7, = €,,7, = ‘Eco Where 'E,,,, is the exact

correlation energy of a single H, molecule. Then the total correlation energy
in the IEPA for the dimer is
Ecorr

(IEPA)= 1,7, + €151,= 2" Ecorr

(5.23)

so that it is twice the exact correlation energy of the monomer. The above
discussion can immediately be extended to show that the IEPA correlation
energy of N independent H, molecules is N times the correlation energy of
the monomer. Thus we see that the IEPA is size consistent as stated previously. Since IEPA is exact while DCI fails badly for this model, one

cannot really consider the [IEPA to be an approximation to DCI.
Exercise 5.2. Derive Eqs. (5.22a) and (5.22b).

Exercise 5.3 Calculate the total first-order pair correlation energy for
the dimer using Eq. (5.19) and show that it is twice the result obtained in
Exercise 5.1.

5.1.1 Invariance under Unitary Transformations: An Example
In spite of the fact that the IEPA is not variational, it has an advantage over

DCI in that it is size consistent. Unlike DCI and many-body perturbation

278 MODERN QUANTUM CHEMISTRY

theory (discussed in Chapter 6) the IEPA has the distinct disadvantage of
not being invariant to unitary transformations of the occupied spin orbitals

in the HF determinant. As we have seen in Chapter 3, if we transform the
occupied spin orbitals {7,} among themselves, |‘¥ > will not change; however,
the total correlation energy obtained using the IEPA will be different. Since
the canonical HF orbitals are unique, apart from degeneracies, the IEPA
using nondegenerate orbitals does give a unique correlation energy. In the
case of degeneracies, however, an arbitrary mixing of degenerate orbitals
can occur in the SCF calculation. The particular linear combination obtained
can be a function, for example, of the iteration step at which it was decided
to terminate the procedure. The fact that the sum of pair correlation energies
is not invariant to this very arbitrary mixing is particularly distressing.
We now investigate this invariance problem with our minimal basis
model of two noninteracting H, molecules. The following example also
provides us with an opportunity to introduce the concept of spin-adapted
pair correlation energies. Up to this point we have considered spin-orbital
pair energies. For example, in a 4-electron system with yw, and wy, doubly
occupied, we must calculate six spin-orbital pair energies, i.e, e,7, e72, €135
ep; €;2, and e,3. However, not all of the corresponding spin-orbital pair
functions are eigenfunctions of #7. In particular, 'V,,, ‘¥43, ¥i2, and Vg
are not pure spin states. The idea behind spin-adapted pair theory is simply
to use only pair functions which are eigenfunctions of £7. In general, the
correlation energy calculated from spin-orbital or spin-adapted pair energies
differs, as will be shown by our example.
For two independent H, molecules using molecular orbitals localized
on the two monomers, (i.e, 1,, 2,, 1,22) we have seen that the IEPA gives
the exact result for the correlation energy of the dimer. We now repeat
our analysis using a set of equivalent delocalized molecular orbitals. Since
orbitals 1, and 1, as well as 2, and 2, are degenerate, we can take an arbitrary
linear combination of them and retain the same HF description. In particular
we consider the completely delocalized orbitals,

a=2°471,4+1,)

+

+

+

+

@)

(5.24a)

b=2>'70,-1,

+t

+

FT

7

Ww

(5.24b)

r=2-'22,-2,)

+

7

TFT

+

@®

(5.24c)

s=27472,4+2,

+t

7

+

>

Ww

(5.24d)

The pluses and minuses indicate the sign of the atomic basis functions in
the LCAO description of the four orbitals. Note that a and r are of gerade
symmetry while b and s are of ungerade symmetry. The HF wave function

PAIR AND COUPLED-PAIR THEORIES

279

in terms of these delocalized orbitals is
|'¥o> = |aabb>

(5.25)

This wave function is identical to |1,1,1,1,>, which is a reflection of the
fact that the HF wave function is invariant to a unitary transformation of
the occupied orbitals.

Exercise 5.4 Show that |aabb> = |1,1,121,>. Hint: use Eq. (1.40) re-

peatedly. Eq. (1.40) for Slater determinants is

Ix1%2

(Zeus) yw) = > Gta%2 ND
k

k

Using the expansions in Eqs. (5.24) one can show that the two-electron
integrals over the delocalized orbitals are

(aa| aa) = (aa| bb) = (bb| bb) = (ab| ab) = 3J,,

(5.26a)

(rr|rr) = (rr|ss) = (ss|ss) = (rs|rs) = 3J22

(5.26b)

(rr|aa) = (ss|aa) = (rr| bb) = (ss| bb) = (ab|rs) = 4J,,

(5.26c)

(ra|ra) = (sb| sb) = (rb| rb) = (sa|sa) = (ra|sb) = (rb|sa)=4Ky2

(5.26d)

and the orbital energies are ¢, = &, = €, and €, = &, = &p.
We now find the six spin-orbital correlation energies: @,4, €a5, Cab» Cab»
ezp. yp. First consider the pair ad. Since |W) is of gerade symmetry and is
an eigenfunction of *, with eigenvalue zero (i.e. Ms = 0), only doubly
excited determinants of gerade symmetry having equal numbers of spin
up and spin down electrons, interact with |‘¥9>. Therefore the required pair
function is

|Paa> = [o> + cy |PEE> + C2|PS

(5.27)

Since

CF lo |¥%,> = Caal |FF> = (ar|ar) = (ralra) = 3K12

(5.28a)

CP oH |¥S5> = <aal |s5> = (as|as) = (salsa) = 4K2

(5.28b)

it is convenient to use symmetric and antisymmetric combinations of these

functions (i.e., 2~* 2(|7,> + |W) so that only the plus combination mixes

with the ground state. Introducing a new notation for this plus combination

Paw > = 27 42(\EE> + |Waa>)

(5.29)

we can write the aa@ pair function as
|'Poa>

=

'¥o>

+

c|P2*

(5.30)

280

MODERN QUANTUM

CHEMISTRY

The required matrix elements are

CV fat) = 2° 17K 2
(W449 — Eo|VEFD = ley — &1) + Jan + Hur —
=2A'
Exercise §.5

°

2 +) 2K)

(5.31a)
(5.31b)

Derive Eqs. (5.314) and (5.31b).

The equations which determine the pair energy are (see Eqs. (5.9a,b)).

Cy = 2-1/7
Ky 9c
272K,

+ 2A'c = egg

(5.32a)
(5.32b)

By eliminating c from these equations and solving the resulting quadratic
equation for e,, we find

Cgq = A’ — (AY? + K?,/2)'?

(5.33)

Because of the high symmetry of this problem, as manifested by the relationship between the two-electron integrals in Eqs. (5.26), it follows that e,; =
€,q- We now show that e,, = e, = 0. To see this, consider the pair function
for the ab pair. Since only double excitations of gerade symmetry and
\
Mg = Oneed be considered, we have
|Pan> =

o> + c,|P >

(5.34)

However, this double excitation does not mix with |W),
CY ol 0 |¥ o> = (ab||rs)> = (ar|bs) — (as|br) = 0

(5.35)

and thus the pair correlation energy of the ab pair is zero. The argument
for the ab pair is the same. This result has an interesting physical interpreta-

tion. Since correlation between electrons with the same spin is included in
the HF approximation (Fermi hole), pair theory does not give any additional
correlation. While it is not true in general that pair energies of electrons with
the same spin are zero, they are smaller than the other pair energies.
Finally, we must find e,; and e,,. Proceeding in the same way as for
the aa pair (i.e, eliminating double excitations of the wrong symmetry and

then constructing + linear combinations) the ab pair function becomes

[Pas) = |Wo) + cl VS"

(5.36)

[PA*> = 271 2\ E> + [WE)

(5.37)

where

The ab function is obtained by interchanging a and b. Now it can be shown
that the equations which determine the ab pair are identical to Eqs. (5.32)
so that the pair correlation energies for the ab and ad pair are the same. Thus

PAIR AND COUPLED-PAIR THEORIES

281

the total pair correlation energy for the dimer using delocalized orbitals is
*E con(IEPA(D))

=

€ga + np

=

403

+

Can + Cab + Cay + Cas

(5.38)

= 4(A’ — ((A’P + K7,/2)"””)

This is to be compared to the result obtained using localized orbitals .

2B co (IEPA(L))

= 2(A — (A? + Kj,)"”)

(5.39)

which is exact for the model. It is clear that the two expressions are different,
and using the minimal STO-3G basis set two-electron integrals in Appendix

D for R =

1.4 a.u., we find

Fo exact) = 7E.o(IEPA(L)) = —0.0411 a.u.

2. ALEPA(D)) = — 0.0275 a.u.
so that there is almost a factor of 2 difference between the two results! In
real systems, the situation is not quite so bad, and the results obtained using
localized and delocalized molecular orbitals, although different, are closer.

For example, Bender and Davidson?

have found for boron hydride, using

a large basis set of Slater orbitals, that with canonical SCF orbitals the
IEPA correlation energy is —0.141, a.u., while with localized orbitals it is
—0.139 a.u..
Exercise 5.6 Show that e,, = en, = ga.

Exercise 5.7 Show that DCI is invariant to unitary transformations for
the above model.
a. The DCI wave function is
pc»

= |Wo> + c,|¥2*> + c| VD

+ c,|‘P5*> + c|P3*

Show that the corresponding eigenvalue problem which determines the

DCI correlation energy of the dimer (7E,,,,(DCI)) is
0

272K,

2717 K,,

212K,

2-12Ky,

1

2°"? Ky

2A’

511

4K12—Ji2

$K12—Ji2

Cy

277 Ky,

iJi1

2A’

3Ki2—Ji2

3K y2—Jiz

C2

2°-'?Ki.

$Ky2-Jiz

3Ki2—Ji2

2A’

is

C3

2°'?K,)

3K,2—Ji2

4K,2.—Jy2

Jay

2A’

C4

1
Cy

= *Ecor(DCI | c2
C3

282

MODERN

QUANTUM

CHEMISTRY

b. Show that c, = cz = c3 = c, = c and then solve the equations to show

? Ecor( DCI) = A — (A? + 2K7,)'? )
which is the same result as found in the last chapter (see Eq. (4.60)).
The pair functions |‘¥,5> and |Wo> are not pure singlet wave functions.
For example, as can be seen from Eq. (5.37), the doubly excited states in the

pair function ‘¥3* are |rabs> and |sabF>, which correspond to

—t—-r

—+~—s

—j—_a

—+—b

” and

——r-—-+—s
—{—a

—}—b

respectively. Recail (see Table 2.7) that there are two linearly independent

singlet spin functions arising from the configuration (a)'(b)*(r)(s)' namely,

|4475,> and |?75. The matrix elements we require for our discussion are in
Table 4.1. Using these results, along with the integrals in Eqs. (5.26), it follows
that

(Poot Pie = PREP

= 0

(5.40)

and hence we only need consider |?%3> in constructing the spin-adapted
pair function for the ab pair,

| Pas> = [Por + cf Pap»

(5.41)

The required matrix elements are

(5.42a)

CP l3PP> = Kiz
CPP

— Eo|?

+J
at) = 2(€s—€:)

+ J22— 2

.2+Kiz2 = 2A”

(5.42b)

the corresponding pair equations are

ermelet

Ky4¢

Ky. + 2A"c = esintlete
Solving these in the standard way, we find

efipelet = A" — ((A")? + K},)*?

(5.43a)
(5.43b)

(5.44)

Since the pair functions for the aa and bb pairs are pure singlets the total
correlation energy for the dimer using spin-adapted pairs is

2 Fsinglet(TEPA(D)) = €,a +

5 + Ene

= 2(A' — (AP + Kj2/2)"7) + (A" — ((A")? + Ki2)"”)

(5.45)

With the STO-3G minimal basis set, the above correlation energy is — 0.0258
a.u. as compared to —0.0275 a.u. obtained using spin-orbital pairs. Thus
pair theory is not only variant to unitary transformations of degenerate HF

PAIR AND COUPLED-PAIR THEORIES 283

orbitals, but also gives different answers depending on whether one uses
spin-orbital or spin-adapted pair functions.
It is interesting to note, however, that the simplest form of pair theory,
namely, first-order pairs (see Eq. (5.19)), is invariant to unitary transformations of degenerate orbitals. To see this, we approximate A’ = A” = «, — &,
in Egs. (5.38) and (5.45),
2. (IEPA(D)) =a(t. —e)-(@- ea(t + TeK?
s) 1/2 )

—~e)-(— ea(l + ie K? ap) 1/2 )

2 E Fsinslet(TEPA(D)) = 2(

—- (€, 2 —€& 1 (1
SS
+ ( &5 2 — &,;) 1 )-(
+ —_—_—_—
\" )
(e, Kin
_ —.)

Notice we have factored (g, — ¢,) out of the square roots. Expanding the

square roots using (1 + x)!/? = 1 + x/2, we find

and
2

*EsadFO(D)) = 4( A(ez—Kiz
)=2(
Kia
)
— &)
2(€, ~ &2)

Ease FO(D) = 2( 4" -) 4 (A)
;

Fsinglet

— K2

12

— K2

12

-2( A)
K2

12

(5.46a)

tease)

These results are equal to the total first-order pair correlation energy,
obtained in Exercise 5.3, for the dimer using localized orbitals. The total
first-order pair correlation energy is identical to the second-order many-body
perturbation result for the correlation energy (see Chapter 6). The above
results are a reflection of the fact that many-body perturbation theory is
invariant to unitary transformations of degenerate orbitals.
Finally, we have seen that using localized orbitals, the IEPA applied to
a dimer of noninteracting minimal basis H, molecules gives twice the exact
energy of the monomer. However, using delocalized orbitals, the energy of
the dimer is no longer twice the monomer energy because of the invariance
problem. This appears to contradict our statement that IEPA is size consistent; however, the essential requirement for size consistency is the linear
variation of the correlation energy with the number of particles. Thus while
the energy of N H, molecules calculated within the IEPA may not be N
times the exact energy of H,, it will be proportional to N as N becomes

large rather than N1/? as with DCI.

Exercise 5.8 Show directly from Eq. (5.19) using delocalized orbitals and
the two-electron integrals in Eq. (5.26) that the total first-order pair correlation energy (which is the same as the many-body second-order perturbation
energy) of the dimer is given by Eq. (5.46).

284

MODERN

QUANTUM

CHEMISTRY

Exercise 5.9 Show that the total correlation energy obtained
Epstein-Nesbet pairs is not invariant to unitary transformations.

using

a. Show, using localized orbitals, that

K 2
2 Eco (EN(L)) = —.
b. Show, using delocalized spin-orbital pairs, that
2

2E | (EN(D}) = _ Fiz
corr

A

c. Show, using delocalized spin-adapted pairs, that
2

,

psinglet

core

(EN(D))

=

Ki,

Ki 12

2A’

2A”

ss 12

°

d. Using the STO-3G integrals for H, in Appendix D compare the numerical values of the above expressions at R = 1.4 a.u.
Exercise 5.10 The DCI
adapted configurations is

wave function for the H, dimer using spin-

Ppci> = |Wo> + Cr|WE*> + col PD

+ c3|PH>

Show that the corresponding DCI eigenvalue problem is

0

2-"?K,,

2°7K,,

Ky,

2-"?K,,

2

Way

2-/7(Ky2
— 2442)

2°'7K,,

3Ji4

2d’

2-/(Ky.

Ky,

2°-"(K4 — 25,2)

271/7(Ky2 — 232)

*

—

23,9)

2A”
1

1

x| 7) = 22 <pcn| ©
C2

C2

C3,

C3,

and then solve the resulting equations to show that
? For(

5.1.2

DCI)

=A—

(A?

+

2K?)

Some Illustrative Calculations

An impressive success of the IEPA is its prediction of the ground state energy
of the beryllium atom. The spin-orbital pair correlation energies obtained by

PAIR AND COUPLED-PAIR THEORIES

285

Table 5.1 Spin-orbital pair correlation energies (a.u.) of Be’
Pair

Correlation energies

(1s, Ts)
(1s, 2s)
(1s, 2s)
(Is, 2s)

—0.0418
—0.0008
—0.0021
—0.0021

(2s, 2s)

—0.0454

(Is, 2s)

Total pair energy
Exact correlation energy

.

—0,0008

—0.0930
—0.094

“R.K. Nesbet, Phys. Rev. 155: 51 (1967).

Nesbet using a large Slater basis set containing s, p, d, and f orbitals are
shown in Table 5.1. The total IEPA correlation energy is 98.9% of the exact
correlation energy. It is estimated that if g, h, i, . . . orbitals were to be included
in the basis, the IEPA would give very close to 100% of the exact correlation
energy. Of course, because IEPA is not variational, it is possible to obtain
over 100%. The individual pair correlation energies listed in Table 5.1 show
some interesting trends. The largest values are for pairs with opposite spin
in the same orbital (e.g., (1s, 1s)) and the smailest are for pairs with parallel
spins (eg., (1s, 2s) or (Is, 2s)). This is a reflection of the fact that the HF
approximation does in fact correlate electrons with the same spin (the Fermi

hole); its major defect is that it allows electrons of different spin to be in the
same place.
For larger atoms, the IEPA works less well. Using a very large basis
containing s, p, d, f, g, h, and i orbitals, Nesbet, Barr, and Davidson* obtained
a correlation energy for neon of 107% of the exact result. Since their basis
was still not complete, they estimate that the IEPA gives about 110% of the
exact correlation energy. The IEPA appears to be even poorer for molecules.
For example, Langhoff and Davidson? studied N, using a moderately large
Gaussian basis set. It was estimated that if full CI were to be performed in
this basis one would obtain a correlation energy of —0.35 a.u. They performed an essentially complete DCI calculation, which gave — 0.324 a.u. for
the correlation energy. This result is necessarily less than the basis set
correlation energy. The IEPA, on the other hand, gave a correlation energy
of —0.412 a.u., which

is 18% larger than the estimated exact result. With

larger basis sets, giving 80 or 90% of the exact correlation energy, it is likely
that the IEPA is even worse. Thus to obtain a really accurate approximation
for the correlation energy one has to improve upon the IEPA. This can be
done by incorporating coupling between pairs as will be discussed in the
next section.

286 MODERN QUANTUM CHEMISTRY

5.2 COUPLED-PAIR

THEORIES

In this section we will extend the IEPA to incorporate coupling between
different pairs ab and cd. Although DCI does include such coupling, since
one needs matrix elements of the type CP ||P. DCI is not size consistent. Because full CI is the exact, but computationally prohibitive, solution
to the many-electron problem, it seems reasonable to begin our search for a
size-consistent extension of the IEPA by considering the full CI equations
and seeing if we can find a novel approximation to them. For the sake of
simplicity, we ignore the presencé of single, triple, etc. excitations; thus, the
intermediate normalized full CI wave function is

IDo> = [Yoo + Yo cael an> +
a<b
r<s

2

a<b<c<

: Capea Vonea> +°°*

(5.47)

r<s<i<u

where the dots represent hextuple etc. excitations. As we have seen in the
last chapter, to determine the variational energy of this wave function, we
substitute it into
(#

_

E)|®o>

=

Ecorr|Po>

and then successively multiply by <Wo|, (Y25|, (‘Yau|, etc. to obtain the
following set of coupled equations
2X

CP lot |Pea> ccd = Ecorr

(5.48a)

t<u

CPIC|Po> + X (Winlo0 — Eo|¥ci>cea
t<u

+ DC

feu

Waoe|Pebea
> Cabea = EconsCah

(5-48)

and so on. For example, the next equation involves the coefficients of the

quadruples and the hextuples. Note that in writing the matrix element
between doubles and quadruples we imcorporated the fact that matrix
elements between determinants which differ by more than 2 spin orbitals are
zero. The above equations form a hierarchy in which the correlation energy
depends on the coefficients of the doubles, but the equation for these coefficients involves the coefficients of the quadruples and so on. Clearly, to make
progress, we must terminate or decouple this hierarchy. The simplest procedure is to set 3%, equal to zero, obtaining a closed set of equations involving
only the coefficients of the doubles. The resulting equations are identical to
the DCI equations, which can be derived by starting with a CI wave function
containing only double excitations and then using the linear variation
method. Is there an alternate and perhaps less drastic way to decouple the
hierarchy?

PAIR AND COUPLED-PAIR THEORIES 287

5.2.1 The Coupled-Cluster Approximation (CCA)
If we could express the coefficients of the quadruples as some function of the
doubles

coefficients,

then we would

obtain

a closed

set of equations.

In

Chapter 4 we found an indication of how this might be done. The full CI
wave function for two noninteracting minimal] basis H, molecules is

[o> = [1,1,1,1,> + ¢2171|2,2,1,1,) + c2223]1,1,2,2,>

+ ¢31}:2222/7,3,2,2)>
11011212

(5.49)

In Exercise 4.12 we found that

HERE= (chEMCRE

(5.50)

That is, the coefficient of the quadruple excitation is just the product of the
coefficients of the two double excitations. This result can be readily understood without our previous algebraic manipulations. The two H, molecules
are separated by infinity so that, for all intents and purposes, we can ignore
the requirement that the total wave function be antisymmetric with respect
to the interchange of electrons which belong to different H, molecules.
Thus since two H, molecules are independent, we can write the exact wave
function of the dimer as a product of the exact wave functions of the monomers,

(o> = (lat, + chi l2:2.> Malad + cf377]2222>1

= |1,1,>|1,1,> + c?!#[2,2,>|12T2> + c22%2[1,1,>|2.22>
+ c3134¢2222/7 3, |2222)

(5.51)

Comparing this equation with Eq. (5.49), note that (aside from antisymmetry)
for the two functions to be identical the coefficients of the doubles and
quadruples must be related by Eq. (5.50). In this simple four-electron model
system, the two pairs of electrons are independent and the coefficient of the
quadruply excited configuration in the full CI wave function is exactly equal
to the product of the coefficients of the double excitations.
In a real many-electron system two pairs of electrons ab and cd are, of
course, not independent. However, since the IEPA works fairly well, it seems
reasonable to approximate the coefficients of the quadruples as products of
the coefficients of the doubles. Thus we write symbolically
rstu

Cabcd

=

rs

Cap *

cd

(5.52)

The reason why c";4, is not simply the product of c’5, and c’4. can be understood
as follows. We can obtain a quadruply excited configuration in which
electrons in spin orbitals abcd are excited to rstu in many ways. For example,
. a>r
du
. aor
du
not only can we excite
and
but we can excite
and
.
bas
cot
bt
cos

In the first case, if |W> is |--- abcd--->, we would obtain a quadruply

288 MODERN QUANTUM CHEMISTRY

excited determinant |---rstu---) while in the second case we would get
|-:-rtsu--->. These determinants represent the same quadruply excited

state but have different signs (ie., |---rtsu---) = —|---+rstu--->). Thus we

could represent c7) either as cZcty or —ci,c%. Unfortunately, there are 18
distinct ways we can get a particular quadruple excitation from independent
double excitations and c73,
is the sum ofall possible products of such double
ai
excitation coefficients. The rather formidable result is

Cabed = Cab * Coa = CanCea — (Cab * Coa
= CieCea — CaeCba *t CoaCoe — CabCea + CacCbd — CaaCbe
+ ConCea — CacCba + CaaCbe + CabCea ~ CacCba + CaaCbe
—

cabCca + CacCha — CaaCbe + CabCea — CacCha + CaaCbe

(5.53)

The signs in front of the various terms are a result of the antisymmetry
property of Slater determinants as explained above. Substituting this expression into Eq. (5.48b), we have

CVI |Y o> + Yo Valse — EolPea>cca
e<d

t<u

+

CBC Pia

c<d

t<u

(cay * cot) =

(Polo
|Pearecs
|
cab
coxa

(5.54)

e<u

where we explicitly used the result in Eq. (5.48a) for E,,,,. Now

(PGC |Viba> = CP lot |P4>
when ab # cd and rs ¥ tu. Since C5, « cl vanishes when ab = cd and rs = tu,
Eq. (5.54) becomes

CPHIE|Po> +

c<d

CWB — El Pcs — Y CP ol ae MED < cs, « ct
c<d

t<y

t<u

$Y Ov le) ciety -| y verte 5
c<d

c<d

t<au

t<y

where we have used the definition ci, * cy = cict —

(cy * >

(see Eq.

(5.53)). Note that the expression on the right-hand side cancels with a term

on the left-hand side, to give

CPi

Vo> + Y CMae — El Vapdy — Yo CP a¢| ><a « dt) = 0
c<d

c<d

t<u

t<u

(5.55)

This equation, along with the definition of the symbol (cj, * ¢4) given in
Eq. (5.53), and the expression for the correlation energy in Eq. (5.48a) are
the equations of Coupled-Pair Many-Electron Theory (CPMET), which is

PAIR AND

COUPLED-PAIR

THEORIES

289

also calied the Coupled-Cluster Approximation (CCA). We shali use the
latter name throughout this book. In quantum chemistry the CCA is associated with the names of J. Cizek and J. Paldus® who first derived these
equations and studied their properties. The casting of Eq. (3.55) into a
computationally convenient form involves fairly laborious manipulations.
It should be remembered that we have negiected single excitations in obtaining the CCA equations. The CCA including only double excitations has
been called CCD (coupied-clusters doubles) to distinguish it from more
general versions of the theory that also incorporate single (CCSD) and
higher excitations. Since such extensions are not considered here we will
continue to use the acronym CCA.
We now briefly discuss various aspects of CCA. One of the interesting
features of this formalism is that Eq. (5.55) does not explicitly contain the

correlation energy. Moreover, since it contains products of the doubles
coefficients, it is nonlinear. Thus, unlike CI, the correlation energy within the

CCA cannot be obtained by simple matrix diagonalization. The CCA,
although quite complicated, has many attractive properties. Aithough it
incorporates coupling between different pairs just as DCI (i.e., it contains

matrix elements of the form (P|a/)5))

it is, in contrast to DCI, size

consistent. Moreover, it does not suffer from the invariance probiems of the
IEPA (ie., it is invariant to unitary transformations of degenerate orbitals).
However, it is still not a variational scheme; that is, it is possible to obtain
more than 100% of the exact correlation energy using the CCA.
After applying the CCA to the problem of N independent minimal
basis H, molecules, we will briefly reconsider the ideas behind this formalism
from a more fundamental point of view.
Consider a supermolecule consisting of N noninteracting minimal basis
H, molecules. In this system, there are N double excitations of the form
|Pre> i=1,...,N. Since ali the H, monomers are identical, all the coefficients of these doubles are equal. Denoting these coefficients by c, and

since (‘Yo|9/|¥?:7'> = Ky

for all i, Eq. (5.48a) becomes

NE

corr

= NeKy>

(5.56)

A given double excitation }¥?:?') will mix with N — 1 quadruple excitations
of the type |¥?:?: BP
Fi. The matrix element between the double and
quadruple excitations is again just K ,2

PETC

EEE

= CP HERE) = Kin

i Fj

If we write the coefficient of this quadruple excitation as c7'?:c??}! = c?, Eq.

(5.54) becomes

K,, + 2Ac + (N — 1)K,.¢? = %E,,,,¢ = (NcK,2)c

(5.57)

The factor (N — 1) appears in front of K ,,c? since there are N — 1 quadruple
excitations that mix with a given double excitation. Note that NK, ,¢? cancels,

290 MODERN QUANTUM CHEMISTRY

and we can rewrite Eq. (5.57) as

K,,+ 2Ac — K,,c? =0

(5.58)

Solving this equation for c, we find
A

_

A?

K?

c= Ane tu)
12

1/2

(5.59)

so that the correlation energy in Eq. (5.56) becomes

NE sor(CCA) = N(A — (A? + K?,)'/2)

(5.60)

which is just N times the exact correlation energy of a single H, molecule.
Thus

the CCA,

unlike DCI,

is exact for our model

problem.

Recall

that

DQC is not exact for N > 2. Thus by approximating the coefficients of the
quadruples by the square of the coefficient of the doubles we did much more
that just approximate DQCI. We have in fact implicitly approximated the
coefficient of the hextuples as the cube of the coefficients of the doubles and
so on. The reason CCA gave the exact answer for our idealized model is
because in our model the coefficient of al! higher (hextuple, octuple, etc)
excitations are exactly equal to products of the coefficients of the double
excitations. This aspect of CCA is brought out clearly using a more fundamental point of view (which is how historically CCA arose) discussed in the
next subsection. This section uses some second quantization notation and
may be skipped without loss of continuity.

5.2.2 The Cluster Expansion of the Wave Function
Recall that, using second quantization, a doubly excited determinant |¥73)
can be written as
[\Pr5> = alata,a,|'Y o>

where a,, a, TemOve occupied spin orbital from the HF determinant and
a}, at replace these by unoccupied spin orbitals. Thus the doubly excited CI
wave function can be written as
[Yoa> = (1 +4

» ciate.)

aors

[Po>

We now introduce a wave function, which not only contains double

excitations

but also quadruples,

hextuples, etc. excitations in such a way

that the coefficients of the 2nth-tuple excitations are approximated by products of n doubly excited coefficients. Such a wave function |®,,,4), can be
written as

cca) = exp(F2)|Yo>

(5.61a)

PAIR AND COUPLED-PAIR THEORIES 291
e

where

1

FJ, = 4 & ciatataa,

(5.61b)

abrs

This is called the cluster form of the wave function. To get some feeling for
it, we expand the exponential as exp(x) = 1+ x + 4x? +--- to obtain
1
+ 4 > cxatalaa, + 32
1

[®oca> = (

Y capcyatala,a,a}alaga, + *-

abrs

abcd

|'¥o>

rstu

1

1

= Yo) +4 & calla) +35 D cckcaisa> + --abrs

abcd
rstu

which, after somewhat lengthy manipulations, can be written as

Yo ch x aul +--+
Y ca + a<b<c<d
®oca> =(Woo + a<b
r<s

(5.62)

r<s<t<u

where c’5 « c™ is our shorthand notation for the sum of the 18 products of
doubly excited coefficients in Eq. (5.53). Thus this form of the wave function
has the feature that higher excitations are products of double excitations.
An alternate, but equivalent, derivation of CCA can be given using the
wave function |®,,,4> in Eq. (5.62). By substituting {®¢c,4)> into the Schrédinger equation
(#

_

E,)

Deca

=

Ecorr|Poca>

and then successively multiplying by <‘¥,|, and <‘¥73| one can show that the
resulting equations are identical to our previous Eqs. (5.48a) and (5.55),
since the matrix element between <‘¥5| and any hextuple excitation is Zero.
The above theory can be generalized to incorporate the effect of single
and/or triple and higher excitations. For example, single excitations can be
included by replacing 7, in Eq. (5.61a) by 7, + 72, where
F,

=

3

cat a,

ra

To distinguish various extensions, the theory using only double excitations
(ie., Z} is commonly called CCD, while the acronym CCSD is used when
both single and double excitations are included (i.¢., 7, + 73).
Exercise 5.11 Show that the wave function two independent H, molecules in Eqs. (5.49) and (5.50) can be written as
|®>

=—

—

212

exp(cffial abaya,

+

222

T

c7272ah,ah,a7,4,,){1,1,1,1,>

292

MODERN

QUANTUM

CHEMISTRY

§.2.3 Linear CCA and the Coupled-Electron Pair
Approximation (CEPA)
Although CCA is an excellent approximation, it is rather demanding from
the computational standpoint. The final equations of CCA have a complicated algebraic structure and can be approximated in numerous ways.
In this subsection we consider two possibilities that are most often encountered in the literature. The simplest possible approximation is to set (cy, * chy
equal to zero in Eq. (5.55) to obtain

CPI [Por + LPG
c<d

— Eol'Pea>cea = 0

(5.63a)

i<au

This along with the usual expression for the correlation energy

Boose =D, (Vol | Veacea

(5.63b)

c<d

t<y

constitute what is called linear CCA (L-CCA). Note that we have eliminated
the nonlinear terms after the cancellation involving the correlation energy
was performed. If we would have simply set c’j, « cl4y equal to zero, we would
have obtained the usual DCI equations.
Introducing the matrix notation

(BY),asp = (Pol | 25>
(D),asb, tcud = CPR

— E,|a>

(C),asb = Cab
Eas. (5.63a, b) become
B+ Dc=0

(5.64a)

E.orr corr = Bre

(5.64b)

Solving Eq. (5.64a) for c and substituting the result into Eq. (5.64b), we have

Eo cor = ~ BD)1B

(5.65)

which is a convenient form for the correlation energy in linear CCA. It is
interesting to compare this with an expression for the DCI correlation energy
obtained in the last chapter (see Eq. (4.30a) },

Eger

cor

= —B'(D — E,o,,1)~1B

(5.66)

corr

Recall that one way of finding the DCI correlation energy is to solve Eq. (5.66)
iteratively (i.c., begin by setting E,,,, = 0 on the right-hand side, find Ej,,,
and use this to find E%,,, and so on until convergence is found). Thus Eq. (5.65)
appears to be an approximation to DCI. This is, however, misleading because
the linear

CCA,

although

no

longer

variational,

is size consistent.

This

PAIR AND COUPLED-PAIR THEORIES

293

approximation is identical to the infinite-order doubly excited many-body
perturbation theory (D-MBPT(0o)) of Bartlett and coworkers’ which was
originally derived by diagrammatic summation techniques (See Subsection

6.7.3).

Exercise 5.12
a. Show that if the matrix D is approximated by its diagonal elements, the
L-CCA correlation energy is identical to the result obtained using EpsteinNesbet pairs (i-e., Eqs. (5.15) and (5.16)).
b. Show that linear CCA is invariant under unitary transformations for the
problem of two independent H, molecules. First show that for this model
the correlation energy of the dimer using localized orbitals is the same
as that obtained in Exercise 59a. Then show using delocalized spin
orbitals that, in contrast to the results of Exercise 5.9, one gets the same
correlation energy. You will find the DCI matrix given in Exercise 5.7
useful.

We now consider a different approximation to CCA, originally proposed
and implemented by W. Meyer® called the Coupled Electron Pair Approximation (CEPA). We begin again with the CCA equation (5.55). Instead of
ignoring all the terms involving <cij « c4> we retain those where c= a
and d = b. Thus we have

WG|%o> +

c<d

WG — Eola ct = L CHWS<a * cl
t<u

t<u

(5.67a)
From Eq. (5.53), which defines <c%, * 4), it follows that

«Cab * Cab> = CabCab
where we have used the fact that a coefficient like c’j, is antisymmetric in the
occupied or unoccupied indices (e.g., ci, = —c, = —c%). Substituting this
into Eq. (5.67a) we have

CP

|Lo> t+ Yo <P
e<d

ea) cea = (x (Pol
— Eo|
t<u

t<u

Recognizing that the sum
energy €,, (see Eq. (5.9a))

in parentheses

a>) Cab

is the expression

(5.67b)

for the pair

Ca =D, (Kolo |Pa5> cat

(5.68a)

CPI |Vo> + YL CPI — Eo ¥ea>cea = eanan

(5.68)

t<u

Eq. (5.67b) becomes

c<d

t<u

294 MODERN QUANTUM CHEMISTRY

The CEPA correlation energy is given by
Ecort

=

YX
a<b

Cab

(5.68c)

These are the equations of CEPA. Note that they are very similar to both
the IEPA and DCT equations. If ¢,, in Eq. (5.68b) were replaced by the total
correlation energy, we would obtain the DCI equation (See Eq. (4.26b)). On
the other hand, if the summation over c < d were approximated by a single
term (i.e., c = a, d = b) we would recover the IEPA result given in Eq. (5.9b).
CEPA includes coupling between pairs ab and cd, unlike the IEPA, yet it
remains size consistent, unlike DCI. Note that computationally, because
the equation which determines e,, contains the coefficients of other pairs
(ci), the equations in CEPA must be solved iteratively. The major advantage
of CEPA over CCA is that it is much simpler computationally. The price
one has to pay is (among others) that CEPA is no longer invariant to unitary
transformations as is CCA. However, it appears to be more nearly invariant
than the IEPA.
As an illustration of the above formalism we calculate the CEPA
correlation energy of our dimer of two noninteracting H, molecules using
both localized and delocalized orbitals. Since with localized orbitals there

is no coupling between different pairs in this model (i.e, (Y7:F:|9¢|V2E> = 0
when i # j) CEPA and IEPA are the same. Using delocalized orbitals, the
Situation is different. The CCA is exact in this case since it is invariant to
unitary transformations, while CEPA is not. However, as we will see CEPA

works much better than the IEPA. Since CEPA can formally be obtained
from the DCI equations by merely replacing E,,,. by the appropriate pair
correlation energies, we immediately get from the result given in Exercise 5.7

*Ecore = 27? Ky2(cy + C2 + C3 + Ca) = Coa + Cp + Cab + Ene
27 "?Ky2 + 2c,

+ 3442

+ (GKi2 — Jy2)c3 + GKi2 — Jia)Ca = Cane

and similar equations for e,5, €.5, eq». From the symmetry of the equations,
it follows that c, = cz =c3 =c,=c and thus all four pair energies are
equal. Hence
> Ecorr

271?K,,+(2A'

=

4e

=

2K,

4(27-

+4341

+

Ky2

(5.69a)

2c)

—2J42)c

=

ec

(5.69b)

Recognizing the quantity in parentheses in Eq. (5.69b) as 2A (see Eqs. (4.20)
and (5.31b)) we have
2-4?K,,

+

2Ac

=e€éc

Multiplying this equation by 2~1/?K,, and using Eq. (5.69a), we obtain

K?,/2 + 2Ae = e?

(5.70)

PAIR AND COUPLED-PAIR THEORIES 295
e

Solving the quadratic equation for e and then using Eq. (5.69a), we finally
have

”Ecorr(CEPA(D)) = 4(A — (A? + K32/2)"?)

(5.71)

Note that this is not equal to the exact correlation energy (i.e., 2(4 —

(A? + K?,)")) of the dimer. However, using the STO-3G minimal basis
H, integrals, in Appendix D, 7E,,,(CEPA(D))

=

—0.0414 a.u. as com-

pared to the exact value of —0.0411 a.u. Thus CEPA is nearly invariant
for this problem.
Before considering some applications of coupled-pair theories, it is

appropriate to summarize the formal relationship of these theories among
themselves and with DCI (see Table 5.2). It can be seen that DCI, L-CCA,
and CEPA are rather similar from the computational point of view. Formally, L-CCA can be obtained from DCI by setting E,,,, = 0, while by
setting E.o,, = €,, one obtains CEPA. One must be careful not to be mislead
by this formal similarity. It might appear that L-CCA is in fact an approxi-

mation to DCI. This is not the case; L-CCA is size consistent in contrast to

DCI. A better point of view is that all these schemes are different approximations to full CI. DCI is variational but is not size consistent. L-CCA,
CEPA, and CCA are not variational but are size consistent. Among the
three coupled-pair theories, the CCA is expected to be the best. As we have
seen, the L-CCA can be obtained from the CCA by setting (cy « cy) = 0
while to obtain CEPA, one makes an apparently less drastic approximation.
However, it turns out that while L-CCA is invariant to unitary transformations of degenerate orbitals, CEPA is not. On the other hand, it is difficult

to argue, on first principles without numerical applications, that L-CCA
should work better than CEPA when applied to a variety of molecules.

Table 5.2 The formal relationship between
DCI and various coupled-pair theories
ccor

=

YX

a<b

Cab

Coy

=

Y

r<s

CH

ol

[FC

CPE |Fo> + Yo CUI — EolWeadcca = X
c<d
<u

Method

X

DC

cor Cab

L-CCA

0

CEPA

Cap

CCA

<P ols
DY
c<d
i<e

< ces * c4>

296 MODERN QUANTUM CHEMISTRY

These comments emphasize that one must be careful in evaluating various
approximation schemes. The consequence of an approximation is often
more subtle than it appears at first glance.
5.2.4

Some Illustrative Calculations

In this section we present results for the correlation energy and equilibrium
geometry of H,O obtained with a near-HF one-electron basis (the 39STO

basis

described

in Chapter

4) via DCI,

TEPA,

L-CCA,

and

CCA.

Meyer and his coworkers have stlidied potential energy surfaces, ionization

potentials, dipole moments,

and polarizabilities of a variety of molecules

using CEPA. Some of their impressive results are contained in a review by

Meyer.?

The correlation energies of H,O obtained via a variety of many-electron
theories within the same one-electron basis are shown in Table 5.3. These
results must be compared with the exact basis set correlation energy (— 0.296
a.u.), which is different from the exact correlation energy (— 0.37 a.u.) because the one-electron basis is incomplete. Otherwise one would obtain the

erroneous conclusion that of all the methods, the IEPA works the best. It

is, in fact, the worst; it overestimates the correlation energy by 13%. We
note that the correlation energies obtained via the L-CCA and CCA are
close to each other and to the exact result. Both are superior to SDCI. The
closeness of the L-CCA and CCA is somewhat surprizing because the
L-CCA involved an apparently drastic approximation to CCA.
In Table 5.4 we present the calculated equilibrium geometries and two
force constants obtained using the above methods. It can be seen that

Table 5.3 Correlation energies (a.u.) of
H,O at the experimental geometry calculated with the 39-STO basis described in
Chapter 4
Ever

sbpcr
IEPA‘
L-CCA?

—0.2756
— 0.3274
—0.2908

Estimated full CI
Exact

—0.296 + 0.001
—0.37

cca?

— 0.2862

*B. J. Resenberg and I. Shavitt, J. Chem. Phys

63: 2162 (1975).

PR. J. Bartlett, [. Shavitt, and G

Chem. Phys. 71: 281 (1979).

D

Purvis, J.

PAIR AND COUPLED-PAIR THEORIES

297

Table 5.4 Equilibrium geometry and some force constants of
H,0 calculated with the 39-STO basis described in Chapter 4

R{a.u.)
6,
far
feo
*B

(1976).

SCF*

SDC

—_L-CCA®

CCAP

Expertment

1.776
106.1
9.79
0.88

1.800
104.9°
8.88
0.81

1.810
104.6
8.51
0.80

1.806
104.7°
8.67
0.80

1.809
104.5°
8.45
0.76

J Rosenberg, W. C. Ermler, and I. Shavitt, J. Chem. Phys. 65: 4072

>R. J. Bartlett, L. Shavitt, and G. D. Purvis, J. Chem, Phys. 71: 281 (1979).

These references contain a large number of additional force constants.

L-CCA and CCA represent a significant improvement over SDCI, which is
in turn significantly better than SCF. When compared to experiment, the
L-CCA appears to be slightly better than the CCA! However, one should
not jump to the conclusion that the L-CCA is a better approximation. After
all, the one-electron basis is clearly not complete and we do not know the
equilibrium geometry of H,O that would be obtained if a full CI were to be
performed in this basis. On the other hand, it is possible that the L-CCA
accidently accounts for the effect of single and triple excitations absent im
the CCA so that the L-CCA results are really closer to the exact values in
the basis. These considerations highlight the need to apply approximation
schemes to a variety of molecules, using basis sets of increasing sophistication, before drawing conclusions as to the superiority of one method over
another.

5.3 MANY-ELECTRON THEORIES
PARTICLE HAMILTONIANS
We

WITH

SINGLE

have encountered a variety of techniques (CI, IEPA, CCA,

CEPA)

for

calculating the correlation energy of a many-electron system, and in Chapter
6 we will discuss still another approach based on perturbation theory. The
complexity of these formalisms and of the many-electron problem itself is
the result of the two-particle nature of the coulomb repulsion between
electrons. If the Hamiltonian contained only single particle interactions,
there would be no need for sophisticated many-electron theories since we
could solve the problem exactly simply by diagonalizing the Hamiltonian in
a basis of one-electron functions (i.e. the orbital picture would be exact).
Nevertheless, it is instructive to apply the formalism of many-electron
theories to an N-electron problem described by a Hamiltonian that contains

298 MODERN QUANTUM CHEMISTRY

only single particle interactions. By seeing how these sophisticated techniques work in such a simple context, insight into the nature of these approaches can be gained. As we shall see here and in the next chapter, when
one approaches a many-electron system with only single particle interactions, using the formalism of many-electron theories, one obtains equations
that are almost completely analogous, yet much simpler, than those encountered previously. In particular, the nature of the approximations and
the relationship between different approaches becomes especially transparent. Moreover, the calculations can be done analytically but still contain
many of the features of ab initio talculations. This section is a rather long
diversion and may be skipped without loss of continuity. Only the second
half of Section 6.3 depends on some of the results obtained here.
We begin by posing the problem and solving it exactly in an elementary
way. Suppose we have a N-electron system described by the Hamiltonian

H = Ho +V =F hi) + ¥ oli)

(5.72)

To obtain a zeroth-order description we assume that the perturbation ¥ is
negligible, and find the eigenfunctions and eigenvalues of the N-electron
Hamiltonian #. Since #, contains only single-particle interactions, we
proceed as follows. First, we find the complete orthonormal set of spin
orbitals {y{°}, which are eigenfunctions of ho

hays? = ef

(5:73)

The ground state wave function, |’), is then a Slater determinant constructed from

the N spin orbitals with the lowest energies. As usual, we

label occupied spin orbitals by a, b, ... and the unoccupied spin orbitals by

r,S,....Thus we have

~

[o> = [x= f+ =

(5.74)

This wave function is an eigenfunction of #
H|Vo>

=) eD'|'Po>

(5.75)

with an eigenvalue equal to the sum of the occupied spin orbital energies.
The approximate ground state energy of the system, in the presence of ¥ is

Eg = (P| 4%

= YO

+ ¥ Cala =

+ PY vg

(5.76)

so that the total energy is not simply the sum of orbital energies. Note the
analogy to the HF energy of a real system having two-particle interactions.

The excited determinants formed from the spin orbitals {y{,

ie,

|, |'Pz5>, etc. form a complete set of N-electron basis functions. Thus the
exact wave function, |®)>, of the N-electron system can be expressed as a

PAIR AND COUPLED-PAIR THEQRIES 299

linear combination of these as

D> =|[¥o + Dal¥o+

Yo cal

a<b

t+--:

(5.77)

r<s

where we have used, as usual, intermediate normalization (i.¢., (P9|®9> = 1).
The exact ground state energy, 6), can be obtained by diagonalizing # in
the basis of N-electron functions (i.e., using (5.77) and the linear variation
method).
However, there is a much simpler way of finding &. Since the total
Hamiltonian # is, just like #5, a sum of single-particle interactions, we can
find a set of spin orbitals {y,;}, which are eigenfunctions of hy + v

(5.78)

(ho + v)X, = EX:

Then the exact ground state wave function is just a Slater determinant
constructed from the N exact spin orbitals with the lowest energies

I®o> = |e

ta

tw?

Since this wave function is an eigenfunction of the total Hamiltonian

H|\Do> = J" €,|Do>

(5.79)
#7

(5.80)

with an eigenvalue equal to the sum of the N lowest spin orbital energies,
the exact ground state energy is

& = (®,|#|®y> = Ve,

(5.81)

Clearly, the two procedures 1) diagonalizing # in the basis of N-electron
functions formed from the eigenfunctions of hy and 2) diagonalizing hy + v
and adding up the N lowest spin orbital energies must give identical ground
state energies. It is equally clear that method (2) is much easier. As a pedagogical device, we will approach the problem the hard way using N-electron

functions. In analogy to the correlation energy, we define the relaxation
energy of our system as the difference between the exact energy and the

energy of |'Py>,

Ep = & — Ey

(5.82)

Our objective will be to calculate Ep using many-electron formalisms.
First, let us calculate the relaxation energy simply by solving the eigenvalue problem for hy + v,

(ho + v)|x> = elx>

(5.83)

in the basis {|7{°}. We expand |x) as

Ixn> = » We; = 2 Pe, + D [Xs

(5.84)

300 MODERN QUANTUM CHEMISTRY

Note that we have divided the sum over all zeroth-order spin orbitals into
the sum of the first N occupied ones and the rest. Substituting this expansion

into Eq. (5.83) and then multiplying by ¢y"| and <y{°| we find
b

<a ho + vb >y + 2 <b Des = 8g

(5.85a)

s

YY Kole,

+ Y KO

b

+ o/c, = Ec,

s

or equivalently
2

(&

(0)

Sab

+

ECg

(5.86a)

Y vay + Y (€06,, + Vp:\s = €C,

(5.86b)

b

Dap)C,

+

2

VasCs

—

(5.85b)

3

To rewrite these equations
matrix H,, with elements

in matrix

notation, we introduce an N x N

(Hades = 6055 + Uap

(5.87a)

(Haa)rs = &7,, + Us

(5.87b)

Similarly, if we define

(Has)as = Vas

(5.87¢)

(Aga), = Ur

(5.87d)

Egs. (5.86a,b) become
Aaa

1) (<)

(i

Hoz/

\cp

(<)

=€

(5.88)

Cp

Note that H,, is a square matrix with dimensionality equal to the number
of occupied orbitals while the dimensionality of Hg, is equal to the number
of unoccupied spin orbitals.
To obtain the exact energy, &, we must solve this eigenvalue problem
and add up the N eigenvalues with the lowest energies. To make this more
explicit we let
U

=

Una

un)

(om

Usp

be the unitary transformation, which diagonalizes the Hamiltonian matrix
in Eq. (5.88),
(a

i)

(O"

un)

_ (UM

un) (

°)

He,

Hes/\Us,

Usp

Usa,

Use/\0

&p

(5.89)

where s, is a diagonal matrix containing the N lowest eigenvalues. Then
the exact energy is
6o = tre,
(5.90)

PAIR AND COUPLED-PAIR THEORIES

301

Note that we have defined the matrix H,, in such a way that the sum of its
diagonal elements is equal to Ey. Thus the relaxation energy can be written
in the compact form
Er

=

&o

_

Eo

=

&o

_

(x

2)

+

ta)

=

tr(e,

_

Ha)

(5.91)

Finally, using the unitary matrix U one can express the exact orbitals |y;>

in terms of the zeroth-order orbitals |y{. Since the ith column of U contains

the coefficients of the ith eigenvector, the exact occupied orbitals can be
written as
\Xa>

=

>

1x

>(U

aaoa

+

b

YX

>

Bara

a=

1, 2,

sto

N

(5.92)

¥

A similar relation holds for the exact unoccupied orbitals.
For future reference we now reformulate the above theory in a way
which might appear unfamiliar at first glance but on closer inspection will
turn out to be a generalization of the procedure we have used many times
to find the lowest eigenvalue of a matrix. We are now interested in finding
the sum of the N lowest eigenvalues. The matrix eigenvalue problem in
Eg. (5.89) is equivalent to four equations, two of which are

HaaUga + Happs = Ussta

(5.93a)

HeaU aa + HgpUpa = Ussta

(5.93b)

Multiplying the first of these by Uj} on the right we have

Haat HapUpsUas = Unstaas

(5.94)

Taking the trace of both sides of this equation and using the fact that
tr AB = tr BA we have
trHya

+

tr H,pUg,Uaa

=

tr Ug4e,U4}

=

tre,Uz}U ga =

tre,

Using this identity and defining
Coa = UpaUas

(5.95)

we can rewrite the relaxation energy as
ER

Now

=

tr(e,

_—

Ha)

=

tr

HasCpa

(5.96)

let us find the equation which determines C,,. To do this, multiply

Eq. (5.94) by Up,U3/ on the left to obtain
UpaUaAHaa

+ UpaUasHasU pans

= UpstaUaa

(5.97a)

Then multiply Eq. (5.93b) by U;} on the right to obtain
Hea + HppUpaUad

= Upsets

(5.97b)

302 MODERN QUANTUM CHEMISTRY

Substracting these two equations and using the definition of C,, in Eq. (5.95)
we finally have
Hepa

+ HasCpa

_ CraHaa

_ CasHasCr,

=0

(5.98)

This relation together with Eq. (5.96) completely determine the relaxation
energy. Note that Eq. (5.98) is nonlinear (i.e., it has a quadratic dependence
on the matrix Cg,) and therefore must be solved iteratively. Finally, we
translate these equations back into a form containing the zeroth-order
orbital energies and matrix elements of the perturbation. If we define
(Cpadra

=

Cra

(5 99)

then we can rewrite Eq. (5.96) as
Ep = tr HgsCg, = > (Hando(Caa)ss = >, UsCos
bs

(5.100)

bs

where we have used Eq. (5.87). Similarly, the ra element of the matrix equation
(5.98) is
(Hga)ra

+

Y
s

(Hap)s(Caa)sa

™

Y
b

(Caa)o(H44)ba

7 YX

(Cyao(Hasle(Cra)sa

bs

=0

which upon using the definitions in Eq. (5.87) becomes
Ora

+ YX
s

(205,

+

s)C sa

~

Y
b

C(O

Sa

+

Upa)

~~ YX
bs

Cre? tsCsa

=0

(5.101)

If this equation is solved for the C,,’s, then the exact relaxation energy can
be found from Eq. (5.100).

In the past when we considered eigenvalue problems we were usually
interested in only the lowest eigenvalue. For the problem at hand we need
the N lowest eigenvalues. The above procedure is just a generalization of
our standard approach to finding the lowest eigenvalue. To see this, suppose
Hy, is a 1 x 1 matrix and that the entire matrix is M = M. In this case
Eq. (5.96) simplifies to
M

(5.102)

Ex=@,—-Hy,= Y HyCa
i=2

and Eq. (5.98) becomes
M

Ay

+

> HC,
j=2

M

—

CaAir

— Cia

Y

j=2

=9

H,,C;,

i=2,3,...,M

(5.103)

Setting C;, = c; and using Eq. (5.102) in Eq. (5.103) we have
M
Ay,

+

Y

J=2

(Ai;

_ H,,6,,)e;

=

Exec;

(5.104)

PAIR AND COUPLED-PAIR THEORIES

303

Equations (5.102) and (5.104) are equivalent to the matrix equation
0

Ay2

te

Him

i

Aa,

Aaa—Aiy

ute

Fo

2

Ay

Hy2

7+)

Aym—Fyy]

\cuy,

1
=Ep

C2

1
=(e,—H1)

Cm,

°

Cm,

which is precisely the equation we would start with if we were after the lowest
eigenvalue.
Exercise 5.13 For the 2 x 2 matrix

(a

Has

Hoa

Has

Gf
Hy,

#)
Hz,

Ay, < Hz,
H,,>0

Equation (5.96) simplifies to
Ex=6,

— Hy, =H,,C€

and Eq. (5.98) is
Ay,

+

H.C

-

CH,

~_

C’H,2

=

Solve this quadratic equation for the lowest C and then show that e, thus
obtained is the lowest eigenvalue of the matrix.

5.3.1 The Relaxation Energy via CI, IEPA, CEPA, and CCA
Many-electron methods use N-electron wave functions (i.e., Slater determinants). For example, to perform a full CI calculation one must diagonalize
the N-electron Hamiltonian in a basis of N-electron functions formed by
making all possible excitations from a reference function, | o>. Formally,
one can proceed in the identical manner irrespective of whether the Hamiltonian contains one or two-particle interactions or both. Of course there are
considerable simplifications in the case that the N-electron Hamiltonian
has only single particle interactions. In particular, the evaluation of the
required matrix elements is easy, and the final equations have a much simpler
structure. Recall that in a real many-electron system the correlation energy
can be written in terms of the coefficients of the doubly excited determinants
in the full CI wave

function. As we shall see, because of the one-particle

nature of the Hamiltonian, the relaxation energy can be expressed in terms
of the coefficients of single excitations. Thus, in this section, single excitations
play the same role as double excitations do in real many-body systems.
Moreover, double excitations here are analogous to quadruple excitations
in previous sections. In particular, when we consider the analogue of CCA

304 MODERN QUANTUM CHEMISTRY

for our model problem, we will need to express the coefficient of the doubles
in terms of products of the coefficients of the singles. This is much simpler;
instead of a messy 18-term result (see Eq. (5.53)) we will have a simple two
term expression. Finally, when the Hamiltonian only contains single particle
interactions, the analogues of pair theories are just “particle” theories. For
example, instead of writing the correlation energy as a sum of independently
calculated pair energies, e,,, we will express the relaxation energy as a sum

of “particle” energies, e,. We can retain the various acronyms used for pair
and coupled-pair theories if we simply change the meaning of the P’s.
We now calculate the relaxation energy using the various many-electron
approaches.
1. Full Cl. The intermediate normalized full CI wave function is given in
Eq. (5.77)
|Dy> = |Wo> + Y c3|P5> + Y
Sb

ch PE> 4°

(5.105)

b<c
s<t

To obtain the full CI equations, we substitute the above expansion for |® >
into
(.# — Eo)|®o> = (Fo + 4

— Eo)|®o> = (Eo — Eo)|Po> = Eg|Mo>

(5.106)

and then successively multiply by ¢‘¥o|. ¢‘¥%]. (ol. and so on, remembering

that the matrix element of a Hamiltonian containing single particle interactions vanishes when the determinants differ by more than one spin orbital.
In this way we find

= Ep

(5.107a)

— Eo|PS>c$ + ¥ COS> chs = Epc,

(5.107b)

Ybs CPt |i
CHIH |Po> + Y) CPI
bs

bs

and so on (Le., the next equation in this hierarchy involves the coefficients
of the doubles and triples).
Exercise 5.14 Show that
a. (HY o|H|'V§> = cps.
b. CY
|P o>= tg:

ifazAb

d. <P?

|W

= Ups
=0

:ac

| =a

Il

ll

c. (YH
— E,|¥5> = 0

r#s

ifa=b
rs
ifa#b
r=s
iffa=b
r=s.
ifaxb
r#s
otherwise.

PAIR AND COUPLED-PAIR THEORIES 305

Using the matrix elements found in Exercise 5.14, Eqs. (5.107a, b) become

Y vy ch = Ep

(5.108a)

bs

Ore

+

¥

s

(Sap

Y

~~

+ v,5)C3

(05,

b

+

YX

+

Ura

bta

UpsCop

=

Excy

(5.108b)

sér

and so on. We now consider various approximations to full CI.

2. SCI. The analogue of truncating the CI expansion for the correlation

energy at double excitations is to use only single excitations for the relax-

ation energy. This amounts to setting c% = 0 in Eq. (5.108b),
Org

+

Y

s

(60%6,,

+

,)Ca

a

Y

b

(eS

as

+

Usa)Ch

=

Exc;

(5.109)

This along with Eq. (5.108a) for the relaxation energy completely specify
the simplest form of truncated CI.

3. IEPA. Since our Hamiltonian contains only single particle interactions,
we must devise an independent “particle” theory. In analogy to pair theory
we define a “particle” function

(5.110)

[¥.> = |Wo> + > c|¥S>

with a variational energy equal to E, + e,. The relaxation energy then is
approximated by a sum of “particle” energies as

(5.111)

Ex=)) eq
To find e,, we substitute the expansion for the “particle” function into
(#

~

E,)|¥.>

= e,|Pa>

(5.112)

and then multiply successively by <‘¥o| and <‘*|. Using the matrix elements
in Exercise 5.14, we obtain

Vea +

Y gC, = Cg

(C55 + UIC, — (EO + Veale, = CoC",

(5.113a)
(5.113b)

which are the required equations. Note that they can be formally obtained
from the SCI equations by restricting the summation over b to one term
(i.e., b = a, this corresponds to neglecting “particle-particle” interactions)
and replacing E, by e,.

4, CCA.

As we have seen in Section 5.2, the idea of this method, as applied

to a real many-particle system, is to truncate the full CI hierarchy by ap-

proximating the coefficients of the quadruples as sums of products of the

306 MODERN QUANTUM CHEMISTRY

coefficients of the doubles. Here we express the coefficients of the doubles
as sums of products of the coefficients of the singles. There are two independent ways in which we can obtain the double excitation ‘P3: 1) we can
excite a— r and then b— s to get |---rs---> and 2) we can excite a — s and
then br to get|- - sr --->. Because the second determinant is the negative
of the first, we can represent c'}, either as cic} or —cécp. In analogy to Eq.

(5.53), we can write

(5.114)

Cab = Cah — CaCh

Substituting this into Eq. (5.108b) with the expression for E, in Eq. (5.108a)
we have
Dra +

Yee

s

0

6,5 +

U,)Ca ~~

¥

b

(ef

0

a

UpsCaCh

UpsCGCb ~ Y

Y

Sap + Vya)Ch +

bs

bs

_—

~~ (x

bs

nth)

Ci

Note that we need not worry about the restriction b #a and s # r since the
expression for c's, in Eq. (5.114) vanishes when b = a or r = s. Cancelling the
common term on the right and left-hand sides, we finally have
Ura

+

Ss

s

(e6,,

+

U,s)C§

_~

>

(eda,

b

+

UraCh

~

>

ChU, SCE

bs

=

0

(5.115)

Note that this equation is nonlinear and does not explicitly contain the
relaxation energy. Before we discuss its properties, we consider two approximations to CCA.
5. L-CCA. The simplest approximation is to linearize Eq. (5.115) by setting

the term which is a quadratic function of the coefficients equal to zero, ie.,

Veg + Y, (605, + DsICh — Y (COS, + Urals = 0
s

b

(5.116)

This is called the linear approx .mation to CCA.
6. CEPA. Finally, we consider the analogue of the coupled-electron pair
approximation. Here instead of throwing away the quadratic term, we
approximate it as follows. First note that
¥

bs

Ss

CHU psCa

~

YX

s

r

CqVasCa

s

+

Y

b#a
s

ry

CEU pCa

7S

and then ignoring the b # a terms, we obtain
YX

bs

r

CE

psa

s

= Ca

r

Y

s

+

VasCa

pS

—

Cag

r

Finally, using this in Eq. (5.115), we have
Vya

+

Y

s

(605,

+

VCa

which is the required equation.

—

Y

b

(65.5

+

UpalCp

=

C4Ca

(3.117)

PAIR AND COUPLED-PAIR THEORIES 307

Table 5.5 Equations for the relaxation energy in manyelectron theories
E,=>De,

=

DL

vas

SCI:

Pra + YF (LGpy + Pye — Y (C'San + sales = Exc

IEPA:

Vea t+ DY (Bs + Uses — (6 + Waals = CaCa

L-CCA:

pq + Y (e855 + ek — ¥ (6S, + Vpadch = 0

CEPA:

Veg + ¥ (, + Vdes — YF (EPSay + veds = Cas

CCA:

Urq

s

b

b

s

+

X

s

b

(6,

+

v,5)Co

_~

xX

b

(San

+

Vpa\Ch

=

x Ch

bs

nsCo

In Table 5.5 we summarize the various results obtained so far. Although
the structure of these equations is considerably simpler than the corresponding ones for a real many-body system, the insights concerning the interrelations among the various approaches gained from a perusal of this table
are generally valid. In particular, note that 1) CEPA can formally be obtained
from SCI by replacing the total relaxation energy E, by e,; 2) IEPA can be
obtained from CEPA by ignoring the coupling between different “particles,”
Le., setting Up, — Uzg0,,; 3) L-CCA can be obtained from SCI by setting
E, = 0 or from CEPA by putting e, = 0. It is important to remember that
just because a method can be obtained from another by setting something
to zero does not mean that it is inferior. Table 5.5 also shows that all methods
except CCA are closely related from the computational point of view. In
the next section we will apply the various formalisms to a simple model
problem where the exact answer for the relaxation energy is known.
First, let us consider the CCA equations more closely. If we set

c,=C
a

ra

in Egs. (5.108a) and (5.115) we see that they are identical to Eqs. (5.100) and
(5.101), which determine the exact relaxation energy. Thus CCA is exact for
an N-electron system with only single particle interactions! It is gratifying
that among all the many-electron theories we have considered at least one
is exact when applied to a problem where the orbital picture is exact. This
must mean that the approximation used in deriving the CCA equations
from the exact full CI ones, i.e.,

Ss

Ss

ab = Cale—

Ss

CaCh

is really not an approximation in the present context, but an exact relation.

308 MODERN QUANTUM CHEMISTRY

This relation can be mathematically proved using the property of
determinants given in Eq. (1.40) and the fact that the exact wave function

| > is a single determinant. Recall that (see Eq. (5.79))

(5.118)

Xo Kw>

Io) = ber

and that the exact orbitals [a> can be expressed as linear combinations of

the zeroth-order orbitals |7{°") as (see Eq. (5.92))
\%a>

=

¥

b

(Ua

aoa

+

YX

(Up adra

r

(5.119)

If we substitute the above expansion for the occupied orbitals into Eq.
(5.118) and make repeated use of Eq. (1.40), it can be shown that the exact
wave function is

I> = [UJ (5 + Dele + Yala ++)

(5.120a)

a<b

where the Coefficients c, are given by

C, = (Ug Ua dra

(5.1206)

8 = ct — CC,

(5.120c)

and

In an analogous way, coefficients of the higher excitations can be expressed
as sums of products of the singles coefficients. Note that for relarion (5.120c)
to hold, we must

use the intermediate

illustrate the above with an example.
problem (i.e., |®o> = |71%2>) and

normalized

Suppose

form

we have

of |®p>.

Let

us

a two-electron

(5.121a)
(5.121b)

x1> = |X + aslz$> + auld
Ix2>= [xP + balx$> + balx?
Then by repeated applications of Eq. (1.40) one can show that

[Do> = [XPD + sl
+ a3¥Px2>

+ balxOxP”>

+ aglxrx?>

+ (a3b, — agbs) 9X

= [Yo + b3|'¥3) + b,|¥S> + ag]¥2) + a,|¥4>

»

(5.122)

+ (a3b, — a,b3)|¥3>>

It is then clear that

034= (asb4 — agb3) = c3e3 — cc}
as we Claimed.

(5.123)

PAIR AND COUPLED-PAIR THEORIES

Exercise 5.15

309

Repeat the above analysis using

a> = ay {xO + aa]x9> + aslxP> + aalx?>
Ix2>= BylxP + balxP> + balxP> + balxP
instead of Eggs. (5.121a, b).

a. By repeated use of Eq. (1.40) show that
+ (a,b, — byas)|x'%x9

|®o> = (a,b, — bya2)KO7xX2

+ (a,b, - bya

+ (a,b2 —

lex?

b4a2)|xXD

+ (a3b,—

>

b3a2)|¥72)

+ (asb4— bag) ¥PxP>

Intermediate normalize this wave function by dividing the right-hand
side by a,b, — b,a, and then explicitly verify that Eq. (5.123) is satisfied.
b. To make contact with the general formalism, note that
U

AA

=

(*

a, 1

b 1
*)

and

U

BA

=

a, 3
( a,

b3
be

Note that |U,,| = a,b, — b,a, as required to make Eq. (5.120a) consistent

with the result obtained in part (a). Use the result of Exercise 1.4(f) to
evaluate U,{ and then verify the general result given in Eq. (5.120b) by
calculating
(UgsUAa)i1

= ct

and showing that it is identical to the coefficient of |y97> obtained in
part (a).

5.3.2 The Resonance Energy of Polyenes in Hiickel Theory
We now consider an interesting application of the various many-electron
approaches just discussed. We will use them to calculate the resonance
energy of a cyclic polyene with an even number of carbon atoms (N = 2n)
within the framework of Hiickel theory, and then compare the predicted
results with the exact value of this quantity. The resonance energy is defined
as the difference between the exact energy of the polyene (as obtained by
diagonalizing the Hiickel matrix and adding up to the occupied orbital
energies) and the energy of n localized and noninteracting double bonds or
ethylenic units. Since Hiickel theory is a one-particle theory (i-e., the effective
Hamiltonian does not contain two-particle interactions), the resonance
energy is analogous to the relaxation energy previously defined.

310 MODERN QUANTUM CHEMISTRY

To introduce notation, we briefly review the application of Htckel
theory to a cyclic polyene with N = 2n carbon atoms. Each carbon atom
contributes one electron to the z system of the molecule. The total Hamiltonian is approximated as a sum of one-particle terms as

H = y heeei)
where hj.

(5.124)

is completely specified by its matrix elements between an ortho-

normal set of atomic orbitals (<¢,|¢,> = 6,,, 4 ¥ = 1,..., N) as

(yy = Hy = Olheld> =

ifv= yp

=f

ifv=pott

=0

otherwise

(5.125)

Both the parameters « and B are negative. Note that in this model only
nearest-neighbor (or “bonded”) carbon atoms interact. We seek a set of
molecular orbitals, |;>, i= 1,..., N, which are eigenfunctions of heg
(5.126)

helWd = elW>

If we expand |y;> as a linear combination of atomic orbitals as

(5.127)

i=1,2,...,N

Wo=YCuléd)
rn

and use the linear variational principle, we are lead to the matrix eigenvalue
problem

HC =Ce

(5.128)

where the matrix elements of the Hiickel matrix, H, are given in Eq. (5.125).
Since the n molecular orbitals with smallest orbital energies are doubly
occupied, the total Htickel energy is
6

=2

y
i=1

Ej =

2

Y
a

Ey

VWa

ue

WW

(5.129)

The exact wave function of the system is
[D>

=

Wits

i

n>

(5.130)

where the spin orbitals are obtained by multiplying the spatial orbitals by
a spin function corresponding to spin up (no bar) or spin down (bar).
For the case of cyclic polyenes (CH)y, the Hickel problem is analytically
soluble.° The orbital energies are
&; = a + 2B cos (xi/n)
Polyenes

with

i=0,+1,4+2,...,4(n-—1),n

N = 4v + 2, v=1,2,...

carbon

atoms

have

(5.131)

closed-shell

PAIR AND COUPLED-PAIR THEORIES

311

electronic configurations. In this case, the exact ground state energy is

&=2

v

>

&=2 )

i= —V

i=

v

a+4B
7—¥

v

ni

cos(55"-5)

i=-V¥

= No + 48/sin(x/N)

(5.132)

For example, for benzene (N = 6, n = 3, v = 1) the ground state energy is
6a + 8B.

Exercise 5.16 Set up the Hiickel matrix for benzene and find its eigenvalues. Remember that if the carbon atoms are labeled clockwise from 1 to
6, then atoms 1 and 6 are nearest neighbors. Show that the six eigenvalues
are identical to those given by Eq. (5.131). Find the total energy and compare it with the result given by Eq. (5.132).
We now turn to the localized description of polyenes. As the zerothorder approximation, we assume that the polyene consists of n noninteracting
double bonds or ethylenic units. To obtain the energy corresponding to this
description we note that the Hiickel matrix for ethylene is

aX

u=(5 5)

with eigenvalues and eigenfunctions

eO=a+

A =a-B

B

|1> = 2-¥(|,> + |¢2)

fl*) =2-*(1g4) — |42>)

(5.133)

(5.1336)

where |1) is the bonding orbital, while |1*) is the antibonding orbital. Since

an ethylenic unit has two electrons, its energy is 2x + 28. Therefore, the
energy of n noninteracting units is

Eo= n(2« + 2p) = Na+

NB

(5.134)

The difference between the exact energy of the polyene and this approximate
localized energy is the resonance energy. Using Eqs. (5.132) and (5.134), we
have

Eg = & — Eo = B(4/sin(n/N) — N)

(5.135)

For benzene, this expression gives Ep = 28. In the limit that the number of
carbons becomes large (N > 00) (since sin(x) = x for small x) the resonance
energy approaches

lim Ep = NB(4/n ~ 1) = 0.2732NB

N>o@

(5.136)

Since f is negative, the resonance energy, just like the correlation energy of
a real many-electron system, is negative. Moreover, it is proportional to the

312 MODERN QUANTUM CHEMISTRY

number of particles as these become large. Therefore, only a size consistent
appreach is suitable for the calculation of the resonance energy of large
polyenes.
To make contact with the various many-electron approaches to the

relaxation energy, we define the set of occupied (|i>) and unoccupied (|i*))

ethylenic orbitals as

[i> = 277(121-1> + |b2i>)

\i*> = 27 7h;

— ba)

=1,2,...,n

Using these localized orbitals, the wave function corresponding
zeroth-order description is

(W,> = [1122 + - nny

(5.137a)

(5.137b)

to our

(5.138)

Since the atomic orbitals are orthonormal (ie., ¢¢,(¢,> = 6,,), it follows
that

<i]j> = <P] I> = 6,

<i] j*> =0

(5.139a)

(5.139b)

Using the matrix elements given in Eq. (5.125), it can be shown that the
nonzero matrix elements of h.¢, in the localized basis are

Cilheg|i> = 0 + B= ef
KM heeli*®> = 0 — B =
Cilhere|i + 1> = B/2
C*hee(it )*> = —B/2
Cifhecl(it D*> = (EF Dlherli*®> = 48/2

(5.140a)
(5.140b)
(5.140c)
(5.1404)
(5.140e)

Exercise 5.17 Verify Eqs. (5.139) and (5.140).
Finally to make contact with the general formalism previously given, we
partition he¢- as

hege = hy + v

(5.141)

where ho is defined so that the localized bonding and antibonding orbitals
are its eigenfunctions

holi> = (@ + B)id = eli>

(5.142a)

holi*> = (a — B)i*> = Ei)

(5.142b)

Since the localized orbitals are orthonormal (see Eq. (5.139)), it follows from
Eq. (5.140) that the nonzero matrix elements of the perturbation v are

Cilvlit 1 =Cilvli+ D*) =< [ofi-1)=f8/2

(5.143)

<i*[v[(i+ 1)*> =<ilv[(i— 1) =<i*[v[é+ 1) = — B/2

5 143by

PAIR AND COUPLED-PAIR THEORIES

313

In using the above matrix elements, it is important to remember that because
of the cyclic nature of the problem (n + 1) =|1)> and |0> = |»). As a con-

sistency check, let us calculate Ey = «VY /9¢|¥o> using the definition of |¥o>

in Eq. (5.138) and the above matrix elements.

Eo = x [<ilholé> + <i[holf >] + CXilv|i> + <ol>]

= ¥ [a +B) + (e+ Py] =Na+NB
imi

where we have used the fact that <i|v|i) and <i|v|f> are zero. Note that this

result for Ey agrees with that obtained in Eq. (5.134).
We are now ready to use the various many-electron theories to calculate
the resonance energy. We restrict ourselves to benzene and leave the extension to larger systems to the exercises. We begin with the IEPA because it

is the easiest. Since benzene has six occupied spin orbitals, we need to calculate six “particle” energies e,, e7, €2, €3, €3, and e3. Since all localized
bonds are equivalent, all these pair energies are equal to, say, e, so that

Ep = 6,

(5.144)

To calculate e, we consider the “particle” function [‘¥,> obtained by mixing
the ground state wave function |) with single excitations obtained by
promoting the electron in orbital }1) to all possible virtual orbitals,

[P1> = [Pod + cy Pr") + co|¥I"> + c3|¥7">

(5.145)

We did not include excitations involving spin-flips (e.g., |v?*)) because these
do not mix with |‘¥9>. Now consider the matrix elements

CP

ae 1P2"> = CAlholl*> + C1[of1*> = 0
CP le |P2*> = CAlho|2*> + <1[o[2*> = B/2
CY 3 |¥3*> = C1 |hol3*> + <1[v]3*> = — 8/2

where we have used Eas. (5.142) and (5.143). Note that |‘¥{"> does not

interact with |¥.>, so we need not consider it further. Moreover, since the
other two excitations have matrix elements that are negatives of each other,

we consider the normalized linear combinations 27 1/?(|¥7"> + |¥3")). The

plus combination does not mix with |"). Introducing a new notation for
the minus combination

\f> = 27 2(H7) — |P7)
or in general

[B= 27 1egrty — ee)

(5.146)

314 MODERN QUANTUM

CHEMISTRY

we can write the “particle” function [‘P ,> as

[¥.> = [¥o> + elt

(5.147)

KP IHD = ey

(5.148)

The corresponding “particle” equations are

[P o> + 41H — Ele
CF]

= exc

(5.1486)

The required matrix elements are

CP LHD = 2778

(5.149a)

<i]? — Eolt> = —36

(5.149b)

a= ofO28=2)

Substituting these into Eq. (5.148) and solving these in the usual way, we find

so that

E,(IEPA) = 6e, = 1.6858
which is to be compared with the exact value of 26 (ie. the IEPA
84% of the exact result).

(5.150)
gives

Exercise 5.18 Evaluate the matrix elements given in Eq. (5.149) and fill
in the remaining steps leading to Eq. (5.150).
Exercise 5.19 a) Extend the above analysis to calculate the IEPA resonance energy for a cyclic polyene with N = 2n (N > 6) carbon atoms. As
before, argue that all “particle” energies are the same so that
E,=Ne,
Consider only single excitations that mix with |‘¥9>. Show that the “particle”

function |'P ,> is

[71> =|Po> + el
where |¥> is obtained from Eq. (5.146),

[t> = 2-7

T> — YT)

Now show that

<Polet> = 27178
as before, but that here

<i]? — Edit) = —28.

PAIR AND COUPLED-PAIR THEORIES 315

instead of the result in Eq. (5.149b). Why the difference? Finally, solve the
resulting “particle” equations to show that

E,(IEPA) = N((3/2)"/2 — 1)B = 0.2247NB.
Note that the IEPA is indeed size consistent and that in the limit of large N
it gives 82% of the exact resonance energy.
b) The above result is not really exact within the IEPA. The reason for
this is that there exist single excitations involving orbital |{> that do not mix

with |‘¥,> but do mix with |#> and thus have some effect on the “particle”

energy e,. These excitations are analogous to single excitations in CI for a
real many-particle system in the sense that although single excitations do
not mix with the HF wave function because of Brillouin’s theorem, they do
mix indirectly through the double excitations. Investigate the effect of such

excitations for the case N = 10. Show

[> is

that the exact “particle” function

[P1> = [o> + cyff> + cs|'¥7"> + cPT
Now show that

(Pole |¥7"> = CP o|ae|PT = 0

ey H — El ¥t"> = (PT — E|¥T> = — 28
CPT E|¥T> = — 8/2

<tlePT> = — 6/2?
<TePT> = 8/2?”
Finally, show from the resulting “particle” equations that e, is the solution of

4e3 + 14Be? + 9f?e, — 3p° =0
This cubic equation can be solved to yield e, = 0.23878 so that the exact
IEPA resonance energy for N = 10 is 2.3878, which is to be compared with
the approximate result of 2.2478 obtained in part (a), so that there is a 6%
difference. The exact resonance energy found from Eq. (5.135) is 2.9446 for
this case.
We now consider the use of singly excited CI to calculate the resonance
energy of benzene. The SCI wave function is
3

a

sp =¥o+

© ol

i=1

3

+ ¥ al
i=l

(5.151)

where |*> is defined in Eq. (5.146); |f> is simply the corresponding wave

function involving a spin orbital with spin down. Because of the symmetry of

316 MODERN QUANTUM

CHEMISTRY

benzene, it follows that c, = c, =c3, = ¢; = C, = C, = c. Furthermore, the
required matrix elements, when i = 1, 2,3

(5.152a)
(5.152b)

CF(Fo> = 271/78
(toe — Eol*t> = —38

[ED = 8/4
Ct? = CHAD = CHOP

are readily evaluated.

The matrix

elements

for the “barred”

(5.152c)
states are

identical and ¢¥|/|?)> = 0 for all i and j. Proceeding in the standard way,
the SCI equations can be shown to be

E,(SCI) = 6(27 1/2cB)

(5.153a)

2-128 — Be = E,(SCI)c

(5.153b)

Solving these for E,(SCI) we find

E,(SCI) = ((13)"/? — 1)8/2 = 1.3038

(5.154)

which is to be compared with the exact value of 28 for the resonance energy.
Thus SCI gives only 65% of the correct answer. Moreover, as will be seen in
Exercise

5.21, this theory

is not size consistent, and

it predicts

that

the

resonance energy of a cyclic polyene is proportional to N‘/? as the number

of carbons increase. This result is quite analogous to the case of N noninteracting H, molecules, where the correlation energy obtained using DCI
also has the same incorrect N-dependence.
Exercise 5.20 Verify Eq. (5.152c), derive Eq. (5.153a,b), and solve them

to obtain the result shown in Eq. (5.154).

Exercise 5.21 Extend the above analysis to calculate the SCI resonance
energy for a cyclic polyene with N = 2n(N > 6) carbon atoms. If we restrict
ourselves to only those configurations which interact with |'¥o>, then the
appropriate generalization of Eq. (5.151) is
|Psa> = [Po> +

aX

cl*> + x a7

As discussed in Exercise 5.19b, this is not the complete SCI wave function

because there exist additional singly excited configurations which, although

they do not mix with |¥,>, they do mix with |*>. The omission of these does

not affect our qualitative conclusions. Show that the required matrix elements
are

CP [se [*> = 27/78
<0

~~ Eo

>

= (—2f)6,,

PAIR AND COUPLED-PAIR THEORIES

317

Why are Eqs. (5.152b) and (5.152c) different? Using these matrix elements,
show that the SCI equations are

E,(SCI) = NcB2- 1/2

2-28 _ IB = E,(SCI)c
Finally, solve them to obtain

E,(SCI) = ((1 + N/2)'/? — DB
which is proportional to N'/? as N becomes large.
Finally, we consider the various coupled-“particle” theories. There is no
need to do a CCA calculation because we have already proved in general
that it gives the exact relaxation energy. To obtain the L-CCA and the CEPA
equations, we use the formal relationship of these methods to SCI which
was brought out by Table 5.5. Thus we can obtain the L-CCA equations by
formally setting E,(SCI) equal to zero in Eq. (5.153b). Hence

E,(L-CCA) = 6cf27 1?
2-128 Bo =0

(5.155a)
(5.155b)

Solving the second equation for c and substituting the result into the first,
we find

E,(L-CCA) = 38

(5.156)

which grossly overestimates the exact resonance energy.
The CEPA equations are formally obtained from the SCI equations by
replacing E,(SCI) in Eq. (5.153b) by the particle energy e. Thus we have
E,(CEPA) = 6¢

(5.157a)

e = cf2-'?

(5.157b)

27128 — Bc = ec
Eliminating c from
equation for e

Eqs.

(5.157b, c), we

(5.157c)
obtain

the following

2e? ~ 2eB — p? =0

quadratic

(5.158)

Solving this for e and substituting it into Eq. (5.157a), we have

Ep(CEPA) = 3(31/? — 1)8 = 2.1968

(5.159)

Thus CEPA gives a respectable approximation to the resonance energy of
benzene.
The results obtained by the various many-electron approaches are

summarized

in Table

5.6. It can be seen that, aside from

CCA,

which

is

318

MODERN QUANTUM CHEMISTRY

Table 5.6 Resonance energy of benzene
Exact

2B

Percent of exact

SCI
IEPA
CCA
L-CCA
CEPA

1.3038
1.6858
2B
3B
2.1968

65
84
100
150
110

exact, CEPA

works the best. It should be emphasized that one should not

draw any conclusions about the validity or accuracy of these methods when
applied to a real many-particle problem from this table. For example,
for a six-electron system, DCI in a large basis set certainly gives more than
65% of the correlation energy. In some sense the calculation of the resonance
energy in this model is more demanding than the calculation of the correlation energy. We certainly do not mean that it is computationally more
difficult but merely that our zeroth-order description here is worse than is
the HF description for a real many-electron system. In benzene all the six
nearest-neighbor atoms interact equivalently (ie. the matrix elements
between adjacent carbons are all equal to §). In the localized description we
assume that the resonance integral is f between atoms | and 2, 3 and 4, and
5 and 6, but is zero between 2 and 3, 4 and 5, and 6 and 1. Thus our zeroth-

order picture is poor, and a general approach like CI does not work very
well then truncated at the lowest nontrivial level. Of course, the CCA takes

full advantage of the fact that the Hamiltonian contains only single particle
interactions and, hence, is exact no matter how poor the starting point.

NOTES
1

O. Sinanoglu, Many-electron theory of atoms, molecules, and their interactions, Adv.
Chem. Phys. 6: 315 (1964).
2. R. K. Nesbet, Electronic correlation in atoms and molecules, Adv. Chem. Phys. 9: 321
(1965).
3. C. F. Bender and E. R. Davidson, Unitary transformations and pair energies, Chem. Phys.
Lett. 3: 33 (1969).
4. R. K. Nesbet, T. L. Barr, and E. R. Davidson, Correlation energy of the neon atom, Chem.
Phys. Lett. 4: 203 (1969).
5. S. R. Langhoff and E. R. Davidson, Configuration mteraction calculations on the mtrogen
molecule, Int. J. Quantum Chem. 8: 61 (1974).
6. J. Citek and J. Paldus, Coupled-cluster approach, Physica Scripta 21: 251 (1980). A nonmathematical review with a historical perspective.
7. R. J. Bartlett, I. Shavitt, and G. D. Purvis, The quartic force field of H,O determined by
many-body methods that include quadruple excitation effects, J. Chem. Phys. 71: 281
(1979), and references therein.

PAIR AND COUPLED-PAIR THEORIES 319
8. W. Meyer, PNO-CI Studies of electron correlation effects. I. Configuration expansion by
means of nonorthogonal orbitals, and application of the ground state and ionized states
of methane, J. Chem. Phys. 58: 1017 (1973).
9. W. Meyer, Configuration expansion by means of pseudonatural orbitals, in Methods of
Electronic Structure Theory, H. F. Schaefer III (Ed.), Plenum, New York, 1977, p. 413.
10. See for example, L. Salem, Molecular Orbital Theory of Conjugated Systems, Benjamin,
New York, 1966, pp. 110-115.

FURTHER

READING

Ahlrichs, R. and Scharf, P., The coupled pair approximation, Adv. Chem. Phys. 67: 501
(1987). Emphasis is on the ideas behind CEPA-like methods and on their application.
(CEPA discussed in this book corresponds to CEPA-2 in this article).
Bartlett, R. J., Many-body perturbation theory and coupled cluster theory for electron correlation in molecules, Ann. Rev. Phys. Chem. 32: 359 (1981). An excellent review of both
theory and applications with two hundred literature references.
Bartlett, R. J., The coupled-cluster approach to molecular structure and spectra: A step
towards predictive quantum chemistry. J. Phys. Chem. 93: xxx (1989). Summarizes some
of the important advances made in the field since the publication of Bartlett’s 1981
review (see above).
Condon, E. U., On pair correlation in the theory of atomic structure, Rev. Mod. Phys. 40:
872 (1968); Nesbet, R. K., Electronic pair correlation in atoms and molecules, Int. J.
Quantum Chem. S4: 117 (1971). In the 1960’s there was a disagreement between Sinanoglu and Nesbet about the origins of the IEPA. These two articles present complementary views of the history of the subject and make fascinating reading.

Hurley, A. C., Electron Correlation in Small Molecules, Academic Press, New York, 1976. An
advanced monograph containing a detailed discussion of Cl, IEPA, and various forms of
coupled-pair theories with numerous literature references The CCA equations are given
in an expheit form.
Kutzelnigg, W., Pair correlation theories, in The Methods of Electronic Structure Theory,H F.
Schaefer IT (Ed.), Plenum, New York, 1977, p. 129. An excellent place to learn more

about the topics of this chapter.

Pople, J. A., Head-Gordon, M., and Raghavachari, K., Quadratic configuration interaction.

A general technique for determining electron correlation energies. J. Chem. Phys. 87:
5968 (1987). Quadratic CI, which is implemented in the Gaussian 88 system of programs,
is a method closely related to the coupled cluster approximation differing only in the
way single and triple excitations are handled. If only doubly excited configurations are
considered, it is identical to the CCA discussed in this chapter (recall that we use CCA
to denote CCD (coupled cluster doubles) since we do not explicitly consider extensions

involving singles (CCSD) and triples (CCSDT)).

Sinanoflu, O. and Brueckner, K. A., Three Approaches to Electron Correlation in Atoms, Yale,
New Haver, 1970. A good discussion of Sinanoglu’s approach to pair theory. Contains
reprints of many of the original papers.

CHAPTER

SIX

MANY-BODY

PERTURBATION

THEORY

Configuration interaction (CY) is a systematic procedure for going beyond
the Hartree-Fock approximation. It has the important advantage that it is
variational (i.e., at each level it gives an upper bound to the exact energy),
but it has the disadvantage that it is only size consistent when all possible
excitations are incorporated into the trial function (ie., full CI). A different
systematic procedure for finding the correlation energy, which is not variational but is size consistent at each level, is perturbation theory (PT). In this
approach, the total Hamiltonian of the system is divided or partitioned into
two pieces: a zeroth-order part, 4%), which has known eigenfunctions and
eigenvalues, and a perturbation, ~. The exact energy is then expressed as
an infinite sum of contributions of increasing complexity. The expressions
for these contributions contain the eigenvalues of 34 and matrix elements
of the perturbation between the eigenfunctions of #). Terms that involve
products of n such matrix elements are grouped together and constitute the
nth-order perturbation energy. If we have chosen #, wisely, then ¥ is small
and the perturbation expansion (Le., the sum of the 1st, 2nd, ..., nth-order
energies) converges quickly.
In this chapter, we consider a form of perturbation theory which is
associated with the names of Rayleigh and Schrédinger (RSPT). Since we
are interested in obtaining a perturbation expansion for the correlation
energy, we choose the Hartree-Fock Hamiltonian as our zeroth-order Hamiltonian. RSPT with this choice of # was applied to N-electron systems in
the early days of quantum mechanics by C. Moller and M. S. Plesset and
hence is sometimes called Moller-Plesset perturbation theory (MPPT).

320

MANY-BODY PERTURBATION THEORY

321

Alternatively, this approach is called many-body perturbation theory
(MBPT) because of its popularity with physicists interested in treating infinite systems. Clearly, to treat such large systems one needs a theory that is
size consistent. It was K. A. Brueckner, while worrying about infinite nuclear
matter, who first conjectured that MBPT was size consistent in each order.
When one casually looks at the standard expressions for higher MBPT
energies, as applied to large systems, one finds that they contain terms that
are proportional to the square of the number of particles. Brueckner was able

to show, for the first few orders, that these ill-behaved terms actually cancel

and thus each order of MBPT was size consistent. He could not prove,
however, that this was the case for all orders. In order to prove such a theorem, J. Goldstone, inspired by R. P. Feynman’s work in quantum electrodynamics, devised a pictorial or diagrammatic representation of the algebraic
expressions which occur in the RS perturbation expansion of the energy of
a many-particle system. He found that in each order the ill-behaved terms,
which were proportional to the square of the number of particles, were represented by pictures made up of disconnected pieces; i.e., these diagrams were
unlinked. He then proved that such unlinked terms always cancel in every
order. This is the famous linked-cluster theorem, which says that the perturbation expansion of the energy of a many-body system can be represented
solely by linked diagrams. It assures us that the Meller-Plesset perturbation
expansion is size consistent no matter in which order it is terminated.
The diagrammatic techniques introduced by Goldstone were first applied to atoms by H. P. Kelly, while he was still a graduate student. Instead
of calculating the sum of the perturbation energies up to, say, second-order
and ignoring all of the higher order energies, he was able to approximately
incorporate certain contributions made in all orders of perturbation theory
by summing the values of certain diagrams to infinite order. In other words,
he obtained an approximate expression for the correlation energy which
contained not only all the contributions made, say, up to second-order but
also certain parts of the higher order terms. Using this kind of approach,
he was the first to perform a calculation which was later shown to be essentially equivalent to the independent electron pair approximation (IEPA).
In this chapter, we give a simple introduction to diagrammatic perturbation theory. However, this chapter is so organized that it can be read

without leafning about diagrams. The sections that discuss diagrams are
starred and can be skipped without loss of continuity. Any result that can
be obtained diagrammatically can always be obtained algebraically. In
quantum chemistry, it is basically a matter of taste whether one finds that
diagrams are useful and give valuable insight (e.g., suggest certain approximations). We hope that our simplified treatment will stimulate some to learn
more about these techniques.

We begin this chapter by deriving the standard expressions for the first-,

second-, and third-order energies of RSPT,

which are applicable to any

322 MODERN QUANTUM CHEMISTRY

quantum mechanical system. In Section 6.2 we introduce a diagrammatic
representation of the various algebraic terms that occur in each order. We
begin by considering a simple system having only two eigenstates and then
generalize our results to handle a system with an arbitrary number of states.
We then consider the perturbation expansion of the energy of an N-electron
system using the Hartree-Fock description as our starting point. In Section
6.3 we treat the simple case where the perturbation contains only one-particle
interactions; Section 6.4 discusses the corresponding diagrammatic representation. In Section 6.5 we consider perturbations containing two-particle
interactions and develop the perturbation expansion for the correlation
energy. In Section 6.6 we consider the size-consistency problem and apply
RSPT to our standard model of N independent minimal basis H, molecules.
In Section 6.7 we discuss the diagrammatic representation of MBPT, and
finally, in Section 6.8 we present some illustrative calculations.

6.1 RAYLEIGH-SCHRODINGER
PERTURBATION THEORY

(RS)

In this section we will derive the standard expressions of RayleighSchrédinger (RS) perturbation theory. Our formulas will be general and
apply equally to one-particle or N-particle systems. Suppose we wish to
solve the eigenvalue problem

H\®;) = (Hy + VIIOD = EI)

(6.1)

where we know the eigenfunctions and eigenvalues of %,

HP)

= EOPO>

or

Holi> = EM i

(6.2)

where we have written |¥{ = |i> for compactness. If the perturbation, ”,
is small in some sense, we expect |®,> and &; to be reasonably close to li>

and E°°), respectively. We wish to devise a procedure by which we can sys-

tematically improve the eigenfunctions and eigenvalues of #%, so that they
become closer and closer to the eigenvalues and eigenfunctions of the total
Hamiltonian, 9. We can do this by introducing an ordering parameter A,
which will later be set equal to unity, and writing

H = Hy+hv

(6.3)

We now expand the exact eigenfunctions and eigenvalues in a Taylor series
in A,

€,= EO 4+ 1B) + VEO ++:

[D,> = [i> + AM) + 22H 4°

(6.4a)

(6.4b)

MANY-BODY PERTURBATION THEORY

323

We call E” the nth-order energy. The problem at hand is to express these
quantities in terms of the zeroth-order energies and matrix elements of the

perturbation / between the unperturbed wave functions, <i
| DLet us take the wave functions of #%, to be normalized (<i|i> = 1)

and then choose the normalization of |®,> such that <i]®,> = 1. This choice
is called intermediate normalization and can always be made unless |i) and
|®;> are orthogonal. Therefore, by multiplying Eq. (6.4b) by <il, we have

Ki[D,> = Ci]i> + ACE WEP

4 A7Ci| PPD +--+ = 1

(6.5)

The above equation holds for all values of A. Therefore, the coefficients of
4” on both sides must be equal, and hence

<i]> =0

n=1,2,3,...

(6.6)

Substituting Eqs. (6.4a, b) into Eq. (6.1),

(Ho + AVM i> + AL WMP + 2|PP) +--+)
= (EO 4 AEM 4 V7E? +--+

ALB

+ --)

and equating coefficients of 4”, we find

Ho|i> = Eid

H|EO) + Vid = LOW)
HlPP>

+ VPM)

= BOW)

+ EMD
4 EMPM)

HW) + Wy = LOO) + EPP

+ E?|YP> + EP i>

+ ET

n=0

(67a)

n=1

(6.7b)

n=2

(6.7c)

n=3

(67d)

and so on. Multiplying each of these equations by <i| and using the orthogonality relation (6.6), we obtain the following expressions for the nth-order
energies

EO = il %#|i>

(6.8a)

E\) = gif |

(6.8b)

E? = il VW

(6.8c)

E? = iV |W?)

(6.8d)

All that remains is to solve the set of equations (6.7) for |W! and then
determine the nth-order energy using (6.8).
First consider Eq. (6.7b), which determines the first-order wave func-

tion |". This can be rewritten as

(ED? — Ho)

=(% — EMD =(% — IY IDID

(6.9)

324 MODERN QUANTUM CHEMISTRY

This is no jonger an eigenvalue equation but an inhomogeneoys differential (or in general integro-differential) equation. One way of solving

such equations is to expand |‘¥{"> in terms of the eigenfunctions of #%o,

which are taken to be complete,

SHY =P cP |n>
Since the eigenfunctions of #%

by <nl, we find

are orthonormal, multiplying this equation

Cn PIP» = ah

Moreover, from Eq. (6.6) it is clear that ci!) = 0, so we can write

[> = 5 p><nHil

where the prime on the summation

(610

serves as a reminder that the term

n =i is excluded. Multiplying Eq. (6.9) by <n| and using the fact that the
zeroth-order wave functions are orthogonal, we have

(E? — ED)Kn| PY

= <nl¥i>

(6.11)

Using the expansion (6.10) in expression (6.8c) for the second-order energy,
we obtain

EP) = IPH) = YY i|rH
<n[ PY

and hence, using (6.11), we finally have

1a TED. y lel ort
=

EO

_

EO}

EO

—

EO}

(6.12)

which is the desired expression for the second-order energy.
To obtain the third-order energy, E‘*!, we proceed similarly. We first
expand the second-order wave function as

> = "In

cn] WEY

(6.13)

Then we multiply Eq. (6.7c) by <n| to obtain

(EO — ED)CnPEPY = Cul HYD — EP Cn] PYY
Next we combine Eqs. (6.8d), (6.13), and (6.14) as follows:

EP) = Gil |¥>

= » Ci[¥ [nd <n|{ PP?)

=>

eel

EMDy dor

(6.14)

MANY-BODY PERTURBATION THEORY

325

and finally, using (6.10) and (6.11) we have

La

B=

| <al¥(m> dm

= 424 Bo

ae

Bay

(dD

»

Kilo?

AOL Geo Bo

(6.15)

which is the desired third-order energy.
We now present a simple application of the above formalism. Let us
consider a simple quantum mechanical system containing only two states

|ID and |IID, which are eigenfunctions of the Hamiltonian #7
HL) = &,|D
Suppose we write

and

= #|I1>) =4,|IID

KH = Hy + Vv

where we know the eigenfunctions and eigenvalues of %,

H1>= EPL)

and =

H#|2) = EP/2)

and we wish to determine the exact ground state energy &,. We assume that
the zeroth-order states are nondegenerate and that E{?) is the lower eigen-

value (i.e., E{0! < E®). We shall first solve the problem exactly and then

compare our results with those obtained using perturbation theory. We solve

HD)

= E|®)

(6.16)

by expanding

|®> = c,|1> + c2|2)

(6.17)

and thus obtaining
vy
EO) 0) + (11>

<2|¥|1>

EX)

om

2>

cr] _ gf %

+ <2|¥|2) || co

Co

(6.18)

To simplify the notation we set (1|/|1> = Wy, <1] |2> = Via, X27 |1> =
Voi, <2|V |2> = V2. The lower eigenvalue of the above matrix is easily

found to be

*

6, =F{EP) + Vy + ED) + V2 — (ED) — ED) + Wu — Ve)? + 4, 2Va1)"7}
(6.19a)
We wish to expand &@, in a Taylor series in the matrix elements of the
perturbation. To do this, it is convenient to multiply each matrix element
by 4,

6, = F{EQ) +4,

+ ED) + AV,

— [(EP! — EP) + AVa1 — Var)? + 407K 2Vai)"7}— (6.19b)

and then expand &, in a Taylor series in A.

326

MODERN QUANTUM CHEMISTRY

We will need two identities, valid when |x} < 1,

(+x? =144x— gx? to

(6.20)

(l—xyt=1Ltx4¢x74x34°---

(6.21)

We begin by rewriting &, as

8,5 YEP HAM + EP + Man + ED — BP + AK ~ Ma)
1

4,2V,

1

V,

1/2

12°21

* | + EO EP +A, — on |
Note that when

}

we factored out (E{ — EY) + A(V,, — V22)) from

the

square root, this quantity was taken to be negative. This follows from the

assumptions that E) < E and that the perturbation is small.
By first expanding the square root and then expanding (E(° — ES? +
AV, 1, — V22))~* as
1

1

EP — EP FAM — Vaz) BP EP |
1

1

Vir — Vas)

TEP ED

AMVs 1 — Vor)

= EO — B® ~ (EP — EO)? +
it can be shown that

&, = Ef) + EW + PEP + BEY + HEY +---

(6.22)

where

(6.23a)

EP=Vy
Vio.

E®)

Om ze

(6.23b)

3) Mi2Ve2Ve,

(EP EPP

Eo

_

VV

VA,

(EP-EPY

Vi2VoVas

(6.23c)

(EO— EP)?

_2Y,

V2.1

V, 1 +

Vij2ViQVar

_

(Vi 2Vo1)?

(EP-EPP " (EP-ED) (EP EPP

(6.23d)

Finally, it can be seen that the general formulas of RS perturbation
theory for the first-, second-, and third-order energies (Eqs. (6.8b), (6.12),
and (6.15)) reproduce the above results for E™, n = 1,2,3. This follows immediately once it is recognized that there is only one intermediate state (i.e.,
{n> = [2)) in the two-state problem. Such a correspondence is to be expected

MANY-BODY PERTURBATION THEORY

327

since the general formulas were derived using a formal Taylor’s series expansion in the parameter 4.

*6.2 DIAGRAMMATIC REPRESENTATION
PERTURBATION THEORY

OF RS

At the end of the last section, we saw that even in the simple case of a twostate system the formulas for higher order energies become quite complicated.
Our primary interest in this chapter is to obtain the perturbation expansion
of the correlation energy with the Hartree-Fock taken as the zeroth-order
description. For this case, the formulas for the higher order energies are
much more complicated. Therefore, it would be convenient if we could find
a relatively simple way of representing and classifying the various terms that
appear in higher orders of perturbation theory. In this section, we introduce
a diagrammatic representation of the RS perturbation expansion. We will
not attempt to derive diagrammatic perturbation theory; rather the approach
we have adopted starts by considering a simple example of perturbation
theory and conjecturing a one-to-one correspondence between the mathematical expressions and a set of pictures drawn in a well-defined way. We then
“guess” the rules for translating these pictures into formulas and show that
everything works. We then proceed to generalize the diagrams and rules
obtained. At each stage, we check consistency by comparing diagrammatic
results with those obtained independently by algebraic methods. In this way
we hope to make the reader feel comfortable with diagrams.
The diagrammatic representation of a perturbation expansion was first
used in quantum electrodynamics. It was invented by Feynman who, in his

Nobel lecture,! discussed the evolution of his ideas. We quote, “The rest of

my work was simply to improve the techniques then available for calculations, making diagrams to help analyze perturbation theory quicker. Most
of this was first worked out by guessing. ..” and again, “Often, even in the
physicist’s sense, I did not have a demonstration of how to get all these
rules and equations from conventional electrodynamics. But, 1 did know,
from fooling around, that everything was, in fact, equivalent to regular
electrodynamics.”

6.2.1 Diagrammatic Perturbation Theory for Two States
We now introduce a pictorial representation of the various terms that occur
in the perturbation expansion of the lowest eigenvalue of the two-state
problem, which we considered in the previous section. Let us represent the
perturbation ¥ by a dot,
V

wa

+e

328 MODERN QUANTUM CHEMISTRY

The two zeroth-order states |1> and |2> are represented by lines with arrows
pointing down and up, respectively.

[> ———~

}

|2> —— |
A line with an arrow pointing down is called a hole line, and a line with an
arrow pointing up is called a particle line. These terms have no significance
at this stage; however, they are introduced now so that one does not have

to relearn names later on. These definitions suggest simple pictorial representations of the matrix elements of ¥:
Cy }l> = Vr

<i)

|2> =Vi2*——

Nz

af!
(2|¥|2> = Vr2

{:

2

In summary, each dot has a line going into it and a line coming out of it.
The corresponding matrix element is (label of line in || label of line out).
Recall that the mathematical expressions for each term in the nth-order
energy, n = 1,2,3,4 contain a product of n matrix elements of ¥ in the
numerator. Since each matrix element is represented by a dot with a line
going into it and a line coming out of it, it might be possible to represent the
algebraic expressions by pictures or diagrams containing n dots connected
in some way. We now give a well-defined prescription for drawing such
diagrams containing n dots:
1. Draw n dots vertically ordered as follows:
e
e
e

1
2
3

MANY-BODY PERTURBATION THEORY

329

2. Connect all n dots together with a continuous line, so that each dot has

one line passing through it.
3. Do this in all possible distinct ways. Two diagrams are equivalent if
each and every dot is connected to an identical pair of dots in both
diagrams.

sa n

The second rule forces us to draw only diagrams that are completely
connected or linked; i.e., they are all in one piece. Unlinked diagrams (n = 4)

, 0

are not allowed. The third rule tells us that the diagrams

»

!

!

!

2

2

2

3

3

3

4

4

4

are really the same because they are connected in the same way: { is linked

to 3 and 4, 2 is linked to 3 and 4, 3 is linked with 1 and 2, and 4 is linked with

{ and 2. To quickly establish the equivalence of diagrams, it is useful to
think of the connecting lines as rubber bands glued to the dots, which can
be distorted in any way we please. Two diagrams are then distinct if there
is no way to distort the connecting lines, so as to make the pictures look
identical. Thus

(

,

(

.

330 MODERN QUANTUM CHEMISTRY

Using these rules, we can draw the following diagrams up to fourth order

(06-

You should convince yourself, by trial and error, that the above are the

only distinct diagrams that one can draw. Now let us draw arrows on each
of the connecting lines in all possible ways so that each dot has a line going
into it and a line coming out of it. Finally, we label lines going down with
1 and up with 2. For example, if n = 3, there are two possible labelings,

I<
_-(

MANY-BODY PERTURBATION THEORY

331

For n = 1, an ambiguity arises since the line is circular and an arrow on it
would point up in one part of the diagram and down in another,

O

We resolve this by defining circular lines to be hole lines. It is easy to show
that the diagrams we can generate in this way are
|

2

t

|

2
2.4

'

l

2

2

2

'

2
1

‘

‘

2

2

'

'

2

2

1
'

2

2

2

5

n=4

t

We now postulate that there is a one-to-one correspondence between the
above pictures with n dots and the terms which contribute to the nth-order
energy, and we give the rules allowing one to translate a diagram into an
algebraic expression. It is rather remarkable that there exists such a simple
correspondence. The translation rules are:

1. Each dot contributes a factor label of line in |¥ | label of line out) to

the numerator.
2. Each pair of adjacent dots contributes the denominator factor
Y

0:

Ee

~

Y

EO ucte

332 MODERN QUANTUM CHEMISTRY

where the sums run over the labels of all hole and particle lines crossin
an imaginary horizontal line separating the two adjacent dots.

3. The overall sign of the expression is (—)**', where h is the number of hol

lines and lis the number of closed loops in the diagram. For the diagrams

discussed in this section 1 is always one. We give this rule in its more general
form for future reference.
These rules are very easy to apply. Consider the fourth-order diagram:

The upper two dots each contribute a factor (2||1) = Wy, and the remaining dots each contribute a factor (1|” |2> =V,2

to the numerator.

Imaginary lines A and C contribute a factor E\?) — E® each to the denominator while imaginary line B contributes the factor (2E°) — 2E'9’). Since we

have two hole lines (h = 2) and one closed loop (l= 1) we multiply the

expression by (— 1)? = --1. So we have

4 \ a

=(-) (EP — EPFQE® —2EP)
(Vi 2V21)?

2

=

—(Vj2V21)?

2B — BP

Notice now that our translation rules give the same algebraic expression
for the following pairs of diagrams

MANY-BODY PERTURBATION THEORY

333

1

2
'

2

2
'

2
1

2

2

This observation allows us to remove the restriction that all the dots in a
given diagram must be on top of one another. The rules are such that we can
distort a given diagram in any way as long as we do not change the vertical
ordering of dots.
In Table 6.1 we have evaluated all second-, third-, and fourth-order
diagrams using our rules. By convention, the first-order bubble diagram is
¥

om

We can see by inspection of Table 6.1 that in each order the sum of the values

of all possible diagrams, constructed and evaluated according to the rules,

gives precisely the results we obtained for the two-state system in the last
section (c.f. Eq. (6.23)).
Exercise 6.1 Write down and evaluate all fifth-order diagrams that have
the property that an imaginary horizontal line crosses only one hole and
one particle line. Show that the sum of such diagrams is
Vi2 V, 1(V22

— Vi i”

(EP — EP

Hint: There are eight such diagrams, and they can be generated by adding
three dots to the second-order diagram in all possible ways.

Table 6.1 Translation of diagrams into formulas

2

Vast

cepts HEROD
Eo

(— yea HPP

_ E®

~~ E®

_ Eo

22D __VaaVarMin
(EP — EY
(EP - ED?

(-ptt YY 2><¥1I><A|Y¥ |b __ “YoY
(EP — EP?
(EP— EDP

(-)4? GY 2>MID
AY ID ay > _

(EO — EP)?

(

(

_pp PDD

(EP — EP)

(Eo

—_

Eg)

rr <1 |2>¢2[72) 2 12>€2]¥ JI)
(ED — E93

(EP — EP

_—

2

(-P*3

«ay [2> AYP

ayy 2><2Ir >

(EP — EPYQEP — 289)

Maven
(EO)

_

EY?)

Vi2V32V

~ (EOF BOS

Waa?
YEO — ED'S

RDA
A
D
pie A
(EO — EPP QE
— 2E

'

:

~ {E®! — BO)

>I WDAI ND __VaaVaa Varn

AK DAWA
aye GD

(-}

ahaa

=

(Vy2Vail?

EP ~ EP}?

MANY-BODY PERTURBATION THEORY

335

6.2.2 Diagrammatic Perturbation Theory for N States
We now generalize our previous development to obtain a diagrammatic
representation of RS perturbation theory as applied to an N-state system.
Consider the problem of finding the perturbation expansion for the lowest

eigenvalue of such a system. Here we still have only one hole state, |1>, but
there are now N — | particle states \n>, n=2,3,...,N. We draw the same

set of diagrams as before. However, now we can label the particle lines with
any index n. For example, the diagram

can now be labeled as

Or OO OO:

and so on, or in general
>

where the labels m and n can take on values between 2 and N independently.
The subset of diagrams

are called diagonal. To obtain mathematical expressions corresponding to
these generalized diagrams, we supplement our previous rules with:
4, Sum the expression over all particle indices.
As an example, we evaluate the second- and third-order energies:

'

a>

nL

VinVin

’

ED — EO — x EO — EO

(6.24a)

336 MODERN QUANTUM CHEMISTRY

m

TP

2 ee = aE? — Em) ~~ GP — BPP
Vi

Venn Mer

ViiVinMn

(6.24b)
These expressions are identical to our previous results for the second- and
third-order energies (Eqs. (6.12) and (6.15)) when i = 1. What if we want the
perturbation expansion for some state i, which is not necessarily the lowest?
What do the diagrams look like? One can easily verify that we get the same
answers as before if we label our hole lines by the index i and the particle

lines by the indices m, n, k,..., which can take on the values 1, 2,...,i— 1,

i+1,...,N. Thus we now have a complete diagrammatic representation
of RS perturbation theory, which is applicable to any perturbation and any
zeroth-order state.

G
G
0
0
00 .

Exercise 6.2 Use diagrammatic techniques to obtain the fourth-order
perturbation energy of a particular state (say, i) of an N-state system. That
is, evaluate the diagrams

where the indices m, n, k,... exclude i. Using the approach of Section 6.1,
obtain an algebraic expression for the fourth-order energy and compare it
to the diagrammatic result.

6.2.3 Summation of Diagrams
An important technique in diagrammatic perturbation theory is the summation of certain classes of diagrams to infinite order. To illustrate the technique
consider our two-state system. The only diagram that contributes in secondorder Is

MANY-BODY PERTURBATION THEORY

337

Now consider the sum ofall diagrams, which are generated from this diagram,
by adding dots in all possible ways,

(}}

O

| (}

|

~

'

‘}

(6.25)

Using Table 6.1 and the result of Exercise 6.1, where such fifth-order diagrams are evaluated, we find
A -|

Vi2Var

ED — EF

|

+|

Aaa

~

|

(EP — EP?

+ [a

7

EP — EP)?

|

+ Map age” | >
Vi2Vo1(Vo2

A=

Vi2Vo1
EO _ E®)

— Vi)

Vo2—- Vir
EO) — EO)
EO)

1+

+

V2 — V,,\7
EO — EO
EO)

(6.26)

easrs) 4° 7
+ (poe

Notice that the quantity in brackets is a geometric series. Using the formula

(d—xyt=14+x4+x74+x34°-°:
the series (6.26) can be summed to give
A=

V; 2V, 1

E®) — E?)

1

1_

V, 2V, 1

V,2-—Via

EY?

_

(ED + V3) — (EY + V22)

E®)

(6.27)

Thus summing this class of diagrams to infinite order yields an expression
which looks like the second-order perturbation result but with a shifted
energy denominator. This can be restated as follows: summing a geometric
series of diagrams to infinite order gives results which can be obtained using
perturbation theory to a finite order, when a different partitioning of the
Hamiltonian into perturbed and unperturbed parts is used. Specifically, in
our two-state problem, we originally partitioned our Hamiltonian as

=(0 ee)

H,={
V=

Eo

0

(7: 1

Vi *)

Vo1

Vr2

2

338 MODERN QUANTUM CHEMISTRY

If we repartition our Hamiltonian as
H. =

E+

v=

0

a

VY,

Vy

0

0

EY + Voz

Vi2

0

then the geometric sum of diagrams with the original partitioning is simply
the second-order perturbation energy with this partitioning.
Let us generalize these results to the N-state system. The diagrams
generated by adding dots to the second-order diagram are

A=

1

fn

+

(

+

(

tees

(6.28)

Note that the class of diagrams generated in this way are all diagonal. These
diagrams can be summed to give
A

=

Yay,
in’ nl

s

x (ED + Vis) — (ED) + Van)

(6.29)

where the prime on the summation serves as a reminder that the n = | term
is excluded. Notice again that the result obtained is simply the second-order
expression with shifted energy denominators. We will see later that the geometric series summation technique can be used to obtain perturbation corrections to the Hartree-Fock energy.

6.3 ORBITAL PERTURBATION THEORY:
ONE-PARTICLE PERTURBATIONS
The theory we have developed so far is applicable to any quantum mechanical system. In this section we consider the important special case where the
unperturbed Hamiltonian is a sum of one-particle Hamiltonians

Ho = ¥ hoi)

(6.30)

In particular, the Hartree-Fock Hamiltonian is of this form. We are interested
in improving such an independent-particle description of a many-electron
system by means of perturbation theory. For the sake of simplicity, we will
first consider the case where the perturbation is also a sum of one-particle
interactions,

v =

vii)
1

(6.31)

MANY-BODY PERTURBATION THEORY

339

and in the next section we generalize our results to perturbations containing
two-particle interactions. As an example of a physical situation where the
perturbation is a sum of one-particle terms, consider a molecule in the
presence of an electric field F. In this case the perturbation is F - » r(i),
where r(i) is the position vector of the ith electron.
Suppose we obtain a set of spin orbitals and orbital energies that are
the eigenfunctions and eigenvalues of ho,

fox? = ef)

(6.32)

The ground state wave function (|>) of an N-electron system with Hamiltonian #, is a determinant formed from the N spin orbitals with lowest
energies,

[Ho>= (xP? - =>

a>

(6.33)

We label the occupied (hole) spin orbitals by a, b, c,... and the unoccupied
(particle) spin orbitals by r, s, t, ... .The wave function (6.33) is an eigenfunction of 4 with an eigenvalue equal to the sum of occupied orbital
energies,
H o|¥ o> = (x ©)

Po>

In the presence of the perturbation ¥, |‘¥.> is an approximation to the
exact wave function, |®,>. Within this approximation, the ground state
energy of the N-electron system in the presence of the perturbation is
E,=

CP o|H|Vo> = CL |%o

= YO

+ ¥|¥o>

4 ¥ catojad = Y

In the special case that the perturbation

+ ¥ v,,

interactions, the total Hamiltonian of the system

H = Hy + V =

(6.34)

” is a sum of one-particle

(heli) + 0) = Y hl)

(6.35)

is also a sum of one-particle interactions. Therefore, we can find a set of
exact spin orbitals and corresponding orbital energies,
= (ho + vy: =

EX,

(6.36)

and construct the exact ground state wave function of the system from the
N exact spin orbitals with the lowest energies,

(6.37)
I®o> = |x1°* Xa" Xn>
This wave function is an eigenfunction of # with an eigenvalue equal to
the sum of occupied orbital energies,
H|\®o> =(x

) |P_> = E|\Po>

340 MODERN QUANTUM CHEMISTRY

so that the exact energy of the system in the presence of the perturbation is

65 => fa

(6.38)

Suppose we wish to obtain a perturbation expansion
energy 6,

for the exact

& = Ef) + Ef) + EP +
Since the exact energy can be written as a sum of occupied orbital energies,
£,, we can simply find the perturbation expansion of each e, and then sum
the result over all occupied spin orbitals. Since the general theory of Section
6.1 is applicable to one-particle zeroth-order Hamiltonians (ie. ho) and
one-particle perturbations (ie., v), we can immediately write

ea = 0+ allay + 52 GO
EI
4.
= AO) + tag +

,
t

ays

(6.39)

Dad;

‘a

t

The sum over i can be divided into two parts, one involving the summation
over all particle orbitals, and the other over all hole orbitals except a,

&,= 08

(0)

Vay pg

Daph
abba

+0, + 2 wm
eG

+ > 0
wz
&

bta

ea

Gy +

(6.40)

wee

&

To obtain the perturbation expansion of the exact energy, we substitute
(6.40) into (6.38) and find

=)e,= 2 gf)
_

=

vv
ar’ra

4

(0)

Vea + Yaya
OO

a

ar

Von? v ba

+

wo

+ wae

(6.41)

a

aeb

The term
X=

2

Lawa
gO) — 0)

eb

is equal to zero. To show this, we interchange the dummy indices a and b
to obtain
X=

Poa ar
20) — gO) =

»
aeb

»

ai

Vay ba
gv — gf)
a

x

atb

and hence X = 0. Thus to second-order, we have
Bo =

Lee

+ Yi

an + Day

Yar? ra

oy +

(6.42

MANY-BODY PERTURBATION THEORY

341

So that

ES) =>

(6.43a)

EW =Y vs

(6.43b)

EQ =

ar)
—

(6.43c)

Vora

Note that the energy of |‘¥,> (see Eq. (6.34)) is equal to the sum of the zeroth-

and first-order energies (ie., Ey = ES + ES).

The summations in Eq. (6.43) are over occupied (hole) and unoccupied

(particle) spin orbitals. Since a matrix element v,; = <i|v|j> is nonzero only

if both spin orbitals i and j have the same spin, for a closed-shell system we
can write these expressions as summations over spatial orbitals simply by
multiplying by a factor of 2,
N/2

ee

(6.44a)

N/2

EM =2Y v,,
E2)

=

2

N/2

Y

(6.44b)
Vgrlrg

or ef

0

y—

e

(6.44c)

9))

where the upper limit of summation (i.e., N/2) is our shorthand notation
indicating that all the summations are over spatial rather than spin orbitals.
Exercise 6.3 Derive
U,V,
ar’ra

(2) _

ED

=) Ar)
or

“a

r

starting with the general expression for the second-order energy (Eq. (6.12))
applied to an N-electron system,

where the sum runs over all states of the system except the ground state.
Hint: The states |”n> must be single excitations of the type

Pod = |

eee

= a>

Exercise 6.4 Calculate the third-order energy ES) using the general

expression given in Eq. (6.15).

342

MODERN QUANTUM CHEMISTRY

a. Show that
BY)

2

EW

=

b. Show that

(EP EPP
Pol ¥ in|?

EP — OF
Vgal rpUor

y

—

tartan FalY¥5

A? =)" CFol¥ |n><nl¥jm> <m|v|¥o> _ 5
°

nm

(EY

~

EO\ EY?

_

E® »

- abrs

2

~

(ef

-

20)

c. Show that
CP5|Y

Os

ifa=b

r#s

= —Vp,

ifa¢#b

r=s

=V

ifa=b

r=s,

|W5> =

¢— Vga t 2,

and zero otherwise.
d. Finally, combine the two terms to obtain
E®?)

=

AG)

+

BY)

=

Y

DgyV
ysl,
ar’rs“sa

ars (a— & YES? — 85°)

VrqVayY;
ra“ab\br

_

aby (EE? — BYES? — F))

e. Show that for a closed-shell system
E>

=

N/2

Og,
VU.
ar’ rs“sa

N/2

DO, ra’ab“br
gvapl

2 » 4 (gO= ON (gO — -O) —2)Le (20)= LOH(EO — -O)”

In Subsection 5.3.2, we have used a variety of many-electron approaches
to calculate the resonance energy of a cyclic polyene with N carbon atoms
(N = 2n = 4v + 2,v =1, 2,...) in the framework of Hiickel theory. As an
illustration of the above formalism we now approach this problem using
orbital perturbation theory. Recall that the resonance energy is defined as
the difference between the exact total energy (as obtained by diagonalizing
the Hiickel matrix and adding up the occupied orbital energies) and the
energy of N/2 =n localized ethylenic units. The occupied (hole) and un-

occupied (particle) orbitals of the ith unit are denoted by [i> and |i*),
respectively (see Eq. (5.137)). The total Hamiltonian is partitioned as

H = Hy + V => hei) + ¥ oli)
so that the ethylenic orbitals are eigenfunctions

holi> = (w + B)li> = eid

holi*> = (a — Pli*> = e }i*)

(6.45)

of ho,

a1?

PS

(6.46a)

eek

(6.46b)

MANY-BODY PERTURBATION THEORY

For future reference note that ef — e

343

= 28 independent of i and j. The

nonzero matrix elements of the perturbation are

(6.47)
(6.47b)

<ilolG + 1I)*> = 48/2
<ilo|i + 1) = B/2

’

<i*o|@ + 1)*) = —/2

(6.470)

Since the polyene is cyclic, the zeroth ethylenic unit is the same as the nth
while the (n + 1)th is just the first. In this model, the exact resonance energy
of benzene is 28, while asymptotically, the exact resonance energy is
lim E, = (4/n — 1)NB = 0.2732NB

(6.48)

No

The matrix elements of the perturbation v, given in Eq. (6.47), and the
zeroth-order orbital energies in Eq. (6.46) are all we need to calculate the
perturbation energies, We begin with the second-order energy. Since we are
dealing with a closed-shell system, the required expression is given by
Eg. (6.44¢),

M2

vara

EY = 2 2

gO —

go) =2

N2 ¢alolry <rlvja>
»

ier _ au

(6.49)

Since the index a runs over all n occupied ethylenic orbitals |i) while the
index r runs over all n unoccupied orbitals |j*>, we have

*

S

Cilol*><i*l>

1 2

Bp =2 5 5 SAO
i=1 j=

Ej

2S FS Gel ctl (650

— Ee

=1j=1

where we have used the fact that the difference between orbital energies is

always 28. For fixed i, the summation over j is easily evaluated, since the
matrix elements are nonzero only when j = i + 1 (see Eq. (6.47a)). Thus

E? =50< fol + D*><E+ D*foli> + <ifo|(i — 1)*><G — 1)* fo]
_li

"P

NB

Dy [(6/2)* + (—B/2" => = 7 = 0.25 NB

(6.51)

For benzene the second-order resonance energy is 1.58 as compared to the
exact value of 26 (ie., 75%). For larger systems the agreement is even better;
by comparing Eqs, (6.48) and (6.51), it can be seen that, for large N, the
second-order energy approaches 91.5% of the exact result.
We now consider the above derivation from a slightly different point of
view, which is extremely helpful in organizing the calculations of the higher
order energies. To evaluate the summation over j, for fixed i, in Eq. (6.50)

344 MODERN QUANTUM CHEMISTRY

we note that orbital i can only interact with the orbitals (i + 1)*. This can
be represented pictorially as

G +i

YN

iajtoiic

i \

JA

o>

> <iloli*><i*|o[i>
J

G-n*
where the plus and minus signs indicate whether the matrix element between
the two orbitals is + 8/2. The sum over j can be evaluated as follows. Start
at i on the left and go to i on the right by all possible paths. Assign to each
path, a number corresponding to the product of the matrix elements en-

countered, and then add all these contributions. To illustrate, the value of

the path i> (i + 1)* > iis (+ B/2)(+ B/2) = 7/4, while the value of the path

i (i—1)* 3i is (—£/2)(— B/2) = B2/4, so that the summation over j is

just 67/2 for each value of i in agreement with our previous results.
We now consider the calculation of the third-order energy. The appropriate expression for a closed-shell system is given in Exercise 6.4(e),
EY

N/2

Var?
ysl,
ar’rs“sa

=2>

are (EL? — LED) — EO)

N/2

-2>

DrqlanY,
raVab“br

ae (EP? — ENCES?” — ef)

(6

2)

Proceeding in the same way as we did for E%, the first term of this expression
is
iv] * >< P*lo|k*)
aye 2, D, &, <ili*><itllee>
2

n

n

n

certeli>

Ck* Io]i

6.53
(6.53)

To evaluate the summations over j and k, we use the pictorial representation
discussed above,

Note that, since i cannot interact with i* or (i + 2)* or (i — 2)* the value of
this sum must be zero. A similar argument holds for the second term in

Eq. (6.52), so we conclude that the third-order resonance energy is zero.

MANY-BODY PERTURBATION THEORY

345

Actually, we have been somewhat hasty. The above result is true in all
cases except benzene. Because of the cyclic nature of the problem, in this
case the orbitals (i + 2)* are the same as (i+ 1)*. Thus the pictorial representation of the sum over j and k with i, say, equal to 1 is

x
So there are two paths: 1) 1 + 2* — 3* > 1 with value (8/2)(— 8/2)(— B/2) =

63/8 and 2) 1+ 3* > 2* +1

with value (—£/2)(—8/2)(B/2) = 87/8. Using

these results in (6.53), we have for the first term in E>)

)]= +
(B7/8
+
[(B°/8)
y
ap 2
In an entirely analogous way one can show that the second term in Eq.
(6.52) is also equal to 38/8, so that the total third-order energy for benzene is

E$(benzene) =

3

(6.54)

Thus the resonance energy of benzene calculated up to third-order is 2.258
(Le., 113% of the exact value). In Exercise 6.7, the fourth-order enerpy
(4)

Eo =

NB

FF

(6.55)

is obtained using diagrammatic techniques. Thus the resonance energy of
benzene calculated up to fourth order is 2.34 (i.e., 117% of the exact value).
Note that the perturbation expansion does not appear to be converging. In
fact, it does converge but the convergence is slow and oscillatory. Exercise
6.6 explores this point further. It is interesting to note that the perturbation
expansion works better for larger systems. The energy up to fourth order is

0.2656N8 (ie., (4 + @)NB)) as compared with the asymptotic exact value of
0.2732NB (.e., 97% of the exact value).

Exercise 6.5 Show that the second term in Eq. (6.52) is equal to 3f for
benzene.

346 MODERN QUANTUM CHEMISTRY

Exercise 6.6 Consider a cyclic polyene with N = 4v + 2, v=1, 2,...
carbons. Instead of assuming that all the bonds are identical, suppose they
alternate in length. In the context of Hiickel theory this means that the
resonance integrals between adjacent carbons are not all equal to 6 but
alternate between f, and £5. For example, for benzene we have

No

Now it can be shown that the exact energy for a cyclic polyene of this type is
y

o=Na-2

di

2

Bi

4

+

B2

Qin

+

2B,B2

cos

5

1/2

1

(see for example, L. Salem, Molecular Orbital Theory of Conjugated Systems,
Benjamin, New York, 1966, pp. 498-500). Note that when f, = B, = f,
since 2cos? 6 = (1 + cos 26) and f is negative, we recover

6 0 ==Na+4
Nat

Bed

v

Sa

jt

4

which is the result quoted in Subsection 5.3.2. Also note that when f, = B
but B, = 0, we have

E, = Na+
NB
which is just the total energy of the polyene using the localized ethylenic
description. The purpose of this exercise is to obtain the perturbation
expansion for the resonance energy by expanding the exact energy in powers
of B2/B,.

a. Show that for benzene (v = 1) the exact ground state energy in the alternating short and long bond model is

6 = 6a + 2(B, + Bo) — 485 + 63 — By B2)"?
Do this first by using the general expression and then by setting up the
Hiickel matrix, diagonalizing it and adding up the occupied orbital
energies. Note that when £, = 6, = f we recover our old result, 6a + 8f.
b. Setting 6, = B and B,/B, = x show that the resonance energy of benzene
can be written as

Ep = 4B(3x — 14+ (1 4 x? — 3/7)
Note that when x = 0, Ep = 0 and when x = 1, Ep = 2B which is exact.

.

MANY-BODY PERTURBATION THEORY 347

c. Using the relation

(i+ yi?
expand Ep, to fourth

=1+4y—

ay? t vey? — ray t--*

yl <i

rder in x and thus show that

Ep = BBX? + 28 + 3yx7 + °°)
Identifying the coefficient of x" with the nth-order perturbation result (i.e,

E), we have

EP = 3p
EP = 38
ED = #8

Note that EY and E'?) agree with our previously calculated values. This

derivation provides some insight into the poor convergence of the perturbation expansion of the resonance energy of benzene. Basically, the perturbation expansion converges rapidly when x is small. However, for our
problem x is equal to unity.
The resonance energy calculated up to Mth-order as a function of M
is shown below. Note the oscillatory convergence towards the exact value
of 28. The method used above to obtain ES? for n = 2, 3, 4 becomes extremely

laborious for larger n. The results below were calculated by first showing

that E%? = 46C, */*(4), where C; 1/?(x) is a Gegenbauer polynomial of degree

nand order —4, and then using the recursive properties of these polynomials,
to show that

(n+ DEG*Y = (n — HEP — (n — DEG"?
24

2.3

M
(n)
= &B o /B
n=2

2.2
2.1
1.9
1.8
LT
1.8
15

348 MODERN QUANTUM CHEMISTRY

*6.4 DIAGRAMMATIC REPRESENTATION
PERTURBATION THEORY

OF ORBITAL

In Section 6.2, we introduced a completely general diagrammatic representation of RS perturbation theory. To adapt this to handle orbital perturbations we take the downward and upward lines to represent hole and
particle spin orbitals, respectively, and the dots to correspond to the oneparticle perturbation v. Then we draw the same set of diagrams as before,
labeling the hole lines by indices a, b,...and the particle lines by indices
r, S,.-.. Thus we have

O

-

(;

n=2

a

r

:

a

a

b

r

n=3

.

OO

.

v

v

b

n=4

We evaluate these diagrams using the same rules as before (with E(® -» 2),
except that we generalize rule 4 to read:
4’. Sum the expression over all particle and hole indices.
Using these rules, we have

a

EW =(}

ED = ,

=Y¥

=>

vag

(6.56a)

STOi

(6.56b)

Dard e.

ar

&q

MANY-BODY

PERTURBATION

THEORY

349

Note that these are the same as the results in Eqs. (6.43b, c). For E® we find

EQ?) =

a+

s

r

b

AHO

PH} LP PHP — gH 6°00

UgsVg-P rq

VyaVapM
or

which is identical to the result obtained in Exercise 6.4. Finally, for a closed-

shell system, since the matrix element v,, is nonzero only if the spin orbitals
i and j have the same spin, we can convert the sums over spin orbitals to
sums over spatial orbitals by multiplying the value of each diagram by a
factor of 2, Le,

N/2

N

y=2>

(6.57)

We will see in Section 6.7 that, in general, we must multiply the value of the
diagram by 2', where | is the number of closed loops, to make this conversion.
Exercise 6.7
polyene.

Find

the

fourth-order

energy

for

a closed-shell

cyclic

a. Show that

so that

4)
_
NB
Ep

44

Thus the resonance energy calculated for a cyclic polyene with N > 6
up to fourth order is (1/4 + 1/64)Nf = 0.2656Nf, which compares very
favorably with the asymptotically exact value of 0.2732NB (i.e., 97%).

350 MODERN QUANTUM CHEMISTRY

b. For benzene, show that the diagrammatic result for the fourth-order
energy agrees with the independently calculated result found in Exercise
6.6.

6.5 PERTURBATION EXPANSION
CORRELATION ENERGY

OF THE

In this section, we consider the problem of improving the Hartree-Fock”
energy of an N-electron system by means of perturbation theory. In other
words, we wish to obtain a perturbation expansion for the correlation energy.
We partition the Hamiltonian as
H=KHtv
where #%

(6.58)

is the Hartree-Fock Hamiltonian,

(6.59)

H => fl) =¥ [h(i + HO]
i

i

and

V=V

i<j

ry

-VF HY

i<j

' - YL
i

O

(6.60)

The use of the above partitioning of the Hamiltonian, along with the general
expressions of RS perturbation theory, is sometimes called M#ller-Plesset
perturbation theory.
In this section, we will use the physicists’ notation for two-electron
integrals rather than the chemists’ notation, which we used extensively in
Chapter 3. We do this not out of perversity or even laziness but because
almost all the literature in this area uses this notation, and we believe that
one should develop equal facility with both notations. Recall that in the
physicists’ notation
fax,

dx, FCN GICOEER CCSD ACS?) = <ij|kl>

(6.61)

It is important to remember that i and k label the spin orbitals which are
functions of the coordinates of electron-one while j and I refer to spin orbitals
which depend on the coordinates of electron-two, i.e.,
i
Gilly
St
Recall that the antisymmetrized two-electron integral is defined as

<ii| [KD = Gi|kID — <ii[IkD

(6 62)

MANY-BODY PERTURBATION THEORY

351

Using this notation, we have

(¥. py ry"

and
Thus

%) = ab] |rs>

(6.63)

~
o(1)F(%1) = x <blrz2 |b>x(x) — py Coir li>xe(X1)

(6.64)

<ijo**| jy = ofF = x <ib| jb) — <ib|bj> = x <ib| |jby

(6.65)

The Hartree-Fock wave function |‘¥,> is an eigenfunction of %#o,
Ho|¥ o> = ED |¥ o>

(6.66)

EP =) e,

(6.67)

with the eigenvalue

which is just the zeroth-order perturbation energy. The first-order energy is

Eo) = (Wl [o>
= <Fo

ay joo
i<j

- <Fol D v¥F (iP o>

1

a

No

=~ x <ab| |ab> — ¥ alu" |a>
1

5 x <ab| |ab>

(6.68)

The Hartree-Fock energy is the sum of the zeroth and first-order energies,

= BY) + BY = Ye, — 5 Y <ab] ab)
a

ab

(6.69)

Thus the first correction to the Hartree-Fock energy occurs in the second
order of perturbation theory.

The general result for the second-order energy, derived in Section 6.1, is
VY

E?) = x ee
ee
where the summation

2

(6.70)

runs over all but the ground state of the system.

Clearly, we take |0> = |‘¥)> but what about |n>? These states cannot be
single excitations since

CPV PED) = CH30 — aN)

= (P| |¥2> — for= 0

352 MODERN QUANTUM CHEMISTRY

The first term vanishes because of Brillouin’s theorem and the second
because the spin orbitals are eigenfunctions of the Fock operator. In addition,
triply excited states do not mix with |¥y> because of the two-particle nature
of the perturbation. Therefore, we are left with double excitations of the

form |'P%5>. Since

HES,

=

(EY?

—

(Ea + &, —

&

— é,)) |W

and because we can sum over all possible double excitations by summing
over all a and all b greater than a and over all r and all s greater than r, the
second-order energy is
°

EP =

x

|<Pol »

ry ||?

i<j

a<b

\<ab| {rs>|?

=>)

&&+&,—~
& — &

r<s

a<b &q + & —
r<s

& —

&

(6.71)

Note that the second-order energy can be expressed as a sum of contributions
from each pair of electrons in occupied orbitals,

BP = Y eff
a<b

where

FO _ Y

Co

=

|<ab| Irs>|?

r<s &q + &

—

€, — &s

We have seen in Chapter 5 that e*? is the first-order pair energy. Thus at the
level of first-order pairs, pair theory gives the same correlation energy as
second-order perturbation theory.
The expression for the second-order energy can be transformed into a
number of other useful forms. Since the quantity being summed is symmetric in a and b andr and s, and vanishes when a = 6 or r = s, we can write
EQ
°

==

1

|<Vea
ab] |rs>|?

6.7
(6.72)

ar’

Furthermore, in terms of regular two-electron integrals, the second-order
energy is
E?

<ab|rs><rs|ab>
= —
7s
abrs
“a +&—6&—&

1- © <ab|rs><rs|ba>
» t & —& — €s
2 Seba

1

(6.73)

Finally, for a closed-shell system, the second-order energy can be written in
terms of sums over spatial orbitals as

BP =25

y

NL <ab|rs><rs|ab> _ N? <ab|rs><rs|ba>
abrs &g +

&, — &

—

&

abrs &g +

&

—

& —

&,

Exercise 6.8 Derive Eqs. (6.73) and (6.74) starting with Eq. (6.72).

(6.74)

MANY-BODY PERTURBATION THEORY

353

In a similar, but much more laborious way, starting with Eq. (6.15)
it can be shown that the third-order energy is

<ab] |rs><cd| ab) <rs| |cd>

ER) = 1 x
°

8 abcdrs (€, +

&

ii yr

—

&

—

eEdé.

+

&

—

&

—

és)

<ab| |rs><rs||tu><tul |ab>

8 abrstu (&q +

4y

&

—

&

—

EMEg

+

€y —

&

—

Fy

<ab| |rs> <cs||tb><rt] |ac>

abcrst (Eq +

&

—

& — EMEq

+

€& —

(6.75)

& — &,)

As an illustration of the above formalism, we now calculate the second

and third-order energies of minimal basis H,. In Chapter 4, we showed that
the exact correlation energy of H, in the minimal basis set is
corm

= A— (A? + K2,)'/2

(6.76)

where

2A = 2e, — €,)+ Jy, + Ja ~ Wi. + 2K 42
= 2(e, — €,) + CUI[LL> + ¢22]22> — 4¢12]12> + 2¢11|22)

If we expand the expression for the correlation energy in a Taylor series in
the two-electron integrals up to third order, we find
corr

= ES

+

ES

tote

where
K?2

EQ = 12
°

(6.77

2(e, — €3)

and

pe — Kis

+ Jo. —4J3,, + 2K,2)

A(e, — €,)*

(6.78)

We will now show that the second-order energy in Eq. (6.77) is a special
case of the general expression given by Eq. (6.74). Since we have but a single
s
me
co
be
74)
(6.
Eq.
t
tha
so
2
=
s
=
r
,
rly
ila
Sim
1.
=
b
=
a
hole orbital,

Ee = 2 $11122)<22| 11>

£11]22><22] 11>

2(E, — &2)

_ |<tl]22>7? —
2e, — 2)

2(eE, — £4)

Ki,

= 2(E, — &2)

In Section 6.7.2, we will show that the general expression for the third-order
energy, given in Eq. (6.75), can be used to obtain the result given in Eqs. (6.78).

)

354 MODERN QUANTUM CHEMISTRY

Exercise 6.9 Derive Eqs. (6.77) and (6.78) from (6.76).

6.6 THE N-DEPENDENCE OF THE
PERTURBATION EXPANSION

RS

In the introduction to this chapter, we mentioned that Brueckner was the
first to investigate the applicability of the RS perturbation expansion of
infinite (macroscopic) systems. He was able to show, by a careful examination of the algebraic expressions that appear in various orders, that Ef? for

n=0,1,..., 6 was indeed proportional to the number of particles. He was,
however, unable to prove this in general (ie., for n = 7, 8,..., 00). Here we

present a simple illustration of Brueckner’s analysis. In Subsection 6.7.2 we
shall discuss Goldstone’s linked cluster theorem which, using a diagrammatic representation of RS perturbation theory, is proof of Bruecknet’s
conjecture that RS perturbation theory is satisfactory in all orders. We
consider a supermolecule consisting of V noninteracting minimal basis H,
molecules. We will show, using the ge :eral expressions derived in Section
6.1, that the first-, second-, and third-order energies of the supermolecule

are simply N times the corresponding results for a single molecule. This is
precisely the model we used to show, in Chapter 4, that the DCI result for
the correlation energy was proportional to N!/? in the limit of large N.
Recall that we label the orbitals of the supermolecule as:

and that all two-electron integrals involving orbitals from different units are
zero. The Hartree-Fock wave function for this system is
(6.79)

Wo> = |i fT, 1,1, --- byin>

If % is the Hartree-Fock Hamiltonian as in the previous section, the zerothand first-order energies are
N

EG” = C¥ | fo|'¥ o> =2

>

i=1

afl

=2Ne,

(6.80a)

= —NJ

(6.80b)

and
N

ED = (PIV |¥o> = — YA
i=1

The Hartree-Fock energy of the supermolecule,

Eo = (Yolo + V|[Yo> = ED + EY = N(2e, — Jus)

(6.81)

MANY-BODY PERTURBATION THEORY

355

is indeed simply N times the Hartree-Fock energy of one subunit. The
general expression for the second-order energy (Eq. (6.12)) is

,|Kolr|n>
2
EP =>
eae

(6.82)

Clearly, |0>= |) and the state |n> must be a double excitation of the type
(¥2:2+>. For these excitations
ES

CPV PEED

_

Eo

=

2(€,

—_

£2)

(6.83a)

= 112.2 — (1,1,]2,2,> = €11|22) = Ky

(6.83b)

and the summation over n can be replaced by a summation over i, so that

£2 = x KP
eR2>[?
eye)
OE.

NK,
Ey — &2)

(6.84)

which again is just N times the second-order energy of one unit.
The general expression for the third-order energy (Eq. (6.15)) is

E®) = A® + BE)

(6.85)

where
A?)

— »

D

OH
|n>
<n
¥
|m>
<m
¥]0>
|
]
(EO)
=

FOU EO

— E®)

(6.86)

and
BO) =
0

-E®

(6.87)

7"|
n>/
[<0]
?
ot
D (EO — EO)?

At first glance, the third-order energy does not appear to have the correct

N dependence, since BS? is proportional to N?:

(3)
Be

N

_(_N
(“NJu)

~

Ki,

(6.88)

Ns, Ki,
ee 12

_

2 , (22, — eye

Ae,

— £9)?

where we have used Egs. (6.80b) and (6.83a,b). If the third-order energy is to
be proportional to N, this term must be cancelled by a part of AG. This is
just the type of cancellation that Brueckner found, as discussed in the
introduction to this chapter. Let us now examine A) more closely. It is

clear that both |n> and |m> must be states of the type |¥7:?>> so that

age= 5 &
.

where

only

the

diagonal

Yr aaa

eee

1=1

4(e, —

element

remains

Ki,

“e

since

(

two-electron

6.89

integrals

356 MODERN QUANTUM CHEMISTRY

involving different units are zero. It can be shown that

PY PRD = CPR — oto E,
=

—NJ,,

tJ

+ Ja.

— Wy.

+

2Ky2

(6.90)

N7J11Ki2 4 NKini1 + Joo — 4Ji2 + 2K 12)

(6.91)

so we have

A®)
°

A(e, — &2)?

A(e, — €2)

,

Thus the N* terms do indeed cancel, leaving us with

Eg) = ap + py — NR

NKiJ

+Ae, Jn— &2)" Via + 7B)
Jo,

—-43

K

gn)

As with ED and E, this is just N times the third-order energy of a single

H, molecule (Eq. (6.78)). Recall that Eq. (6.78) was obtained by expanding
the exact correlation energy within the basis in a Taylor series, so that the
equivalence of the expressions derived in different ways provides a consistency check. Although this example is by no means a proof, we hope it will
inspire some confidence in the statement that RS perturbation theory—in
contrast to DCI—yields an approximation to the correlation energy which
is size consistent (1.e., has the correct N-dependence).
Exercise 6.10 Derive Eqs. (6.80b) and (6.90).

*6.7 DIAGRAMMATIC REPRESENTATION OF THE
PERTURBATION EXPANSION OF THE CORRELATION
ENERGY
We now introduce a diagrammatic representation of the nth-order energy.
Our zeroth-order wave function is taken to be the Hartree-Fock function.
Although it is possible to derive a perturbation expansion starting with any
single determinantal wave function, the Hartree-Fock description is the most
convenient starting point because of Brillouin’s theorem. The fact that single
excitations do not mix with the Hartree-Fock ground state considerably
simplifies the structure of the perturbation expansion. The rules we give for
constructing the diagrams will be correct only for Hartree-Fock perturbation
theory. Although we wil] not “derive” the rules for constructing and evaluating the diagrams, we hope that the formalism will appear as a “natural”
generalization of our previous results.

6.7.1 Hugenholtz Diagrams
As before, we represent an interaction by a dot and a hole or a particle state
by a line with an arrow pointing down or up, respectively. Looking back to

MANY-BODY PERTURBATION THEORY

357

Eq. (6.72), we note that the matrix elements, which appear in the numerator
of the second-order energy, now have four indices instead of two. This is an

immediate

result of the two-particle nature of the perturbation. Therefore,

it is reasonable to expect that the diagrams which represent Hartree-Fock
perturbation theory have dots with two lines going in and two lines coming
out. This is in fact the case. To obtain the diagrams that contribute to the
nth-order energy we connect n vertically ordered dots in all possible ways,

PeNE

such that

Each dot has four lines emanating from it.
Each diagram is linked.
Each diagram is distinct.
Diagrams containing more than one dot do not have lines which start
and end at the same point. That is, they contain no elements of the type

(

Requirements (2) and (3) are precisely the same as in Section 6.2, and requirement (4) is a “nonobvious” consequence of Brillouin’s theorem. Just as in
Section 6.2, the diagrams can be distorted in any way we please as long as
the vertical arrangement of the dots is not altered. Using these rules, we

find

358 MORERN QUANTUM CHEMISTRY

There are, however, twelve unique diagrams with four dots as shown in
Fig. 6.1. Just as before, we label all the lines with arrows pointing up or
down, in all possible ways such that each dot has two lines going into it and
two lines coming out of it. In this way, we find only a single second-order

JY OE
84€ &
» IOS
Figure 6.1 Unlabeled fourth-order diagrams.

MANY-BODY PERTURBATION THEORY

359

r

s oa

b oF

qo

OU

ll
we

diagram but three third-order diagrams,

These diagrams are called Hugenholtz diagrams.
Fortunately, the rules for translating them into algebraic expressions
are virtually identical to our previous rules:
Hl. Each dot contributes an antisymmetrized matrix element

label-2 in||label-1 out, label-2 out)> to the numerator.

<label-1

in,

The particular

labeling 1 and 2 is arbitrary.
H2. Each pair of adjacent dots contributes the denominator factor
>

Ebotes

— >

particles

where the sums run over the labels of all hole and particle lines crossing
an imaginary horizontal line separating the two adjacent dots.
H3. The overall sign of the expression is (—)"*', where h and | are the number
of hole lines and closed loops, respectively. The number of closed loops
cannot be determined by looking at the diagram alone. We will give a
prescription below as how to find it from the string of matrix elements
written down using rule (H1).

H4. Sum the expression over all particle and hole indices.
HS. Multiply the expression by a weight factor 2~*, where k is the number
of pairs of equivalent lines in the diagram. Two lines are equivalent when
both start and end at the same dot and both go in the same direction.
You will note that only rule (H‘5) is substantially different from our previous
rules. The only tricky part in applying these rules is the determination of
the number of closed loops. How this is done is best illustrated by the

360

MODERN QUANTUM

CHEMISTRY

following example. Consider the second-order diagram:

It clearly has two hole lines and two pairs of equivalent lines (r, s) and (a, 5).
So we can immediately write
Case A:

(sy (pte

y <ab| |rs><rs| |ab>

2

abrs

&q +

&

—

&

—

Ey

Since we said that the order of the two in or two out labels in the antisymmetrized matrix element does not matter, we could equally have written
(5) ce
y <ab| |rs><sr||ab>
Case B:

2

abrs

&q +

& —

& —

€,

It is clear that if our rules are any good, these two expressions must be equal.
This responsibility belongs to the | factors. The number of closed loops can
be found only after we have written down a string of matrix elements. To
determine

I, we select a particular label and follow it through the matrix

elements using the rule

<il|KI>

and

<i

until we reach the same label. The number of times we have to do this,
before we exhaust all the labels, is | Consider Case A,
1

2

<ab| |rs> <r

1

2

Jab)

:

azr>a

2
ry
abl |rs><rs| lab)

:

b 4s4b

1

Therefore, 1, = 2. For Case B, on the other hand, we have
1

2

<ab|f's><er |ab>

:

a>r>obos
>a

Since a single “path” involves all the labels, I, = 1. Because
<rs||ab> = —<sr||ab>
it is clear that both Cases A and B give the same result namely,

FE?=

1 y <ab| |rs><rs| |ab>
4

ors Eq + &p —

& —

Eg

MANY-BODY PERTURBATION THEORY

361

which is identical to the result of Eq. (6.72), which was obtained algebraically.
We now evaluate the three third-order diagrams, paying particular attention
to the determination of 1:

a
c
o
l
l
a
(Scope x
2

abcdrs (€, + &, —

&

—

ed(é,

+ &y —

& —

és)

The value of | is two for this case since we have the two paths, a>r—-+c—7 a
and b>s>d—b.

<ab| |rs><rs| |tu> <tu| |ab>

(3) (yy

b=

abrstu (€, +

2

€, —

Ey —

Here | = 2 since we have the paths a> r—t— aand bs

r

abcrst (€, + &, —

Here

|= 3

since

we

have

the

Thus the third-order energy is

°

8 abcdrs (€

re

—>u- b. Finally,

paths

&—

&,)(Eq

aar—7a,

+ & —

& —

b>s—b

+ &, —

y

& —

abcrst (€,

+ &y—

& —

é5)

<ab| |rs><rs| |tu><tul |aby

8 abrstu (e. + Ey —

+y

e)(E

&

— E)(Eq

+ &

— &, — é,)

<ab| |rs><cs| |tb> <rt||ac>
+ &

—

& —

&,)(Eq +

& —

which is the same as the result quoted in Eq. (6.75).

& —

é,)

and

<ab| |rs><cd| lab) <rs| |cd>

y

Fe) _i

é,)

<ab| |rs>< cs| |tb> <rt||ac>

Y

=(-)3*!

& —

—

&

ed(eq +

&,)

cot.

362 MODERN QUANTUM CHEMISTRY

Exercise 6.11 Show that the fourth-order diagram

4 AY }

is equal to

ly

2 abcderst (e, +

<rs| |ac><at| |de) <de| |tb> <e||rs)
&

—

8

—

ed(E,

+

&q +

&

—

&

—

&

—

&)(E

+ &

—

&

—

&,)

6.7.2 Goldstone Diagrams
We now consider an alternate diagrammatic representation of many-body
perturbation theory due to Goldstone. Goldstone diagrams translate directly
into regular two-electron integrals and are such that the number of closed
loops (1) can be determined by inspection. However, there are more Goldstone
diagrams than Hugenholtz diagrams in a given order of perturbation theory.
In Goldstone diagrams we represent a two-particle interaction not by a dot
but by a dashed line. The particle and hole states are still represented by
lines with arrows, but now there is one line going into and one line coming
out of each end of an interaction (dashed) line. For example, the element

sa

in a Hugenholtz diagram is replaced in a Goldstone diagram by the two
elements
and

This eliminates the antisymmetric matrix elements. One can think of the
above correspondence as “pulling apart” the dot and labeling the arrows
in two distinct ways. The Goldstone diagrams, which contribute to a given
order, can be obtained by pulling apart all Hugenholtz diagrams in that

“

MANY-BODY PERTURBATION THEORY

363

order. For example,

The two second-order Goldstone diagrams are called direct and exchange
diagrams, respectively.
Table 6.2 contains all second- and third-order Goldstone diagrams in
Hartree-Fock perturbation theory. They have been evaluated using the
following rules:
G1.

Each interaction line

contributes a matrix element factor <label-left in, label-right in | label-left
out, label-right out) to the numerator.
G2. Each pair of adjacent interaction lines contributes the denominator factor
.

G3.
G4.
G5.
G6.

>

Fnote —

>

E particle

where the sums run over the labels of all hole and particle lines crossing
an imaginary horizontal line separating the two adjacent interaction lines.
The overall sign of the expression is (—)**', where h and | are the number
of hole lines and closed loops, respectively.
Sum the expression over all particle and hole indices.
Diagrams which have a mirror plane perpendicular to the plane of the
paper are multiplied by a factor of 1/2.
For closed-shell systems, a summation over spin orbitals is equal to
2! times a summation over spatial orbitals, i.e.,
N

1 =

N/2

2d.

364 MODERN QUANTUM CHEMISTRY

Table 6.2 Second- and third-order Goldstone diagrams

b

(+2

(-yt?

6) r <ab|rs><rs|ab>
2

abrs &a + &, — &, — €s

6)

r <ab|rs><rs|ba>

2

(-)?*?

(2

()

2.

abrs Eg + &, — &, —

<ab|ru><ru|ts><ts|ab>

y

abraut (8g + & — &, — EE

6) yr

(pe

+&

>
aberst (e, +

(-y"?

>

&

—

e)(e, +

&p — & — &,)

<ac|rt><rb]sc><st| ab>

oy
aberst (€

+ & — & — &5)

<ad|rs><cb|ad)<rs| cb>

2 abcdrs (e, + &4 —

(pr

by

—&

— EME

+ & — & — &)

<be|rt><ra|sb><st|ac>
&

— &

—

&)(Eq +

& —

&

—

&)

<ac|rt><bt|sc><rs|ab>

abcrst (e4 +&—&

— &)(Eq + & — & — &5)

MANY-BODY PERTURBATION THEORY

Table 6-2 (continued)

<cb|rt) <at|sc> <rs| ab)

it

(-¥*?

.

cp

yee

<be|rt> <at|sc><rs|ab>
aberst (e

+E

— &

&)(Eq + & ~— & — &5)

365

366

MODERN QUANTUM CHEMISTRY

As an application of these rules, we evaluate the second-order energy.
Consider reflecting the direct diagram about the mirror plane perpendicular
to the plane of the paper,

The diagram remains invariant upon reflection, so the weight factor is 1/2.

Since we have two hole lines and two closed loops, the value of this diagram is

©

1 _y
=5(-)

yr <ab|rs)<rs|ab)>
abrs &g + &

— &

—

&,

so the weight factor is again 1/2. Since we have two hole lines but only one
closed loop (r > b > s > a
r), the value of this diagram is

Lahey Slecsibe
— 1

par

<ab|rs><rs|bay

abrs &a +

&

—

&

— &

Note that the sum of the values of these two diagrams is just the result given
in Eq. (6.73). Moreover, for a closed-shell system using rule (G6), we can
convert the summation over spin orbitals to spatial orbitals simply by
multiplying the value of the direct diagram by 2? and the exchange diagram
by 2! and, thus, recover Eq. (6.74). Table 6.2 contains the algebraic expressions corresponding to all 12 third-order Goldstone diagrams. You should
check your understanding of the rules by verifying these results.

Exercise 6.12 We stated that the Goldstone diagrams in Table 6.2 can
be obtained by “pulling apart” the second- and third-order Hugenholtz
diagrams. This is quite tricky to see but the converse is much easier. For

.
MANY-BODY

PERTURBATION

THEORY

367

example, if we push

Push all third-order diagrams in Table 6.2 together in a similar way and,
thus, find which Goldstone diagram comes from which Hugenholtz diagram.
For the above Hugenholtz diagram, verify that its mathematical value is
indeed the sum of the values of the corresponding Goldstone diagrams.
As an illustration, we now evaluate all the second- and third-order
diagrams in Table 6.2 for minimal basis H, and show that the corresponding
energies are identical to our previous results (Eqs. (6.77) and (6.78)). To do
this we convert to a spatial orbital summation by multiplying by 2', where
lis the number of closed loops, and then set all hole indices equal to 1 and
all particle indices equal to 2. For the two second-order diagrams, we find

1+>(2)°(1/2)

2<> —(2)(1/2)

<11]22>?_

Ki,

(2e, — 2€2) — (€, — &2)

<11|22>? _

K?,

(2e;— 22) le, — &2)

so that their sum is indeed identical to the second-order energy of Eq. (6.77).
For the third-order diagrams we have
1

(2)

2 <> (2)?

3
4<

1

€11|22><22]22)<22|11>

_

2

4(e, — £2)?

2(e, — €2)”

1

€11]22>¢11]11><22] 11> _

K2,J 44

2

4(e, — €2)”

2(e, — £2)"

11
—(2)? €11]22><21]21>¢22|

K2,J22

Ki

12

4(e, — £2)"

(e, — €2)"

(2)? <11]22><21|21><22| 11> __

K?,J 42

4(e, - &2)*

(e, — €2)°

368 MODERN QUANTUM CHEMISTRY

oO}
5

€11|22><12]21><22]11)

Q)

4e, — &2)*

6(2
7

9

Ae, — £5)"

2(e, — &)"

2

1

€11]22><11]115<11|22

2

Ae, - £2)?

1

€11|22><22|22><11|22

2

4(e, — @,)*

> (2) $AAL22><12] 12911] 22)

__

KJ
Ae,

_

_

K2,J 42

€11]22><¢21]21><11]22> _

K2,J 42

ey — 8)?

—Q)

— £2)”

4(e, — €2)”
2(8, — €)"

€11]22><21[12><11] 22

2

Mey — en)"
__

K?,K,2

A(e, — €2)7

(é1 — £2)"

€11]22><12{21><22| 11>

K?,K,2

A(e, — €2)*

13

K?,J42

A(e, — £2)"

lo —(Q

124

_ £2)"

K2,K,2

—(2)

10

~ -&

€11]22><12]21><22] 11> _
—(Q)

8 <>

K?,K,>

(@ — ey"

One can now verify that the sum of these twelve expressions agrees with the
third-order energy of Eq. (6.78).

6.7.3 Summation of Diagrams
In Subsection 6.2.3, we found that certain classes of diagrams could be
summed to infinite order, because the values of the diagrams formed a
geometric series. The analogous summation can be performed with Goldstone diagrams. Recall that in the N-state problem we summed only certain
diagrams that were diagonal; that is, they were formed by adding dots to
our second-order diagram in such a way that the labels on the lines entering
and leaving the new dot were the same. With Goldstone diagrams we can
do the same. We start with the second-order direct and exchange diagrams
and add interaction lines in such a way that the labels on a hole or particle
line intersected by the added interaction line are the same above and below
the interaction line. For example, consider the following set of diagrams

a--()-(} OO .
All of these have a weight factor equal to 1/2. Because they all have the same
number of hole lines and closed loops, they have the same sign. If we evaluate

MANY-BODY PERTURBATION THEORY

369

y Le

|

them, we find

A

1

|<rs|ab>}?

2,

+

&

—

& —

&

&, +

& —

&

<rs|rs>

+ (-

<rs|rs>

E +

— &,

a +

&% —

& — &,

1
|<rs|ab>|?
~ 28,
+ & — 8 — 6, — <rs|rs>
Thus the summation of a geometric series, just as before, results in a shifted
energy denominator. Now if one were to sum all possible diagrams generated
by the prescription given above, one would find

E cord EN) =

ane

<ab] |rs)|

wale

—

2

Eo|¥a>

(6.93)

This result is identical to the correlation energy obtained using EpsteinNesbet pair energies, as discussed in the previous chapter (see Eqs. (5.15)
and (5.16)).
Finally, we mention that if one were to sum all double excitation diagrams (an imaginary horizontal line crosses only two hole and two particle
lines for such diagrams) one would obtain the doubly excited MBPT
(D-MBPT(oco)) of Bartlett and coworkers.* This approximation is equivalent to the linear CCA discussed in Subsection 5.2.3. Thus, the appropriate
correlation energy is (see Eq. (5.65))

Ee orr(D-MBPT(co)) = —B'(D)"'B

(6.94)

where

(B'),asb = <P ol3¢|Va>

(6.95a)

(D),asp.reua = (Valo — Eo|¥ea>

(6.95b)

Note that if matrix D is approximated by only its diagonal part, we
recover the Epstein-Nesbet
second-order energy.
Unlike E,,,EN),
E cor(D-MBPT(00)) i is exact to third order in perturbation theory. In fourth
order, it is missing contributions due to single, triple, and quadruple
excitations,
6.7.4

What Is the Linked-Cluster Theorem?

Goldstone’s linked-cluster theorem is simply a general proof, using diagrams,
of Brueckner’s conjecture that RS perturbation theory, order by order, is
size consistent. The algebraic terms that are proportional to N? can be
represented by diagrams consisting of separate pieces (i.e, by unlinked
diagrams). Goldstone proved, using time-dependent techniques, that such
diagrams never appear in the final result for the nth-order energy. Thus he
was able to write the nth-order energy in terms of only linked diagrams. In
this chapter, we used only linked diagrams right from the beginning. We
hope that the numerous consistency checks, which compared results obtained

370 MODERN QUANTUM CHEMISTRY

using diagrammatic and algebraic methods, have made it convincing (or at
least plausible) that all forms of RS perturbation theory (Le., N-state, orbital,
etc.) can be represented by only linked diagrams, It should be emphasized that
the term “size consistent” is used in this book to describe theories in which
the energy increases linearly with the size of a many-body system. Only if a
system is a supermolecule composed of N independent closed-shell monomers and only if a method is invariant to unitary transformations of degenerate orbitals, does size consistency imply that the energy of the
supermolecule is N times the monomer energy.

Exercise 6.13 Calculate ES for a supermolecule consisting of N non-

interacting minimal basis H, molecules by evaluating the Goldstone diagrams in Table 6.2. Compare your result with that of Eq. (6.92), which was
obtained algebraically by explicitly cancelling terms proportional to N?.
Hint: Simply show that the value of each Goldstone diagram for the supermolecule is N times the result for a single molecule

6.8 SOME

ILLUSTRATIVE

CALCULATIONS

In this section, we use perturbation theory to calculate the correlation
energies, potential energy surfaces, equilibrium geometries, and dipole moments of a variety of small molecules.
Table 6.3 compares the correlation energy of H, calculated using secondand third-order perturbation theory with the full CI results for a series of
basis sets of increasing quality. It is interesting to note that the fraction of
the basis set correlation energy obtained at second-order increases significantly with the size of the basis. This appears to be a general phenomenon
and is not restricted to two-electron systems. Thu it is dangerous to draw
conclusions about the utility of perturbation theery from small basis set
calculations. It can be seen that the perturbation expansion converges
Table 6.3 Correlation energy (a.u.) of H, at R = 1.4
Basis
STO-3G
4-31G
6-31G**
(10s, 5p, 1d)’

Exact?

E}

Percent of full CI

Ei? + El

—0.0132
—0.0174
—0,0263
—0.0321

64
70
78
81

—0.0180
— 0.0226
—0.0319
—0.0376

Percent of fullCl = Full CI
87
91
94
95

— 0.0206
—0.0249
—0.0339
— 0.0397

— 0.0409

* J. M. Schulman and D. N. Kaufman, J. Chem. Phys. 53: 477 (1970), for E?; U. Kaldor,
J. Chem, Phys. 62: 4634 (1975) for, ES; C. E. Dykstra, unpublished result, for full CI.
> W. Kolos and L. Wolniewicz, J. Chem. Phys. 49: 404 (1968).

>

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

Table 6.4 Equilibrium
(a.u.) for H,

bond

length

Basis set

SCF

E??

Full Cr

STO-3G
4-31G
6-31G**

1.346
1,380
1.385

1.368
1.394
1.387

1.389
1.410
1.396

Exact?

371

1.401

“W. Kolos and L. Wolniewicz, J. Chem.

Phys. 49:404 (1968).

quickly for the larger basis sets and that the correlation energy obtained
through third order is in good agreement with the exact value for the basis.
In Table 6.4 we compare the equilibrium bond lengths of H, obtained

using SCF, E

and full CI for three basis sets, with the exact result. For the

6-31G** basis, the SCF result differs from the exact basis set result by only
0.011 a.u.; the second-order energy corrects the SCF bond length in the right
direction, but by a rather small amount.

In Table 6.5 we compare the SCF and second-order perturbation theory
results for the equilibrium bond lengths of the ten-electron series CH,,
NH;, H,O, and FH with experiment. At the 6-31G** level, the largest
difference between the SCF and experimental results is 0.03 a.u. In all cases,
the second-order energy reduces this error to less than 0.01 a.u. Note that
in all the systems discussed so far, large basis set SCF calculations underestimate the equilibrium bond length. Correlation effects tend to lengthen
Table 6.5 Equilibrium
series

CH,
SCF
ED
NH,
SCF
E2)
HO
SCF
ED
FH

SCF
E®

bond

lengths (a.u.) of the ten-electron

STO-3G

4-31G

6-31G*

6-31G**

Experiment

2.047
2.077

2.043
2.065

2.048
2.060

2.048
2.048

2050
.

1.952
1.997

1.873
1.907

1.897
1.922

1.897
1912

1913
.

L871
1.916

1.797
1.842

L79t
1.831

1.782
1816

1.809
,

1.812

1.742

1.722

1.703

1733

1.842

1,790

1.765

1.740

372 MODERN QUANTUM CHEMISTRY

Table 6.6 Equilibrium bond angles for NH, and H,O

NH,
SCF
ED
H,0
SCF
ED

STO-3G

431G

6-31G*

6-31G**

Experiment

1042
100.9

1158
1139

1075
1063

107.6
106.1

106.7

1000
97.2

12
1088

105.5
1040

106.0
103.9

1045

those bonds that lead to open-shell fragments when stretched. In Table 6.6
the equilibrium bond angles for NH, and H,O, calculated at the SCF and
E’ levels, are compared with experiment. For the larger basis sets, the
second-order energy reduces the SCF error by about a half.
Although perturbation theory at the level of the second-order energy
predicts excellent bond lengths for bonds involving hydrogen, this is net
the case for multiple bonds. Table 6.7 compares the SCF and perturbation
theory results for the bond lengths of N, and CO with experiment. For the
largest basis set, the SCF underestimates the experimental result by about
0.03 a.u.; second-order perturbation theory increases the predicted bond
length but it significantly overestimates the correction. The third-order
correction partially counteracts the effect of the second-order correction,
but the agreement with experiment is still not completely satisfactory.
Before leaving the topic of equilibrium geometries, we consider the
calculation of the potential energy of H,O in the vicinity of its equilibrium
geometry using a near-HF-limit one-electron basis set (the 39-STO basis
described in Chapter 4). We have used this example both in Chapter 4, in the
context of CI, and in Chapter 5, to illustrate pair and coupled-pair theories.

In Table 6.8 we compare the correlation energy obtained through fourth
order of perturbation theory with those found using a variety of many-

electron approaches, discussed in the previous chapters. We note only that
the second-order energy gives a respectable fraction of the basis-set correlation energy and is superior to SDCI. A more interesting comparison of these
Table 6.7 Equilibrium bond lengths (a.u.) of N, and CO
N,

co

Basis set

SCF

EW

EP + ES)

STO-3G
431G
6-31G*

2143
2.050
2.039

2.322
2.171
2.133

2.222
2.098
2.109

Experiment

2.074

SCF

EY

EQ) 4 ED

2.166
2.264
2.132
2.216
2105 = 2.175

2 132

2.216
2.169
2.145

MANY-BODY PERTURBATION THEORY
«

373

Table 6.8 Correlation energies (a.u.) of
H,O at the experimental geometry
calculated with the 39-STO basis de-

scribed in Chapter 4°

Boon

E®

—0.2818

E®

+ E®

E®

+ ED

—0.2850
+ E®

SDCI
IEPA
L-CCA
CCA
Estimated full CI
Exact

— 0.2960
— 0.2756
— 0.3274
~ 0.2908
—0.2862
—0.296 + 0.001
—0.37

*R. J. Bartlett, S. J. Cole, G. D. Purvis,
W. C. Ermler, H. C. Hsieh, and I. Shavitt, J.
Chem. Phys. 87: 6579 (1987), and references
therein.

many-electron theories is given in Table 6.9, which presents the equilibrium
geometry and two force constants for H,O calculated using the different
approaches. Before considering these results, it should be pointed out that
the predictions of the various theories should be compared with the exact

basis set results (i.e., the results obtained from full Cl calculations) and not

Table 6.9 Equilibrium geometry and some force

constants of H,O calculated with the 39-STO ba-

sis described in Chapter 4°
R
(a.u.)

6,

RR

i

SCF
ER

1.776
1.811

106.1
104.4

9.79
8.55

0.88
0.78

EQ + EG + Em
spDcI
L-CCA
CCA

1.813
1.800
1.810
1.806

104.4
104.9
1046
104.7

842
888
851
8.67.

E2 + ES

Experiment

1.803

1.809

1048

104.5

880

8.45

0.81

90.79
0.81
0.80
0.80
0.76

*R. J. Bartlett, S. J. Cole, G. D. Purvis, W. C. Ermler,
H. C. Hsieh, and I. Shavitt, J. Chem. Phys. 87: 6579 (1987),
and references therein.
» The force constants are in 10° dyn/cm with angles measured in radians.

374 MODERN QUANTUM CHEMISTRY

experiment. Unfortunately the exact basis set results are unavailable and
hence the best one can do is use the experimental results as a benchmark.
The most striking aspect of this Table is that, while SDCI considerably
improves the SCF results, all the many-body methods are superior to SDCI
for this molecule. The second-order perturbation results are remarkably
close to experiment. However, the convergence of the perturbation expansion appears to be oscillatory and the third-order results are relatively poor.
This is in contrast to the correlation energy (see Table 6.8), where the
convergence seems to be monotonic. Thus it appears that to obtain highly
accurate potential energy surfaces even near equilibrium one needs to go to
higher orders in perturbation theory. This is consistent with the improved
agreement obtained with the two coupled-cluster methods (CCA and
L-CCA). The CCA and the L-CCA are exact to third-order in perturbation
theory and also incorporate some important parts of the fourth, fifth, ...,

infinite order energies.
A central problem in quantum chemistry is the calculation of potential

energy surfaces far from the equilibrium configuration, for use in describing

chemical reactions. A simple example is the potential energy curve of H2.
We have seen in Chapter 3 that restricted Hartree-Fock is not a satisfactory
method since it does not predict that H, dissociates into two hydrogen atoms.

Recall that for the minimal basis set description, in the limit that R — oo,

h,, and h,, both become equal to the energy of the hydrogen atom in the
basis (E(H)) while all two-electron integrals (J,,, J12, J22, K 2) become
equal to $(¢@|¢¢), where ¢ is the hydrogen atom orbital. Thus the HF
energy E, (Eo = 2hy;, + J11) behaves as

jim E,(R) = 2E(H) + 3($¢|¢¢)
We

have seen that CI rectifies this situation; unfortunately,

(6.96)
perturbation

theory using restricted HF orbitals makes things even worse. In fact, the
second-order energy in the limit R > oo diverges. Recall that for minimal
basis set H, the second-order energy (see Eq. (6.77)) is

In the limit R

00, K,2 becomes $(¢¢|$¢), which is finite, but both ¢,

(€; = hy, + J4) and &2 (€2 = hy2 + 2J,. ~ K,2) go to the same limit (i.e,

E(H) + 4(¢¢|¢¢)). Thus ¢, — 2 tends to zero and EY becomes infinite.

The simplest way out of this difficulty is to improve the unrestricted HF
description by means of perturbation theory. Computationally, this involves
simply using the unrestricted spin orbitals and orbital energies in the formulas for the second and higher order energies written as sums over spin
rather than spatial orbitals (e.g., Eqs. (6.72) and (6.75)). The potential energy
curves for minimal basis H,, obtained in this way, are shown in Fig. 6.2

MANY-BODY PERTURBATION THEORY

375

a

0.02

0.00

10

14

#16

22

26

3.0

3.4 Rau)

002

E(Hy) - 2E(H) (a.u,)

0.04
-0.06

3

-0.08

7

“/

“

“Exact

(Kolas-Wolntewicz)

-0.10
0.12

0.14
-0.16
0.18
020

Figure 6.2 Potential energy curves for H, using the STO-3G basis set.

The exact result of Kolos and Wolniewicz is shown for comparison. Recall
that the UHF and full CI calculations predict a larger dissociation energy
than the exact result because the STO-3G basis is so poor for the hydrogen
atom. Note that the convergence of the perturbation expansion is excellent
for the dissociation energy. At third-order, the perturbation theory result
differs only by about 1% from the exact basis set value. The disappointing
aspect is that, while the unrestricted second and third-order energies are
well behaved at large R (ie., dissociation is correctly described), perturbation theory starting with the UHF description gives a negligible amount of
the correlation energy at large, but finite, R. Thus the potential curve calculated using perturbation theory is not satisfactory at long range. Perturbation theory converges quickly if one has a good starting point. Although
the UHF wave function gives the correct energy at R — 00, it has the incorrect form, i.e.,

lim |¥O""> = |¢,62>

R70

(6.97)

where ¢, and ¢, are the hydrogen atomic orbitals on centers 1 and 2, while
the exact singlet wave function at infinite separation is

Him |®oy = 2° (|9192> + 6261)

(6.98)

376 MODERN QUANTUM CHEMISTRY
0.06 F

004+
0.02

lo

0.00
3

-0.02F

=

0.04

Wy

0.06

=

-0.08F

\

=
Wy

18

[

.
“0.14
r

-0.16
veer
0.18

30

“y

1

3.4 R(au)

7

/=<Exact

27 (Kolos-Wolniewicz)

/ -7~Full Cl

_

0.10
-0.12

26

22

.

G

=

14

10

\

x:‘\

LiLy

yy
77

WAY
WoNZ

Figure 6.3 Potential energy curves for H,

using the 6-31G** basis set.

Note that the exact wave function at large R cannot be described by a single
ed
ain
obt
was
r
pte
cha
this
in
bed
cri
des
ory
the
ion
bat
tur
per
The
nt.
determina
It
nt.
ina
erm
det
le
sing
a
was
on
cti
fun
e
wav
der
-or
oth
zer
the
that
ng
assumi
g
usin
ves
cur
l
ntia
pote
of
part
ge
ran
long
the
be
cri
des
to
that
s,
ear
app
thus
perturbation theory, one must start with a multiconfigurational zeroth-order
*
wave function. In Fig. 6.3 we present the corresponding results at the 6-31G*

the
of
size
the
of
nt
nde
epe
ind
are
ons
ati
erv
obs
ve
abo
the
that
level, to show

basis set.
in
s
ent
mom
ole
dip
of
on
ati
cul
cal
the
er
sid
con
we
e
mpl
exa
l
fina
a
As
batur
per
te
fini
of
hod
met
the
g
usin
ry,
theo
ion
bat
tur
per
of
ork
mew
fra
the
of
rgy
ene
d
ate
rel
cor
the
e
ulat
calc
to
is
ch
roa
app
this
ind
beh
idea
The
s.
tion
a molecule in the presence of a small but finite electric field and then numerically differentiate the energy with respect to the field to obtain the dipole
in
used
be
can
and
l
era
gen
is
hod
met
this
that
ed
not
be
uld
sho
moment. It
or
maj
A
gy.
ener
on
ati
rel
cor
the
for
n
tio
ima
rox
app
any
with
on
conjuncti
aput
com
be
can
it
that
is
ch
roa
app
ion
bat
tur
per
te
fini
the
of
age
ant
adv
proting
exis
of
s
ion
cat
ifi
mod
or
min
ly
tive
rela
with
ed
ent
lem
imp
ally
tion
grams, which calculate the correlation energy. This is a consequence of the
fact that the additional term in the Hamiltonian due to the presence of the

MANY-BODY PERTURBATION THEORY

377

electric field contains only one-particle interactions and thus can be incorporated into the HF procedure by a simple modification of the core-Hamil-

tonian.
To make the above ideas more explicit, consider a molecule in the presence of an electric field F. The total Hamiltonian in the presence of the

field is

HF) = (0) + F -

0)

(6.99)

where r(i) is the coordinate of electron i. If we expand the total energy in the
presence of the field F in a Taylor series, we have

Be) = BO +¥ (SE \ +i 53 (ee) FE, +++ (6.100)
oE(F

EF

where the sums run over the Cartesian (x, y, and z) components of the field.
By definition, the component of the dipole moment vector, ji, in the ith
direction (i.e. 44;) is

_ _

=

(GE(F)

( aF, ),

(6.101)

The minus sign is chosen so that the dipole moment vector points from the
negative to the positive part of the molecule. Similarly, the second derivatives
of E(F) evaluated at zero field define the polarizability tensor of the molecule.
Thus finite perturbation theory can be used to obtain the polarizability as
well as the dipole moment of a molecule.
The dipole moments presented below were obtained by first performing
a HF calculation in the presence of the field, then calculating the secondorder energy using the field-dependent HF orbitals and orbital energies,
and finally, numerically differentiating the total energy calculated up to
second-order in perturbation theory. We first consider the dipole moments
of the ten-electron series NH;, H,O,

and FH. Recall that we have seen in

Chapter 3 that even at the 6-31G** level the HF dipole moments were poor
in comparison with larger SCF calculations near the HF limit. The dipole

moments, calculated using the second-order energy for the standard basis
sets, are shown in Table 6.10. Note that for the larger basis sets, correlation

changes the dipole moment in the right direction but, except for the 6-31G**
result for FH, the agreement with experiment is still poor. This illustrates
the fact that inadequacies in the basis set cannot be corrected by including
correlation effects.
A particularly challenging molecule for any theory of dipole moments is
CO. Recall that in Chapter 3 we have seen that the SCF procedure in the
limit of a very large basis set gives the incorrect sign for the dipole moment.
Does perturbation theory at the level of the second-order energy rectify this?

Table 6.11 shows that the larger basis sets are of sufficient quality (ie., the

378 MODERN QUANTUM CHEMISTRY

Table 6.10 Dipole moments (a.u.) of the ten-electron series
NH,

H,0

Basis set

SCF

STO-3G
431G
6-31G*
6-31G**

0.703
0692
0.905 = 0.891
0.768
0.773
0.744
8=©06.733

Experiment

EY

0.579

FH

SCF

EY?

SCF

EY?

0679
1.026
«0876
«0.860

0652
0994
0859
0825

0507
0897
0.780
0.776

0477
0861
0.747
0.728

0.723

0.719

Table 6.11 Dipole moment (a.u.) of CO*
Basic set

SCF

EY

STO-3G
431G
6-31G*

0.066
—0.237
—0.131

0.510
0.165
0.167

Experiment
“Positive
cot”.

0.044
dipole

moment

corresponds

to

predicted SCF dipole moment has the wrong sign in agreement with the
near-HF results) to be able to answer this question qualitatively. The secondorder energy does indeed predict the correct sign of the dipole moment. The
basis sets are, however, not sufficiently large to draw any quantitative conclusions. At first glance this success of second-order perturbation theory
might appear to be surprising. In Chapter 4 we have seen that, using CI, the
correct sign is obtained only if we include single excitations. However, because of Brillouin’s theorem, only double excitations contribute to the
second-order energy. The resolution of this apparent paradox lies in the
nature of the numerical differentiation, which was used to obtain the dipole

moment. While it is by no means obvious, the answer is that while the
second-order energy does indeed contain only double excitations, the HF
orbitals used to calculate FE‘? are field-dependent and the numerical differentiation effectively introduces single excitations involving the HF orbitals
of the molecule in the absence of the field.

NOTES
1. R. P. Feynman, The development of the space-time view of quantum
Science 153:699 (1966). This is an amusing as well as inspiring article.

electrodynamics,

MANY-BODY PERTURBATION THEORY

379

2. R. J. Bartlett, 1. Shavitt, and G. D. Purvis, The quartic force field of H,O determined by

many-body methods that include quadruple excitation effects, J. Chem. Phys. 71:281 (1979),
and references therein.

FURTHER

READING

Bartlett, R. J., Many-body perturbation theory and coupled cluster theory for electron correlation in molecules, Ann. Rev. Phys. Chem. 32: 359 (1981). An excellent review of the theory
and applications with two hundred literature references.
Brandow, B. H., Linked-cluster expansion for the nuclear many-body problem, Rev. Mod.
Phys. 39: 77) (1967). A classic review which discusses, among many other things, how to
use Goldstone-like diagrams with antisymmetric matrix elements associated with Hugenholtz diagrams. This is an alternate way of getting around the problem of not being able
to determine the number of closed Joops in a Hugenholtz diagram by inspection.

Freed, K. F., Many-body theories of the electronic structure of atoms and molecules, Ann.

Rev. Phys. Chem. 22: 313 (1971). An excellent review with almost three hundred
references. It is written for the nonspecialist with a historical perspective.
Lindgren, I., and Morrison, J., Atomic Many-Body Theory, Springer-Verlag, Berlin, 1982.
Chapters 9-12 of this advanced textbook develop diagrammatic perturbation theory in
a rigorous yet accessible way. The labels used for occupied and virtual orbitals are the
same as ours.
Manne, R., The linked-diagram expansion of the ground state of a many-electron system: A
time-independent derivation, Int, J. Quant. Chem. Sti: 175 (1977). A pedagogical article
which presents a relatively simple proof of the linked cluster theorem.
Mattuck, R. D., 4 Guide to Feynman Diagrams in the Many-Body Problem, 2nd ed., McGtaw-

Hill, New York, 1976. A wonderful book which presents diagrammatic perturbation
theory from the time-dependent point of view. The author has made the subject as entertaining and as simple as possible. A disadvantage for chemists is that the emphasis is
placed on treating infinite systems where the basis functions are plane waves.
Paldus J. and CiZek, J., Time-independent diagrammatic approach to perturbation theory of
fermion systems, Adv. Quantum Chem. 9: 105 (1975). An authoritative discussion of the
subject.

Robb, M. A., Pair functions and diagrammatic perturbation theory, in Computational Techniques in Quantum Chemistry, G. H. F. Diercksen, R. T. Sutcliffe, A. Veillard (eds.),
Reidel, Boston, 1975, p. 435. An accessible review which discusses IEPA, CEPA, and
CCA in diagrammatic terms.
Wilson, S., Electron Correlation in Molecules, Clarendon Press, Oxford, 1984. This book

discusses many of the modern approaches to the correlation problem in a way compli-

mentary to our own. It is particularly strong on diagrammatic perturbation theory and
also contains an excellent chapter on the group theoretical aspects of electron correlation.

CHAPTER

SEVEN

THE ONE-PARTICLE MANY-BODY
GREEN’S FUNCTION

Green’s function techniques are one of the most powerful tools of many-body
theory. In this chapter, we will consider the one-particle many-body Green’s
function (MBGF), which contains information about the electron affinities
(EA’s) and ionization potentials (IP’s) of an N-electron system. We will see
that MBGF theory provides a systematic framework for improving the [P’s
and EA’s obtained within the Hartree-Fock approximation using Koopmans’
theorem. In contrast to perturbation theory, which can be presented without
ever mentioning diagrams or using second quantization, Green’s function
techniques are really quite different from the approaches we have thus far
discussed. Therefore, to provide a simple introduction, we have to restrict

our scope even more substantially than in previous chapters. We do not
discuss the time-dependent aspects of Green’s function theory and, consequently, lose the physically appealing interpretation of these functions as
propagators. Moreover, we do not consider two-particle MBGF’s, which
describe the excitation spectrum of an N-electron system. Hence, the oneparticle prefix will be implicit when we talk about MBGF’s. Finally, we
will not discuss the fact that MBGF’s, in addition to describing ionization
and electron capture, contain information about the one-particle density
matrix and ground state energy of an N-electron system. Nevertheless, we
hope that our treatment will give you some feeling for Green’s functions
and serve as a first step towards more advanced discussions.
We begin this chapter by showing how Green’s functions naturally arise
in the solution of certain inhomogeneous differential equations. We then
380

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

381

discuss the properties and the use of these functions in the quantum mechanics of single-particle systems. In Section 7.2, we consider a many-particle
system within the framework of the Hartree-Fock approximation and introduce the Hartree-Fock Green’s function (HFGF). In Subsection 7.2.1, we
consider how to go beyond the HF approximation while retaining a singleparticle picture. We introduce an energy-dependent potential, called the
self-energy, and set up the machinery for improving on Koopmans
theorem [P’s and EA’s. In Section 7.3, we apply the formalism to minimal
basis H, and HeH*. In Section 7.4, we generalize some of the insights
gained in the previous section, and consider the relationship between perturbation theory and Green’s function approaches to the calculation of the
IP’s and EA’s of a many-electron system. Finally, in Section 7.5 we present
some illustrative calculations.

7.1 GREEN’S FUNCTIONS
SYSTEMS

IN SINGLE-PARTICLE

Suppose we wish to solve the following matrix equation for a

(E1 — H,ja=b

(7.1)

where E is a parameter, Hy is an N x N Hermitian matrix and a and b are
column matrices. The most straightforward way to proceed is to find the
inverse of the matrix EI — Ho, which we denote by G,(£),

Go(E) = (El — Hy)?

(7.2)

so that we immediately have

a= (El — H,)'b=G,(E)b

(7.3a)

a; = d (Go(E));;b;

(7.3b)

or

Note that once we have found G,(E), we can solve Eq. (7.1), given any b,
just by carrying out the matrix multiplication indicated in Eq. (7.3). Recall
that in Exercise 1.12c, we showed that G,(£) can be expressed in terms of
the eigenvalues and eigenvectors of Ho,
Hoe* = EOe*

a=1,2,...,N

as
cict*

(GE) = LE Fw

(7.4)

(7.5)

Note that each element of G,(E) “blows up” or, more technically, has a
pole at values of the parameter E equa} to the eigenvalues of Hp. We call

382 MODERN QUANTUM CHEMISTRY
'

the matrix G,(E) the Green’s “matrix” associated with the matrix Hy. As
we will see, the Green’s function for a differential equation is simply a continuous generalization of this matrix.
Exercise 7.1 Suppose we have a matrix H which is

H=H,+V
Show that the associated Green’s matrix

G(E) = (E1 — H, — V)"!
obeys the equation

G(E) = G,{E) + Go(E)VG(E)
Suppose we wish to solve the following
equation for a(x)

inhomogeneous

(E — #o)a(x) = B(x)

differential

(7.6)

where E is a parameter and %) is a differential operator which is Hermitian.
Note that the equation which determines the first-order wave function in
Rayleigh-Schrédinger perturbation theory is of this form (see Eq. (6.9)). If
we know the eigenfunctions and eigenvalues of %

Ho (x) = ED Ax)

(7.7)

we can expand both a(x) and b(x) in terms of these as

a(x) = ¥ a,x)

(7.8)

B(x) = ¥) bw)

(7.9)

The coefficients {a,} are to be determined. Since b(x) is given and the set
{y,{x)} is orthonormal, we can find b, by multiplying Eq. (7.9) by w*(x) and
integrating over all x

b, = f dx’ W*(x’)b(x’)

(7.10)

Substituting expansions (7.8) and (7.9) into Eq. (7.6) and using Eq. (7.7), we
find

Y adE — HoW(x) = Yi aE — EP W(x) = ¥) baWlx)
a

a

Multiplying both sides of this equation by W(x) and integrating, we have
afE

~~ E®)

=

by

Finally, substituting this into Eq. (7.8), we obtain

a(x) =

b

ET po vA)

(7.11)

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

383

and thus we have solved the problem. Let us rewrite this solution by substituting Eq. (7.10) for b, and interchanging orders of summation and
integration,
x)we(x’

a(x) = f dx’ B tee

,

| b(x’)

(7.12)

If we define the quantity in brackets as the Green’s function,

Ax)
a(x
Go(x, x’, E)= 2 vee)
re )

(7.13)

a(x) = f dx’ Go{x, x’, E)b(x)

(7.14)

then Eq. (7.12) becomes

Thus if we can find Go(x, x’, E), then we have reduced the problem of solving

the inhomogeneous differential equation (Eq. (7.6)), containing any function
b(x), to an integration (Eq. (7.14)). Note the similarity with the matrix
problem discussed in the beginning of this section (compare Eq. (7.14) with
Eq. (7.3b) and compare Eq. (7.13) with Eq. (7.5)). We see that, as before,
G,(x, x’, E) has poles at values of E equal to the eigenvalues of #.
Let us now find the differentia] equation obeyed by Go(x, x’, E). Notice
that if we let b(x) be the Dirac 6 function,
b(x) = d(x — x’)
then Eq. (7.14) gives
a(x) = fax” Go(x, x”, E)6(x’ — x”) = Go(x, x’, E)

Thus the required differential equation is
(E — H#)Go(x, x’, E) = d(x — x’)

(7.15)

The matrix analogue of this is simply

(El — H,)(E1 — Hy)* =
Exercise 7.2 Consider the differential equation
dz

Bae tey= 6)

asxsB

Find a(x) by using the appropriate Green’s function.

a. Convince yourself by a graphical argument that d?/dx? |x|, where |x| is
the absolute value of x, is proportional to the Dirac 6 function, i.e, show
that it is zero for all x except x = 0 where it is infinity.

384 MODERN QUANTUM CHEMISTRY

b. Evaluate the constant of proportionality by integrating both sides over x
and thus show that

c. From this it follows that
dz

aa al

— x'|) = d(x — x’)

and thus the Green’s function corresponding to the operator d?/dx? is

4|x — x’|. So from Eq. (7.14) we have

a(x) = ; f * dx’ |x — x'|b(x’)
Verify, by simple differentiation, without using the result in (b), that this
is a solution of the above inhomogeneous differential equation.
Suppose that we have an operator

KH = H+

¥(x)

and we know the Green’s function associated with 3%. To find the Green’s
function corresponding to #,
(E —

4%

— ¥(x))G(x, x’, E) = d(x — x’)

(7.16)

we rewrite Eq. (7.16) in a form identical to Eq. (7.6)
(E — #)G(x, x’, E) = 6(x — x‘) + V(x)G(x, x’, E)
Hence, the solution is immediately given by Eq. (7.14),

G(x, x’, E) = fax" Golx, x", E)[d(x” — x’) + V(x" G(x", x’, E)]
or after carrying out the integration involving the 6 function
G(x, x’, E) = Golx, x’, E) + fax" Golx, x”, EY (x’)G(x"", x’, E)

(7.17a)

Because the unknown function G(x, x’, E) appears under the integral sign,
this is called an integral equation for G. Note that it is the continuous
analogue of the result obtained in Exercise 7.1 for matrices,

G(E) = G(E) + GolE)VG(E)

(7.17b)

In fact, Eq. (7.17b) is just the matrix representation of Eq. (7.17a) in some

complete orthonormal basis. If we can solve the integral equation (7.1 7a) for
G, we can obtain the eigenvalues of 2+ % by finding the values of the
parameter E for which G blows up.

THE ONE-PARTICLE MANY-BODY

GREEN’S FUNCTION

385

Finally, we rederive Eqs. (7.17a) and (7.17b) using abstract operator
notation. We let
GE)

=(E-

Hy)

*

GE) =(E- #%-V)*

so that

(ME))"' = E~ H—-V

=(GE))'- Vv

(7.18)

Multiplying this on the left by ,(E) and on the right by #(E) and rearranging
we have

GE) = GlE) + G(E)Y BE)

(7.19)

We now give a simple example of the formalism developed so far.
Consider a particle moving in one dimension under the influence of an
attractive Dirac 6 function potential located at the origin,
V(x) = —4(x)

(7.20)

We wish to find the bound state eigenvalues by first calculating the freeparticle Green’s function G(x, x’, E), then solving the integral equation
(7.17a) for G(x, x’, E) and then, finally, finding the values of E for which
G(x, x’, E) blows up. Since # = —4d?/dx?, Eq. (7.15) becomes

E

a’
GGol x, ", E)=6
+ 51 Get)
B) = (x
~ x),

(7.7.21
21)

This equation is most easily solved by first Fourier transforming it and then
evaluating the inverse transform by contour integration.! The result is
1

Go(x, x’, E) = ip?

exp(i(2E)'7[x — x’[)

(7.22)

where |x| is the absolute value of x.
Exercise 7.3 Show that the result in Eq. (7.22) does indeed satisfy
Eg. (7.21). To do so you will need the relation obtained in Exercise 7.2b

and should convince yourself that (d/dx |x|)? = 1 for all x.
Substituting Eq. (7.20) into Eq. (7.17a) we have

G(x, x’, E) = G(x, x’, E) — fax” Go(x, x”, E)d(x’) G(x”, x’, E)

= G(x, x’, E) ~ Go(x, 0, E)G(O, x’, E)

(7.23)

Note that the integral equation has reduced to an algebraic equation. To
solve it, we need to know G(0, x’, E) on the right hand side. So setting x = 0,
we have

G(0, x’, E) = G,(0, x’, E) — Go(0, 0, E)GQO, x’, E)

(7.24)

386

MODERN

QUANTUM

CHEMISTRY

Solving this equation for G(0, x’, E) and substituting the result back into
Eq. (7.23), we find
G(x, x’, E) = G(x, x’, E) —

G(x, 0, E)G,(0, x’, E)

1+ G,(0, 0, E)

(7.25)

Using the result for Go in Eq. (7.22), we have

1

.

,

GO, x E) = pin (ap (EYP — x)

i(2E)*/?(|x}

+

|x’

ae)

Finally, note that the only nonzero value of E for which G blows up occurs

when i(2E)1/? = —1, so that E = —1/2 is the energy of the only bound state.

This result is an example of a general theorem that in one dimension any
attractive potential has at least one bound state.

Exercise 7.4 From Eq. (7.13) as applied to G(x, x’, E) it follows that

lim (E — E,)G(x, x’, E)
PAXIPR(x') = E-E,
where ¢,(x) is the normalized eigenfunction of # with energy E,,. For the

attractive 5 function potential, show that (x) = exp(—|x\).

Exercise 7.5 Verify that (x) = exp(—|x|) is indeed an eigenfunction of
12

= ~9 gzO09)
with eigenvalue —} by calculating #¢.
Exercise 7.6 Consider the use of Green’s functions in time-dependent
quantum mechanics. The time-dependent Schrodinger equation is
O(x, t)

a

OO)

a. Given that G(x, x’, t) is a solution of the Schrodinger equation
i OG(x, x’, t)
= HG(x, x’, t)
ot
where # operates on the coordinate x, subject to the initial condition
that att = 0
G(x, x’, 0) = d(x — x’)
show for any y{x), that
(x, t) = fax G(x, x’, thi(x)
satisfies the time-dependent Schrédinger equation and ¢(x, 0) = y(x).
Thus given an arbitrary initial wave function (x), we can find the wave

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

387

function at a later time by using this equation. In this sense, G(x, x’, t)
“propagates” the initial wave function through time and hence is called
a propagator.
b. To make connection with the theory discussed in this section, show that

G(x, x’, E) = lim (—i) {e dt e'¥e-"G(x, x’, t)
e>0

-i {r dt eF'G(x, x’, t)
is a solution of

(E — #)G(x, x’, E) = 6(x — x’)
The parameter e(e > 0) is a convergence factor which is set equal to zero
at the end of the calculation. Hint: First multiply both sides of the dif-

ferential equation obeyed by G(x, x’, t) by —ie“=~™ and integrate over t,
and thus obtain

dG(x, x', 0) _

lim {~ dt et" P42
ée70

JO

at

=~ G(x, x’, E)

Then integrate the left-hand side by parts to show

lim [eG
e>0

x’, ae —(iE—8) f © dt eE-G(x, x, a] = #G(x, x’, E)

c. Redo this problem using abstract operator notation. Manipulate operators as if they were numbers. First, show that Y(t) =e '* satisfies the
differential equation

8ai= Gt) = #90)

Then show that

HE)=-—i}—ilim fg * ate iEt e~ ,~ #912)
1
E—-#

7.2 THE ONE-PARTICLE
GREEN’S FUNCTION

=(E-— #)5

MANY-BODY

We have seen that in single-particle quantum mechanics the Green’s function
has poles at values of E equal to the eigenvalues of the Hamiltonian. To
generalize Green’s function theory to many-particle systems, we first con-

sider an independent particle description, such as the Hartree-Fock (HF),

388 MODERN QUANTUM CHEMISTRY

where

Ho =¥. $i)

(7.26)

In the HF approximation for an N-particle system, we obtain a set of spin
orbitals and orbital energies by solving the eigenvalue problem
Sulx) = €x,(x)

(7.27)

Because the y’s and e’s are single-particle quantities, in analogy with Eq. (7.13),
it is natural to define the Hartree-Fock Green’s function (HFGF) as

Golx, x’, E)=

i(x)yr
(x)
rE -

(7.28)

where the summation runs over both occupied and unoccupied spin orbitals,

Golx, x’, E)= 5 td)
mat) +¥ mesic)
Me ©)

(7.29)

vr

The matrix representation of the HFGF in the basis of HF spin orbitals is
64

(GolE)); = f { dx dx! y#(x)Go(x, x’, E)y,(x’)= Es,

(7.30)

Thus

GE)

= (El — e)7!

(7.31)

where e is a diagonal matrix containing the HF orbital energies. From now
on when we talk about MBGF’s we will mean the matrix representations of
these functions in the basis of HF orbitals of the N-particle system. G,(E)
has poles at values of E for which the inverse (E1 — 2)! does not exist
(e., it is infinite). The inverse of a matrix does not exist when its determinant

is zero. Thus G,(E) has poles for values of E for which

det(E1 — 2) =
Since e is a diagonal matrix, we have

det(El — e) = [](E- 2) =0
So that the HFGF

has poles at the Hartree-Fock orbital energies. This

result is also evident from Eq. (7.30).

Recall that Koopmans’ theorem says that these orbital energies are
related to the ionization potentials and electron affinities of an N-particle

system. In particular, if |"¥> is the Hartree Fock wave function for the
N-particle system and |*~',> is an approximate wave function for the

(N — 1)-electron system obtained by removing an electron from spin orbital

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

389

c, then

—IP = 6, = (W[a¢ ("Po
Similarly

—EA = 6, = CNT

— <8 He

|S

ENT PTY — Op LH

(7.32a)

O>

(7.32b)

where |**'"> is an approximate wave function for the (N + 1)-particle
system obtained by putting an electron into spin orbital r. As we discussed
in Chapter 3, the orbital energies do not give the exact IP’s and EA’s because
of two distinct effects. First, |Y~'.> and [¥*'’> are not the HF wave
functions of the (N — 1)- and (N + 1)-particle systems since they contain the
spin orbitals of the N-particle system. In general, the HF orbitals of the
N —1, N, and N + 1 systems differ. Thus the HF energy of, say, the (N — 1)particle system, which was obtained by removing an electron from the spin
orbital c, is

NTE (Cc) = C87 BISA HD + YE R(C)

(7.33)

where “~'E,(c) is called the relaxation energy. Second, the correlation
energies of the N and N + 1 systems must be included,
"Eo

=

“Eo

+

” E corr

(7.34a)

and for the(N — 1)-particle system with an electron in spin orbital c missing

N~160(c) = %~ 1 Eo(c) + %~ *Ecore(¢)

(7.34b)

Hence, the exact ionization potential can be written as

—IP = %& —*%"'8)(c)

= &, — N~TER(C) + (“Ecorr — ~ 'Eeors(C))

(7.35)

where we have used Eqs. (7.32a, 7.33, 7.34a,b). Thus to get the exact IP,
the Koopmans’ theorem result must be corrected by the relaxation energy of
the (N — 1)-particle system and the difference in the correlation energies
of the N- and (N — 1)-particle system. The situation for electron affinities
Is analogous.

7.2.1

The Self-Energy

We have seen that the HFGF (G,(E)) has poles at values of E that approximate the energy differences between the N and the (N + 1)-particle systems
(i.e., at the orbital energies). It is not difficult to believe that the HFGF is an
approximation to an exact MBGF, G(F), which has poles at the exact
energy differences

between

the N and

the (N + 1)-particle systems. While

the “one-body” GF of Section 7.1 has poles at the eigenvalues of a Hamiltonian, the “many-body” GF has poles at differences between eigenvalues.

390 MODERN QUANTUM CHEMISTRY

If we could obtain G(£), or at least a better approximation to it than G,(E),
then we would be able to improve upon Koopmans’ theorem IP’s and EA’s
while retaining the one-particle picture associated with HF theory. At first
glance it does not appear possible to construct an exact one-particle theory
since the many-electron Hamiltonian contains two-particle interactions.
F. Dyson surmounted this apparent difficulty by mtroducing an effective
potential which was energy dependent, called the self-energy. Moreover, he
showed that the exact G(E} obeys the integral equation (now called the
Dyson equation):

G(E) = G,(E) + Go E)X(E)G(E)

(7.36)

where X(F) is the matrix representation of the exact self-energy in the basis
of HF spin orbitals. Finally, various terms in the perturbation expansion
of X(E) can be generated,

L(E) = LE) + LOWE) 4 + -

(7.37)

In particular, the matrix elements of the second-order self-energy ({@(E))
are

52k) = ; yr <rs| |ia>
< jal |rs> ; 1 yr <ab| |ir>< jr| |ab>
as E+

&,—

&

—

&

2

E +68,

—&—

&

(7.38)

We shall spend the rest of this chapter trying to get a feeling for this rather
unusual formalism. Comparing the Dyson equation (Eq. (7.36)) with Eggs.
(7.17) and (7.19} we see why L(E) is called an energy-dependent

potential.

It should be stressed that the above formalism is exact; that is, if we use the
exact £(E) and solve the Dyson equation for G(£), then G(E) will have poles
at the exact IP’s and EA’s of the N-particle system. Of course, one has to
make approximations and in GF theory one approximates the self-energy.
If 2(E) = 0, then G(E) = G,(E). As can be seen from Eq. (7.37), the lowestorder correction to X(E) occurs in second order of perturbation theory. This
is similar to many-body perturbation theory, where the first correction to
the HF energy also occurs in second order. In fact, by comparing the ex-

pressions for Ef? (see Eq. (6.72)), and for 2{7(E) (see Eq. (7.38)) we can see

certain common features, i.e., there are two antisymmetrized matrix elements
in the numerators and both have single term denominators containing some
orbital energies. In Section 7.5, we shall investigate the relationship between
GF theory, using £'?(E), and second-order perturbation theory for the calculation of ionization potentials. One of the most attractive features of
the MBGF formalism is that the dimensionality of all the required matrices
is equal to the number of HF spin orbitals. Thus this formalism generalizes
HF theory while retaining a single-particle picture. This is accomplished at
the expense of introducing a potential which is energy dependent. Before
considering the MBGF formalism in more detail, we present the expression

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

391

for 2{P(E) involving summations over spatial orbitals:

EQXE) = > <rs|ia>(2< ja|rs> — <aj|rs))
ars

E+ &,—&

—

&

+ Ni2 <ab| ir>(2< jr|ab> _ <rj|ab))
abr

E

+

& — €& —

&

(7.39)
,

This form is convenient for the calculation of ionization potentials of closedshell N-particle systems.
Exercise 7.7 Obtain Eq. (7.39) from Eq. (7.38).
Exercise 7.8 The exact MBGF ofan N-particle system can be defined as
(G(E));,

= 2»

<*@olal|*~ *®,,.><"~*@,,a;/"Po>
E—-—(*&

+ yr

<*@,|a;|"*

?

E

—*~'6,,)

1O,><N*

— (**'6,

—

'@, Ja! |%®o>
"&)

where the sums over m and p run over all the states of the N — 1- and N + 1-

particle systems, respectively. |“®,>, M = N, N +1, is the exact full CI

wave function containing the HF spin orbitals of the N-particle system, of

the kth state of the M-particle system with energy “&, = (“®,|9/|"®,>.

The creation (a*) and annihilation (a,) operators add and remove HF spin
orbitals, respectively.
Show that this GF reduces to the HFGF given in Eq. (7.30) when

1. |“®o> is replaced by the HF wave function |"¥>.

2. The states of the (N — 1)-particle system are approximated by a,|"Po).
3. The states of the (N + 1)-particle system are approximated by at |").

7.2.2 The Solution of the Dyson Equation
To obtain the IP’s and EA’s of an N-particle system, we must solve the

Dyson equation (Eq. (7.36)) for G(E£) and then find the values of E for which

G(E) is infinite. Multiplying the Dyson equation by (Go(E))~'

and (G(E))"! on the right we have

(G.(E))"* = (G(E))~! + Z(E)

on the left

(7.40)

Solving this for G(E), we find

G(E) = ((Go(E))" * — X(E))"* = (El — @— X(E))“*

(7.41)

where we have used the definition of G,(E) given in Eq. (7.31). Since the

inverse of a matrix

does not exist when

its determinant

is zero, we must

392 MODERN QUANTUM CHEMISTRY

determine the roots of the equation

det(E1 — e — X(E)) =0

(7.42)

When L(E)= 0, the roots occur at the é;'s. To find the lowest-order correction to these Koopmans’ theorem results, let us ignore the off-diagonal
elements of £(E). Then Eq. (7.42) simplifies to

(7.43)

[[ @ —«— 2,(E)) = 0
To find the correction to €,, we must solve

E=6, + %,,(E)

(7.44)

for E. This can be done iteratively by first evaluating 2,,(E) at E = e; to
obtain
&, = &; + 2,,(&)

(7.45)

and then finding «7 by evaluating 2,,(£) at E = «; and so on until con-

vergence is found. The lowest-order correction to ¢, is given by Eq. (7.45)
with the second-order self-energy,

ef = 6 + BPE)

We will analyze the results obtained using this equation in some detail.

(7.46)

7.3 APPLICATION OF THE FORMALISM TO
H, AND HeH+
A good way of developing a feeling for the way GF theory, using XE),
improves upon the Koopmans’ theorem IP’s and EA’s is to apply the
formalism to some simple cases where the exact results are known. Therefore,
we now apply the theory to minimal basis H, and HeH™. In the next section,
we shall generalize some of the insights gained here. We focus only on the
IP’s and the analysis of the EA is left for the exercises.
Recall that for minimal basis H, we have one occupied (labeled 1) and
one unoccupied (labeled 2) molecular orbital with orbital energies

&,=hy, +4,

(7.47a)

&, = hy.+ 2,2.
— Ky,

(7.47b)

The HF energy for this model is

NEo = 2hy, + Jy, = 26, — Jy,

(7.48)

while the correlation energy is

* Eco

corr

= A ~ (A? + KG,)17

(7.49)

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

393

where
A=

(62

—

1)

+

1

511

+

J22)

—

i.

+

Ky2

(7.50)

Thus the exact energy of this system is “& = “Eo +E zo,;- The exact

eigenstates of the (N — 1)}-particle system, i.e. HZ, are easily found not only
because there is no correlation in this molecule, but also because in the
minimal basis the HF orbitals of H, are also the optimum orbitals of Hy
(Le, in this model the HF orbitals of the N and (N — 1) systems are the
same and the relaxation energy is zero). This follows from the fact that the
two HF orbitals of H, have different symmetry and hence h,, = 0. Therefore, the ground state energy of H} is

N16, =hyy,

(7.51a)

while the first excited state has energy

N16, = hy

(7.51b)

Thus the exact ionization potential of minimal basis H, is
—IP

=

NE

_

N-16,

=

2hy,

+

Jay

+

oe

_

hy,

=

Ey

+

NE

oor

(7.52a)

Note that the ionization potential differs from its Koopmans’ theorem value
by the correlation energy of H,. This result is not true in general and is a
consequence of the simplicity of the model. It should be pointed out that
we have calculated a vertical IP, because we have assumed that H, and
H} have the same internuclear separation. Finally, it is possible to remove
an electron from H, and end up with an excited state of HZ. The ionization
potential for this process is
IP! = "6 — "16, = Qhyy + Jaa + “Ecorr ~

hy»

= 2ey — 2 + (2949 — Jy, — Kuz) + “Econ

(7-52b)

We will now apply GF theory to this system and compare the results
obtained with the exact answers. The second-order self-energy for this model
is easily found from Eq. (7.39) by setting all the hole and particle indices
equal to one and two, respectively (i.e. a = b = 1, r = s = 2),

1A

CANE

22(E)

Ki 12

=

LAF)

E

)

_

+

Ey

E-—

— 264

K? 12

E+e6,—26,

LYE) = TYNE) = 0

K? 12

=
=

Ey

+

2(e;

K? 12

.
_

E)

E-—e,—2(e, —€2)

53a)

7

;

(7.53b)

(7.53c)

where we have used the fact that all two-electron integrals, which do not
contain an even number of 1’s or 2’s, vanish by symmetry. Since LE) is

394 MODERN QUANTUM CHEMISTRY

a diagonal matrix, the matrix elements of G(E) calculated from Eq. (7.41)
are just
G,,(E) = (E — ¢, —29}(E))*

(7.54a)

G,,{E) =(E — &,

(7.54b)

er

(7.54c)

G,(E) = G2,(E) =

To find the IP’s and EA’s, we must find the poles of G, ,(E) and G,,(E). The
poles of G, ,(E) occur when

E—«, — X2X{E)=0

(7.55a)

Substituting the expression for £9)(E), given in (7.53a), we have

=0

(7.55b)

Before solving this quadratic equation for the two roots, let us find the
lowest-order correction to ¢,. Using Eq. (7.46), which is equivalent to setting

E equal to e, in £Y)(E), we have

=
Ki
ei, =e, + [P(e,)=e,
+ e,-@)

=6,+

N °E5(2)

(7.56)

where we have noticed that K?,/2(e,— €) is just the second-order perturbation result for the correlation energy of H, found in Chapter 6 (see Eq.
(6.77)). This is a very pleasing result. By comparing with the exact result
for the model given in Eq. (7.52a) we see that the GF formalism, using

XE), in lowest order is correcting the Koopmans’ theorem result (¢,) by

the second-order many-body perturbation energy. What happens if we solve
Eq. (7.55) exactly? The two roots of the quadratic equation are

ef = @, + ((e2 — &4)+ (ep — &:)? + K3,)")
_

Ki,

(ene oF

=€
=&

+(a4H ne Meg —— &y)
6) FED
+
o

Ki,

tag pt)

__ +)
=+ —Be,Kia
—«)°

(7.57)
:

where we have expanded the square root. What is the significance of these
two roots? Consider ¢7,,
€yy = & + ((€2 — 8) — ((€2 — &)? + K72)'”)

= 6, + NEP —

At

(7.58)

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

395

Thus, ¢;, is the negative of the ionization potential of H,. Note that the
correlation energy implicit in the full GF treatment, using £@(E), has the
same form as the exact result in Eq. (7.49). The difference is that in the GF
result A is simply (¢, — ¢,) (see Eq. (7.50)). The perturbation expansion of
this correlation energy is exact in second order and also contains approximate higher order terms, What is the significance of the other root ef,?
Exercise 7.9 will ask you to show that it is an approximation to the energy
for an electron capture process in which H> ends up in an excited state.
Exercise 7.9 Consider the (N + 1)-particle system, Hz.

a. Show that in the minimal basis description
Ne Eo

~

XE

=

&y—

NEcor

N+16,

— Bq = 2b. ~ &) + Jo2 + Kyo — 242) — “Ecore

b. Show that ef, (see Eq. (7.57)) approximates %*+'&, — %&>.
c. Show that the poles of G,,({E) occur at

ef, = €, — ((€2 — &:)¥ ((€2 — &4)? + K?2)"”).

d. Show that e3, approximates "*'&, -- %& while 2, approximates “6, —
N-1¢ (see Eq. (7.52b)).
Exercise 7.10 The matrix elements of the third-order self-energy, 2 (E),
for minimal basis H, are

ME)

LEXE

Ki 22 ~— 22+

(ED te?

Ky.) | KiASi, — 2y2 + Ki2)

* (E— 2 + ee, — 0)

, Kiki.
Kia — Ju)
A(e, — &,)?

EXE) = Ki(2J42 — Ky2 — Jai) +| Ki 22 — ia + Ki2)
(E

_

26,

+

£5)"

(E

_

26;

+

&r)(Ey

_

£2)

KiAJo2 + Ky. — 2542)
*

4(e, — &)?

LOWE) = IGKE) =
Note that the third-order self-energy has an energy-independent part. Now
consider the lowest-order approximation to the first IP (ie., Eq. (7-45))

using L(E) = DOE) + LEE),
f=

8+

LYVHlEx) + ZH Ples)

396 MODERN QUANTUM CHEMISTRY

Show that the right-hand side of this equation is equal to e, + NEY + NES),
where * E®) is the third-order many-body perturbation result for the correlation energy for H, (see Eq. (6.78)). Similarly, show that the lowest-order
correction to the EA,

bp = Ez + LPHeE2) + LE)

is equal to 2, — (ME? + “EY). Thus for this model, the correlation energy

implicit in the GF formalism, using a self-energy correct up to third order
and the simplest approximation for finding the roots, is just the manybody perturbation result up to third order.
We now consider the application of GF theory to minimal basis HeH*.
This is a slightly more complicated and hence a more interesting system
because the HF orbitals of HeH* are not the optimum orbitals of HeH?*
(i.e., the (N — 1}-particle system). Since in HeH* one cannot classify the HF
orbitals as gerade or ungerade, h,, does not vanish by symmetry. In fact

hy = —€11]12)

(7.59)

since fi, =h,, + (11 | 12) is equal to zero. Thus the ground state energy of

HeH?* is not h,,, but can be written as

NV = hy, + NOE,

(7.60)

where *~'Ep is called the orbital relaxation energy. Since the exact energy
of HeH* is

(7.61)

N8q = NEo + “Ecorr = 2hi1 + S11 + “Ecore

and the negative of the tonization potential of HeH* is
N89— N16

= hy

+ “Ecorr—*~'Eg

— hy —'Ep=61
tay + “Eco

(7.62)

Thus the exact IP differs from the Koopmans’ value because of: 1) the correlation in the two-electron system and 2) orbital relaxation in the one-electron
system.
We now derive an approximate expression for “~ ‘Eg. To find the exact
ground state energy for HeH?* in the minimal basis, we must solve the
eigenvalue problem
hy,

(pe

hy2\f1

ho)\e

=

N-1

NE

Ne

1

63

(7.63)

Using Eqs. (7.60), (7.59), and (7.47a, b) and proceeding in the standard way,
it can be shown that Eq. (7.63) leads to

}<11] 12>)?

N-IFI=

8 — €2 ~ Jy

— 2542 + Kya) +

Noa

Ep

(7.64)

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

397

Instead of solving this equation exactly for ‘~'E,, we obtain the following
approximate expression
N~1 FQ)

[<1 |12>??

(7.65)

&; — &2

by ignoring *~'E, and the two-electron integrals in the denominator. It is
clear from the form of this expression that it can be obtained from some sort
of second-order perturbation theory. In the next section, we clarify just what
sort of perturbation theory.

Exercise 7.11

Derive Eq. (7.64) from Eq. (7.63).

We now apply GF theory, using £@(E), to HeH*. From Eq. (7.39) by
setting a= b= 1 andr
=s = 2, we find
x?

E

HE)

LE

226)

QE)

Note that ££)

=

LYNE)

K?,

}<11] 12>]?

E + 6, — 26, +E +6, — 28
22} 12>|?

K?

E+e,—2e,'

Ete,—2y

IK

K 12422]

12>

{1

+

E+eé,—28,

(7.66a)

12

1]12)K
»
|

(

7.66b

)

(7.66c)

12

E+6€,— 28,

is not zero as it was for H,. Instead of calculating G(E)

using Eq. (7.41), which involves inverting a two-by-two matrix, we find the
lowest-order correction to the Koopmans’ IP using Eq. (7.46), Le.,

é =e, + LYE) = ey +

Kin

\<11]12>|?

2(€1 — &2)

&; — &2

Note that K?,/2(e, — €5) is the second-order energy for HeH*

(7.67)
(NEY?) and

|<11| 12) P/(e, — €,) is the approximate expression for the relaxation energy
of HeH?* (*~ 1) in Eq. (7.65). Thus

ey, = 6, + NED — N-1EQ

(7.68)

Comparing this with the form of the exact result in Eq. (7.62), we see that
GF theory, using £E), takes into account both the correlation energy of
the N-particle system and the orbital relaxation energy of the(N — 1}particle
system. When the simplest approximation is used to find the poles (i.e., Eq.
(7.46)) these effects are included to second order in perturbation theory. If
we were to solve the Dyson equation for G(E) and then determine the poles
exactly, these effects would be approximately treated in higher orders. Since
we considered only two-electron systems in this section, we were not able to
determine whether the GF method also takes into account correlation in

398 MODERN QUANTUM CHEMISTRY

the (N — 1)-particle system.
account for this effect.

In the next section we shall see that it does

Exercise 7.12 Consider the EA of HeH*.

a. Show that the exact ground state energy of HeH is
N+t6,

=

where ‘+E, is a solution of

0

6)

+

XEo

<12}22\/1\

<12|22>

D

+

N+lE

were

c

(2

c

where
D=e,

—

&,

~

22+

Ky.

+

Jo2

b. Then show that
}<12}22)}?

=

N+ ip)

&;
— &2

is an approximation to the relaxation energy.
c. Finally show that
ro

2

_

£2 = &2 + LHe.) = €2 +

7.4 PERTURBATION THEORY
FUNCTION METHOD

AND

N+17(2

EX?—

Np)

NEG?

THE GREEN’S

In the previous section we studied two very simple two-electron minimal

basis problems using GF theory with £E).

We saw that the simplest

correction to &,, iLe., £42(e,) includes both the effect of correlation in the twoparticle system and orbital relaxation in the one-particle system. Moreover,
we found that the magnitudes of these effects were precisely what one would
expect from second-order perturbation theory. We would like to know:
1) if our observations hold for two-electron systems described by larger
basis sets and 2) if for larger systems GF theory accounts for correlation in
the (N — 1)-particle system.
In this section we will establish the relationship between the simplest
approximation in GF theory for the energy required to remove an electron
from spin orbital c,

IP = 6h = 6, + EP (@,)
=6, +3

2

__|<rs|lea>)?

ars &g +

&, —

&

—

&y

, 3

|<ab]ler>|

abr &¢ + & —

(7.69)

2

Eq —

Ep

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

399

and perturbation theory. Since the analysis is somewhat involved, it is
appropriate to present the result before the derivation. For the N-particle
system, we choose

our unperturbed

Hamiltonian

as the HF

and calculate the energy up to second order
NEO

1+ 2)

_

NEO

+

NEW

+

Hamiltonian

NEW)

= NE, + XE

(7.70)

using the formalism presented in Chapter 6. We represent the zeroth-order
wave function of the (N — 1)-particle system by a Slater determinant obtained
by removing

spin orbital c from the HF

wave function of the N-particle

system, i.e, |’~'W,>. Note that this is not, in general, the HF wave function

for the (N — 1}particle system since it contains the HF spin orbitals of the
N-particle system. Then we partition the total Hamiltonian of the (N — 1)particle system into an unperturbed and perturbed part in such a way that

|“ *,>

is an eigenfunction of the unperturbed Hamiltonian. Using this

partitioning, we calculate the energy of the (N — 1)-particle system up to
second order,

N-VFO+1

+ 2H)

=

N-3 EO)

+ N-1 EW)

+

N~1 EQ) ¢)

(7.71)

The tildes serve as a reminder that we are not doing perturbation theory
‘Starting with a HF Hamiltonian. Finally, we shall show that
é =é+

x0) é) =

NEO +142)

_

N-3 FAO +1 +20)

(7.72)

which is the main result of this section. In addition, we shall see that the

derivation suggests a simple physical interpretation of the various terms
that contribute to £2e,). The above result goes some of the way towards
demystifying the GF formalism. It shows that the simplest possible approximation in this formalism yields an answer which is identical to the result
given by the simplest form of perturbation theory (ie., second-order using
the HF orbitals of the N-particle system for both the N- and (N — 1)particle systems).
To establish our notation, we briefly review HF perturbation theory for
the N-particle system (see Chapter 6). We choose the unperturbed Hamiltonian, 37%, as the HF Hamiltonian,
N
HS = ¥ (hi) + HH)
(7.73a)
i=4

and hence the perturbation is
N

WN=PVrgt—
i<j

N

Y vr

(7.73b)

— Prrdlae(2)>

(7.73¢)

i=1

where the HF potential is

oy(i) = » <xo(2) [riz

400 MODERN QUANTUM CHEMISTRY

with the sum running over all occupied HF spin orbitals of the N-particle
system. The Hartree-Fock wave function

SWo> = |ab---c-—lec+1-->

(7.74)

is an eigenfunction of #4
Hh|"% o> = NEON)

= Y e.|\Po>

(7.75)

The first-order energy is

NED)= WHF > = -5 2, <ab] |ab>

(7.76)

and the second-order energy is
NEV)

x

OP

|e oly * >?

SPO

—

<n\xN\n>

ty [oly Mee? _ 1
4 cars

y |eF
ol ¥* n>?

&q + & — & — €s

-

NEO)

_

NEO)

_ cab rs?

4 oirs 8a + & — & — &s

(7.77)

Recall, that in calculating the second-order energy the intermediate states,

|n>, exclude single excitations of the form

|")

because of Brillouin’s

theorem. In this section, we always use a, b,... to label the orbitals which
are occupied in the N-particle system and r, s, . . . to label orbitals which are

unoccupied in this system.
For the (N — 1)-particle system, we choose the unperturbed
tonian, #73~', as

HN) = > (h(i)
+ vEFi))

Hamil-

(7.78a)

so that the perturbation is

t=

N-1

N-1

i>j

i=1

yt

¥ vw

(7.78b)

It is important to note that our zeroth-order Hamiltonian for the (N — 1)-

particle system contains the HF potential of the N (not the N — 1) particle
system. We have chosen this partitioning so that the (N — 1)-particle wave
function, obtained by removing spin orbital c from the HF wave function
of the N-particle system,
|X.)

=lab---c-1c+1-->

is an eigenfunction of #37 ',

2319) = BOQ) = De
ate

(7.79)

(7.80)

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

401

The tilde on the zeroth-order energy serves as a reminder that, since #7"!
is not the HF Hamiltonian of the (N — 1)-particle system, we are not doing
standard HF perturbation theory. In particular, Brillouin’s theorem does
not hold for the (N — 1)-particle system, so single excitations will contribute

to the second-order energy, "~ 1 Ec), of this system. We have chosen the

above zero-order Hamiltonian so that the terms in perturbation expansion
for the energy of the (N — 1)-particle system contain two-electron integrals
and orbital energies of the N-particle system. Consequently, since we are
interested in the difference between energies of the N and (N — 1)-particle
systems, we will be able to explicitly cancel terms in the two perturbation
expansions, which result from correlation effects common to the two systems.
Note that since the difference between the zeroth-order energies of the
N and (N — 1)-particle systems is e,
NED) — NEO)

=Yieg—

Yt

=k

(7.81)

atc

a

It then follows from Koopmans’ theorem

be = CN ION Hy) — CANE IGEN HINTED
«= (MED + NES) — (SEDC) + S1ESC))

that the first-order energies of the N- and (N — 1)}-particle systems must be

equal (ie, YEW = %—1£0(c)). Thus to find the lowest order correction to

the Koopmans’ theorem IP, we must find the difference between the secondorder energies of the two systems.

Exercise 7.13 By explicitly evaluating <Y-'WJy%~"}"— 1.) (see Eqs.
(7.78b) and (7.79)) show that it is equal to “EG.
The second-order energy of the (N — 1)-particle system is
_

N~ Ip

YW

Mn]?

ONO = 2 TE EINE — GnaeEnp

N-1p2y 6) —
_

IK

x

\cn-

wp lyn

c

‘In>|?

(7.82)

wD, &a— nq *|n>
ate

where the sum runs over all states of the system except |“~'W,>. There are
three types of excitations which contribute to the sum.

1. Single excitations f—'¥.">.

If #37!

were the HF Hamiltonian of the

(N — 1)-particle system, such excitations would not contribute because of

Brillouin’s theorem. The effect of these single excitations is to improve upon
the occupied orbitals of the (N — 1)-particle system (which are the HF orbitals
of the N-particle system) by making them closer to the optimum orbitals;
ie, they allow

the orbitals

to “relax.” The

resulting

contribution

to the

402 MODERN QUANTUM CHEMISTRY

second-order energy, denoted by *~!E"), can be shown to be

me

N-1k

r

_

)

[XI

)

IVA?

atc

&g —

&

|<ac| |er>/?

ate

&| —

&,

2

(7.83)

‘ede
-2 Kceeller9[°

where in the last step we used the fact that the antisymmetric matrix element
is zero when a = c. Note that this quantity is always negative.
Exercise 7.14 Show that for minimal basis HeH* , Eq. (7.83) is equivalent

o *~'E® given in Eq. (7.65).

2. Double excitations |N~ "77>.

These are just the usual types of exci-

tations which occur in HF perturbation theory of the N-particle system,

except that a and b cannot equal c. Thus we have

| <ab| |rs>|?
N-1 (2)
=- 1 y _Weus7t
B (4)
4 atc
2 &q + & — &, — &y
b#¥c
rs

This can be rewritten in terms of the second-order energy of the N-particle

system (i.e., Ei?) as

vaga()_ty
ab

Kelle 1p _KearP

4 dors &a +

= NEI 4
Eo

by — & —

bs

2 ors &, +

&, —

& — &,

2

+52

784

__KkesifeayP

+ & — by — &

(7.84)

Note that this contribution is always less negative than the second-order
energy of the N-particle system.
3. Double excitations |X" '¥,%>. These excitations are possible in the
(N — 1}particle system since there is no electron in spin orbital c (ie. c is a
virtual or particle orbital in the N — 1 system). It can be shown that these
excitations make the contribution
N- ‘B15

3 ->y

\<x-

2 ose
b¥c

=--)

€g

1
2

tw lyn

—
b#e

+

&

4/R- twee?
—

&

—

&

|<ab| Jer>]?

te

7%

r

to the second-order energy. Note that this term is negative.

(

7.85

)

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

403

Finally, combining all these terms, the difference between the secondorder energies of the N- and (N — 1)-particle system becomes

NEQ)—N~1
BQ) = NE(2)_|

N~1 £2)

|<ac| |cr>|?
=2

&

~

&4

r
a

4 N-1 BQ) cr
ab

1
+7

4 N-1 EQ)

\<ab|\cr>|?_
Dd

bec

46

—0,-&

1
12

rs
ab

{<rs} |ca>|?
Yate,

6,

2,

(7.86)
which, upon combining the first two terms and comparing with Eq. (7.69),
can be seen to equal £{) (¢,). This completes the proof of the relationship
between perturbation theory and the simplest approximation in GF theory
that was stated in the beginning of this section.

Exercise 7.15 Fill in the missing steps leading to Eqs. (7.83), (7.84) and

(7.85).

L

Now that we have quickly dispensed with the algebra, we will consider
the physical interpretation of the three terms shown in Eq. (7.86), that make
up £2 ¢.). For the purposes of the discussion, it is convenient to express

our

results

(IP) koopmans

as

a correction

to

the

Koopmans’

theorem

IP,

ie,

IP =

+ AIP, where

apy kode? 1 y Katler? 1 Kelle?
&q

bc

atc

© +E,

Eg

Ey

2 os &, + &,—~—&,
— €,

r

(ORX)

(PRX)

(PRM)

(7.87)

The acronyms representing the algebraic expressions will be explained below.
The first term (ORX), which is always negative, arises from the presence of
single excitations a@— r in the second-order energy of the (N — 1)-particle
system. Because of Brilfouin’s theorem, such excitations would not have
contributed if we had used the HF orbitals of the (N — 1)-particle system.
Their effect is to optimize or relax the orbitals we did use (i.e., the HF orbitals

of the N-particle system) and hence this term is said to arise from orbital
relaxation (ORX). Since it lowers the energy of the (N — 1)-particle system
relative to the “frozen” orbital approximation, it decreases the Koopmans’
theorem IP. Consider the second term (PRX), which is also always negative.
.
.
ar
a>c.
This term arises from double excitations of the type b
in the second-order
Fr

energy of the (N — 1)-particle system. Such excitations do not occur in the
N-particle system because c is occupied. Thus this term accounts for extra
correlation in the (N — 1)-particle system due to the presence of an additional

404 MODERN QUANTUM CHEMISTRY

virtual orbital. Using the language of pair theory, we can say that a given
pair of electrons in spin orbitals ab in the (N — 1)-particle system can correlate (in a way not possible in the N-particle system) by being excited into
the virtual orbital c. Thus in analogy with orbital relaxation, this effect can
be called pair relaxation (PRX). Note that both these effects stabilize the
(N — 1)-particle system and hence decrease the ionization potential. Finally,
consider the last term (PRM), which is always positive. This represents the
additional correlation in the N-particle system due to the presence of an

extra electron. Since we have removed an electron from spin orbital c, pair

correlation energies involving this spin orbital are absent in the (N — 1)particle system. Hence the N-particle system (which has a larger number of
correlating pairs) is stabilized relative to the (N — 1)-particle system. The
corresponding increase in the IP can be said to result from pair removal
(PRM). The above interpretation is due to Pickup and Goscinski.?
In Table 7.1 we have summarized the results of this analysis. Single
excitations of the type a— r contribute only to the second-order energy of
the (N — 1)-particle system. Their effect is to stabilize the (N — 1)-particle
system relative to the “frozen” orbital approximation implicit in the Koopmans’ theorem IP and thus they tend to decrease the IP. Excitations of the
ar

.

.

type bos’ where neither a or b are equal to c, are present in both systems
and their effect exactly cancels in second order of perturbation theory. The
o,

ue

ac

excitations bor
—

:

:

however, occur only in the (N — 1)-particle system and

change the IP in the same direction as single excitations. Finally, double
°

.

excitations of the type

c—r

contribute exclusively to the second-order

bos
energy of the N-particle system. Since they stabilize the N-particle system

Table 7.1 Contributions of various excitations to the second-order energies
of the N- and (NV — 1)-particle systems
Excitation

N

N-1

Effect on Koopmans’ IP

Name

:
Orbital relaxation (ORX)

a>r
ate

x

vY

Decrease

aor
bos

~

~

None

4 7e
or

x

~

Decrease

Pair relaxation (PRX)

cor

~

x

Increase

Pair removal (PRM)

a#xb#c

bos

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

405

relative to the (N — 1)-particle system, they tend to increase the Koopmans’
theorem IP. Thus the simplest approximation in GF theory incorporates,
at least qualitatively, all the physical effects that are missing in the “frozen”
orbital approximation. In the next section, we will present the results of
calculations on a variety of systems to see how well this simple approximation works quantitatively.

7.5 SOME

ILLUSTRATIVE

CALCULATIONS

In this section, we present numerical results for the correction to the Koopmans’ vertical ionization potentials of H,, N2, and the ten-electron series

(CH,, NH3, H,0, and FH), calculated using the simplest possible approximation of GF theory, i.e., Eq. (7.46). It is important to note that these calcu-

lations are illustrative and do not reflect the full power of the GF approach.
We will see that, while GF theory at this level changes the Koopmans’ IP in
the right direction and, in eases such as N,, rectifies the incorrect ordering of
the two lowest IP’s, it tries too hard. That is, if the Koopmans’ IP is greater

than experiment, the lowest order correction underestimates the experimental
value often by a larger amount than Koopmans’ theorem overestimated it.
This situation is unfortunately not uncommon in quantum chemistry. If the
simplest theory works fairly well, the first correction will sometimes make
things worse. To obtain satisfactory agreement with experimental ionization
potentials within the framework of the GF approach we must use a selfenergy, which is correct to at least third order in perturbation theory.
We begin with the application of the formalism to H,. A two-electron
system is special since the ion (e.g., HZ) has no correlation. Thus the exact

IP differs from the Koopmans’ value only because of orbital relaxation in
the (N — 1}-particle system and correlation in the N-particle system. In the
language of the previous section, there is no pair relaxation term (PRX)
since the (N — 1)-particle system has but a single electron. Moreover, in
second order, the pair removal term is just the negative of the second-order

perturbation energy of the N-particle system.
Exercise 7.16

Show

that for a two-electron

system

Eq. (7.87) is zero while the PRM term equals ~E®,

the PRX

term

m

In Table 7.2, we compare the results for the vertical IP of H, calculated

from Koopmans’ theorem and GF theory using 2), with the exact (full CI)

values in the basis. Unless otherwise indicated, all results are obtained using

the diagonal part of X
evaluated at the appropriate orbital energy. The
exact basis set results were obtained by subtracting the full CI energy of H,

and the exact energy of H} in the same basis. Note that, even for the largest
basis, there is a significant difference between the exact result in the basis

406 MODERN QUANTUM CHEMISTRY

Table 7.2 Ionization potential (a.u.) of H,
Basis set

Koopmans’

L(g)

Full CI

0.578
0.596
0.595

0.591
0.593
0.598

0.599
0.595
0.600

STO-3G
4-31G
6-31G*"*
Experiment

0.584

and experiment. This is a consequence of the fact that the 6-31G** basis for
hydrogen is far from complete. Except for the 4-31G basis, the GF results are
closer to the full CI values than the Koopmans’ theorem results. It is interesting to note that, for the larger bases, the Koopmans’ theorem result is close
to the full CI result. This arises from the near cancellation of two competing
corrections: 1) the orbital relaxation (ORX) in HZ, which tends to decrease
the IP, and 2) the correlation energy in H,, which tends to increase the IP.
This near cancellation is illustrated in Table 7.3. The exact ORX was obtained by subtracting the energy of H} calculated using the HF orbitals of
H, from the exact energy of H} in the basis. In the minimal basis description,
the optimum orbitals of H, and HZ are the same by symmetry, so there
is no orbital relaxation. The exact pair removal (PRM) contribution is simply
the negative of the full Cl correlation energy of H,. Both the ORX and
PRM contributions calculated using GF theory (see Eq. (7.87)) are somewhat smaller than the exact results. Nevertheless, for the 6-31G** basis,
the GF answer is very close to the exact result in the basis. Note that for

the 4-31G basis the Koopmans’ result is slightly larger than the exact value.
The Green’s function formalism tries to remedy this but overshoots slightly.
This behaviour of GF theory at the level of the second-order self-energy
is more striking for the lowest ionization potentials of the ten-electron series
shown in Table 7.4. At the level of 6-31G** both the Koopmans’ and GF
results appear to have converged. For all four molecules, Koopmans’ theorem
overestimates the IP’s, and in all cases the GF treatment lowers the IP too

far, so that the Koopmans’ result actually agrees better with experiment.
Table 7.3 Orbital relaxation (ORX) and pair removal
(PRM) contributions (in a.u.) to the correction to Koopmans’ theorem IP for H,
Basis set
STO-3G
4-31G
6-31G**

ORX

— 0.020
— 0.023

ORX (exact)

PRM

PRM (exact)

— 0,026
— 0,029

0.013
0.017
0.026

0.021
0.025
0.034

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

407

Table 7.4 Lowest ionization potentials (a.u.) of the ten-electron series

CH,

STO-3G

4-31G

6-31G*

6-31G**

Experiment

0.518

0.543

0.545

0.543

052

Koopmans’

(in)
EP%ey
NH, — Koopmans’

0.493
0.353

0.502
0.414

0.507
0.421

(3a,)
H,O

E%e)
Koopmans’
=e)

0.299

FH

Koopmans’

0.464

(1b,)

(in)

0.275
0.391

E%ey

0.396

7

0.331
0.500

0.510
0.421

0.388

0.352
0.498

0.394

0.353
0.497

0.628

0.628

0.627

0.507

0.395

0.509

0.509

528

O

400
0.463
.

0.581

Although the GF formalism, using £@), changes the Koopmans’ result in

the right direction, it is clearly not a quantitative theory. One must use more
accurate self-energies if satisfactory results are to be obtained.
As a final example we consider the ionization potentials of N2. As we
have seen in Chapter 3, this is a particularly interesting case, because using
large basis sets, Koopmans’ theorem is qualitatively wrong. Experimentally,
one finds that the lowest ionization potential corresponds to an ejection of
an electron from the 3a, orbital (ie., NJ ends up in a 72; state) and that it is

more difficult to remove an electron from the 11,, orbital. Koopmans’ theorem
predicts the opposite. How does the simplest approximation of GF theory
work? Table 7.5 shows that the GF approach at the level of £ yields ionization potentials that are qualitatively in accord with experiment. For the
largest basis set used, the Koopmans’ theorem result for ionization out of
the 17, orbital is raised slightly so that it is very close to the experimental

value. On the other hand, the ionization potential of the 3c, orbital is de-

creased significantly, m fact far below the experimental result. Thus we see
again, the GF approach at the level of the second-order self-energy, while
qualitatively correct, is quantitatively deficient. It is interesting to examine

Table 7.5 Ionization potentials (a.u.) of Nz
3a, orbital

in, orbital

Basis

Koopmans

<£°%e}

Koopmans

\(e)

STO-3G
4-31G
6-31G*

0.540
0.629
0.630

0.463
0.517
0.534

0.573
0.621
0.612

0.620
0.643
0.627

Experiment

0.573

0.624

408 MODERN QUANTUM CHEMISTRY

Table 7.6 Orbital relaxation (ORX), pair relaxation (PRX), and pair
removal (PRM) contributions (in a.u.) to the correction to Koopmans’
theorem IP’s for N,
3a, orbital

1x, orbital

Basis

ORX

PRX

PRM

ORX

PRX

PRM

STO-3G
4-31G
6-31G*

— 0.006
—0.051
— 0.056

—0.091
—0.098
— 0.096

+0.020
0.037
0.055

—0.001
—0.044
—0.055

— 0,008
—0.008
—0.016

0.056
0.074
0.086

(see Table 7.6) the breakup of the second-order correction into orbital relaxation (ORX), pair relaxation (PRX), and pair removal (PRM) contributions.
Consider the 6-31G* basis. For both orbitals, the orbital relaxation term is
about the same. For the 17, orbital the PRM term is somewhat larger than
it is for the 30, orbital. This means that double excitations involving the 1z,,
orbital make a larger contribution to the correlation energy of N, than
excitations involving the 30, orbital. Although this effect helps, the correct
ordering results primarily from the much larger pair relaxation contribution

for 30, orbital. That is, double excitations in which one of the electrons of

Nj ends up in the vacant 3a, orbital are much more effective in lowering
the energy of the ion than double excitations to the 17, orbital.
As an illustration of the effect of using higher-order self-energies, in
Table 7.7 we present some calculations of Cederbaum and co-workers on
N,. These calculations were done using a near-Hartree-Fock-limit basis set
of Gaussians. For the second-order self-energy, the results of two types of

calculations are shown. The first (£e)) was obtained in the same way as

the GF results in the previous tables (i-e., using Eq. (7.46)), while the second
(X?E)) was found by solving the Dyson equation, with the second-order
self-energy, exactly (i.e., solving Eq. (7.42)). The results shown for the secondplus third-order self-energy were also obtained by solving the Dyson equation exactly. For the 30, orbital, the third-order calculation raises the IP so
that the final result is reasonably close to experiment. Note that while the
second-order result undershoots, the third-order result slightly overshoots.

Table 7.7 Ionization potentials (a.u.) of N, using second- and thirdorder self-energies*
Orbita}

Koopmans’

Lee

LANE)

LONE) + LOWE)

Experiment

3a,
in,

0.635
0.615

0.538
0.626

0.546
0.626

0.584
0.613

0.573
0.624

“L.S. Cederbaum and W. Domcke, Adv. Chem. Phys. 36: 205 (1977).

THE ONE-PARTICLE MANY-BODY GREEN’S FUNCTION

409

Thus the convergence is oscillatory. For the 12, orbital, the second-order
result is fortuitously close to experiment and the third order is thus in
somewhat worse agreement with experiment. These calculations show that
in order to obtain very accurate results, one must use self-energies that go
beyond third order.
In this chapter, we have barely scratched the surface of the Green’s
function approach. This technique has been widely used, and with sufficient
effort (i.e., using sophisticated self-energies) it provides an excellent description of both valence and core ionization potentials of a large class of molecules. We hope that our introduction will help the interested reader penetrate
the literature.

NOTES
1. See for example, D. Rapp, Quantum Mechanics, Holt-Reinhart-Winston, New York, 1971,
p. 463.
2. B. T. Pickup and O. Goscinski, Direct calculation of ionization energies I. Closed shells,
Mol. Phys. 26: 1013 (1973). This article also contains a relatively simple derivation of
the expression for the second-order self-energy using algebraic rather than diagrammatic
techniques.

FURTHER

READING

Cederbaum, L. 8. and Domcke, W., Theoretical aspects of ionization potentials and photoelectron spectroscopy: Green’s function approach, Adv. Chem. Phys. 36: 205 (1977). A
comprehensive review article with emphasis on the authors’ approach but with numerous
literature references.
Fetter, A. L. and Walecka, J. D., Quantum Theory of Many-Particle Systems, McGraw-Hill,
New York, 1971. An advanced textbook for physicists.
Linderberg, J. and Ohrn, Y., Propagators in Quantum Chemistry, Academic Press, New York,
1973. A worthwhile but demanding book.
Mattuck, R. D., A Guide to Feynman Diagrams in the Many-Body Problem, 2nd ed., McGrawHill, New York, 1976. An entertaining book which discusses many-body Green’s functions
from the time-dependent point of view. Its only disadvantage to chemists is that the
emphasis is on treating infinite systems where the basis functions are plane waves.

Oddershede, J., Propagator methods, Adv. Chem. Phys. 69: 201 (1987). A concise review
of the principles and applications of Green’s functions and related approaches with
_
humerous references to the literature.
Ohrn, Y., Propagator theory of atomic and molecular structure, in The New World of Quantum
Chemistry B. Pullman and R. Parr (eds.), Reidel, Boston, 1976 p. 57. A review lecture
presented as a major international conference.
Paul, R., Field Theoretical Methods in Chemical Physics, Elsevier, Amsterdam, 1982. A

valiant attempt to treat a difficult subject in a pedagogical way. Chapter VII deals with
the application of the Green’s function method to problems of atomic and molecular
structure.

APPENDIX

A

INTEGRAL EVALUATION WITH
ls PRIMITIVE GAUSSIANS

In most molecular calculations one uses a fixed molecular coordinate system
such that the basis functions are centered at position vectors R, in this
coordinate system, as shown in Fig. A.1. The value at a position vector r,
of a function centered at R,, will depend on r — R, and we hence write a
general basis function as ¢,(r — R,) to denote that it is centered at Ry. Ina

Figure A.t- Molecular coordinate
system.

410

INTEGRAL EVALUATION WITH

Is PRIMITIVE GAUSSIANS

411

molecular calculation we will need to evaluate a number of one- and two-

electron integrals involving functions ¢,(r ~ R.4) at different centers. If we

have basis functions at four or more centers, then the two-electron integrals

will involve L-, 2-, 3-, and 4-center integrals. Nuclear attraction integrals can
involve at most 3 centers. These multicenter (more than 2) integrations are

difficult for Slater-type functions but are relatively simple for Gaussian-type
functions. Thus most polyatomic calculations use Gaussian functions.
In a Gaussian calculation the contracted Gaussian basis functions ¢{St
are normally expanded in a set of primitive Gaussian functions g = @C* (see
Eq. (3.283) or Eq. (3.212)), and thus we need only consider integral evaluation

over the primitive functions. The integrals for contracted functions g¢F

are obtained just by summing up integrals over primitives using the appropriate contraction

coefficients.

One

commonly

uses only

Is, 2p, 3d, etc.

primitive Gaussians, since any function of s, p, d, etc. symmetry can be expanded in just these Gaussians. Here we consider integral evaluations only
for 1s primitive Gaussians. Shavitt' has given a similar, but complementary,
discussion of integral evaluation methods for the Gaussian function. Integrals
involving p, d, etc. symmetry functions could be obtained by differentiating

our results with respect to the Cartesian coordinates of the centers R,, R,,
etc. However, integrals for higher angular quantum numbers are more efficiently formulated for computation using newer methods based on Rys

polynomials,”

The unnormalized 1s primitive Gaussian at R, is

Gs" — Ry) = eo tr RaP

(A.1)

We will use a, 8, y, and 6 for orbital exponents of functions centered at R ,,
R,, Rc, Rp, respectively. The reason why Gaussians simplify multicenter
integrations is that the product of two 1s Gaussians, each on different centers,
is proportional to a 1s Gaussian on a third center. Thus
Git — R491," — Re) = Kir

— Rp)

(A.2)

where the proportionality constant K is

K = exp[—aB/(« + BIR, — Rz|’]

(A.3)

The third center P is on a line joining the centers A and B,

Rp = (oR, + BRs)/(« + 8)

(A.4)

The exponent of the new Gaussian centered at Rp is

p=at+B

(A.5)

Thus for ts Gaussians any 2-center distribution, i.e., product of functions on

2 different centers, can immediately be converted to a one-center distribution.
We now evaluate the basic integrals that we need for any ab initio calculation

412

MODERN QUANTUM CHEMISTRY

that uses only contractions of primitive 1s Gaussians. We will evaluate
integrals for unnormalized functions and, if we require integrals for normalized functions, we can easily multiply by the appropriate normalization
constants.
Consider the 2-center overlap integral first

(A|B) = [dr Gusts — Ril", — Re)

(A6)

Using (A.2) we immediately have

(A|B) = K [dr, G1.(ts — Re) = K fae, expl—plts — Re]

(A)

If we now let r =r, — Rp and dr = dr,, then

(A|B) = K f dr eo? = 4nK fe dr re"???

(A.8)

This last integral is just (x/p)*/2/4z, so that

(A|B) = [x/(a + B)]*? exp[ —aB/(« + B)|R4 — Rz|”]

(A.9)

The kinetic energy integral

(A|—4V?[B) = [dey Gilt — R—$VDGrle1 — Re)

(A.10)

can be evaluated in a very similar way (after letting V? operate) to give

(A|—3V7|B) = aB/(a + B)[3 — 2a8/(a + B)IR« — Rz|7][a/(@ + )]°?
x exp[ —aB/(a + B)|R4 — Rgl7]
(A.11)
In order to evaluate the nuclear attraction and two-electron repulsion
integrals, we now introduce here a powerful and general technique that is
often useful for evaluating integrals, particularly of the type that we will be
considering. The technique is to replace each quantity in the integrand by
its Fourier transform. If we are given a function f(r) of the vector r, then its
three-dimensional Fourier transform F(k) is defined by

F(k) = f dr f(rje"*""

(A.12)

where the vector k is the transform variable. The Fourier integral theorem
states that

f(t) = (2n)-3 f dk Fikje*""

(A.13)

F(k) and f(r) are said to be a Fourier transform pair. All the Fourier transform
pairs we shall need here are given in Table A.1. In particular, the Fourier
representation of the three-dimensional Dirac delta function is

6(t, —¥,) = (2n)~3 f dk elk (1-72)

(A.14)

INTEGRAL EVALUATION WITH 1s PRIMITIVE GAUSSIANS

Table A.1

413

Fourier transform pairs

S(t)

F(k)

1

r

ar

ew?

(5)

o(r)

1

k?

o

en Bila

Recall that the Dirac 6 function has the property that

f dr, 5(t, —¥2)h(r,) = h(t)

(A.15)

for any function h(r).
Let us now consider the nuclear attraction integral for our primitive
1s Gaussians.

(Al—ZofrycfB) = [dry Gusts — Ra -Zollts — Relldssle1 — Ro)
= Ze fdr, ent Farle, — Re te“Fls “Bal?

(16)

We first combine the two Gaussians to obtain a single Gaussian at Rp,

(A|—Ze/rsB) = —ZcK [dey oP -Pfey — RJ?

(A.17)

We then substitute for the two terms in the above integrand using (A.13)
and Table A.1,

(Al —Z¢/r1 |B) =

—Z_K(2n)~ °(x/p)?? fae,

dk, dk, e7 Kap
(A.18)

x efkr re ~®PATKS 2 pik2- (rr —Re)

If we collect all the exponential terms involving our original variable of
integration r,, we obtain
(A]—Ze/ricfB)

—

—4nZ -K(2n)~ °(x/p)?””

far,

dk,

dk,

ky 29 kil4p

x eT ik Reg ~ tka “Re girs - (ki +2)

(A.19)

We can now use the definition (A.14) of the delta function to perform the
integration Over r, to obtain

(A|—Ze/re|B) = —4nZcR(2n)~*(n/p)> dk, dk, e~4/47k;?
x eM
Rrp” th -Reg(k, + k,)

= —ZeR/Q2n?\(n/py?? [dk e~W!*P
Fe" kMe-Re)—_

(4,20)

414 MODERN QUANTUM CHEMISTRY

where we have set k, = —k, because of the delta function and relabeled
the variable as k. If we let Rp — R¢- lie along the z axis so that k - (Rp — R,) =

k|Rp — R¢{cos 6, then we can easily perform the angular part of the integration

over k to obtain

(A| —Zc/ryc|B) = N f, ® dk e#/4Pk-1 sin(KIRp — Re)
N = —2Z,K(a|Rp — Re)" (n/p)?

(A.21)
(A.22)

To evaluate the integral in (A.21), we consider the general integral:

I(x) = fe dke~k~! sin kx

(A.23)

and its derivative with respect to x,

I(x) = fe dk e~* cos kx

(A.24)

Note that the integrand in Eq. (A.24) is an even function of k. Since 1(0) = 0,
we have

f dy I'(y) = I(x) — 10) = I(x)

(A.25)

The integral in (A.24) can be evaluated by noting that cos @ is the real part

of e* (ie., cos 6 = Re[e”]), so that

+
_— 1
*
I)
=5
[Ppo dke —ak2cosh =_ 51 | [de

— ak?

e _ikx

(A.26)

By completing the square, we have
1
I(x)
=5 1

90
—(a¥/2k—1;2ia~
"Re [Pdke
12ia~ 1/2x)242x)

(A.27)

—x2/4a

Letting u = a'/*k — dia~ '/*x, we have
I’)

=

51 e77Aag-

1/2

i co

du

eo”

=

; (x/a)'/*e-*

2 {4a

(A.28)

so that

I(x) = 5 (n/a)?
1

1/2

[> dye
[*

(A.29)

—y2/4a

Therefore

(4|—Ze/ricfB)= —2nZeRp|Rp
—
Re)" [OP
~

_

IRp—Rcl

—2nZ Kp" (p'"[Rp
— Re)~* {?
mw

_

dy e-*
1/2|Rp—

Rc]

dye”

(A30)

INTEGRAL EVALUATION WITH

Is PRIMITIVE GAUSSIANS

415

We now introduce the Fy function, which is defined by
_

_w

dye»

(A.31)

F(t) = 3(a/t)'erf(t""?)

(A.32)

F((t)=t

4-12

1/2

f

It is related to the error function by
Therefore, our nuclear attraction integral can be written in terms of the Fo
function as

(A|—Ze/ric|B) = —2af(o + B)Zcexp[—oB/(« + B)[Ra— Rol?]
(A.33)
x Fol(@ + B)|Rp — R-|"]
The error function (hence F(t)) is a built-in function on IBM

compilers,
Let us now consider the two-electron integral

FORTRAN

(AB|CD) = [dry dry ssl: — RadGisls — Re)ri2Tis(F2 — ROTrs(F2 — Ro)
(A.34)

The first step is to combine the Gaussian at R, and R, into a new Gaussian
at Rp and to combine those at Rc and Rp into a new Gaussian at Rg as
shown in Fig. A.2. Then (A.34) becomes
(AB| CD) = exp[—aB/(« + B)|Ra ~ R,|’

— 76(y + d)[Re — R,|7]

x f dr, dry e7 Pitt Rel? 1 palr2 Rol?
A

c

Q
P

Figure A.2 The six centers involved in a two-electron integral

(A.35)

416 MODERN QUANTUM CHEMISTRY

Replacing the three terms in the integrand by their Fourier representation
gives

(AB|CD) = M(22)~9 f dr, dr, dk, dk, dk, (1/p)?/2e~i 47 git -1—Re)
x

4nky

2 oik2 “(ry “a

ngy

2

(A.36)

Kii4agiks *(r2—-Ra)

where

M = exp[~aB/(« + B)IRa — Rel? — y6/(y + 5)[Re — Ry|?]_

(A.37)

After collecting the exponential terms in the original variables of integration
r, andr, we have

(AB| CD) = 4xM(22)~°(x?/pq)>” f dr, dr, dk, dk, dk, e~ 4?
@~ K49
x

kz 27

iki: Rp, tks . Ropin

‘(ki +k2) ira *(k3—k2)

(A.38)

The integral overr, and rz now introduces two delta functions (see Eq. (A.14))

(AB|CD) = 4xM(2n)" *(x?/pq)?” fax, dk, dk, e7 *i/4Pg — #344
x ky7e7 i Reg
hs Ros(k, + k,)d(k, — k,)

(A.39)

We can now set k, = —k, and k, = k, and relabel k, as k to obtain

(AB|CD) = M/(2n2)(n2/pq)?? f dk k~2e7(P+4#/4pqgik-(Re-Ro)

(A 40)

This integral 1s identical in form to that of (A.20) which we encountered in
evaluating the nuclear attraction integral. Performing the rest of the algebra
we finally obtain

(AB| CD) = 2n°/?/[(a + Bly + Na+ B+ y+ 57]
x exp[ —aB/(« + B)[R4— R,|” — y6/(y + ORe - R,|’]

x Fol(a + Bly + Ja + B+y + d|Rp— Ral?)

(A.41)

These then are the explicit formulas for all the integrals required in a HartreeFock calculation provided we are using only 1s-type primitive Gaussian
functions. They are used in the computer program listed in Appendix B.

NOTES
{. 1 Shavitt,

The

Gaussian

function

in calculations of statistical mechanics

and

quantum

mechanics, in Methods in Computational Physics, B. Alder, S. Fernbach, and M. Rotenberg

(Eds.), Academic Press, New York, 1963.

2. M. Dupuis, J. Rys, and H. King, Evaluation of molecular integrals over Gaussian basis
functions, J. Chem. Phys. 65: 141 (1976).

APPENDIX

B

TWO-ELECTRON
SELF-CONSISTENT-FIELD PROGRAM

This Appendix gives a FORTRAN listing and the sample output (HeH*) of
a small program which illustrates ab initio Hartree-Fock calculations. Subsection 3.5.3 of the text discusses the HeH* calculation.
The program will calculate STO-NG (for N = 1, 2, or 3) wave functions
for any two-electron diatomic molecule. The input parameters to the main
subroutine HFCALC are an option to control the printing, the number of
primitive 1s Gaussian functions in which a 1s Slater function is to be expanded, i.e., the N of STO-NG, the bond length R in atomic units, the two
exponents €, and ¢, of the 1s Slater functions, and the atomic numbers Z,
and Z, of the two nuclei. If

G1 (0%) = (2a/n)?/4e-or"

(B.1)

is a normalized primitive 1s Gaussian, then the program can use for basis
functions any one of the following three least-squares fits to Slater-type
functions

CGF(¢ = 1.0, STO-1G) = g,,(0.270950)
b5s*(¢ = 1.0, STO-2G)

4g, (0.151623) + 0.430129g,,(0.851819)
= 0.67891

(B.2)

(8.3)
417

418 MODERN QUANTUM CHEMISTRY

#SSF(C = 1.0, STO-3G)
= 0,444635g,,(0.109818) + 0.535328g,,(0.405771)
+ 0.154329g, (2.22766)

(B.4)

The program was most recently run with the FORTRAN IV compiler
of a PDP-10 computer. It should, however, translate unaltered to almost
any FORTRAN compiler. On IBM machines the function DERF can be
replaced by a standard library routine. The program uses double precision
arithmetic, but single precision would be sufficient in many cases. The
program is specifically written in an inefficient way so that anyone with a
knowledge of FORTRAN and the discussions of Chapter 3 should be able
to follow completely the details of the ab initio Hartree-Fock calculation.
Subroutine INTGRL, after scaling the contraction coefficients and
exponents of (B.2) to (B.4) to the input values of €, and €,, calculates all
basic one- and two-electron integrals according to the explicit formulas of
Appendix A. The overlap, kinetic energy, nuclear attraction, and two-electron
integrals for unnormalized primitives are evaluated by the functions S, T,
V, and TWOE, and then summed using modified contraction coefficients
that include the normalization constants. The basic integrals are then
passed through COMMON storage to COLECT, which forms from the
integrals those matrices S, H°*"S, etc. which remain fixed during the SCF
iterations. The transformation matrix X to orthogonal basis functions is

the canonical one described in the text. The SCF iteration procedure uses
the core-Hamiltonian for an initial guess at the Fock matrix and convergence
is assumed when the standard deviation in a density matrix element is less
than 107* a.u. A maximum of 25 iterations is allowed. No expectation values
are calculated other than the energy, but the matrix PS is printed for a
Mulliken population analysis.
The program Is simple, but it contains the basic ingredients of sophisticated programs for large ab initio calculations. The integral routines S, T,
V, and TWOE are general for any set of 1s Gaussian basis functions. The
interested and adept student, who fully understands the current program,
could extend it to model calculations on polyatomic molecules using a basis
set of floating

1s Gaussians,

such

as

the “Gaussian

lobe”

basis

sets of

Whitten.’ Calculations with more than two basis functions would require a
general matrix diagonalization routine? rather than just the 2 x 2 diagonal-

ization considered here. Most polyatomic programs, in addition to the above,
require special techniques for storing and handling the large number of
two-electron integrals and an efficient algorithm for forming the matrix G
from the two-electron integrals and density matrix. Evaluating integrals for
p- and d-type Cartesian Gaussians is considerably more difficult than for
the 1s Gaussians and the writing of an efficient polyatomic program is a

major undertaking.*

TWO-ELECTRON SELF-CONSISTENT-FIELD PROGRAM
COSSSS

SS SOS

SSH

SETS

HOTS

SSTSSTESS

SESS

SASHH

SESH

SESH

SHH

SSESSH

SHEE

SESH

419
SOS

c
Cc
MINIMAL BASIS STO-3G CALCULATION ON HEH+
Cc
Cc
THIS IS A LITTLE DUMMY MAIN PROGRAM WHICH CALLS HFCALC
Cc
COO SOe ee eeee sees ee eee eee eee OS OKOSOEOOT SERS EEE OOD SEED SEES EERE EES
IMPLICIT DOUBLE PRECISION(A-H,0-Z)
IOP=2
N=3
R=1. 463200
ZETA1=2.092600
ZETAZ=1.24D0
ZA=2.0D0
ZB=1.0D0
CALL HFCALC(IOP,N,R,ZETA1,
ZETA2, ZA, ZB)
END
CPS

SSSSSSSS

SESH

SOSH

AOMAAAAAAAAAAAADA

SUBROUTINE

c
c
c

Cc

COS

EES

SOHO

EHHHSEEESESSTEOSESHSSEH

EH STOO

SSHOCE

TOS

HFCALC(IOP,N,R,
ZETA1, ZETAZ, ZA, ZB)

DOES A HARTREE-FOCK CALCULATION FOR A TWO-ELECTRON DIATOMIC
USING THE 1S MINIMAL STO-NG BASIS SET
MINIMAL BASIS SET HAS BASIS FUNCTIONS 1 AND 2 ON NUCLEI A AND

IOP20
IOP=1
IOP=2
N
R
ZETA1
ZETAZ
ZA
ZB

NO PRINTING WHATSOEVER (TO OPTIMIZE EXPONENTS,
PRINT ONLY CONVERGED RESULTS
PRINT EVERY ITERATION
STO-NG CALCULATION (N=1,2 OR 3)
BONDLENGTH (AU)
SLATER ORBITAL EXPONENT (FUNCTION 1)
SLATER ORBITAL EXPONENT (FUNCTION 2)
ATOMIC NUMBER (ATOM A)
ATOMIC NUMBER (ATOM B)

SAY)

IMPLICIT OOUBLE PRECISION(A-H,0-2)
IF (I0P.£Q.0) GO TO 20
PRINT 10,N,ZA,ZB
10 FORMAT(1H1,2X,4HSTO-,11,21HG FOR ATOMIC NUMBERS ,F5.2,5H AND ,
$F5.2,//)
20 CONTINUE
CALCULATE ALL THE ONE AND TWO-ELECTRON INTEGRALS
CALL INTGRL(IOP,N,R,
ZETA1, ZETAZ,ZA, ZB)
BE INEFFICIENT ANO PUT ALL INTEGRALS IN PRETTY ARRAYS
CALL COLECT(IOP,N,R,ZETAL,
ZETA2, ZA, ZB)
PERFORM THE SCF CALCULATION
CALL SCF(IOP,N,R,ZETA1,
ZETAZ, ZA, ZB)
RETURN
END

CPPS

c
c

SSH

PSST

ESTES

SS

SUBROUTINE

ESOS

SETS

EH SEH

SOSEHESHTESSESSHSES

INTGRL(IOP,N.R,ZETAL, ZETAZ,ZA, ZB)

CALCULATES ALL THE BASIC INTEGRALS NEEDEO
FSCS

SS SSS

SESH

SEES

ESSE

OSES

SOSH

SOT ESOH

SOSH

SHOES

OSC ESEOE

EHS

SSHTEETOS

FOR SCF CALCULATIDN
SESH

SS

OTOH

SHE

SHTEET

SS

B

aQaan

Qan

420 MODERN QUANTUM CHEMISTRY

IMPLICIT DOUBLE PRECISION(A-H,
0-2)
COMMON /INT/S12, 711,712,722, V11A,V12A, V22A,V21B ,V12B,V22B,
$ V1111,V2111,V2121,V2211,V2221,V2222
DIMENSION COEF(3,3),€XPON(3,3),01(3).A1(3).02(3).A2(3)
DATA PI/3.1415926635B98D0/
THESE ARE THE CONTRACTION COEFFICIENTS AND EXPONENTS FDR
A NORMALIZED 1S SLATER ORBITAL WITH EXPONENT 1.0 IN TERMS OF
NORMALIZED 1S PRIMITIVE GAUSSIANS
DATA COEF ,EXPON/1.0D0,2°0.0D0,0.67B914D0 ,0.430129D0,0.0D0,
$ 0. 44463600, 0.63632BD0, 0. 154329D0, 0. 270960D0,2*0.000,0.
151B23D0,
$ 0.861819D0,0.0D0,0.109818D0,0.40577100,2.22766D0/
RZ=R®R
SCALE THE EXPONENTS (A) OF PRIMITIVE GAUSSTANS
INCLUDE NORMALIZATION IN CONTRACTION COEFFICIENTS (D)
DO 10 1=1,N
A1(1)=EXPON(I,N)*(ZETA1®*2)
D1(1)=COEF(I,N)*((2.0D0°A1(1)/PI)**0.
76D0)
A2(1) =EXPON(I,N)*(ZETAZ**2)
D2(1)=COEF(I.N)*®((2.0D0°A2(1)/P1)**0.
76D0)
10 CONTINUE
D AND A ARE NOW THE CONTRACTION COEFFICIENTS AND EXPONENTS
IN TERMS OF UNNORMALIZED PRIMITIVE GAUSSTANS
$12=0.0D0
T11=0,0D0
T12=0.0D0
T22=0. 000
V11A=0.0D0
V12A=0.0D0
V22A=0.0D0
V11B=0.0D0
V12B=0.0D0
V22B=0.0D0
V1111=0.000
V2111=0.0D0
V2121=0.0D0
V2211=0,0D0
V2221=0.0D0
V2222=0.0D0
CALCULATE ONE-ELECTRON INTEGRALS
CENTER A IS FIRST ATOM, CENTER B IS SECOND ATOM
ORIGIN IS ON CENTER A
V12A = OFF-DIAGONAL NUCLEAR ATTRACTION TO CENTER A, ETC.
DO 20 I=1,N
DO 20 J=1,N
RAP2 = SQUARED DISTANCE BETWEEN CENTER A AND CENTER P, ETC.
RAP=A2(J)*R/(A1(1)+A2(3))
RAP2=RAP**2
RBP2=(R-RAP)**2
$12=$12+S(A1(1) ,A2(3).R2)*D1(1)*D2( 3)
T12=T114+T(A1(1)
,A1(3), 0.000) *D1(1)*D1(9)
712*T12+T(A1(1) ,A2(3),R2)*D1(1)*02( 3)
T22=T22+T(A2(1),A2(J),0.
000) *D2(1)*D2(3)
VA1ASV11A4V(A1(1).A1(3),0.000,0.0D0,2A)*D1(1)*D1(J)
V1ZA=V12ZAtV(A1(1),A2(3),R2, RAP2,ZA)*D1(1)*02(9)
V22A=V22A+V(A2(I).A2(J),0.0D0,R2,
ZA) *D2(1)*D2(3)

TWO-ELECTRON SELF-CONSISTENT-FIELD PROGRAM

V118=V11B+V(A1(1).A1(J),0.0D0,R2,2B)*D1(1)*D2(3)
V12B=V12B+V(A1(I),A2(J),R2,RBP2,ZB)*D2(1)
*D2(3)
V22B=V22B+V(A2(I),A2(J),0.0D0,0.0D0,2B)*02(1)*D2(9)
20 CONTINUE
CALCULATE TWO~ELECTRON INTEGRALS
DO 30 I#1,N
DO 30 J=1,N
DO 30 Kei,N
DO 30 L*1,N
RAP=A2(1)*R/(A2(1)+A1(9))
RBP=R-RAP
RAQ=A2(K)*R/(A2(K)+A1(L))
RBQ=R-RAQ
RPQ=RAP-RAQ
RAP2=RAP*RAP
RBP2=RBP*RBP
RAQ2=RAQ*RAQ
RBQ2=RBQ*RBQ
RPQ2=RPQ*RPQ
V1414=V1111+TWOE(A1(1),A1(3),A1(K),A1(L),0.0D0,0.0D0,0.0D0)
$ *D1(1)*D1(9)*D1(K)*D2(L)
V2121=V2211+TWOE(A2(I),A2(J),A1(K),A1(L),R2,0.0D0,RAP2)
$ *D2(1)*D1(3)*D1(K)*D4(L)
V2121=V2121+TWOE(A2(1),A1(J),A2(K),A2(L),RZ2,R2,RPQ2)
$ *02(1)*01(J)*D2(K)*D2(L)
V2211=V2211+TWOE(A2(1),A2(J),A1(K),A1(L),0.0D0,0.0D0,R2)
$ *D2(1)*D2(J)*D1(K)*D1(L)
V2221=V2221+TWOE(A2(I),A2(J),A2(K),A1(L),
0. 0D0,R2,RBQ2)
$ *D2(1)*02(3)*D2(K) *D4(L)
V2222=V2222+TWOE(AZ(1),A2(J),A2(K) ,A2(L),0.0D0,0.0D0,0.0D0)
$ *D2(1)*D2(3)*D2(K)*D2(L)
30 CONTINUE
IF (10P.EQ.0) GO TO 90
PRINT 40
40 FORMAT(3X, 2HR, 20X, BHZETA1, 6X , 5HZETAZ, 6X, 3HS12, 8X, 3HT12/)
PRINT 60, R,ZETAI,ZETA2,S22,711
60 FORMAT(6F11.6//)
PRINT 60
60 FORMAT( 3X ,3HT12,BX, 3HT22, 8X, 4HV11A, 7X, 4HV12A, 7X, 4HVZ2A/)
PRINT 60, 112,122,V21A,V12A,
V22A
PRINT 70
70 FORMAT( 3X, 4HV11B, 7X, 4HV12B, 7X, 4HV22B, 7X, 6HV1111, 6X, 6HV2112/)
PRINT 60, V11B,V12B,V22B,V1211,V2122
PRINT 80
80 FORMAT (3X, 6HV2122, 6X, 6HV2221, 6X, 5HV2221, 6X, GHV2222/)
PRINT 60, V2121,V2211,V2221,V2222
90 RETURN
END

ceess

c
Cc
Cc
Cc

Ceeee

FUNCTION FO(ARG)
CALCULATES THE F FUNCTION
FO ONLY (S-TYPE ORBITALS)

421

422 MODERN QUANTUM CHEMISTRY

IMPLICIT DOUBLE PRECISION(A-H,0-Z)
DATA PI/3.1416926535898D0/
IF (ARG.LT.1.0D-6) GO TO 10
FO IN TERMS OF THE ERROR FUNCTION
FO=DSORT(PI/ARG
) *DERF (DSQRT(ARG) )/2.0D0
GO TO 20
ASYMPTOTIC VALUE FOR SMALL ARGUMENTS

c
c

10
20

FO=1.0D0-ARG/3
.0D0
CONTINUE
RETURN
END

AQAAAAAAA

COFFS

CPS

SSS

SSESSSSSOT

HOST

OTTSTSSSSSOTSSSTHST

FUNCTION DERF(ARG)

HSS

SO SEH

SET

SESS HSS

EOS

OTTO

TEES

CALCULATES THE ERROR FUNCTION ACCORDING TO A RATIONAL
APPROXIMATION FROM M. ABRAMOWITZ AND I.A. STEGUN,
HANDBOOK OF MATHEMATICAL FUNCTIONS, DOVER.
ABSOLUTE ERROR IS LESS THAN 1.6°10°*(-7)
CAN BE REPLACED BY A BUILT-IN FUNCTION ON SOME MACHINES

IMPLICIT DOUBLE PRECISION(A-H,D-Z)
DIMENSION A(6)
DATA P/0.3275911D0/
DATA A/0.264829692D0,
-0. 284496736D0, 1. 42141374100,
$ -1. 46316202700, 1.061405429D0/
T=1.000/(1.0D0+P*ARG)
TN=T
POLY=A(1)*TN
DO 10 1=2,6
TN=TN°T
POLY=POLY+A(1)*TN
10 CONTINUE
DERF=1.0D0-POLY*DEXP(-ARG*ARG)
RETURN
END

FSS

c
c

SSS

SSS

FSH

SSE

TEST

SESS

FUNCTION S(A,B,RAB2)

HT HSSSHSSSHSSSES

TS

SHESTH

SSS

STOSTSSEOTE

SST

SEEEE

CALCULATES DVERLAPS FOR UN-NORMALIZED PRIMITIVES

Leseecescccccecessescccscnsencccscccesoccsovcessccssccscecesesoscess

CPP

SSS

c
c
c

COFFS

IMPLICIT DOUBLE PRECISION(A-H,
0-2)
DATA PI/3.1415926635898D0/
S*(PI/(A+B) )*°1.5D0*DEXP(-A*B*RAB2/(A+B) )
RETURN
END
SSSSSSST

SESS

SESH

ST

SSS

FUNCTION 1(A,B,RAB2)

TSS

SHSTSHSHSSSTSSSSSHSSSTSE

SESE

SEES

TSEESE

CALCULATES KINETIC ENERGY INTEGRALS FOR UN-NORMALIZED PRIMITIVES
eee

See

SSeS

OSES

E HE

TOTETHSE

EES

EHSEDE

IMPLICIT DOUBLE PRECISION(A-H,0-Z)
DATA PI/3.1416926636B9BD0/

OSES

ESE

OSSHH

ETOH

EE EET

EEO

EEETE

TWO-ELECTRON

CPO

c
c
c

COO

See

OFS

OSES

TOTES

NQNAQaAaAag

c
Cc
Cc
c

CES

c

c

c

EEO

SE

ETS

ESTES

FUNCTION V(A,B,RAB2,RCP2,ZC)

ST

HOST

HST

T HST

OSOHTSSST

CALCULATES UN-NORMALIZED NUCLEAR ATTRACTION
Fe OSS

TOS

SOOO

SESE

DOUBLE

SESE

TEST

SESS

SSSSSSHSSSST

STH

HST

ESTHET

SSS

S

EOS

S TESST

423

ETG

INTEGRALS
SHH

HHT

SHSSSESE

SEES

PRECISION(A-H,0-Z)

DATA PI/3.1416926635B98D0/
N
v=2. 0D0*PI/(A+B)*F0(
(A+B) *RCP2) *DEXP(-A*B*RAB2/(A+B))
V=-V°ZC
RETURN
END
FUNCTION

CSO

PROGRAM

T=A°B/(A+B)*(3.0D0-2.0D0°A*B*RABZ/(A+B))*(PI/(
A+B) )**1.6D0
$ *DEXP(~A*B*RAB2/(A+B))
RETURN
END

IMPLICIT

CSF

SELF-CONSISTENT-FIELD

OTS

SSSTT

SESH

SST

HSS

HT SST

STT

OSH

SE

SHSHSHSSST

SST

ETTTOS

TWOE(A,B,C,0,RAB2,RCO2,RPQ2)

CALCULATES TWO-ELECTRON INTEGRALS FOR UN-NORMALIZED PRIMITIVES
A,B,C,D ARE THE EXPONENTS ALPHA,BETA, ETC.
RAB2 EQUALS SQUARED DISTANCE BETWEEN CENTER A AND CENTER B, ETC.

IMPLICIT DOUBLE PRECISION(A-H,0-2)
DATA PI/3.1425926535898D0/
TWOE#2 .0D0*(PI**2.5D0)/(
(A+B) ®(C+D) *DSQRT(A+B+C+D) )
$ *FO( (A+B) *(C+D) *RPQ2/ (AtB+C+0))
$ *DEXP(-A°B*RABZ/(A+B)-C*D*RCDZ/
(C+D) )
RETURN
END

SOO

SSS

EOE

ASSET

SUBROUTINE

SOT

EH SSS

S ET

SST

EH

SHSETEHS

SFOS

SSS

SSSH

SET

EHESESSEESE

COLECT(IOP,N,R,ZETA1, ZETAZ,ZA, ZB)

THIS TAKES THE BASIC INTEGRALS FROM COMMON AND ASSEMBLES THE
RELEVANT MATRICES, THAT IS S,H,X,XT, AND TWO-ELECTRON INTEGRALS
Se SOOO

SO FATE

SHEE

H SSH

OTOH

S HST

HSSHSSHSETSH

OH SSS

SHSEHHSSSESHSO

SHEET

SES

IMPLICIT DOUBLE PRECISION(A-H,
0-2)
COMMON/MATRIX/S(2,2).X(2,2).XT(2,2),H(2,2).F(2,2).G(2.2),C(2,2).
$ FPRIME(2,2),CPRIME(2,2),P(2,2),OLDP(2,2),11(2,
2-2-2) ,E(2,2)
COMMON/INT/S12 711,712,722, V11A,V12A,V22A,V11B,Vi2B,V22B,
$ Vi112,V2111,V2221,V2212,V2221,V2222
FORM CORE HAMILTONIAN
H(1,1)=T114V11A+V11B
H(1,2)=T12+V22A+V12B
H(2,2)=H(2,2)
H(2,2)=T22+v22A+v22B
FORM OVERLAP MATRIX
S(1,1)#=1.0D0
$(1,2)=$12
$(2,1)=S(1,2)
§(2,2)=1.0D0
USE CANONICAL ORTHOGONALIZATION
X(1,1)=1. 0D0/DSQRT(2.0D0*(1.000+S12))

424 MODERN QUANTUM CHEMISTRY

c

c

10

20
30
40
CPSSH

c
c
c

X(2,2)=X(1,2)
X(1,2)+1. 0DO/DSORT(2.0D0*(1.0D0-S12))
X(2,2)=-X(1,2)
TRANSPOSE OF TRANSFORMATION MATRIX
XT(1,2)=X(1,2)
XT(1,2)=X(2,1)
XT(2,1)#=X(2,2)
XT(2,2)=X(2,2)
MATRIX OF TWO-ELECTRON INTEGRALS
TT(2,4,2,2)*V1121
TT(2,1,1,2)*V2121
TT(1,2,2,1)=V2111
TT(1,2,2,2)=V2221
1T(1,1,2,2)=V2911
TT(2,2,2,2)=V2221
TT(2,2,2, 1)=V2122
TT(2,2,2,2)*V2121
11(1,2,1,2)*v2i2i
TT(2,2,1,2)=V2212
TT(1,1,2,2)2V2211
TT(2,2,2,1)=V2222
TT(2,2,1,2)#V2221
TT(2,1,2,2)=V2221
TT(1,2,2,2)=V2221
TT(2,2,2,2)=V2222
IF (I0P.£Q.0) GO TO 40
CALL MATOUT(S,2,2,2,2,4HS
)
CALL MATOUT(X,2,2,2,2,4HX
)
CALL MATOUT(H,2,2,2,2,4HH
)
PRINT 10
FORMAT(//)
DO 30 I=1,2
DO 30 J=1,2
DO 30 K=1,2
DO 30 L#1,2
PRINT 20, I,J,K,L,TT(I,J,K,L)
FORMAT(3X,1H{,412,2H ),F10.8)
CONTINUE
RETURN
END

SSS

Cc
Cc

SHS

SSSHSSEHHSTSSSSEHESSEHHSHSSSESHHFSESSHSHSSSHSHDFOH

SUBROUTINE SCF(IOP,N,R,ZETA1,ZETA2,ZA,ZB)

OES

PERFORMS THE SCF ITERATIONS

CESHSSSHS

c

SHCSSHEHHST

SHE

SHHSHTSSHHSSEHFSHSHESFSSSEHHSSESHSTSFS

SSS

SSOHEAHUE

THE

ROTA

OD

IMPLICIT DOUBLE PRECISION(A-H,0-Z)
COMMON /MATRIX/S(2,2),X(2,2) .XT(2,2),H(2,2),F (2,2) G(2.2),C(2,2),
$ FPRIME(2,2),CPRIME(2,2),P(2,2),OLDP(2,2),1T(2,2,2,2),E(2+2)
DATA PI/3. 1416926636898D0/
CONVERGENCE CRITERION FOR DENSITY
DATA CRIT/1.0D-4/
MAXIMUM NUMBER OF ITERATIONS
DATA MAXIT/26/
ITERATION NUMBER

MATRIX

TWO-ELECTRON SELF-CONSISTENT-FIELD PROGRAM

ITER=0
USE CORE-HAMILTONIAN FOR INITIAL GUESS AT F, I.E. (P=0)
DO 10 f=1,2
DO 10 J=1,2
10 P(I,J)=0.0D0
IF (IOP.LT.2) GO TO 20
CALL

HATOUT(P,2,2,2,2,4HP

=)

START OF ITERATION LOOP
20 ITER=ITER+2
IF (1OP.LT.2) GO TO 40
PRINT 30, ITER
30 FORMAT(/,4X,28HSTART OF ITERATION NUMBER = ,I2)
40 CONTINUE
FORM TWO-ELECTRON PART OF FOCK MATRIX FROM P
CALL FORMG
IF (IOP.LT.2) GO TO 60
CALL

MATOUT(G,2,2,2,2,4HG

DO

J=1,2

—)

60 CONTINUE
ADD CORE HAMILTONIAN TO GET FOCK MATRIX
00 60 I=1,2
60

70
80
90

60

F(1,3)=H(1,J)+6(1,9)
CONTINUE
CALCULATE ELECTRONIC ENERGY
EN=0.0D0
DO 70 I=2,2
DO 70 J=1,2
EN=EN+0.5D0°P(1,J)°(H(I.3)+F(1,J))
CONTINUE
IF (I0P.LT.2) GO TO 90
CALL MATOUT(F,2,2,2,2,4HF — )
PRINT 80, EN
FORMAT(///,4X,20HELECTRONIC ENERGY = ,D20. 12)
CONTINUE
TRANSFORM FOCK MATRIX USING G FOR TEMPORARY STORAGE
CALL MULT(F,X,G,2,2)

On

CALL

NULT(XT,G,FPRIME,2,2)

DIAGONALIZE TRANSFORMED FOCK MATRIX
CALL DIAG( FPRINE,CPRIME,E)
TRANSFORM EIGENVECTORS TO GET MATRIX C
CALL MULT(X,CPRIME,C,2,2)
FORM NEW DENSITY MATRIX
DO 100 I=1,2
DO 100 J=1,2
SAVE PRESENT DENSITY MATRIX
BEFORE CREATING NEW ONE
OLDP(I,3)=P(I,J)
P(1,3}=0.0D0
DO 100 K=1,1
P(1,J)=P(1,3)+2.0D0°C(1,K)*C(J,K)
100 CONTINUE
IF (IOP.LT.2) GO TO 120
CALL MATOUT(FPRIME ,2,2,2,2,4HF' )
CALL MATOUT(CPRIME,2,2,2,2,4HC’ )
CALL MATOUT(E,2,2,2,2,4HE
—)

XX

425

426 MODERN QUANTUM CHEMISTRY

ad

CALL MATOUT(C,2,2,2,2,4HC
CALL MATOUT(P,2,2,2,2,4HP
110 CONTINUE
CALCULATE DELTA
DELTA=0.000
DO 120 1=1,2
DO 120 J=1,2
DELTA=DELTA+(P(I,J)-OLDP(I,J))**2
120 CONTINUE
DELTA=DSOQRT(DELTA/4
.0D0)
IF (IOP.£Q.0) GO TO 140
PRINT 130, DELTA
130 FORMAT(/,4X,3QHDELTA(CONVERGENCE OF DENSITY MATRIX) ©
$ F10.6,/)
140 CONTINUE
CHECK FOR CONVERGENCE
IF (DELTA.LT.CRIT) GO TO 160
NOT YET CONVERGED
TEST FOR MAXIMUM NUMBER OF ITERATIDNS
IF MAXIMUM NUMBER NOT YET REACHED THEN
GO BACK FOR ANOTHER ITERATION
IF (ITER.LT.MAXIT) GO TD 20
SOMETHING WRONG HERE
PRINT 150
150 FORMAT(4X,21HNO CONVERGENCE IN SCF)
STOP
160 CONTINUE
CALCULATION CONVERGED IF IT GOT HERE
ADD NUCLEAR REPULSION TO GET TOTAL ENERGY
ENT=EN+ZA°ZB/R
IF (IOP.EQ.0) GO YO 180
PRINT 170, EN, ENT
170 FORMAT(//,4X,22HCALCULATION CONVERGED,//,
$ 4X,20HELECTRONIC ENERGY = ,020.12,//,
$ 4X,20HTOTAL ENERGY =
020.12)
180 CONTINUE
If (IOP.NE.1) GO TO 190
PRINT OUT THE FINAL RESULTS IF
HAVE NOT DONE SO ALREADY
CALL MATOUT(G,2,2,2.2,4HG
)
CALL MATOUT(F,2,2,2,2,4HF
)
CALL MATOUT(E,2,2,2,2,4HE
)
CALL MATOUT(C,2.2,2,2,4HC
)
CALL MATOUT(P,2,2,2,2,4HP
)
190 CONTINUE
PS MATRIX HAS MULLIKEN POPULATIONS
CALL MULT(P,S,OLDP,2,2)
IF (I0P.EQ.0) GO TO 200
CALL MATOUT(OLDP,2,2,2,2,4HPS )
200 CONTINUE
RETURN
END

oO

AaaaANA

oO

c

an

c
c

c

COCCCCOCE

c

SE

CEE

EEE

SUBROUTINE

SEES

FORMG

SEE

EEEE

EEE

CESSES

ESSER

SESE

SESS

SESE

SE

OEE

SES

OOH

SOS

TWO-ELECTRON

c
c

SELF-CONSISTENT-FIELD

PROGRAM

427

CALCULATES THE G MATRIX FROM THE DENSITY MATRIX
AND TWO-ELECTRON INTEGRALS

Lececscceccscescescescnscosccscescescescnscsccsccscsscsccccesenseces

IMPLICIT DOUBLE PRECISION(A-H,0-Z)
COMMON/MATRIX/S(2,2),X(2,2) ,XT(2,2).H(2,2).F(2,2).G(2.2),C(2.2),
$ FPRIME(2,2),CPRIME(2,2),P(2,2),OLDP(2,2),1T(2,2,2,2),€(2,2)
BO 10 I#1,2
\
DO 10 J=1,2
G(1,J)=0.0D0
DO 10 K=1,2
DO 10 L=1,2
G(1,9)=G(1,J)+P(K,L)*(1T(1,9,K,L)-0.6D0°TT(I,L,K,9))
10 CONTINUE
RETURN
END

CPSSSSS

c
c
c
c

CO

c

SSSSSSSSSSSSSSSSSSSH

SUBROUTINE DIAG(F,C,E)
DIAGONALIZES
THETA IS THE

SFOS

c

Cc

SSeS

10

SSeS

SeSl

SSS

SSSSSS

SESS

SE

F TO GIVE EIGENVECTORS IN
ANGLE DESCRIBING SOLUTION

SSSSSHSSSSSSESSSESSHES

C AND

EIGENVALUES

Ss SOOSSSSSSSSHHSSSSSHSSESSHSSHSSSHSSHHESSESS

IMPLICIT DOUBLE PRECISION(A-H,0-Z)
DIMENSION F(2,2),C(2,2),E(2.2)
DATA PI/3.1416926636B98D0/
IF (DABS(F(1,1)-F(2,2)).GT.1.0D-20)

HERE IS SYMMETRY DETERMINED SOLUTION
THETA=PI/4.0D0
GO TO 20
CONTINUE
SOLUTION FOR HETERONUCLEAR DIATOMIC

GO TO 10

(HOMONUCLEAR

THETA=0.6D .*DATAN(2.0D0°F(12,2)/(F(1,1)-F(2.2)))
20 CONTINUE
C(1,1)=DCOS( THETA)
C(2,1)=DSIN( THETA)
C(1,2)=DSIN( THETA)
C(2,2)=-DCOS (THETA)
E(1,1)=F(1,1)*DCOS(
THETA) **2+F (2,2) *DSIN( THETA) **2
$ +F(1,2)*DSIN(2.0D0°THETA)
fl: 2)=F (2,2)*DCOS( THETA) **2+F( 1,1) °DSIN( THETA) **2
$ -F(1,2)*DSIN(2.0D0°THETA)
E(2,2)=0.0D0
E(1,2)=0.0D0
ORDER EIGENVALUES AND EIGENVECTORS
IF (E(2,2).GT.E(1,1)) GO TO 30
TEMP=E(2,2)
E(2,2)*E(1,1)
E(1,1)=TEMP
TEMP=C(1,2)
C(1,2)=C(1,1)
C(1,1)=TEMP
TEMP=C(2,
2)
C(2,2)=C(2,1)
C(2,1)=TEMP

OSES

IN

E

ETESEEES

DIATDMIC)

428 MODERN QUANTUM CHEMISTRY
30

RETURN
END

AOA

CSSSCESSSSSSSSSSSSESSSSSSSSS

CS

SESS

SSESESSESESSSSESSSSSSOSSSSSSSESESESESEEEE

SUBROUTINE

MULT(A,B,C,IM,M)

MULTIPLIES

TWO

SQUARE

MATRICES

A AND

IMPLICIT DOUBLE PRECISION(A-H,
0-Z)
DIMENSION A(IM,IM),B(IM,IM),C(IM,
IM)
DO 10 I=1,M
DO 10 J=1,M
C(I,3)=0.0b0
DO 10 K=1,M
10 C(1,3)=C(1, 3)+A(1,K)*8(K, 3)
RETURN
END

SSSS

c
c

SES

SSSESS

SES

SSESS

SESS

SESS

SSE

SSESS

SESE

SUBROUTINE MATOUT(A,
IM, IN,M,N, LABEL)

B TO

SESS

GET

SSE

C

SSESOSSSESESESSEEERE

PRINT MATRICES OF SIZE M BY N

Keccccccccccccccscccccccncccccecceccccccesccceccccsccscccceccssccece

10
20
30
40
60

IMPLICIT DOUBLE PRECISION(A-H,0-Z)
DIMENSION A(IM, IN)
IRIGH=0
LOW=IHIGH+2
IHIGH= IHIGH+6
IHIGH=MINO( IHIGH,N)
PRINT 20, LABEL, (I,I=LOW, IHTGH)
FORMAT(///,3X,6H THE ,A4,6H ARRAY,/,16X,6(10X,13,6X)//)
DO 30 I=1,m
PRINT 40, I,(A(I.J3),J=LOW, IHIGH)
FORMAT(110,5X,6(1X,018.10))
IF (N-IRIGH) 60,60, 10
RETURN
END

TWO-ELECTRON

STO-3G

FOR

ATOMIC

NUMBERS

2.00

AND

SELF-CONSISTENT-FIELD

1.00

ZETA2

ZETA2

$12

T11

1.463200

2.092600

1.240000

0.460770

2.164313

712

T22

V11A

V12A

V22A

0.167013

0.760033

-4.139827

-1.102912

~-1.266246

V11B

v12B

Vv22B

v1111

v2111

“0.677230

-0.411306

-1.226616

1.307162

0.437279

v2121

v2222

v2221

v2222

0.177267

0.606703

0.311796

0.77460B

THE

S$

ARRAY

THE

X

THE

H

Np

R

Nn»

ARRAY

eee’ See” See
Nee? Nee! Nee” Nee! Nee” See”
Nee

MeN
Ne

ee
he

ee DDD
ON
eh

be
op
DD PO
~

me

POP

ed
be pe
be
pe
be
DO be

NN
EN i

be

Ne

ARRAY

1
0.1000000000D+01
0. 4607704116D+00

2
0.46077041160+00
0.10000000000+01

1
0.6870642B12D+00
0.6870642B12D+00

2
0.96413107220+00
-0.96413107220+00

1
-0.2662744703D+01
-0.1347206024D+01

2
-0.13472060240+01
-0.1731B28436D+01

1.307162
0.437279
0.437279
0.606703
0.437279
0.177267
0.177267
0.321796
0.437279
0.177267

PROGRAM

429

ARRAY

1
2
START

OF

G

THE

F

ITERATION

ARRAY

NUMBER

=

1
0.0000000000D+00
0.0000000000D+00

NP

THE

1
0.0000000000D+00
0.00000000000+00

ARRAY

1
-0.2662744703D+01
-0.1347206024D+01

ELECTRONIC

F°

THE

C’

THE

E

2
»0000c000000+CO
,0o0co0c00ccD+00

1

2
»00000000000+00
-0occocooccd+00

2
- 1347206024D+01
-1731828436D+01

o.0000000000000+00

1
-0.2439732411D+01
-0.6168386047D+00

2
-0.6168386047D+00
-0. 1638667186D+01

1
0.9104462570D+00
0.4136296866D+00

2
0.4136296866D+00
-0.91044626700+00

1
-0.2674086994D+01
0.0000000000D+00

2
0. cOCCOCOOCOD+00
-0.1304313603D+01

Nn»

ARRAY

ARRAY
nP

=

ARRAY

Nw

THE

ENERGY

oo

P

0.177267
0.311796
0.606703
0.311796
0.311795
0.774608

oo

ew
NN

THE

DY
NeNM

NPP
NNN

PD

NNNNNN

NN
a on

430 MODERN QUANTUM CHEMISTRY

TWO-ELECTRON SELF-CONSISTENT-FIELD PROGRAM
THE

C

ARRAY
1
2

THE

P

ARRAY
1
2

1
0.9291467304D+00
0. 1398330603D+00

2
-0.6268669639D+00
0. 1111611266D+01

1
0.1726627293D+01
0.2598608430D+00

2
0. 2698608430D+00
0.3910666393D-02

DELTA( CONVERGENCE

OF

START

NUMBER

THE

OF

ITERATION

G

ARRAY
1
2

THE

F

ARRAY
1
2

ELECTRONIC

THE

F’
1
2

=

MATRIX)

=

0.8B2867

2

1
0.12623300440+01
0.3740040663D+00

2
0.3740040663D+D0
0.9889630699D+00

1
-0.1390414669D+01
-0.9732009679D+00

2
-0.9732009679D+00
-0.7428763661D+00

ENERGY

ARRAY

DENSITY

=

-0.4141862686810+01

1
-0. 1406043276D+01
-0.36271024660+00

2
-0.3627102466D+00
-0.1701366816D+00

1
0.9649913726D+00
0.26228162490+00

2
0.2B22816249D+00
~0.9649913726D+00

=~

THE

C*

ARRAY
1
2

THE

E

ARRAY

431

432 MODERN QUANTUM CHEMISTRY
1
2

THE

C

ARRAY
1
2

THE

P

ARRAY
1
2

~0.1604626781D+01
0.0000000000D+00

0,00000000000+00
-0.71553076680-01

1
0.8167630146D+00
0.3162609186D+00

2
-0.76676207960+00
0.10747044270+01

1
0.1334203644D+01
0.6166204426D+00

2
0.61662044250+00
0.2000419373D+00

DELTA(CONVERGENCE

OF

START

NUMBER

THE

OF

ITERATION

G

ARRAY

F

ELECTRONIC

F°

THE

C*
1
2

3

2
~0.10433988600+01
-0.80339647690+00

=

-0.422649172662D+01

ARRAY

ARRAY

0.279176

1
~0.1461398403D+01
~0. 10433988600+01

ENERGY

1
2

=

2
0. 303806 1741D+00
0. 9284329600D+00

ARRAY
1
2

THE

=

MATRIX)

1
0.1201346300D+01
0.303806 1741D+00

1
2

THE

DENSITY

1
~0.14963066300+01
~0.3629699437D+00

2
-0.3629699437D+00
-0.1629380263D+00

1
0.9694747616D+00
0.2461911622D+00

2
0.2451911622D+00
-0.96947476160+00

TWO-ELECTRON SELF-CONSISTENT-FIELD PROGRAM
THE

E

ARRAY
1
2

THE

C

ARRAY
1
2

THE

P

ARRAY
1
2

1
-0.16881047460+01
0.00c00000000D+00

2
0.0000000000D+00
-0.6113881008D-01

1
0.8030886047D+00
0.3361994916D+00

2
~0.7810630108D+00
0.1068948968D+01

1
0.1289902293D+01
0.6383697 171D+00

2
0.6383897171D+00
0.2247173984D+00

DELTA(CONVERGENCE

DF

START

NUMBER

THE

OF

ITERATIDN

G

ARRAY
1
2

THE

F

ARRAY
1
2

ELECTRONIC

THE

F’
1
2

THE

C’
1

ARRAY

=

MATRIX)

=

0.029662

4

1
0.1194670199D+02
0.2971626826D+00

2
0.2971625826D+00
0.9218706199D+00

1
-0.1468074604D+01
-0.1060042442D+01

2
-0.10600424420+01
-0.8099679160D+00

ENERGY

ARRAY

DENSITY

=

~0.4227622763340+01

1
~0.1606447474D+01
-0.3630336096D+00

2
-0.36303360960+00
-0.16289374460+00

1
0.9698136 474D+00

2
0.2438472663D+00

433

434 MODERN QUANTUM CHEMISTRY
2

THE

E

C

ARRAY
1
2

THE

~0.9698136474D+00

1
-0.1596727643D+01
0.00000000000+00

2
0.00000000000+00
-0.61613657601D-01

1
0.8020052066D+00
0.3366806982D+00

2
-0.7821753162D+00
0.1068483366D+01

1
0.128642 4699D+01
0.6400393450D+00

2
0.54003934500+00
0.22670778600+00

ARRAY
1
2

THE

0.2438472663D+00

P

ARRAY
1
2

DELTA(CONVERGENCE

OF

START

NUMBER

THE

OF

G

ITERATION

ARRAY
1
2

THE

F

ARRAY
1
2

ELECTRONIC

THE

F°
1
2

=

MATRIX)

=

0.002318

6

1
0.1194147846D+01
0.2966615832D+00

2
9. 2966615832D+00
0.9213675914D+00

1
-0.1468696868D+01
-0.1060553441D+01

2
-0. 106056344 1D+01
~0.8104708445D+00

ENERGY

ARRAY

DENSITY

=

-0.422752909612D+01

1
-0.1606166506D+01
-0.3630388891D+00

2
-0.3630388891D+00
~-0.1529068377D+00

TWO-ELECTRON

THE

C*

ARRAY

1
2

THE

E

ARRAY
1
2

THE

C

ARRAY
1
2

THE

P

ARRAY
1
2

1
0.9698390734D+00
0.2437461212D+00

2
0Q.2437461212D+00
-0.9698390734D+00

1
-0.16597397746D+01
0.00000000000+00

2
0.0000000000D+00
-0.6166469619D-02

1
0.8019236266D+00
0.3367921306D+00

2
-0.7822689636D+00
0. 1068448236D+02

1
0.1286163006D+01
0.6401631334D+00

2
0.6401631334D+00
0.2268678784D+00

DELTA(CONVERGENCE

OF

START

NUMBER

THE

OF

G

ITERATION

ARRAY
1
2

THE

F

ARRAY
1
2

ELECTRONIC

THE

F°
1
2

DENSITY
=

MATRIX)

=

0.000174

6

1
0.11941085647D+01
0.2966131916D+00

2
0.2966131916D+00
0.9213190068D+00

1
-0.1468636166D+01
-0.1060691833D+01

2
-0.10606918330+01
-0.81060943010+00

ENERGY

ARRAY

SELF-CONSISTENT-FIELD

=

-0.422762913203D+01

1
-0.1606209810D+01
-0. 363039288 1D+00

2
~0.36303928B1D+00
-0.1629068392D+00

PROGRAM

435

436 MODERN QUANTUM CHEMISTRY
THE

C'

ARRAY

1
0.9698409800D+00
0.2437386353D+00

2
0.2437385353D+00
-0.9698409800D+00

1
-0.1897448132D+01
0.0000000000D+00

2
0.0000000000D+00
-0.61668616652D-01

1
0.8019175078D+00
0.3368004878D+00

2
-0.7822652261D+00
0.1068445602D+01

1
0.1286143379D+01
0.6401724156D+00

2
0.54017241560+00
0.2268691372D+00

1
2

E

THE

C

THE

P

ARRAY
Nu»

THE

Le

ARRAY

ARRAY
1
2

DELTA({CONVERGENCE

OF

CALCULATION

CONVERGED

ELECTRONIC

ENERGY

TOTAL

THE

ENERGY

PS
1
2

ARRAY

=

=

DENSITY

MATRIX)

=

0.000013

-0.422762913203D+01
-0.286066199152D+01

F3
0.1529637121D+01
0.6424383099D+00

2
0.1119927796D+01
0. 4703628793D+00

NOTES
1. J. L. Whitten, Gaussian lobe function expansions of Hartree-Fock solutions for the firstrow atoms and ethylene, J. Chem. Phys. 44: 359 (1966).
2. A listing of an efficient diagonalization program is given by J. A. Pople and D. L. Beveridge,

Approximate Molecular Orbital Theory, McGraw-Hill, New York, 1970, Appendix 2.
3. J. S. Binkley, R. A. Whiteside, R. Krishnan, R. Seeger, H. B. Schlegel, D. J. Defrees, and
J. A. Pople, Gaussian 80, program #406, Quantum Chemistry Program Exchange, Indiana
University.

APPENDIX

C

ANALYTIC

DERIVATIVE METHODS AND
GEOMETRY OPTIMIZATION
Michael C. Zerner
Quantum Theory Project
University of Florida

C.1 INTRODUCTION
One of the most successful applications of molecular quantum mechanics
has been the reproduction and prediction of molecular conformation. In
many cases bond lengths are reproduced to +0.02 A and bond angles to
+5° with a variety of simple molecular orbital models, or with minimum

basis set ab initio calculations. Larger basis sets, especially those of double
zeta plus polarization type, and the inclusion of electron correlation are
now producing geometries which challenge crystallography for accuracy.
Armed with the growing success of conformational calculations, one might

even choose the calculated results on isolated molecules over the experi-

mental results obtained in condensed media, as the former may be more
appropriate for the gas phase.

In addition to yielding information about global minima of the potential
energy surface, quantum mechanical calculations yield information on local
minima, which may or may not be observable directly, but which might
be involved in reaction pathways. Similarly, information can be obtained
about transition states and energy barriers that would be difficult or impossible to obtain in other ways.
The gleaning of all this information from a potential energy surface is
difficult. For N atoms, the energy is a function of 3N ~— 6 (or 3N — 5)
437

438 MODERN

QUANTUM CHEMISTRY

degrees of freedom. For detailed statistical calculations, one may have to
live with this “3” problem and visit all regions of the surface that are
thermally accessible. This appendix, however, is concerned with determining only a small part of the potential energy surface: those points that
correspond to minima, representing stable or metastable conformations,
and points that correspond to transition states.

C.2 GENERAL

CONSIDERATIONS

The energy E of a molecular system obtained under the Born-Oppenheimer
approximation is a parametric function of the nuclear coordinates denoted
here as X' = (X,, X2,.... , X3y). We wish to move from E(X) to E(X,),
where q = (X, — X). We expand the energy in a Taylor series about X
as follows:

E(X,) = E(X) + q'f(X) + dq'H(X)q + ---

(C.D

where the gradient is

9E(X)
_
f=
x
and the Hessian is

_

dE(X)

Hy = oy, ax,
Note that subscripts on column matrices designate different matrices, X,,
X,, etc., whereas X, designates the ith element of X. Although the Taylor
series is infinite, close to extrema we expect a quadratic form to be adequate; i.e., for X

=

X,, where X, designates a stationary point and by

definition is characterized by f(X,) = 0,

E(X,) = E(X,) + 4q°H(X.)q
In a similar fashion,
For the point X,

f(X,) = f(X) + H(X)q

(C.2)

f(X) = —H(X)q

(C.3)

= X,,

The solution of Eq. (C.3) is the starting point of the most efficient
procedures used to find extrema of functions of several variables where
the functional form of E(X) is not explicit in X. If H is nonsingular, then

q = —H“'(X)f(X)

(C.4)

which allows the solution for X, from any point X near enough so that the
energy function is nearly quadratic. Similarly, an estimate of E(H,) is

438

MODERN

QUANTUM

CHEMISTRY

degrees of freedom. For detailed statistical calculations, one may have to

live with this ‘“3N” problem and visit all regions of the surface that are
thermally accessible. This appendix, however, is concerned with determining only a small part of the potential energy surface: those points that
correspond to minima, representing stable or metastable conformations,
and points that correspond to transition states.

C.2 GENERAL

CONSIDERATIONS

The energy E of a molecular system obtained under the Born-Oppenheimer
approximation is a parametric function of the nuclear coordinates denoted

here as X' = (X, X2, . . . , X3y). We wish to move from E(X) to E(X,),

where q = (X, ~— X). We expand the energy in a Taylor series about XK
as follows:

E(X%,) = E(X) + q'f(X) + iqhH()q + ---

(C.1)

where the gradient is
_ dE(X%)

f=

ax,

and the Hessian is

_

9E(X%)

H, = aX, aX,
Note that subscripts on column matrices designate different matrices, X,,

X), etc., whereas X, designates the ith element of X. Although the Taylor
series is infinite, close to extrema we expect a quadratic form to be ade-

quate; i.e., for X = X,, where X, designates a stationary point and by
definition is characterized by f(X,} = 0,

E(X,) = E(X.) + $q°'H(X.)q
In a similar fashion,

f(X,) = {(() + HCXOD)q

(C.2)

f(X) = ~H(X)q

(C.3)

For the point X, = X,,
The solution of Eq. (C.3) is the starting point of the most efficient
procedures used to find extrema of functions of several variables where
the functional form of E(X) is not explicit in X. If H is nonsingular, then

q = —H(X)fX)

(C.4)

which allows the solution for X, from any point X near enough so that the
energy function is nearly quadratic. Similarly, an estimate of E(H,) is

ANALYTIC DERIVATIVE METHODS AND GEOMETRY OPTIMIZATION 439
obtained from

E(X.) = E(X) — 3£(X)"H™'(X)£(X)
= E(X) — 4q*H(X)q

(C.5)

For the specific problem of uncovering extrema on the potential energy

surface, it should be pointed out that H~'(X) will not exist unless the

rotations and translations which represent zero eigenvalues of H have been
factored out. This may be accomplished via the B matrix of Wilson and
Eliashevich:!

Y' = X'B

(C.6)

where X has 3N entries and B is 3N x (3N — 6) relating an internal set
of coordinates to the original Cartesian coordinate X. The easiest way to
uncover the structure of the Taylor series in these new coordinates is to
consider the work w, as it is independent of the choice of coordinate system.
Then

work,

which

is force times distance,

coordinate system by

w=

f'q

=

fq

=

can be represented

in either

fB'q

f' = £B'
or
f = f(B)"!

(C.7)

where (B*)~! satisfies
B‘(B‘)-!

=1

A general solution of the above equation is given by
(B‘)"! = mB(B'mB)“!
where m is an arbitrary 3N x 3N matrix, usually taken as a diagonal matrix
containing the reciprocal of each atomic mass three times in the appropriate
positions. It may also be chosen as the unit matrix with six (or five) zero
entries chosen to prevent translation and rotation. A simple choice of this
type is to place atom 1 at the origin, atom 2 on the z axis, and atom 3 in
the xz plane. Then the six (or five) coordinates removed are x, = y,; =
z, = 0, x, = y. = 0, and y;, = 0. If y; = 0 implies x, = 0 for any choice
of third atoms, then the molecule is linear and only five degrees of freedom
are chosen. In practice, inverting H will prove to be of little difficulty. The
update methods that are discussed below build up H™' directly and are
constructed in such a way as to never update the rotations and translations.
In the analytic evaluation of H, the rotations and translations can be removed as previously discussed, or, if the inversion proceeds via diagonalization, the six (or five) zero eigenvalues of H can be replaced with an
arbitrary large number, essentially uncoupling these modes in the inverse.

440

MODERN

QUANTUM

C.3 ANALYTIC

CHEMISTRY

DERIVATIVES

We now turn to the calculation of f and H in quantum chemistry. A straight-

forward approach is to simply numerically differentiate the energy. Alternatively, it is possible to obtain these derivatives by analytic derivative
methods. Let us illustrate some of the essential ideas in the framework of
Hartree-Fock calculations.
The Hartree-Fock energy depends explicitly on the occupied molecular
orbital coefficients C and on X. Its derivative is given by

dE

aE

aX,

OX,

dE dCi

+
ya

Cua

(C.8)

OX,

where d£/8X,, represents the derivative of all terms with explicit depen-

dence on the nuclear coordinate X,, and where the chain rule term arises
from the implicit dependence of the molecular orbital coefficients on ge-

ometry. Since dE/dC,, = 0 is the condition for the Hartree-Fock solutions
(Subsection 3.2.1),

0E

dE

aX,

= 3X,

(C.9)

This realization allows one to ignore to first order the change in molecular
orbital coefficients with respect to geometry changes. The total energy of
a closed-shell system in the Hartree-Fock approximation can be written as

E=

2 P,,He + 4 > P,P uv| lod) + Van

(C.10)

Mag

(see Eqs. (3.184), (3.185), and (3.154)) where we have defined
LZ,

Vw=>>
A

sat

A>B

Rap

and introduced the shorthand notation

(u»| |cd) = (wed) — Hudloy)
For real orbitals, the density matrix is
N/2

Py = 2 > Cu
(see Eq. _

ae

avo

Differentiating a

2

P,

x

oe

+ 3 oP
x

0X4

(C.10) yields

15D

P,

%

Po

Hyrore + x5 uP
prrems

a(ur| |oA)

aX,

Wwe

(uv| |oA)

ot

OV nw

aX,

TD

(C.11)

ANALYTIC

DERIVATIVE

METHODS

AND

GEOMETRY

OPTIMIZATION

441

Equation (C.11) suggests that derivatives of the coefficients are required,
whereas Eq. (C.9) does not! Expanding the last two terms of Eq. (C.11)
gives
N24

=4

2

25

N/I2

SHC

>

>

VAG

:

N/2

=

Ne OC nap
4D

Pw

a

ueS| Hee + SP, (url

(I

dX,

loA)Cva

Jy |

aK Fn

NI2

42h
To evaluate

+4

oc

ay, Sul
Cua

¢

the derivative of the coefficients,

normality condition of the molecular orbitals is
>

uw

CS

yxCrb

=

we

recall that the ortho-

Ou

(see Exercise 3.10). Differentiating this yields

2 25

oe

_ Cua

Combining these rs
ox, = 2uw

as my

2

=

Culm 5 x,

results in
OH
P
Py aX,

(ur |oA)
P,P
“
aX,

+d

|, Vn
2 Q,° 5 et aX,

(C.12)

where we have defined
NI2

Quy = 2 >) GCC
Thus the derivative of the energy can be calculated using the molecular
orbital coefficients and the derivatives of the overlap and the one- and twoelectron integrals.
‘
Taking derivatives of the integrals that appear in electronic structure
theory in an effective manner is a somewhat specialized area, but we can
easily understand the general ideas. Most ab initio calculations are per-

formed using Cartesian Gaussian functions
GF

imn

—

Non

i

XaYa

—alr—R,?

Za€ al

al

442

MODERN

QUANTUM

CHEMISTRY

(see Section 3.6), where Non, is a normalizing constant given by

N= [Se
ion 1 (2D (2m) (27)!

(2)"
7

and where lowercase a refers to electronic coordinates measured from
nucleus A. The derivative of @f*, with respect to the nuclear coordinate is
relatively straightforward, yielding, for example,
a GF

@

APP = (Ql + Da}76 Em — 21

~ )

1/2

PF

where now X, refers specifically to the x coordinate of nucleus A It should
be understood that the second term in the above equation is not considered
when / = 0.
The derivative of all one-center integrals is zero, for it is usually assumed that all orbitals on center A follow the displacement of center A.
The kinetic energy operator, and the electron-electron repulsion operator
r,', are not functions of nuclear coordinates. The derivative of the nuclearnuclear repulsion energy Vy, is again straightforward:

OVnn _
ZX, ~ X,)
ax,
Z, >B
R3,
For the nuclear-electronic attraction term, one finds
IV ne

ax,

_

-4 2

x,

a

~~

ny

Xa

The above equations are sufficient to evaluate the gradients of all
integrals that are met in electronic structure calculations. In actual practice,
however,

many

tricks are used

to reduce

the computational

work.

The

evaluation of the gradients when Slater-type functions are used (see Sections 3.5 and 3.6) is more difficult, but could proceed along the same lines
as for Gaussian functions, at least for the two-center integrals that usually
appear in semiempirical models.
The relative simplicity of Eq. (C.12), with no derivative of P appearing,

should not be confused with the Hellmann-Feynman theorem.” Given that

E = (®|.7|®)

with (b|@) = 1, then
dE
—
OX,

o®
=
(—, |# |®)
(2 ||
)

+

(9.4%
( [7

o®
|=)
ee)

Cea
+
(®|—
( a

|®

)

(

C.13

)

ANALYTIC

DERIVATIVE

METHODS

AND

GEOMETRY

OPTIMIZATION

443

The Hellmann-Feynman condition, then, is that
a®

(2

—

|x ) + C
|.

a®

" ie)

H

———

=

0

(C.14)
.

which holds only for exact solutions, or certain classes of trial functions.

Under the constraints of Eq. (C.14), Eq. (C.13) is simply

dE
aH
3x7 (
)

(C.15)

ax,

Equation (C.15) is the expectation value of a simple one-electron operator
plus the derivative of the nuclear repulsion term. Equation (C.12), however, does not depend on Eq. (C.14). The integrals in dH°°*/dX, and

8(uvlo/)/8X, involve the wave function through “atomic orbital follow-

ing”—i.e., 063/0X,, where #4 is an atomic orbital on center A—and are
far more complicated than those of Eq. (C.15). In practice, the forces
evaluated through Eq. (C.15) can be large even when they are found to
be zero under Eq. (C.13) and thus represent an extremum of the energy
function. Nevertheless, the simplicity of Eq. (C.15) is appealing, and one
wonders if the increased inconvenience of meeting the condition of Eq.
(C.14) is not repaid in utilizing Eq. (C.15) when the goal is geometry
optimization.
For a configuration interaction (CI) wave function involving determinants |¥;),
|®q)

=

>

I

cl¥)

one obtains for the energy derivatives

dE _ dE

=

0X,

=a t

GE Cy

=

0X,

wi

6C,

aE cy

—

+

0X,

tT

Oc;

ox,

(C.16)

where now the first sum is over ail molecular orbital coefficients. In this
case, 8E/aX, = dF/aX, only for a multiconfiguration self-consistent field
(MCSCF) function. For the general Hartree-Fock plus CI wave function,
dE/dc,

= 0 and

OE _ OE
0X,

0X,

> BE 8Cn
“ul

aC, 0X,

(C.17)

The evaluation of dC,,/dX,, is complicated, but can be approached through
perturbation theory.* The contribution to the forces of the second term
might be expected to be small for a large Cl as the dependence of the
energy on C is downgraded, or for a system without a great deal of bond
polarity, or for a system in which the molecular orbitals are determined

444

MODERN

QUANTUM

CHEMISTRY

by symmetry. Under such situations, an initial search can be made of the
surface using Eq. (C.9), but for accurate results reliance on this approximation is not satisfactory.
Second derivatives of the Hartree-Fock energy can be obtained directly
from Eq. (C.12):
_

PE

aX, dX,

=>

&

P

a

2 ‘Heore

ue

+2

aXaXn * 24

_ S 0,

P,

2
PS,

Pig

(uv

ox,

)

5 aP,, dH°core

OX, 6X, * aX, 0X;

+ 2 Puy

le

A

aX, aX,

PV 2 nw

OP io a(ur| |cA)

vos

7

“1 aX, aX,

dQ,

OS ys

2 aX, aX,

The Jast three terms of this expression involve the derivatives of the molecular orbital coefficients and cannot easily be avoided. They are obtained
through coupled perturbed Hartree-Fock theory (CPHF).3

C.4 OPTIMIZATION

TECHNIQUES

There is a rather large literature on numerical methods for finding stationary points of a function of many variables. They may be classified as
follows:
(a)
(b)
(c}
(d)

methods
methods
methods
methods

without gradients
with numerical gradients and second derivatives
with analytical gradients and numerical second derivatives
with analytical gradients and analytical second derivatives

and so forth.
All but the first of these methods are based on the Taylor expansions
of the function E and its derivatives f as given in Section C.2. In practice,
they can be applied as “estimate” techniques, or as “‘iterative”’ techniques.
Type d methods might be preferred, since they utilize the greatest
amount of information, but this is the case only if the analytic first and

second derivatives can be obtained at the same

time, and with the same

ease, as the energy E. It is clear, however, that insofar as our initial estimate
of the geometry at an extremum is within the quadratic region of the valence
bond force field (the Y coordinates of Eq. (C.6)), a single application of Eqs. (C.4) and (C.5) gives X, and the energy E(X,). Such a single
application of Eq. (C.4) we shall call an estimate. If we are not within the
quadratic region of the potential, the estimate may not be very accurate,

and it may be desirable to iterate; that is, having determined a new set,

ANALYTIC DERIVATIVE METHODS

AND GEOMETRY

OPTIMIZATION

445

X,, from the initial guess X,, we might solve the equations of Section C.2
for X,. This requires f(X,) and H~'(X,). This procedure might then be
repeated until E,, ~ E,_, is below a given threshold, o = f(X,)‘f(X,) is
below a given threshold, qjq, is below a given threshold, or all three.
In practice, type d algorithms are not used routinely in geometry
searches, because of the difficulty that arises in analytically obtaining the
second derivatives. First derivatives, on the other hand, are generally evaluated in a time comparable to the evaluation of the energy itself. For this
reason, type c algorithms are the most popular and are implemented in
most modern quantum chemistry programs. Unfortunately, most algorithms that search for transition states require analytic second derivatives,
and are thus very expensive in computer resources. Analytic second detivatives are also of use in determining whether an extreme point of the
potential energy surface is a minimum (all eigenvalues of the Hessian
positive) or a transition state (one and only one eigenvalue negative), and
in yielding the vibrational spectrum at a minimun, if this is sought.

C.5 SOME

OPTIMIZATION

ALGORITHMS

The simplest of the methods are of type a. The simplest of these are the
so-called axial iteration or univariant techniques. A set of internal coordinates are chosen, and the potential energy is minimized with respect to
each coordinate in turn. After completing the 3N — 6 = m independent
searches, one returns and repeats the procedure until the change in coordinates is below a given threshold.
One successful procedure of this sort is to step along each coordinate
Y, by a,. If ECY + ae.) < E(Y), where e, is the unit vector along i, repeat
the step until E(Y + rae,) > E(Y + (r — 1)a@e,), r an integer. The new
coordinates are Y = Y + (r — 1)ae,. If E(Y + ae) > E(Y), step in the
other direction until E(Y — rae) > E(Y — (r — 1)ae,). Again, the new

coordinates are Y = Y — (r — 1)ae,. If E(Y) is of lower energy than both
E(Y + ae,) and E(Y — ae,), then a quadratic is fitted through these three
points and the minimum is found. The coordinates Y are updated and a,
is set to a,/4. This procedure is repeated for all i, and then iterated until
all a, are below a specified threshold.

The most effective of the type a algorithms seems to be of the simplex
type, and this is a very useful technique for problems where gradients are
not available. The method given below is that of Nelder and Mead.* Figure
C.1 is a schematic attempt to follow this method for two variables.
Consider m variables. Xy, X,, ... , X,, are the m + 1 independent
points in this »7-dimensional space that defines the ‘“‘simplex.” E, designates
the value of the energy E(X;). Let E,, be the highest value of {E,} and E,

B)

Yp
Figure C.1 The simplex method, where h designates E,, C designates the centroid of points:
(A) a successful reflection (*) but failed expansion (**); (B) a failed reflection (*) but successful
contraction (**).

446

ANALYTIC DERIVATIVE METHODS AND GEOMETRY

OPTIMIZATION

447

the lowest. Let X be the centroid of the points {X},«, and [X,X,] the distance

between X, and X,.

[XXP = > [X). — (XP
In the above, (X,), is the ath component of the vector X;. The reflection

of X,, is denoted X* and its coordinates are given by

X* = (1 + a)X — aX,

_ [x*X]

o £XX]

(C.18)

where a is called the reflection constant and is positive. X* is thus on a line
joining X, and X, but reflected to the far side of X from X,. Three possibilities ensue. If E, << £* < E,, then X, is replaced by X* and one starts
again with a new simplex, reflecting the new X,, etc.

If E* < E,, if the reflection has produced a new minimum, then X* is

“expanded” to X** by

X** = vX* + (1 — v)X

[x**X]
v=
>1
[X,.X]

(C.19)

where v is the expansion coefficient. If E** < E,, X, is replaced by X**
and the procedure is restarted. If E** > E,, then the expansion has failed
and X,, is replaced by X* before restarting.
Finally, if E*

> E, for all i—i.e., if replacing X, with X* leaves E*

the new maximum—then a new contraction is examined (see Fig. C.1B):

X** = BX, + (1 — f)X

B

_

[X**X]

[XX]

(C.20)

The contraction coefficient f lies between 0 and 1. X** replaces X,, unless
E** > min (E(X,), E(X*)). In the latter, rather rare case, all X, are replaced

by (X, + X,)/2 and the process is restarted.
Nelder and Mead‘ suggest the values a = 1, 8 = 4, v = 2 and discuss
the mathematical implications of this strategy.

448

MODERN

QUANTUM

CHEMISTRY

Exercise C.1

(a) Consider the quadratic function E = E, + 3K(x - af +
4K'(y — by + K"xy. Use the Newton-Raphson equation

(Eg. (C.4)) to solve for g = (4, — x,y) — y); ie., “evaluate”
H~'(X) and f(X). You can easily check your result by letting the
coupling constant K” equal zero.

(b) Let a = 3.00 a.u., b = 2.00 a.u., K = 1.000, and K’ = 0.100.
Given the three different coupling cases (1) K"” = 0, (2) K” =

0.010, and (3) K” = 0.030, solve the equation of part (a) for (x,,

y-}. Notice that the shorter, ‘“‘weaker’’ bond is affected much more

by the coupling than is the stronger bond.

Exercise C.2 Consider case 3 of Exercise C.1b. Evaluate the gradient
and the Hessian at x = 3.3, y = 1.8 and solve the Newton-Raphson
equation of Exercise C.1a for (x, y;). Comment on this. In practical cases,
the quantum mechanical potential energy surface is not quadratic, especially for regions as far away from the neighborhood of the minimum as
(x, y) in this example.
Exercise C.3 Consider the potential energy function of Exercise C.1.
Form the simplex of points (x, y) = (3.3. 1.8), (3.0, 1.5), and (2.7, 2.1).

Follow the algorithm of Nelder and Mead, making three successive moves

for all three coupling cases. Follow the centroids you calculate as a function
of cycle number. In cases where there are few variables, “contractions ’
often dominate the moves, and this is the case here.

The simplex method is rather easy to program for a computer. If this
is done, all three coupling cases yield answers accurate within +0.002 for
x and y within 15 cycles. For comparison, the univariant method needs 11
energy evaluations for case 1, in which the variables are weakly coupled;

and 22 evaluations for case 3, where they are strongly coupled. The advantage of the simplex method over the univariant method becomes even
greater when the number of variables increases.

The most efficient methods that use gradients, either numerical or
analytic, are based upon quasi-Newton update procedures, such as those
described below. They are used to approximate the Hessian matrix H, or
its inverse G. Equation (C.4) is then used to determine the step direction
q to the nearest minimum. The inverse Hessian matrix determines how far
to move along a given gradient component of f, and how the various
coordinates are coupled. The success of methods that use approximate
Hessians rests upon the observation that when f = 0, an extreme point is
reached regardless of the accuracy of H, or its inverse, provided that they
are reasonable.
The most popular quasi-Newton update procedures used at this time

ANALYTIC

DERIVATIVE

METHODS

AND

GEOMETRY

OPTIMIZATION

449

are the Murtagh-Sargent® variant of the Davidon-Fletcher-Powell method
(MS),° and the Broyden-Fletcher-Goldfarb-Shanno (BFGS) algorithm.’

Consider first the energies E,, and E,,_, and the gradients f,, and f,_,
obtained at two geometries characterized by X,, and X,,_,. If the energy
were

a quadratic

function

of the

coordinates,

then

the

Hessian

H,,_1 = H) would relate the coordinates to the gradients by

(H,

=

Hq, = Hq, = 4,

or

Gn

=

xX,

d,,

= f,

—

X,-1

~ fi-1

Gd, = H-'d, = q,

(C.21)

Equation (C.21) expresses the quasi-Newton condition, and any procedure
that constrains G to obey Eq. (C.21) is a quasi-Newton procedure.
An “update” procedure is generated by defining a sequence G,, that
approaches H~'(X,) for sufficiently large n. Given G,,_,, then

G, = Gia + W,

(C.22)

where W, is the correction to G,_,. Inserting Eq. (C.22) into Eq. (C.21)
generates a quasi-Newton update procedure:

(G,-1 + W,)d, = Gr

(C.23a)

In a “rank 1” procedure, such as MS, W is chosen as
U,

W, =a4,|

°

|(Ui--- > Un) = aqU,Ut

(C.23b)

Un,
Equation (C.23a) becomes
G,-14, + a,U,U'd,

= q,

(C.23c)

The number a, is an arbitrary scale, and can be used to scale U,, so that

a,' = U'd,

(C.24a)

U, = qn — G,-1d,

(C.24b)

yielding

These equations form the basis of the Murtagh-Sargent procedure.
Equation (C.4) defines the search direction, but the actual step is often
scaled:
qn

=

X,

~

Xi-1

=

= O-1G,-1f,-1

(C.24c)

450

MODERN

QUANTUM

CHEMISTRY

Exact line searches determine that value of a that minimizes the energy
along the search direction defined by q,. Partial line searches can be designed with less stringent demands, the weakest requiring only that E,, <
E,,-1. The situation is depicted in Fig. C.2. In practice, it is found that
exact line searches are seldom worth the extra calculations required to
minimize the energy along the line: far better is just to require a reduction
in energy.
The popular Murtagh-Sargent algorithm proceeds as follows:

STeP 1: Set ap = $ and Gy, = I. Use Eq. (C.24c) to obtain a new set

of coordinates X.

If E, > Ep, repeat this step with a) = $ a until E, <

Eo. This is equivalent to the method of steepest descent with “‘half-steps.”
STEP 2: Form

Uy =
=

— ay Gyfk
-G,ih

= Ud,

— Gai

— fe)

+ feei(a%-1 — D]

= UL

— £1)

T, = UU,

If ag! < 10-57, or a,Ujf,_, > 1075, G, is reset to 1 and a, is reset to 4.

These tests ensure the stability of G,; that is, G, remains positive definite
after update.> With reasonable starting geometries, G, is seldom reset to
1, a fortunate finding, for the reset would mean the loss of all information

about the curvature of the surface built up from previous cycles. If these
two tests are passed, then G, is updated by Eq. (C.22) and a, is set to
unity.

STEP 3: Equation (C.24c) is solved to find a new set of X,. E, and f,

are calculated. If E, = E,_,, one returns to step 2 until o/m

~ fif,/m <

10-3 a.u., with m again the number of independent variables, at which
point most bond lengths are converged to +0.01 a.u. and bond angles to
+1.0°. If E, > Ex_1, a -; = 4a,_; (a “backstep”) and step 2 repeated
without updating the “counter” k.
An important feature of the Murtagh-Sargent procedure is that a stationary value of E is obtained at the latest in m + 1 steps even if H is
singular. In practice, far fewer steps than m + 1 are required if reasonable
guesses on starting geometries are available.
The “‘rank 2” methods use an update of the form

G, = G,-, + 4,U,U;, + 6,V,Vi,

(C.25a)

Placing Eq. (C.25a) in the quasi-Newton condition of Eg. (C.21) does not
uniquely determine U and V (one equation, two unknowns!) but leads to

"SUOKE NITED 389} AURUE YSNOIY) SPEUE UOIZBAIASQO UE ‘UINUTTUTUE ay} 0) 2DUaTIAAUOD ayesozao0e JOU ABUT yoseas our] JOexe ue Aq posnbas suonenoeo
B1)X2 JYJ JeYJ ySadTNs 0} payonsysuos st ainyoid oyy “Apoanoadsas ‘sayoseas ouly exa puUe fered YsNOJy) pouleIgO SaloUoEs 9Y} WO] dALOp
1+"8 pue '+"b suonoadp ayy ‘Yoseas oury pensed e wos} poureygo st (,) Aq payoidap Anauload ayy ‘yoseas oul] Joexe ue SoyeUsISAp (,,) ‘eAnpadoid
SOA 10 SW au) UO sdeysod ‘pauruajap si “b uoKsomp ou ‘'-“K JuIod Wo BuNIeIg "YosRas aU] ay) JO UONEJUASeJdas ONeUIOYOS 7D aIMSLy

Yb

451

452

MODERN

QUANTUM

CHEMISTRY

a “Broyden family” of solutions. The most successful of these for quantum
chemical applications appears to be the BFGS method,’ defined by

_ (, _ od,

©, = (1

et G(1

_ adi\" | aa

qd)

‘qa,

(©20)

The BFGS method has the important advantage over the MS method that
the updated Hessian will remain positive definite (i.e., all eigenvalues of
the second derivative matrix will remain positive) and thus a step in the
direction given by Eq. (C.4) with G,, obtained from Eq. (C.25b) can always
be made to reduce the energy. In practice, the BFGS algorithm is usually
more successful than the MS algorithm, especially for larger molecules with
many soft vibrational modes. Several line search procedures have been
devised for the BFGS method, but again, it appears that partial line
searches are the most effective in finding minima.®

Exercise C.4 Using the trial energy function of Exercise C.1, and
starting with the point (x, y) = (3.3, 1.8), apply the MS method for case
3 of that problem. Assume that the energy £ and the derivative f are easy
to obtain, but not H. Perform three steps with this algorithm. After three
moves, one is remarkably close to the final result. Note also that the energy
along the softer mode is the more difficult to minimize.

C.6 TRANSITION

STATES

A transition state occurs when f(X,) = 0 (a stationary point) and one and
only one eigenvalue of H(X,) is negative. These two considerations define
a simple saddle point. In addition, E(X,) should be the highest-energy
point on a continuous line connecting reactants and products; i.e., X,
should represent the saddle point of highest energy. Such a definition tends
to associate clearly one side of the “pass” with reactants, the other with
products. In addition X, must represent the lowest-energy point which
satisfies the above three conditions.
Clearly, finding transition states is more difficult than finding simple
minima. Unlike the algorithms described for finding minima, algorithms
for finding transition states do not always succeed! Part of the problem is
that it is difficult to ensure movement along a surface that exactly meets
the conditions of a simple saddle point. In addition, a difficulty may reside
in the fact that wave functions for a transition state may be considerably
more complex than those that describe minima.

ANALYTIC DERIVATIVE METHODS

AND GEOMETRY

OPTIMIZATION

453

Defining, as before

o(X) = 2» fi) = £(X)'f(X)
we seek points for which o(X,.) = 0. Since o(X) = 0, least squares minimization procedures are appropriate.? Such a procedure, however, will
force convergence to any stationary point X,, and so care must be taken
with the (initial) guesses. Chemical intuition is of great use here!
There are many methods of least squares minimization. The general
starting point is, again, a Taylor expansion:
OX

11) = O(X)

+ Gear
Ve + bap: Tides

Gk+1 = Meri

— X

+

++ (C.26)

where V, is a column vector, the elements of which are

(a0X)
_
(V,)i = ( aX, )

(C.27a)

and

_ ({ &o(X)

(Ti)y = (2 »)

(C.27b)

At the minimum value of a, o(X.) = 0 and V(X,) = 0. Examining the
Taylor series expansion for V(X,) in an analogous fashion to Eq. (C.2)
suggests the iterative equation
Gist =

—(Ti)7'V,

(C.28a)

where

V, = 2Hf,

(C.28b)

T, = 2(H{H, + C,)

(C.28c)

(Cv = 3 higg Se

(C.284)

and

with

a can be minimized in exactly the same fashion in which E itself was
minimized, e.g., by using the Murtagh-Sargent or the BFGS procedure
already described. A’ generalized Newton-Raphson method may also be
employed, assuming

T, ~ 2H'H,

454

MODERN

OUANTUM

CHEMISTRY

Interestingly, T,, by this construction is guaranteed positive semidefinite,
and (T,)~! is a good candidate for the Murtagh-Sargent procedure. If the
initial geometry is not sufficiently close to the transition state, minimization
of ¢ will not succeed. Then various geometric algorithms might be used to
help get sufficiently close. One such method maximizes the energy along
a line connecting reactants with products. Then the energy is minimized
in the hyperplane perpendicular to this direction, perhaps by the BFGS
or the MS method (see Fig. C.3). This procedure might be repeated until
the saddle point is found or, after several moves,

¢ is minimized

as de-

scribed above.
Another interesting procedure uses the concept of a gradient extre-

Xe

SS

Figure C.3 An energy contour diagram as a function of coordinates X, and X2. A gradient
extremum is depicted by the arrow, with its tail on the energy contour with value E>. Point
A represents the reactant, B the product, and C the sought-after transition state. Imagine
also on this plot the geometric search described in the text. In this algorithm, the energy
along the line AB is maximized, and point D is found. Then a search 1s made for the minimum

energy in the hyperplane perpendicular to line AB and passing through point D.

ANALYTIC DERIVATIVE METHODS

AND GEOMETRY

OPTIMIZATION

455

mal.!° This is defined as the smallest energy gradient along a constantenergy contour, as shown in Fig. C.4, and can be used to proceed uphill
along the softest direction from any point on the potential energy surface
including a minimum. The gradient extremal is formed by

ax. [ff — 2A(E — E,)] = 0

(C.29)

where 2/ is a Lagrange multiplier. This yields the eigenvalue equation

H(X)f(X)

= ACX)ICX)

(C.30)

In the quadratic region,

H(X)

= H

(C.31a)

A(X) =A

(C.31b)

f(X) = £(X,.) + Hq

(C.31c)

Saddle
Point
Figure C.4 Graphic representation of the gradient extremal leading from a minimum to a
saddle point following Eq. (C.34). The direction q, has followed the lowest vibrational frequency at the minimum.

456

MODERN

QUANTUM

CHEMISTRY

and

(H

— A1)Hgq

=

—(H

- ADf

(C.31d)

The equations of group (C.31) are equivalent to the quasi-Newton constraint. Diagonalizing Eq. (C.30), we choose the eigenvector V = f, which
overlaps with the direction we are interested in, and introduce the projector

= (1 - VV’)

(C.32)

and project the step along the direction
PHgq

=

—Pf

Since

PH

= HP = PHP

we find

Pq = —PGf

(C.33)

which is a projected Newton-Raphson equation, with direction chosen along
the gradient extremal defined by Eq. (C.30). The actual step taken is given

by

q = —PGf + aV

(C.34)

which satisties Eq. (C.33). The constant a is again an arbitrary scale chosen
to correct for the finite size of each step, as indicated in Fig. C.4.'°

C.7 CONSTRAINED

VARIATION

It is clear from the outset that the fewer the degrees of freedom that are
varied in the study of the energy surface of a system, the easier it will be
to obtain stationary points on that surface. The five or six degrees of
freedom representing translation and rotation may always be removed
exactly without any real constraints on the optimization procedure. If there
exists symmetry in the system, then symmetry-adapted coordinates may
be used in the optimization procedure, again simplifying the calculation.
Considering formaldehyde, H,CO,

there are 12 coordinates, reduced to 6

by removing translation and rotation. Considering C;, symmetry, only three
variables remain, the CO and CH bond lengths and the OCH angle.
Some care must be exercised when using symmetry in optimizing geometry. Except in cases in which the electronic state is degenerate, gradient
optimization methods will not reduce symmetry, for the gradients that do
so are zero. If this corresponds to a minimum, as, for example, in trigonal
NH;, then considerable effort might be saved; but if a geometry search
starts with planar NH;, the molecule will remain planar. In this case the

ANALYTIC DERIVATIVE

METHODS

AND GEOMETRY

OPTIMIZATION

457

gradient perpendicular to the plane is zero, and the planar structure is the

transition state for the NH; inversion. When there is doubt, it is better to

let symmetry arise as a result of the optimization, and not as an assumption.
Symmetry constraints do not affect our ability to obtain exact stationary
points on the potential energy surface. To ease the calculation, however,
we might also consider constraints on the variables suggested by “chemical
intuition.” In the above example of formaldehyde, we might fix the CH
bond at a typical value of 1.1 A and vary only the CO bond length and
the OCH angle. If we are interested in the biphenyl C—C bond between
the phenyl moieties, we might fix all the coordinates except this C—C bond
length and the dihedral angle between the two phenyl planes. The saving
of effort can be substantial, but it is clear that the accuracy of the results
obtained will depend on the soundness of our intuition.
Somewhat more dangerous is the use of such intuition for problems
that follow pathways on the surface (valleys). In examining internal rotations—for example, of ethane—it is tempting to freeze all bond lengths
and angles except the torsional one. This is a reasonably accurate procedure, but if one has started with optimized coordinates for the minimum,
the barrier, calculated without relaxing all coordinates, might be too large.
In the search for reaction pathways, freezing coordinates will generally
lead to an overestimate of barrier energies.
Worse, by freezing coordinates we prejudice the direction of the path,
and so can completely miss alternate pathways, the lowest-energy pathways, and perhaps even the most important transition state! New methods
that probe the rotational energy surface for stable geometries and for
transition states for a wide variety of wave functions are currently becoming
available. The literature is now full of interesting applications using these
methods, and a dream of theoretical chemistry is being achieved. From a
collection of nuclei, and a given number of electrons, quantum chemistry
can construct molecules.

NOTES
1. See, for example,

E. B. Wilson, J. C. Decius, and P. C. Cross, Molecular Vibrations,

McGraw-Hill, New York, 1955.
2. H. Hellmann, Einfiihrung in die Quantenchemie, Franz Deuticke, Leipzig, 1937; R. P.
Feynman Phys. Rev. 41: 721 (1939); A. C. Hurley, Proc. Roy. Soc. A226: 170, 179

(1954).
3. See, for example, J. A. Pople, H. Krishnan, H. B. Schlegel, and J. S. Binkley, Int. J.

ne

Quantum Chem.

§13: 225 (1979), and references therein.

J. A. Nelder and R. Mead,

Comput.

J. 7: 308 (1965).

. B. A. Murtagh and R. W. H. Sargent, Comput. J. 13: 185 (1970); a principal disadvantage
of this method is that for poor starting geometries it is plagued with “resets.”

6. W. C. Davidon, AEC Research & Development Report ANL-5990 (1959), and Comput.
J. 10: 406 (1968); R. Fletcher and M. J. D. Powell, Comput. J. 6: 163 (1963).

458 MODERN

QUANTUM

CHEMISTRY

7. R. Fletcher, Comput. J. 13: 317 (1970); D. Goldfarb, Math. Comput. 24: 23, (1970); D.
F. Shanno, Math. Comput. 24: 647 (1970); C. G. Broyden, Math. Comput. 21: 368 (1967).
8. J. D. Head and M. C. Zerner, Chem. Phys. Lett. 122: 264 (1985).
9. J. W. McIver, Jr., and A. Komornicki, J. Am. Chem. Soc. 94: 2625 (1972).
10. P. Jorgensen, H. J. A. Jensen, and T. Helgaker, Theoret. Chim. Acta 73: 55 (1988);
D. K. Hoffman, R. S. Nord, and K. Ruedenberg, Theoret. Chim. Acta 69: 265 (1986).

FURTHER

READING

Head, J. D., Weiner, B., and Zerner, M. C., A survey of optimization procedures for stable
structures and transition states, Int. J. Quantum Chem. 33: 177 (1988).
Head, J. D., and Zener, M. C., Newton-based optimization methods for obtaining molecular
conformation, Adv. Quanturn Chem. 20: 1 (1988).
Helgaker, T., and Jorgensen, P., Analytical calculation of geometrical derivatives in molecular
electronics structure theory, Adv. Quantum Chem. 19: 183 (1988).
J@rgensen, P., and Simons, J., Geometrical Derivatives of Energy Surfaces and Molecular
Properties, Reidel, Dordrecht, Netherlands, 1986.
Press, W. H., Flannery, B. P., Teukolsky, S. A., and Vetterling, W. T., Numerical Recipes,
Cambridge University Press, Cambridge, 1986. Chapter 10 discusses the problem of
optimizing functions and provides FORTRAN implementations of the Nelder-Mead and
BFGS algorithms. Highly recommended!
Pulay, P., Analytical derivative methods in quantum chemistry, Adv. Chem. Phys. 69: 241

(1987).

Schlegel, H. B., Optimization of equilibrium geometries and transition structures, Adv. Chem.
Phys. 67: 249 (1987).

APPENDIX

D

MOLECULAR INTEGRALS FOR
H, AS A FUNCTION OF
BOND LENGTH

All quantities are in atomic units. The integrals are for a minimal basis
STO-3G calculation with Slater exponent ¢ = 1.24, as described in the text

(Subsection 3.5.2).

R

&

£2

Ju

Jiz

Jr2

Ki2

0.6
0.8
1.0
1.2
1.4
16
1.8
2.0
2.5
3.0
40
5.0
75
10.0
20.0
100.0
co

—0.7927
— 0.7321
— 0.6758
— 0.6245
— 0.5782
— 0.5368
— 0.4998
— 0.4665
— 0.3954
—0.3377
— 0.2542
—0.2028
—0.1478
—0.1293
—0.1043
— 0.0843
— 0.0793

1.3327
1.1233
0.9418
0.7919
0.6703
0.5715
0.4898
0.4209
0.2889
0.1981
0.0916
0.0387
—0.0114
—0.0292
—0.0543
— 0.0743
—0.0793

0.7496
0.7330
0.7144
0.6947
0.6746
0.6545
0.6349
0.6162
0.5751
0.5432
0.5026
0.4808
0.4533
0.4373
0.4123
0.3923
0.3873

0.7392
0.7212
0.7019
0.6824
0.6636
0.6457
0.6289
0.6131
0.5789
0.5512
0.5121
0.4873
0.4540
0.4373
0.4123
0.3923
0.3873

0.7817
0.7607
0.7388
0.7176
0.6975
0.6786
0.6608
0.6439
0.6057
0.5734
0.5259
0.4947
0.4547
0.4373
0.4123
0.3923
0.3873

0.1614
0.1655
0.1702
0.1755
0.1813
0.1874
0.1938
0.2005
0.2179
0.2351
0.2651
0.2877
0.3206
0.3373
0.3623
0.3823
0.3873

459

INDEX
Ab initio calculation, 147
Adiabatic ionization potential, 194
Ammonia
bond angle
via MBPT, 372
via SCF, 202
bond length
via MBPT, 371
via SCF, 202
dipole moment
via MBPT, 378
via SCF, 205
ionization potential
via Koopmans’,

via MBGF, 407

198

orbital energies, 198

population analysis, 203, 204
SCF energy, 192

Angstr6m unit, 43
Annihilation operator, 90
Anticommutator, 4, 90, 92
Antisymmetrized two-electron integrals, 67
Antisymmetry principle. 46, 50
Atomic units, 41

Basis, 2
Basis fu.ictions, 57, 136
Basis set correlation energy, 234
Basis sets. 180
STO-NG, 156, 184
4-31G, 186
6-31G", 189
6-31G**, 189
double zeta, 186
minimal, 57, 184
Basis vectors, 2, 9, 10
BeH, (see Beryllium hydride)
Beryllium atom
pair energies, 285
Beryllium hydride, 248
Bethe-Goldstone theory, 273
Bohr unit, 42
Born-Oppenheimer approximation, 43
Bra vectors, 10

Brillouin’s theorem, 128, 235, 352, 356
Canonical Hartree-Fock equations, 120

Canonical orthogonalization, 144, 173

Carbon monoxide
bond length
via MBPT,

372

via SCF, 201
dipole moment
via CI, 251
via MBPT, 378
via SCF, 204
ionization potentials
via Koopmans’,

195

SCF energy, 192
CCA (see Coupled-ctuster approximation)
CEPA (see Coupled electron pair
approximation)
CH, (see Methy! radical)
CH, (see Methane)
Charge density, 138, 203, 212

Chemists’ notation, 67
Cl (see Configuration interaction)
Closed shell determinant, 83, 101, 132
Cluster form of the wave function, 290
CO (see Carbon monoxide)
Commutator, 4

Completeness relation, 3, 11
Configuration interaction (CI), 61, 231
Contracted Gaussian functions, 155, 181
Contractions, 155, 181

Convergence of SCF procedure, 148
Core-Hamiltonian, 64, 114
matrix, 140
Correlation energy, 61, 231, 238
Coulomb integrals, 85, 209
Coulomb operator, 113, 134, 209
Coupled-cluster approximation (CCA),
287, 295
Coupled electron pair approximation
(CEPA), 293, 295
Coupled pair many electron theory
(CPME?T), 288
Creation operator, 89
Cyclic polyenes, 310
resonance energy, 311

Davidson correction, 267
DCI (see Doubly excited CI}
Debye unit, 43
Delta function (see Dirac delta function)

461

462. INDEX
Density matrix, 139, 252
unrestricted, 212
Density operator, 139
Determinant, 7
Diagonal diagrams, 335, 363

Diagrammatic perturbation theory, 327,
356
Dipole moment, 150, 377
Dirac delta function, 25, 385, 413
Dirac notation, 9, 26, 30
Dissociation, 221

D-MBPT (©) doubly excited infinite
order many-body perturbation
theory, 293, 369
Double-zeta basis sets, 186
Doublet,

102

Doubly excited CI (DCI), 243
Doubly excited determinants, 59, 236
Doubly excited singlets, 104
Dyadic, 3
Dyson equation, 390
EA (see Electron affinity)

Eigenfunction, 28
Eigenvalue, 15, 28
Eigenvalue problem, 22, 145

Eigenvector, 15
Electric field, 37, 339, 377

Electron affinity, 127, 194

Electron volt, 43
Electronic Hamiltonian, 43

Electronic problem, 40
Energy
electronic, 43
orbital, 123
total, 44

Epstein-Nesbet pair energy, 275
Epstein-Nesbet second-order energy, 369
Exchange correlation, 51, 86

Exchange integrals, 86, 210
Exchange operator, 113, 134, 209
Excited determinants, $8, 234
Extended Hiickel theory, 148
Fermi hole, 53, 280, 285
FH (see Hydrogen fluoride)
Finite perturbation theory, 376
First-order energy, 131, 351
First-order pairs, 276, 352

First-order reduced density matrix, 252
Fock matrix, 137, 140, 214

Fock operator, 54, 114, 208
Force constants, 249

Four center integrals, 154, 415
Frozen orbital approximation, 128, 404

Full CI, 62, 234

matrix, 235
Functional variation, 115
Gaussian basis functions, 153, 181
integral evaluation, 154, 410

Gaussian lobes, 155, 181, 418
Generalized valence bond (GVB), 259
Geometric series, 337, 369
Gerade, 57

Goldstone diagrams, 362
translation rules, 363

Green’s functions
many-body (MBGF), 387, 391
one-body, 383
GVB (see Generalized valence bond)

H (see Hydrogen atom)
H, (see Hydrogen molecule)
Hamiltonian, 31, 41
Hartree unit, 42
Hartree-Fock approximation, 53, 108
Hartree-Fock equation, 54, L11
derivation of, 115
Hartree-Fock Green's function, 388
Hartree-Fock Hamiltonian, 130, 320, 350
Hartree-Fock limit, 55, 62, 146, 191
Hartree-Fock potential, 54, 114

Hartree product, 48
HeH* (see Helium hydride cation)
Helium hydride cation
electron affinity, 398
ionization potentials, 396

potential energy curve, 178
SCF calculation, 168
HFGF (see Hartree-Fock Green’s function)
H,0 (see Water)
Hole orbitals, 54
Hiickel theory, 309, 342
Hund’s rule, 217, 221
Hugenholtz diagrams, 356
translation rules, 359

Hydrogen atom, 33, 178
Hydrogen fluoride
bond length
via MBPT,

371

via SCF, 202
dipole moment
via MBPT, 378
via SCF, 205
ionization potential

INDEX
via Koopmans’,

198

via MBGF, 407
orbital energies, 198
population analysis, 203, 204
SCF energy, 192
Hydrogen molecule
bond length
via CI, 245
via MBPT,

371

via SCF, 201
correlation energy
via CI, 245
via GVB,

260

via MBPT, 370
correlation energy of noninteracting H,’s
via CCA, 289
via CEPA, 294
via DCI, 265, 281, 284
via Epstein-Nesbet pairs, 284
via first-order pairs, 277, 283
via full Cl, 265, 266
via IEPA, 277, 281, 282
via L-CCA, 293
via second-order MBPT, 355
via third-order MBPT, 366, 370
GVB wave function, 259
ionization potential
via Cl, 406
via Koopmans’, 194
via MBGF, 406
MCSCF wave function, 258
minimal basis description, 55
ab initio SCF catculation, 159
correlation energy, 241
electron affinity, 395
Hartree-Fock energy, 82, 135
ionization potentials, 393
MBGEF calculation, 393

MO integrals, 164, 459
orbital energies, 135, 136, 165
second-order energy, 353, 367
spin-adapted configurations, 102

spin orbitals, 57
third-order energy, 353, 367
UBF calculation, 222
orbital energies, 195
potential energy curve
via CI, 242, 246
via GVB, 260
via MBPT, 375, 376
via RHF,

166

via UHF, 227
SCF energy, 192

463

Hydrogenation energies, 193
Hyperfine coupling constant, 218
Idempotent,

139

IEPA (see Independent electron pair
approximation)
Independent electron pair approximation

(IEPA), 273

Initial guess, 148, 174, 216
Integral transformation, 164
Intermediate normalization, 237, 323
Ionization potentials, 125, 194
effect of correlation, 128, 389
effect of relaxation, 128, 389

IP (see Ionization potential)
Iterative natural orbital method, 257
Ket vectors, 9

Koopmans’ theorem, 127
Kronecker delta symbol, 3
Lagrange’s method of undetermined
multipliers, 34, 116
L-CCA (see Linear coupled-cluster
approximation)
Linear coupled-cluster approximation
(L-CCA), 292, 295
Linear dependence, 144
Linear variational problem, 33
Linked cluster theorem, 321, 369
Léwdin population analysis, 152, 204
Many-body perturbation theory (MBPT),
321, 350
diagrammatic representation, 356
relation to MBGF theory, 398
Matrix
adjoint of, 6
diagonal, 6
eigenvalue of, 16
functions of, 21
Hermitian, 7
inverse of, 7
multiplication, 5
orthogonal, 7
symmetric,

7

trace of, 6, 14
transpose, 6
unit, 6
unitary, 7, 13
Matrix elements
rules for one-electron operators, 70, 72
rules for two-electron operators, 70, 72

464 INDEX
Maximum coincidence, 69
MBGF, many-body Green’s function (see
Green’s function)

MBPT (see Many-body perturbation
theory)
MCSCF (see Multiconfiguration selfconsistent field method)
Methane
bond angle
via MBPT, 372

via SCF, 202
bond length
via MBPT, 371

via SCF, 202
ionization potential
via Koopmans’,

198

via MBGF, 407
orbital energies, 198
population analysis, 203, 204
SCF energy, {92
Methyl radical, 216

Open-shell, 101, 206
Operators
adjoint of, 12
Hermitian, 12, 28

linear, 3
matrix representation of, 4, 10, 11

nonlocal, 27, 113
one-electron, 68
second-quantized, 95
two-electron, 68
Orbital] energies, 123
Orbital exponents, 153, 159
Orbital perturbation theory, 339
diagrammatic representation, 348
Orbital relaxation, 403
Orbitals
canonical, 122
Gaussian, 56
hole, 54

molecular, 46
natural, 254

Minimal basis set, 57, 184
Meller-Plesset perturbation theory

occupied, 54

theory)
Mulliken population analysis, 151, 203
Multiconfiguration self-consistent field

spatial, 46
spin, 47
unoccupied, 54

(MPPT), 320, 350
MPPT (see Meller-Plesset perturbation

(MCSCF), 258

N, (see Nitrogen)
NH, (see Ammonia)
Natural orbitals, 252. 254
Nitrogen
bond length
via MBPT, 373
via SCF, 201
1onization potentials
via Cl, 250
via Koopmans’, 196
via MBGF, 407, 408
via UHF, 220
orbital energies, 197
SCF energy, {92

O, (see Oxygen)
Occupied orbitals, 54
One-electron integrals, 65
notations for, 68

One-matrix, 253

One-particle reduced density matrix, 252

particle, 54
restricted, 100, 132
Slater, 56

unrestricted, 105, 207
virtual, 54

Orthogonalization of basis functions, 142
Orthonormal
functions, 25, 47
vectors, 3
Overlap integral, 56
Overlap matrix, 137

Oxygen

UHF orbital energies, 220

Pair energy, 274
Pair function, 273

Pair relaxation, 404
Pair removal, 404
Particle orbitals, 54

Pauli exclusion principle, 46, 50

Permutation, 7
Permutation operator, 67, 114
Perturbation expansion, 130, 322
of the correlation energy, 350
Physicists’ notation, 67
Polarizability, 38, 377
Polarization functions, 189
Pople-Nesbet equations, 210

INDEX
Population analysis
Léwdin, 152, 204
Mulliken, 151, 203

Potential energy surface, 44, 146
Primitive Gaussian functions, 155, 181, 411
Propagator, 387
Rayleigh-Schrédinger perturbation theory
(RSPT), 322
diagrammatic representation, 327
Reduced density function, 252
Reference state, 59
Relaxation energy, 299, 307
via CCA, 305
via CEPA, 306
via full CI, 304
via IEPA, 305
via L-CCA, 306
via MBPT, 340
via SCI, 305
Resonance energy, 309, 311
Resonance energy of benzene
via CEPA, 317
via IEPA, 314
via L-CCA, 317
via mth-order MBPT, 347
via SCI, 316
via second-order MBPT, 343
via third-order MBPT, 345
Resonance energy of cyclic polyenes
via fourth-order MBPT,

349

via IEPA, 314
via SCI, 316
via second-order MBPT, 343
Restricted determinants, 83, {00
energy of 83, 87

Restricted Hartree-Fock, 83, 132
Restricted spin orbitals, 100, 132
RHF (see Restricted Hartree-Fock}
Roothan equations, 138
RSPT (see Rayleigh-Schrédinger perturba-

tion theory)
Rules for matrix elements, 70, 72
derivation of, 74
Scalar product, 2, 6, 10, 27
Scaling, 158, 188

SCF (see Self-consistent field)
Schmidt orthogonalization, 16, 173
Schrédinger equation, 31, 40

time-dependent, 386
SDCI, singly and doubly excited configuration interaction, 243

465

Second-order energy, 352, 360, 366
Second-order self-energy, 390, 393
Second quantization, 89
Secular determinant, 17, 18
Self-consistent field method, 54, 140, 145

Self-energy, 389

second-order, 390, 393
third-order, 390, 395

Shifted energy denominator, 337, 369
Singlet, 101
Singly excited determinants, 59, 236
effect on dipole moment, 251
effect on energy, 248
Size consistency, 261, 271, 369
Slater determinant, 50, 74
energy of, 71, 73, 88
Spatial orbitals, 46
Spin, 45, 97

Spin-adapted configurations, 100, 234
matrix elements between, 236
Spin-adapted pairs, 278
Spin angular momentum, 97
commutation relations, 98
Spin contamination, 107, 228

Spin density, 212, 217
matrix, 213

Spin functions, 45
Spin operators, 97
Spin orbital pair energies, 278
Spin orbitals, 47

Split valence-shell basis set, 187

Summation of diagrams, 336, 368
Symmetric orthogonalization, 143, 174
Triplet, 102
Two-electron integrals, 66, 141

notations for, 68
UHF (see Unrestricted Hartree-Fock)
Ungerade, 57
Unitary transformation, 14
Unlinked diagrams, 321, 329, 369
Unoccupied orbitals, 54
Unrestricted determinants, 104
energy of, 2{0, 215
Unrestricted Hartree-Fock, 205
Unrestricted spin orbitals, 105, 207
Vacuum

state, 93

Valence bond, 167, 259
Variation method, 32
Variation principle, 31

466

INDEX

Vertical ionization potential, 194, 393
Virtual orbitals, 54

Water
bond angle
via CCA, 297
via Cl, 249
via L-CCA, 297
via MBPT, 372, 373
via SCF, 202
bond length
via CCA, 297
via Cl, 249
via L-CCA, 297
via MBPT, 371, 373
via SCF, 202
correlation energy

via CCA, 296
via CI, 248
via IEPA, 296
via L-CCA, 296

via MBPT, 373
dipole moment

via CI, 251
via MBPT, 378
via SCF, 205

force constants
via CCA, 297
via Cl, 249
via L-CCA, 297
via MBPT, 373
via SCF, 249
ionization potential
via Cl, 250
via Koopmans’, 198
via MBGF, 407
orbital energies, 198, 199

population analysis, 203, 204
SCF energy, {92
Zero-point energies, 193
Zeroth-order energy, 130, 35{

Note: To request information about or place an order for HyperChem, please
contact Hypercube, Inc., directly, using the information on the opposite page. Do
not contact Dover Publications;
Hypercube, Inc.

there is no connection between

Dover and

